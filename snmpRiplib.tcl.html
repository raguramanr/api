<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/transitional.dtd">
<!-- Generated by TclDoc @@VERSION@@ -->
<html>
<head>
  <title>snmpRiplib.tcl</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="default.css">
</head>
<body class="src-html">
<div class="index-selector">
<!-- index for tcl source files -->
	Index by: 
	<a href="index_main.html#snmpRiplib.tcl">file name</a> | 
	<a href="index_main.html#byprocname">procedure name</a> | 
	<a href="index_main.html#bycall">procedure call</a> | 
	<a href="index_annot_full.html">annotation</a>

</div>
<hr>

<p><strong>snmpRiplib.tcl</strong>&nbsp;&nbsp;<span class="filetype-link">(<a href="snmpRiplib.tcl-annot.html">annotations</a> | <a href="snmpRiplib.tcl.txt">original source</a>)</span>
</p>
<pre class="src-code">
<span class="comment-line">#!/usr/bin/tclsh</span>

<span class="comment-line">################################################################</span>
<span class="comment-line">#  Procedure Name: snmpEnableRIPIf</span>
<span class="comment-line">#  </span>
<span class="comment-line">#  Description:</span>
<span class="comment-line">#  This procedure enables RIP on a vlan with the specified vlan </span>
<span class="comment-line">#  ip address in the given DUT.</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Input Variables:</span>
<span class="comment-line">#    session - Session identifier which identifies the connection</span>
<span class="comment-line">#              with the DUT</span>
<span class="comment-line">#    ipa  - IP address of the VLAN on which RIP interface </span>
<span class="comment-line">#                 needs to be enabled.</span>
<span class="comment-line"># </span>
<span class="comment-line">#  Optional Args:</span>
<span class="comment-line">#    fd - File descriptor for logging the command outputs   </span>
<span class="comment-line"># </span>
<span class="comment-line">#  Output Variables: </span>
<span class="comment-line">#     None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Variables:</span>
<span class="comment-line">#    Logs the error message - On failure </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Possible Usage:</span>
<span class="comment-line">#    snmpEnableRIPIf -session $sessionid -ipa &#34;10.0.0.1&#34; </span>
<span class="comment-line">###############################################################</span>

<strong><a name="::::snmpEnableRIPIf_29">proc <a href="snmpRiplib.tcl-annot.html#::::snmpEnableRIPIf">::::snmpEnableRIPIf</a></a></strong> { args } {
    <a name="::parse_args(1)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> snmpEnableRIPIf $args {
       session &#34;&#34;
       ipa  &#34;&#34;
       fd &#34;NULL&#34;
    }
 
    set func &#34;snmpEnableRIPIf:&#34; 

    if { $session == &#34;&#34; || $ipa == &#34;&#34; } {
       <a name="::result_error(1)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;$func session and ipaddress must be specified&#34;
       return
    }   

    <a name="::snmpDebug(1)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func session-$session ipaddress -$ipa fd-$fd -Start&#34; $fd
    <a name="::result_debug(1)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\n-- Enabling RIP on the interface $ipa --&#34;

<span class="comment-line"># ---- Enable rip2IfConfStatus.for this interface</span>
    set result [snmpSet -session $session -oid rip2IfConfStatus.$ipa -type i -val 1]
    <a name="::snmpDebug(2)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func snmpSet-$result&#34; $fd
    return $result
}

<span class="comment-line">################################################################</span>
<span class="comment-line">#  Procedure Name: snmpDisableRIPIf</span>
<span class="comment-line">#  </span>
<span class="comment-line">#  Description:</span>
<span class="comment-line">#  This procedure disables RIP on a vlan with the specified vlan </span>
<span class="comment-line">#  ip address in the given DUT.</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Input Variables:</span>
<span class="comment-line">#    session - Session identifier which identifies the connection</span>
<span class="comment-line">#              with the DUT</span>
<span class="comment-line">#    ipa  - IP address of the VLAN on which RIP interface </span>
<span class="comment-line">#                 needs to be disabled.</span>
<span class="comment-line"># </span>
<span class="comment-line">#  Optional Args:</span>
<span class="comment-line">#    fd - File descriptor for logging the command outputs   </span>
<span class="comment-line"># </span>
<span class="comment-line">#  Output Variables: </span>
<span class="comment-line">#     None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Variables:</span>
<span class="comment-line">#    Logs the error message - On failure </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Possible Usage:</span>
<span class="comment-line">#    snmpDisbleRIPIf -session $sessionid -ipa &#34;10.0.0.1&#34;</span>
<span class="comment-line">###############################################################</span>

<strong><a name="::::snmpDisableRIPIf_78">proc <a href="snmpRiplib.tcl-annot.html#::::snmpDisableRIPIf">::::snmpDisableRIPIf</a></a></strong> { args } {
    <a name="::parse_args(2)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> snmpDisableRIPIf $args {
       session &#34;&#34;
       ipa  &#34;&#34;
       fd &#34;NULL&#34;
    }
 
    set func &#34;snmpDisableRIPIf:&#34; 

    if { $session == &#34;&#34; || $ipa == &#34;&#34; } {
       <a name="::result_error(2)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;$func session and ipaddress must be specified&#34;
       return
    }   

    <a name="::snmpDebug(3)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func session-$session ipaddress -$ipa fd-$fd -Start&#34; $fd
    <a name="::result_debug(2)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\n-- Disabling RIP on the interface $ipa --&#34;

<span class="comment-line"># ---- Disable rip2IfConfStatus.for this interface</span>
    set result [snmpSet -session $session -oid  rip2IfConfStatus.$ipa -type i -val 2]

    <a name="::snmpDebug(4)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func snmpSet-$result&#34; $fd
}

<span class="comment-line">################################################################</span>
<span class="comment-line">#  Procedure Name:snmpUtilGetRipVer </span>
<span class="comment-line">#  </span>
<span class="comment-line">#  Description:</span>
<span class="comment-line">#  This procedure extracts RIP version from the string obtained  </span>
<span class="comment-line">#  by SNMP Get operation.      </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Input Variables:</span>
<span class="comment-line">#    session - Session identifier which identifies the connection</span>
<span class="comment-line">#              with the DUT</span>
<span class="comment-line">#    param   - The string which is obtained from SNMP Get operation</span>
<span class="comment-line"># </span>
<span class="comment-line">#  Output Variables: </span>
<span class="comment-line">#     res </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Variables:</span>
<span class="comment-line">#     res which contains the value returned from SNMP Get operation </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Possible Usage:</span>
<span class="comment-line">#    snmpUtilGetRipVer &#34;hklllllrip1ksklsaksk&#34;</span>
<span class="comment-line">###############################################################</span>

<strong><a name="::::snmpUtilGetRipVer_123">proc <a href="snmpRiplib.tcl-annot.html#::::snmpUtilGetRipVer">::::snmpUtilGetRipVer</a></a></strong> { param } {
 
   set func &#34;snmpUtilGetRipVer:&#34;

   set res &#34;&#34;
   set res1 &#34;&#34;
   regexp {.*INTEGER.*\(([0-9]+)\)} $param res1 res
   return &#34;$res&#34;
}

<span class="comment-line">################################################################</span>
<span class="comment-line">#  Procedure Name: snmpSetRIPTx</span>
<span class="comment-line">#  </span>
<span class="comment-line">#  Description:</span>
<span class="comment-line">#  This procedure sets the RIP Tx on a vlan with the specified vlan </span>
<span class="comment-line">#  ip address in the given DUT. Depending upon the Tx value, RIP </span>
<span class="comment-line">#  packet of appropriate version will be sent.</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Input Variables:</span>
<span class="comment-line">#    session - Session identifier which identifies the connection</span>
<span class="comment-line">#              with the DUT</span>
<span class="comment-line">#    ipa  - IP address of the VLAN on which RIP interface </span>
<span class="comment-line">#                 needs to be disabled.</span>
<span class="comment-line">#    version - Rip Version number depending on which packets needs </span>
<span class="comment-line">#            to be transmitted.</span>
<span class="comment-line"># </span>
<span class="comment-line">#  Optional Args:</span>
<span class="comment-line">#    fd - File descriptor for logging the command outputs   </span>
<span class="comment-line"># </span>
<span class="comment-line">#  Output Variables: </span>
<span class="comment-line">#     None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Variables:</span>
<span class="comment-line">#    Logs the error message - On failure </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Possible Usage:</span>
<span class="comment-line">#    snmpSetRIPTx -session $sessionid -ipa &#34;10.0.0.1&#34; -version v1only </span>
<span class="comment-line">#                 -vlan vlan1</span>
<span class="comment-line">###############################################################</span>

<strong><a name="::::snmpSetRIPTx_163">proc <a href="snmpRiplib.tcl-annot.html#::::snmpSetRIPTx">::::snmpSetRIPTx</a></a></strong> { args } {
    <a name="::parse_args(3)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> snmpSetRIPTx $args {
       session &#34;&#34;
       ipa  &#34;&#34;
       fd &#34;NULL&#34;
       <a name="::version(1)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a> &#34;&#34;
       <a name="::vlan(1)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> &#34;&#34;
    }
 
    set func &#34;snmpSetRIPTx:&#34; 
    set val &#34;&#34;

    if { $session == &#34;&#34; || $ipa == &#34;&#34;  || $version == &#34;&#34;} {
       error &#34;$func session, ipaddress and Version must be specified&#34;
       return
    }   

    if {$version == &#34;none&#34;} {
        set val 1
    } elseif {$version == &#34;v1only&#34; } {
        set val 2
    } elseif {$version == &#34;v1comp&#34; } {
        set val 3
    } elseif {$version == &#34;v2only&#34; } {
        set val 4
    } elseif {$version == &#34;ripV1Demand&#34; } {
        set val 5
    } elseif {$version == &#34;ripV2Demand&#34; } {
        set val 6
    }

    <a name="::snmpDebug(5)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func session-$session ipaddress -$ipa version -$version fd-$fd -Start&#34; $fd

    if { $vlan != &#34;&#34; } {
      <a name="::result_debug(3)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\n-- Setting RIP Tx mode to $version in vlan $vlan&#34;
    } else {
      <a name="::result_debug(4)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\n-- Setting RIP Tx mode to $version in Switch&#34;
    }

    set result [snmpSet -session $session -oid  rip2IfConfSend.$ipa -type i \
                        -val $val]
    <a name="::snmpDebug(6)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func snmpSet-$result&#34; $fd
    set result [snmpGet -session $session -oid  rip2IfConfSend.$ipa]
    <a name="::snmpDebug(7)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func snmpGet-$result&#34; $fd
    set getVal [<a name="::snmpUtilGetRipVer(1)"><a href="./snmpRiplib.tcl.html#::snmpUtilGetRipVer_123">::snmpUtilGetRipVer</a></a> $result]
    <a name="::snmpDebug(8)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func The Value received is $getVal&#34; $fd

<span class="comment-line"># ---- If SNMP Get operation matches with the Set value, SNMP Set works. </span>
<span class="comment-line">#      Otherwise Set using CLI. CLI operation will be removed once the </span>
<span class="comment-line">#      related PD is fixed.</span>

    if {$getVal != $val} {
        <a name="::snmpDebug(9)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> &#34;$func snmpSet is done for $val but snmpGet fetched value $getVal&#34; $fd
<span class="comment-line"># ---- If vlan name is mentioned, configure RIPTx mode for the specifi vlan.</span>
<span class="comment-line">#      Or else set the RIPTx mode globally for the switch </span>
      if {$vlan == &#34;&#34;} {
        <a name="::SendACmd(1)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config rip vlan all txmode $version&#34;
      } else {
        <a name="::SendACmd(2)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config rip vlan $vlan txmode $version&#34;
      }
    } else {
        <a name="::result_ok(1)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;$func snmpSet is done for $val and snmpGet \
                        fetched value $getVal&#34;
    }
}

<span class="comment-line">################################################################</span>
<span class="comment-line">#  Procedure Name: snmpSetRIPRx</span>
<span class="comment-line">#  </span>
<span class="comment-line">#  Description:</span>
<span class="comment-line">#  This procedure sets the RIP Rx on a vlan with the specified vlan </span>
<span class="comment-line">#  ip address in the given DUT. Depending upon the Rx value, RIP </span>
<span class="comment-line">#  packet of appropriate version will be received.</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Input Variables:</span>
<span class="comment-line">#    session - Session identifier which identifies the connection</span>
<span class="comment-line">#              with the DUT</span>
<span class="comment-line">#    ipa  - IP address of the VLAN on which RIP interface </span>
<span class="comment-line">#                 needs to be disabled.</span>
<span class="comment-line">#    version - Rip Version number depending on which packets needs </span>
<span class="comment-line">#    vlan    - vlan name for which RIP Tx mode is Set. </span>
<span class="comment-line">#              used incase CLI configuration is used.</span>
<span class="comment-line"># </span>
<span class="comment-line">#  Optional Args:</span>
<span class="comment-line">#    fd - File descriptor for logging the command outputs   </span>
<span class="comment-line"># </span>
<span class="comment-line">#  Output Variables: </span>
<span class="comment-line">#     None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Variables:</span>
<span class="comment-line">#    Logs the error message - On failure </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Possible Usage:</span>
<span class="comment-line">#    snmpSetRIPRx -session $sessionid -ipa &#34;10.0.0.1&#34; -version v1only </span>
<span class="comment-line">#                 -vlan vlan1</span>
<span class="comment-line">###############################################################</span>

<strong><a name="::::snmpSetRIPRx_260">proc <a href="snmpRiplib.tcl-annot.html#::::snmpSetRIPRx">::::snmpSetRIPRx</a></a></strong> { args } {
    <a name="::parse_args(4)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> snmpSetRIPRx $args {
       session &#34;&#34;
       ipa  &#34;&#34;
       fd &#34;NULL&#34;
       <a name="::version(2)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a> &#34;&#34;
       <a name="::vlan(2)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> &#34;&#34;
    }
 
    set func &#34;snmpSetRIPRx:&#34; 

    if { $session == &#34;&#34; || $ipa == &#34;&#34;  || $version == &#34;&#34;} {
       <a name="::result_error(3)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;$func session, ipaddress and Version must be specified&#34;
       return
    }   

    if {$version == &#34;v1only&#34; } {
        set val 1
    } elseif {$version == &#34;v2only&#34; } {
        set val 2
    } elseif {$version == &#34;any&#34; } {
        set val 3
    } elseif {$version == &#34;none&#34;} {
        set val 4
    } else {
       error &#34;$func Version must be specified one of v1only v2only any none&#34;
       return
    }   
    <a name="::snmpDebug(10)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func session-$session ipaddress -$ipa version -$version fd-$fd -Start&#34; $fd

    if { $vlan != &#34;&#34; } {
      <a name="::result_debug(5)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\n-- Setting RIP Rx mode to $version in vlan $vlan --&#34;
    } else {
      <a name="::result_debug(6)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\n-- Setting RIP Rx mode to $version in Switch --&#34;
    }

    set result [snmpSet -session $session -oid  rip2IfConfReceive.$ipa -type i -val $version]
    <a name="::snmpDebug(11)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func snmpSet-$result&#34; $fd
    set result [snmpGet -session $session -oid  rip2IfConfReceive.$ipa]
    <a name="::snmpDebug(12)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func snmpGet-$result&#34; $fd
    set getVal [<a name="::snmpUtilGetRipVer(2)"><a href="./snmpRiplib.tcl.html#::snmpUtilGetRipVer_123">::snmpUtilGetRipVer</a></a> $result]
    <a name="::snmpDebug(13)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func The Value received is $getVal&#34; $fd

<span class="comment-line"># ---- If SNMP Get operation matches with the Set value, SNMP Set works. </span>
<span class="comment-line">#      Otherwise Set using CLI. CLI operation will be removed once the </span>
<span class="comment-line">#      related PD is fixed.</span>
    if {$getVal != $val} {
        <a name="::snmpDebug(14)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> &#34;$func snmpSet is done for $val but snmpGet fetched value $getVal&#34; $fd
<span class="comment-line"># ---- If vlan name is mentioned, configure RIPRx mode for the specifi vlan.</span>
<span class="comment-line">#      Or else set the RIPRx mode globally for the switch</span>
        if { $vlan == &#34;&#34;} {
           <a name="::SendACmd(3)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config rip vlan all rxmode $version&#34;
        } else {
           <a name="::SendACmd(4)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config rip vlan $vlan rxmode $version&#34;
        }
    } else {
        <a name="::result_ok(2)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;$func snmpSet is done for $val and snmpGet \
                        fetched value $getVal&#34;
    }
}

<span class="comment-line">################################################################</span>
<span class="comment-line">#  Procedure Name: snmpVerifyRIPconfig</span>
<span class="comment-line">#  </span>
<span class="comment-line">#  Description:</span>
<span class="comment-line">#  This procedure verifies various configured value of RIP. </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Input Variables:</span>
<span class="comment-line">#    session - Session identifier which identifies the connection</span>
<span class="comment-line">#              with the DUT</span>
<span class="comment-line">#    vlanid  - vlan id for which vlan verification is done</span>
<span class="comment-line">#    ipa  - IP address of the VLAN on which RIP interface </span>
<span class="comment-line">#    forwarding  - Ip Forwarding for this interface </span>
<span class="comment-line">#    ripStatus   - Whether RIP is enabled or disabled</span>
<span class="comment-line"># </span>
<span class="comment-line">#  Optional Args:</span>
<span class="comment-line">#    fd - File descriptor for logging the command outputs   </span>
<span class="comment-line"># </span>
<span class="comment-line">#  Output Variables: </span>
<span class="comment-line">#     None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Variables:</span>
<span class="comment-line">#    Logs the error message - On failure </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Possible Usage:</span>
<span class="comment-line">#    snmpVerifyRIPconfig -session $sessionid -ipa &#34;10.0.0.1&#34;</span>
<span class="comment-line">#                        -vlanid 79 -forwarding enable -ripStatus enable</span>
<span class="comment-line">#                        -fd $fd_res</span>
<span class="comment-line">###############################################################</span>

<strong><a name="::::snmpVerifyRIPconfig_350">proc <a href="snmpRiplib.tcl-annot.html#::::snmpVerifyRIPconfig">::::snmpVerifyRIPconfig</a></a></strong> { args } {
    <a name="::parse_args(5)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> snmpVerifyRIPconfig $args {
       session &#34;&#34;
       vlanid &#34;&#34;
       ipa  &#34;&#34;
       forwarding &#34;&#34;
       ripStatus &#34;&#34;
       fd &#34;NULL&#34;
       comment &#34;Verification for RIP Status and IP Forwarding status on \
                interface $ipa&#34;
    }
 
    set func &#34;snmpVerifyRIPconfig:&#34; 

    <a name="::result_debug(7)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$func verifying the RIP status and IP Forwarding status on \
                  interface $ipa&#34;

    set forwarding [string tolower $forwarding]
    set ripStatus [string tolower $ripStatus]

    set status(1) &#34;enable&#34;
    set status(2) &#34;disable&#34;

    if { $session == &#34;&#34; || $vlanid == &#34;&#34; } {
       <a name="::result_error(4)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;$func session and vlanid must be specified&#34;
       return
    } elseif {$forwarding != &#34;&#34; &amp;&amp; $forwarding != &#34;enable&#34; &amp;&amp; 
              $forwarding != &#34;disable&#34;} {
       <a name="::result_error(5)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;$func forwarding is expected either enable or disable but \
               got $forwarding&#34;
       return
    } elseif {$ripStatus != &#34;&#34; &amp;&amp; $ripStatus != &#34;enable&#34; &amp;&amp; 
              $ripStatus != &#34;disable&#34;} {
       <a name="::result_error(6)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;ripStatus  is expected either enable or disable but \
               got $forwarding&#34;
       return
    }

    <a name="::snmpDebug(15)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func session-$session vlanid -$vlanid fd-$fd -Start&#34; $fd

    <a name="::report_start_test(1)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;Verification for RIP Status and IP Forwarding status on \
                       interface $ipa&#34;

<span class="comment-line"># ---- verify forwarding status for the given vlan</span>
    if {$forwarding != &#34;&#34;} {
      set result [snmpGet -session $session -oid \
                          extremeVlanIpForwardingState.$vlanid]
      <a name="::snmpDebug(16)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func snmpGet-$result&#34; $fd
      set val [<a name="::snmpUtilGetVal(1)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> boolean $result]
      <a name="::snmpDebug(17)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func snmpGetVal-$val&#34; $fd

<span class="comment-line"># ---- If The return value is true, RIP is enabled, or it is disabled. set </span>
<span class="comment-line">#      val accordingly required for comparison later</span>
      if {$val == &#34;true&#34;} {
        set val &#34;enable&#34;
      } elseif {$val == &#34;false&#34;} {
        set val &#34;disable&#34;
      }

<span class="comment-line"># ---- If forwarding status of the vlan does not match with the expected </span>
<span class="comment-line">#      value, log Error</span>
      if {$forwarding == $val } {
         <a name="::result_ok(3)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Check status for IP Forwarding for interface $ipa passed \
                    status is $forwarding as expected&#34;
      } else {
         <a name="::result_error(7)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Check forwarding status failed for interface $ipa \
                       expected $forwarding but got $status($val)&#34;
      }
    } 

<span class="comment-line"># ---- verify rip status for the given vlan</span>
    if { $ripStatus != &#34;&#34;} {
      set result [snmpGet -session $session -oid  rip2IfConfStatus.$ipa ]
      <a name="::snmpDebug(18)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func snmpGet-$result&#34; $fd
      set val [<a name="::snmpUtilGetVal(2)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> inttext $result]
      <a name="::snmpDebug(19)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func snmpGetVal-$val&#34; $fd

<span class="comment-line"># ---- If RIP status of the vlan does not match with the expected </span>
<span class="comment-line">#      value, log Error</span>
      if {$ripStatus == &#34;enable&#34; &amp;&amp; $val == &#34;active&#34;} {
         <a name="::result_ok(4)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Check status for ripStatus for interface $ipa passed \
                    status is $ripStatus as expected&#34;
      } elseif {$ripStatus == &#34;disable&#34; &amp;&amp; $val != &#34;active&#34;} {
         <a name="::result_ok(5)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Check status for ripStatus for interface $ipa passed \
                    status is $ripStatus as expected&#34;
      } else {
         <a name="::result_error(8)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Check ripStatus failed for vlan $vlanid. \
                       expected $ripStatus but got $val&#34;
      }
    }
   <a name="::report_end_test(1)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: SendRipErrorFrame   </span>
<span class="comment-line"># Description: </span>
<span class="comment-line">#	Send RIP packet(request or response) from an ixia port.  This Proc</span>
<span class="comment-line">#	mainly simulates a neighbor to advertise RIP routes to DUT. </span>
<span class="comment-line"># Input args: args</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: Frame sent</span>
<span class="comment-line"># Typical usage: </span>
<span class="comment-line">#	set frame [SendRipFrame -txPortId 1  -destMac $destMac -frameSize 130 \</span>
<span class="comment-line">#         -sourceIp 192.207.39.2  -destIp $destIP \</span>
<span class="comment-line">#         -command $ripCommand  -version $ver  -numRoute 4 \</span>
<span class="comment-line">#         -routeFamilyId {2 2 2 2}  -routeTag {00 00 00 00}\</span>
<span class="comment-line">#         -routeIp &#34;$oldRoute(1) $oldRoute(2) $newRoute(1) $newRoute(2)&#34;  \</span>
<span class="comment-line">#         -routeMask &#34;$routeMask $routeMask $routeMask $routeMask&#34; \</span>
<span class="comment-line">#         -routeNextHop {0.0.0.0  0.0.0.0 0.0.0.0 0.0.0.0} \</span>
<span class="comment-line">#         -routeMetric {2 5 1 3} ]     </span>
<span class="comment-line">#         -udfEnable &#34;true&#34;</span>
<span class="comment-line">#         -udfInitval &#34;03&#34;</span>
<span class="comment-line">#         -udfOffset  &#34;43&#34;</span>
<span class="comment-line">#         -udfCountertype &#34;c1&#34;</span>
<span class="comment-line"># Category: SendTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::SendRipErrorFrame_466">proc <a href="snmpRiplib.tcl-annot.html#::::SendRipErrorFrame">::::SendRipErrorFrame</a></a></strong> {args} {
   <a name="::parse_args(6)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> SendRipErrorFrame $args {
     txPortId &#34;1&#34;
     sourceMac &#34;default&#34;
     destMac &#34;01 00 5e 00 00 09&#34;
     sourceIp &#34;127.0.0.1&#34;
     destIp &#34;224.0.0.9&#34;
     gatewayIp &#34;127.0.0.1&#34;
     sourcePort &#34;520&#34;
     destPort &#34;520&#34;
     goodChecksum &#34;true&#34;
     numFrames &#34;1&#34;
     frameSize &#34;70&#34;
     ipOptions &#34;&#34;
     frameRate &#34;default&#34;
     dataPattern &#34;0000&#34;
     streamType &#34;stopStream&#34;
     fcsError &#34;good&#34;
     tag &#34;none&#34;
     TOS &#34;0x00&#34;
     userPriority &#34;0&#34;
     percentage &#34;100&#34;
     priority &#34;0&#34;
     saMode &#34;idle&#34;
     daMode &#34;idle&#34;
     ipSaMode &#34;ipIdle&#34;
     ipDaMode &#34;ipIdle&#34;
     id &#34;0&#34;
     command &#34;ripRequest&#34;
     <a name="::version(3)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a> &#34;2&#34;
     authen &#34;&#34;
     authenType &#34;2&#34;
     numRoute &#34;1&#34;
     routeFamilyId {2}
     routeTag {00}
     routeIp {0.0.0.0}
     routeMask {0.0.0.0} 
     routeNextHop {0.0.0.0}
     routeMetric {16}
     udfEnable &#34;false&#34;
     udfInitval &#34;00&#34;
     udfOffset &#34;0&#34;
     udfCountertype &#34;c8&#34;
   }

   set numIxiaCd [<a name="::::GetNumIxiaCd(1)"><a href="./SystemSetup.tcl.html#::::GetNumIxiaCd_546">::::GetNumIxiaCd</a></a> $txPortId]
   set rxPo [<a name="::MapIxiaPortId(1)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $txPortId chasisId card port]
   if {$tag != &#34;none&#34; } { set wTag &#34;true&#34; } else {set wTag &#34;false&#34; }
   global startCardNum
   set frameSent [<a name="::ixiaConf_2Ports_ip(1)"><a href="./ePTL3Tx.tcl.html#::ixiaConf_2Ports_ip_867">::ixiaConf_2Ports_ip</a></a> -numIxiaCd $numIxiaCd  \
              -txChas $chasisId -txCard $card -txPort $port \
              -rxChas $chasisId -rxCard $card -rxPort $rxPo \
              -ipProtocol &#34;udp&#34; -sMacAddr $sourceMac -dMacAddr $destMac \
              -sIpAddr $sourceIp -dIpAddr $destIp -dDutIpAddr $gatewayIp \
              -pSrcPort $sourcePort -pDstPort $destPort -ttl 1 \
	      -goodChecksum $goodChecksum -numFrames $numFrames -frameSize $frameSize \
	      -frameRate $frameRate -dataPattern $dataPattern -streamType $streamType \
	      -fcsError $fcsError -wTag $wTag -tagNo $tag -TOS $TOS -userPriority $userPriority \
	      -percentage $percentage -priority $priority -ipOptions $ipOptions \
              -saMode $saMode -daMode $daMode -ipSaMode $ipSaMode -ipDaMode $ipDaMode \
              -id $id -ipApplication &#34;rip&#34; -ripCommand $command  -ripVersion $version \
              -ripAuthen $authen  -ripAuthenType $authenType  -ripNumRoute $numRoute \
              -ripRouteFamilyId $routeFamilyId  -ripRouteIp $routeIp  \
              -ripRouteMetric $routeMetric  -ripRouteNextHop $routeNextHop  \
              -ripRouteTag $routeTag  -ripRouteMask $routeMask \
              -udfEnable $udfEnable -udfInitval $udfInitval -udfOffset $udfOffset -udfCountertype $udfCountertype ]
                                  
  if {$streamType != &#34;contPacket&#34; &amp;&amp; $numFrames &gt; 100} {
    <a name="::ixiaCheckTxDone(1)"><a href="./ePTMisc.tcl.html#::ixiaCheckTxDone_334">::ixiaCheckTxDone</a></a> $chasisId $card $port $numFrames
  }  
  return $frameSent           
}

</pre>
<hr>
<div class="index-selector">
	<a href="index_main.html#byfilename">file name</a> 
 | 
	<a href="index_main.html#byprocname">procedure name</a> 
 | 
	<a href="index_main.html#bycall">procedure call</a> 
 | 
	<a href="index_annot_full.html">annotation</a> 

<br>
<cite>File generated 2018-06-14 at 17:09.</cite>
</div>

</body>
</html>
