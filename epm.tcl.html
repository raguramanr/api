<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/transitional.dtd">
<!-- Generated by TclDoc @@VERSION@@ -->
<html>
<head>
  <title>epm.tcl</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="default.css">
</head>
<body class="src-html">
<div class="index-selector">
<!-- index for tcl source files -->
	Index by: 
	<a href="index_main.html#epm.tcl">file name</a> | 
	<a href="index_main.html#byprocname">procedure name</a> | 
	<a href="index_main.html#bycall">procedure call</a> | 
	<a href="index_annot_full.html">annotation</a>

</div>
<hr>

<p><strong>epm.tcl</strong>&nbsp;&nbsp;<span class="filetype-link">(<a href="epm.tcl-annot.html">annotations</a> | <a href="epm.tcl.txt">original source</a>)</span>
</p>
<pre class="src-code">
<span class="comment-line">####################################################################</span>
<span class="comment-line"># Procedure: killExosProcess</span>
<span class="comment-line">#</span>
<span class="comment-line"># inArgs:  -process       = process name</span>
<span class="comment-line">#          -waitForReboot = true|false  default=true</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">####################################################################</span>
<strong><a name="::::killExosProcess_9">proc <a href="epm.tcl-annot.html#::::killExosProcess">::::killExosProcess</a></a></strong> {args} {
    global DUTs_Info MAIN connectionTimeout

    <a name="::parse_args(1)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> killExosProcess $args {
        process        &#34;null&#34;
        waitForReboot  &#34;true&#34;
        time           &#34;null&#34;
    }

    if {$process == &#34;null&#34;} {
        <a name="::result_warning(1)"><a href="./ql_multi.tcl.html#::result_warning_407">::result_warning</a></a> &#34;No process passed in to kill&#34;
    }
    if {$time == &#34;null&#34;} {
        set time {s: 10 i: 20 f: 60}
    }
    <a name="::EnableDebugMode(1)"><a href="./misc.tcl.html#::EnableDebugMode_2430">::EnableDebugMode</a></a>
    <a name="::ShellSend(1)"><a href="./SendSwCmd.tcl.html#::ShellSend_3233">::ShellSend</a></a> &#34;!sh&#34;
    <a name="::ShellSend(2)"><a href="./SendSwCmd.tcl.html#::ShellSend_3233">::ShellSend</a></a> &#34;ps -ef | grep $process&#34;
    <a name="::ShellSend(3)"><a href="./SendSwCmd.tcl.html#::ShellSend_3233">::ShellSend</a></a> &#34;killall -9 $process&#34;
    <a name="::ShellSend(4)"><a href="./SendSwCmd.tcl.html#::ShellSend_3233">::ShellSend</a></a> &#34;exit&#34;

    if {$waitForReboot == &#34;true&#34;} {
        set com &#34;Wait for switch to reboot after epm reboot due to process $process killed&#34;
        <a name="::WaitForReboot(1)"><a href="./SendSwCmd.tcl.html#::WaitForReboot_1446">::WaitForReboot</a></a> 90 $com 1
        <a name="::VerifyExosProcessState(1)"><a href="./epm.tcl.html#::VerifyExosProcessState_47">::VerifyExosProcessState</a></a> -process $process -time $time
        return 1
    } else {
        return 0
    }
}
<span class="comment-line">####################################################################</span>
<span class="comment-line"># Procedure: VerifyExosProcessState</span>
<span class="comment-line">#</span>
<span class="comment-line"># inArgs:  -process = process|null   default=null checks all procs are ready</span>
<span class="comment-line">#          -state   = Ready|crashed  default=Ready</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">####################################################################</span>
<strong><a name="::::VerifyExosProcessState_47">proc <a href="epm.tcl-annot.html#::::VerifyExosProcessState">::::VerifyExosProcessState</a></a></strong> {args} {
    global DUTs_Info MAIN connectionTimeout

    <a name="::parse_args(2)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> VerifyExosProcessState $args {
        process      &#34;null&#34;
        state        &#34;Ready&#34;
        time         &#34;null&#34;
    }

    if {$process == &#34;null&#34;} {
        <a name="::result_debug(1)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;-process is a required arg.  Else output is too large&#34;
        return 0;
        set state &#34;Ready|Init|No license&#34;
        set parameterList &#34;&#34;
        lappend parameterList &#34;{epmpcb {state}} {$state} regexExist&#34;
        return [<a name="::CheckDictValue(1)"><a href="./jsonLib.tcl.html#::CheckDictValue_319">::CheckDictValue</a></a> -cmd &#34;show process&#34; -parameterList $parameterList \
           -comment &#34;Check that all processes are $state&#34; -yesorno &#34;Yes&#34; \
           -debugjson &#34;false&#34; -time &#34;$time&#34;]
    } else {
        set parameterList &#34;&#34;
        lappend parameterList &#34;{epmpcb {name state}} {$process $state} exist&#34;
        return [<a name="::CheckDictValue(2)"><a href="./jsonLib.tcl.html#::CheckDictValue_319">::CheckDictValue</a></a> -cmd &#34;show process $process&#34; -parameterList $parameterList \
           -comment &#34;Check that all processes are $state&#34; -yesorno &#34;Yes&#34; \
           -debugjson &#34;false&#34; -time &#34;$time&#34;]
    }
}
</pre>
<hr>
<div class="index-selector">
	<a href="index_main.html#byfilename">file name</a> 
 | 
	<a href="index_main.html#byprocname">procedure name</a> 
 | 
	<a href="index_main.html#bycall">procedure call</a> 
 | 
	<a href="index_annot_full.html">annotation</a> 

<br>
<cite>File generated 2018-06-14 at 17:09.</cite>
</div>

</body>
</html>
