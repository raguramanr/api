<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/transitional.dtd">
<!-- Generated by TclDoc @@VERSION@@ -->
<html>
<head>
  <title>cleanup.tcl</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="default.css">
</head>
<body class="src-html">
<div class="index-selector">
<!-- index for tcl source files -->
	Index by: 
	<a href="index_main.html#cleanup.tcl">file name</a> | 
	<a href="index_main.html#byprocname">procedure name</a> | 
	<a href="index_main.html#bycall">procedure call</a> | 
	<a href="index_annot_full.html">annotation</a>

</div>
<hr>

<p><strong>cleanup.tcl</strong>&nbsp;&nbsp;<span class="filetype-link">(<a href="cleanup.tcl-annot.html">annotations</a> | <a href="cleanup.tcl.txt">original source</a>)</span>
</p>
<pre class="src-code">

<span class="comment-line"># Global variable for upload debug command</span>
set coreDumpFiles &#34;&#34;

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: cleanup  </span>
<span class="comment-line"># Description:  show log information of all involved DUTs at the end</span>
<span class="comment-line">#		of each test module </span>
<span class="comment-line"># Input args: {verIndex &#34;all&#34;}</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Typical usage: </span>
<span class="comment-line">#           cleanup</span>
<span class="comment-line"># Category: GetSwitchInfo</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::cleanup_15">proc <a href="cleanup.tcl-annot.html#::::cleanup">::::cleanup</a></a></strong> {{verIndex &#34;all&#34;}} {
    global env
    global DUTs_info MAIN
    global supportedPlatform
    global coreDumpFiles 
    global efence
    global chassis
    global enableSaveConfigPerTest
    global DUTs_Slot_info
    global pioneerChassis;
    global gHeapTracingProcess heapTraceEnabled;
    global stacking
    global noNvram
    global tftpServerList
    global returnFlag

    <span class="comment-line"># ----- Environment variables setup</span>
    set _log_user [log_user]
    set DUTs_info(tftpserverlist) $tftpServerList;
    
    <a name="::UpdateTrackDBTxt(1)"><a href="./resource_track.tcl.html#::UpdateTrackDBTxt_133">::UpdateTrackDBTxt</a></a> &#34;executing: cleanup&#34;;<span class="comment-line"># tracking db location</span>

    <span class="comment-line"># Logic to check for code coverage run.  If this in fact a code coverage run, </span>
    <span class="comment-line">#    a reboot is required in order to build the coverage files in internal memory.</span>
    set rebootList &#34;&#34;
    set ccovSession 0
    set coreDumpIFiles &#34;&#34;
    if {[<a name="::CompareRelease(1)"><a href="./misc.tcl.html#::CompareRelease_891">::CompareRelease</a></a> [<a name="::GetVersion(1)"><a href="./misc.tcl.html#::GetVersion_303">::GetVersion</a></a> DUT1] &#34;15.1.0&#34;] &lt; 0} {
        <a name="::result_debug(1)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;INFO:  Release too early for code coverage support&#34;
    } else {
        set fd_res [<a name="::open_result_file(1)"><a href="./result.tcl.html#::open_result_file_276">::open_result_file</a></a> &#34;CCOV_Check&#34; &#34;a&#34;]
        <a name="::result_debug(2)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;CCOV Check for /tmp/gcov_enabled on all DUTs&#34;
        for {set numDUT 1; global DUT${numDUT}_CONNECT} \
                    { [info exists DUT${numDUT}_CONNECT] } \
                    {incr numDUT ; global DUT${numDUT}_CONNECT} {
            global DUT${numDUT}_CONNECTB
            foreach msm {a b} {
                if {$msm==&#34;a&#34;||($msm==&#34;b&#34;&amp;&amp;[info exists DUT${numDUT}_CONNECTB])} {
                    if {$msm==&#34;a&#34;} {
                        set connect [set DUT${numDUT}_CONNECT]
                        <a name="::Login(1)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connect
                    } elseif {$msm==&#34;b&#34;} {
                        set connect [set DUT${numDUT}_CONNECTB]
                        <a name="::Login(2)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connect -masterCheck 0 -CheckOperational 0
                    }
                    <a name="::result_debug(3)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;================= CCOV File Check =====================&#34;
                    <a name="::EnableDebugMode(1)"><a href="./misc.tcl.html#::EnableDebugMode_2430">::EnableDebugMode</a></a>
                    set ccovBuf [<a name="::SendACmd(1)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;!ls /tmp&#34;]
                    if {([regexp -nocase &#34;gcov_enabled&#34; $ccovBuf])} {
                        lappend rebootList $numDUT
                        set ccovSession 1
                        set newName $DUTs_info(DUT${numDUT},sysType)
                        regsub -all {[ ]+} $newName &#34;-&#34; newName
                        <a name="::result_debug(4)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;GCOV Enabled on DUT $numDUT&#34;
                        <a name="::SendACmd(2)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;configure snmp sysName $newName&#34;
                    }
                    unset ccovBuf
                }
            }
        }
        <a name="::close_result_file(1)"><a href="./result.tcl.html#::close_result_file_363">::close_result_file</a></a>
    }
    <span class="comment-line"># Reboot all code coverage switches to build the coverage data files.</span>
    if {$ccovSession} {
        set rebootString [join $rebootList &#34;,&#34;]
        <a name="::CheckReboot(1)"><a href="./SendSwCmd.tcl.html#::CheckReboot_1202">::CheckReboot</a></a> $rebootString
    }
    <span class="comment-line">#  End of code coverage run check</span>
    for {set numDUT 1; global DUT${numDUT}_CONNECT} { [info exists DUT${numDUT}_CONNECT] } \
                                     {incr numDUT ; global DUT${numDUT}_CONNECT} {
        global DUT${numDUT}_CONNECTB
        <a name="::result_debug(5)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34; Memory Card Present : [regexp -nocase \&#34;present\&#34; $DUTs_info(DUT${numDUT},memoryCard)]&#34;
        if {[<a name="::CompareRelease(2)"><a href="./misc.tcl.html#::CompareRelease_891">::CompareRelease</a></a> [<a name="::GetVersion(2)"><a href="./misc.tcl.html#::GetVersion_303">::GetVersion</a></a> DUT${numDUT}] &#34;11.6.0.1&#34;] &gt;= 0} {
            foreach msm {a b} {
                if {$msm==&#34;a&#34;||($msm==&#34;b&#34;&amp;&amp;[info exists DUT${numDUT}_CONNECTB])} {
                    set fd_res [<a name="::open_result_file(2)"><a href="./result.tcl.html#::open_result_file_276">::open_result_file</a></a> &#34;DUT${numDUT}Log$msm&#34; &#34;a&#34;]
                    result_h1 &#34;Cleaning up on DUT$numDUT $msm&#34;
                    if {$msm==&#34;a&#34;} {
                        set connect [set DUT${numDUT}_CONNECT]
                        <a name="::Login(3)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connect
                    } elseif {$msm==&#34;b&#34;} {
                        set connect [set DUT${numDUT}_CONNECTB]
                        <a name="::Login(4)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connect -masterCheck 0 -CheckOperational 0
                    }
                    <a name="::result_debug(6)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;=============================WARNING LOGS=============================&#34;
                    set buf [<a name="::SendACmd(3)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;show log warning&#34;]
                    <a name="::SendACmd(4)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;show switch&#34;
                    <a name="::CaptureErroneousLog(1)"><a href="./cleanup.tcl.html#::CaptureErroneousLog_744">::CaptureErroneousLog</a></a> $buf
                    <span class="comment-line">#_verifyCFCorruptionStatusOnLogin</span>
                    <a name="::EnableDebugMode(2)"><a href="./misc.tcl.html#::EnableDebugMode_2430">::EnableDebugMode</a></a>
                    <a name="::result_debug(7)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Gather info for ECC bug&#34;
                    <a name="::SendACmd(5)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;debug hal show sys-health-check&#34;

                    if {[<a name="::CompareRelease(3)"><a href="./misc.tcl.html#::CompareRelease_891">::CompareRelease</a></a> [<a name="::GetVersion(3)"><a href="./misc.tcl.html#::GetVersion_303">::GetVersion</a></a> DUT${numDUT}] &#34;12.0.3.1&#34;] &gt;= 0} {
                        if {![regexp -nocase $noNvram [<a name="::GetPlatform(1)"><a href="./misc.tcl.html#::GetPlatform_478">::GetPlatform</a></a> DUT$numDUT]]} {
                            lappend cfbuff &#34;{^1} notExist&#34;
                            if {[<a name="::CheckKeyValue(1)"><a href="./OptionCheck.tcl.html#::CheckKeyValue_47">::CheckKeyValue</a></a> &#34;!cat /proc/jffs2_corruption&#34; $cfbuff -reportResults 0] != &#34;ok&#34;} {
                                <a name="::result_error(1)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;CF corruption happened. Format CF&#34;
                                <a name="::SendACmd(6)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;!dd if=/dev/hda7 of=/dev/null bs=1024 count=16384&#34;
                            }
                            unset cfbuff
                        }
                        <a name="::SendACmd(7)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;ls&#34;

                        set efenceBuf [<a name="::SendACmd(8)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;debug epm show heapdbg&#34;]
                        if {([regexp -nocase &#34;not&#34; $efenceBuf])} {
                            <a name="::result_debug(8)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$efenceBuf&#34;
                        } else {
                            <a name="::result_debug(9)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Efence is enabled for process $efenceBuf&#34;
                            <a name="::result_debug(10)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Disabling efence for all process now&#34;
                            <a name="::SendACmd(9)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;debug epm disable heapdbg process all&#34;
                        }
                        unset efenceBuf
                    }

                    <a name="::result_debug(11)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Display MiniCore if any&#34;
                    if {[regexp -nocase $noNvram [<a name="::GetPlatform(2)"><a href="./misc.tcl.html#::GetPlatform_478">::GetPlatform</a></a> DUT$numDUT]]} {
                        set coreNvramContent [<a name="::SendACmd(10)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;!cat /persistent/clearOnRescue/core*&#34; NULL NULL false]
                    } else {
                        set coreNvramContent [<a name="::SendACmd(11)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;!cat /proc/core*&#34; NULL NULL false]
                    }
                    if { [regexp -nocase &#34;bd-88|aspen|xcm|$pioneerChassis&#34; $DUTs_info(DUT${numDUT},platform)] } {
                        <a name="::SendACmd(12)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;show debug system-dump&#34; 
                        set slotNumber 1
                        foreach slot $DUTs_info(DUT${numDUT},hwList) {
                            if {[regexp -nocase &#34;Empty&#34; $slot]} {
                                incr slotNumber;
                                continue;
                            }

                            <a name="::SendACmd(13)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;show debug system-dump slot $slotNumber&#34; 
                            if {[regexp -nocase $pioneerChassis $DUTs_info(DUT${numDUT},platform)]} {
                                <a name="::exSleep(1)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 40
                                <a name="::SendACmd(14)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;&#34;
                            } 
                            <a name="::SendACmd(15)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;clear debug system-dump slot $slotNumber&#34; 
                            incr slotNumber
                        }
                    } 
                    <a name="::SendACmd(16)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;clear debug system-dump&#34; NULL NULL false
                    if {[regexp -nocase $noNvram [<a name="::GetPlatform(3)"><a href="./misc.tcl.html#::GetPlatform_478">::GetPlatform</a></a> DUT$numDUT]]} {
                        <a name="::result_debug(12)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;core_dump_info cleared by previous command&#34;
                    } else {
                        <a name="::SendACmd(17)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;!echo clear_old &gt; /proc/core_dump_info&#34; NULL NULL false
                        <a name="::SendACmd(18)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;!echo clear_old &gt; /proc/core_dump_info_last&#34; NULL NULL false
                    }
                    if { ([info exists enableSaveConfigPerTest] ) &amp;&amp; \
                    ([<a name="::CompareRelease(4)"><a href="./misc.tcl.html#::CompareRelease_891">::CompareRelease</a></a> [<a name="::GetVersion(4)"><a href="./misc.tcl.html#::GetVersion_303">::GetVersion</a></a> DUT${numDUT}] 12.1]&gt;=0 ) \
                    &amp;&amp; ($enableSaveConfigPerTest == &#34;yes&#34; ) } {
                        if {$msm==&#34;a&#34;} {
                            <a name="::uploadConfigDiff(1)"><a href="./cleanup.tcl.html#::uploadConfigDiff_841">::uploadConfigDiff</a></a>
                        }
                    }
                    if {[regexp -nocase &#34;present&#34; $DUTs_info(DUT${numDUT},memoryCard)] &amp;&amp; \
                           $DUTs_info(DUT${numDUT},coreFileTarget) == &#34;memorycard&#34;} {
                        set coreBuf [<a name="::SendACmd(19)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;ls /usr/local/ext&#34;]
                    } else {
                        set coreBuf [<a name="::SendACmd(20)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;ls /usr/local/tmp&#34;]
                    }
                    if {$ccovSession} {
                        if {(![regexp -nocase &#34;core.*&#34; $coreBuf]) &amp;&amp; \
                               (![regexp -nocase &#34;trace.*_&#34; $coreBuf]) &amp;&amp; \
                               (![regexp -nocase &#34;ccov.*&#34; $coreBuf]) } {
                            <a name="::close_result_file(2)"><a href="./result.tcl.html#::close_result_file_363">::close_result_file</a></a>
                            continue
                        }
                    } elseif {(![regexp -nocase &#34;core.*&#34; $coreBuf]) &amp;&amp; \
                           (![regexp -nocase &#34;trace.*_&#34; $coreBuf]) } {
                        <a name="::close_result_file(3)"><a href="./result.tcl.html#::close_result_file_363">::close_result_file</a></a>
                        continue
                    }
                    <span class="comment-line"># If ONLY ccov code coverage is hit, don't fail the test.</span>
                    set COREPRESENT($numDUT) 0
                    if {(![regexp -nocase &#34;core.*&#34; $coreBuf]) &amp;&amp; \
                            (![regexp -nocase &#34;trace.*_&#34; $coreBuf]) &amp;&amp; \
                            ([regexp -nocase &#34;ccov.*&#34; $coreBuf]) } {
                        set CCOV_ONLY($numDUT) 1
                    } else {
                        set CCOV_ONLY($numDUT) 0
                    }
                    <span class="comment-line"># We only want to set as a failure if a core file is present.</span>
                    if {([regexp -nocase &#34;core.*&#34; $coreBuf]) } {
                        set COREPRESENT($numDUT) 1
                        set testText &#34;core dump&#34;
                    } else {
                        set COREPRESENT($numDUT) 0
                        set testText &#34;system files&#34;
                    }
                    <a name="::SendACmd(21)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;configure default delete port all&#34; ;<span class="comment-line"># needed if sw rebooted</span>
                    <span class="comment-line">#EnableDebugMode</span>
                    <span class="comment-line">#SendACmd &#34;jerry ems gzip trace&#34;</span>
                    <a name="::exSleep(2)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 3 
                    <a name="::DisableDebugMode(1)"><a href="./misc.tcl.html#::DisableDebugMode_2957">::DisableDebugMode</a></a>

                    <a name="::report_start_test(1)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;NOTE: found $testText in DUT${numDUT} MSM-$msm \
                    internal memory, moving it to TFTP server&#34;
                    if { $msm == &#34;b&#34; } {
                        set fd_bak $fd_res
                        set connect [set DUT${numDUT}_CONNECT]
                        puts &#34;connect : $connect&#34;
                        <a name="::Login(5)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connect
                        if {![info exists configGw]} {
                            <a name="::ConfigGatewayNetwork(1)"><a href="./SendSwCmd.tcl.html#::ConfigGatewayNetwork_2110">::ConfigGatewayNetwork</a></a>
                            set configGw 1
                        }
                        set fd_res $fd_bak
                    } else {
                        <a name="::ConfigGatewayNetwork(2)"><a href="./SendSwCmd.tcl.html#::ConfigGatewayNetwork_2110">::ConfigGatewayNetwork</a></a>
                        set configGw 1
                    }
                    <a name="::SendACmd(22)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;ping vr [<a name="::GetVrString(1)"><a href="./misc.tcl.html#::GetVrString_3157">::GetVrString</a></a> $numDUT] [lindex $DUTs_info(tftpserverlist) 0]&#34;

                    <a name="::exSleep(3)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 15
                    set outFd [open &#34;Tmp/sendcmdOut&#34; &#34;w&#34;]
                    <a name="::SendACmd(23)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;upload debug [lindex $DUTs_info(tftpserverlist) 0] vr [<a name="::GetVrString(2)"><a href="./misc.tcl.html#::GetVrString_3157">::GetVrString</a></a> $numDUT]&#34; \
                             &#34;NULL&#34; $outFd &#34;true&#34; &#34;3&#34; &#34;n&#34;
                    if {$COREPRESENT($numDUT)} {
                        <a name="::result_error(2)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;There is a coredump file on DUT${numDUT} MSM-$msm .&#34;
                    } else {
                        <a name="::result_ok(1)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Moved the code coverage file from DUT${numDUT} MSM-$msm to TFTP server&#34;
                    }

                    close $outFd 

                    set outFd [open &#34;Tmp/sendcmdOut&#34; &#34;r&#34;]
                    while { [gets $outFd line] != -1 } {
                        if {[regexp -nocase &#34;Tarball Name: (.*.tgz)&#34; $line result fileName]} {
                            lappend coreDumpFiles &#34;DUT${numDUT}_$fileName&#34;
                            if [regexp &#34;I&#34; &#34;DUT${numDUT}_$fileName&#34;] {
                                <a name="::result_debug(13)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;CORE FILE NAME $fileName&#34;
                                lappend coreDumpIFiles &#34;DUT${numDUT}_$fileName&#34;
                            }
                        }
                    }
                    <span class="comment-line">#added for sending mail on a core</span>
                    global cfg
                    if {$COREPRESENT($numDUT)} {
                        set message1 &#34;\nOn cfg $cfg\n Seeing a core file on DUT${numDUT} \
                           while running $MAIN(feature_directory)\n\
                           on build $DUTs_info(DUT${numDUT},version) $coreBuf \n \
                           $coreNvramContent&#34;
                        set tempMsgFile   &#34;/tmp/filedoesnot.txt.[pid]&#34;
                        exec echo $message1 &gt; $tempMsgFile
                        catch {exec dos2unix -f $tempMsgFile} a
                        exec mail -s &#34;CoreDump seen in test bed $cfg on DUT${numDUT} during $MAIN(feature_directory) &#34; \
                                      sqaauto@extremenetworks.com &lt; $tempMsgFile
                        exec rm -f $tempMsgFile
                    }
                    close $outFd
                    <a name="::result_debug(14)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;List of debug file names are $coreDumpFiles&#34;
                    file delete  &#34;Tmp/sendcmdOut&#34;
                    <a name="::report_end_test(1)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>
                    <a name="::close_result_file(4)"><a href="./result.tcl.html#::close_result_file_363">::close_result_file</a></a>
                }
            }

            <span class="comment-line"># ---- Unconfigure network only if it already configured</span>
            if {[info exists configGw]} {
                set connect [set DUT${numDUT}_CONNECT]
                <a name="::Login(6)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connect
                <a name="::UnconfigGatewayNetwork(1)"><a href="./SendSwCmd.tcl.html#::UnconfigGatewayNetwork_2356">::UnconfigGatewayNetwork</a></a>
                unset configGw
            }
            continue
        }
        <span class="comment-line">###</span>
        foreach msm {a b} {
            if {$msm==&#34;a&#34;||($msm==&#34;b&#34;&amp;&amp;[info exists DUT${numDUT}_CONNECTB])} {
                set fd_res [<a name="::open_result_file(3)"><a href="./result.tcl.html#::open_result_file_276">::open_result_file</a></a> &#34;DUT${numDUT}Log$msm&#34; &#34;a&#34;]
                result_h1 &#34;Cleaning up on DUT$numDUT $msm&#34;
                set buf &#34;&#34;
                if {[regexp -nocase $supportedPlatform [<a name="::GetPlatform(4)"><a href="./misc.tcl.html#::GetPlatform_478">::GetPlatform</a></a> DUT$numDUT]]} {
                    if {$msm==&#34;a&#34;} {
                        set connect [set DUT${numDUT}_CONNECT]
                        <a name="::Login(7)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connect
                    } elseif {$msm==&#34;b&#34;} {
                        set connect [set DUT${numDUT}_CONNECTB]
                        <a name="::Login(8)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connect -masterCheck 0 -CheckOperational 0
                    }
                    <a name="::result_debug(15)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;&lt;&lt;&lt;&lt;&lt;    after test scripts in tests_to_run($verIndex) finished    &gt;&gt;&gt;&gt;&gt;&#34;
                    <a name="::result_debug(16)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;=============================WARNING LOGS=============================&#34;
                    set buf [<a name="::SendACmd(24)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;show log warning&#34;]
                    <a name="::result_debug(17)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;=============================ALL LOGS=============================&#34;
                    <span class="comment-line">#   SendACmd	&#34;show log&#34;</span>
                }
                <span class="comment-line"># SK: Foll proc is written on request from Developers to be able to capture specific error</span>
                <span class="comment-line"># nasty logs and maybe dump additional info</span>
                <a name="::CaptureErroneousLog(2)"><a href="./cleanup.tcl.html#::CaptureErroneousLog_744">::CaptureErroneousLog</a></a> $buf

                <span class="comment-line">#   SendACmd &#34;clear log stat&#34;</span>
                if {[<a name="::CompareRelease(5)"><a href="./misc.tcl.html#::CompareRelease_891">::CompareRelease</a></a> [<a name="::GetVersion(5)"><a href="./misc.tcl.html#::GetVersion_303">::GetVersion</a></a> DUT${numDUT}] 11.1.0.21]&gt;=0} {
                    <span class="comment-line"># EY-06-14-2006: Changed regexp switch from &#34;--&#34; to &#34;-nocase&#34;.</span>
                    if {[regexp -nocase &#34;present&#34; $DUTs_info(DUT${numDUT},memoryCard)] &amp;&amp; \
                        $DUTs_info(DUT${numDUT},coreFileTarget) == &#34;memorycard&#34;} {
                        set coreBuf [<a name="::SendACmd(25)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;ls /usr/local/ext&#34;]
                        if { [regexp -nocase &#34;Value too large for defined data type|No such file&#34; $coreBuf] } {
                            <a name="::result_error(3)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;External Memory Card corruption happened. Format Memory Card&#34;
                            <a name="::formatExternalCF(1)"><a href="./SendSwCmd.tcl.html#::formatExternalCF_3037">::formatExternalCF</a></a>
                        } 
                        set tftpCliMode externalMem
                    } else {
                        set coreFileList &#34;&#34;
                        set coreBuf [<a name="::SendACmd(26)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;ls /usr/local/tmp&#34;]
                        set tftpCliMode internalMem
                        <a name="::result_debug(18)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;coreBuf $coreBuf&#34;
                    }

                    <span class="comment-line">#_verifyCFCorruptionStatusOnLogin</span>
                    <a name="::EnableDebugMode(3)"><a href="./misc.tcl.html#::EnableDebugMode_2430">::EnableDebugMode</a></a>
                    if {[<a name="::CompareRelease(6)"><a href="./misc.tcl.html#::CompareRelease_891">::CompareRelease</a></a> [<a name="::GetVersion(6)"><a href="./misc.tcl.html#::GetVersion_303">::GetVersion</a></a> DUT${numDUT}] &#34;12.0.3.1&#34;] &gt;= 0} {
                        lappend cfbuff &#34;{^1} notExist&#34;
                        if {[<a name="::CheckKeyValue(2)"><a href="./OptionCheck.tcl.html#::CheckKeyValue_47">::CheckKeyValue</a></a> &#34;!cat /proc/jffs2_corruption&#34; $cfbuff -reportResults 0] != &#34;ok&#34;} {
                            <a name="::result_error(4)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;CF corruption happened. Format CF&#34;
                            <a name="::SendACmd(27)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;!dd if=/dev/hda7 of=/dev/null bs=1024 count=16384&#34;
                        }
                        unset cfbuff
                        <a name="::result_debug(19)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Display MiniCore if any&#34;
                        <a name="::SendACmd(28)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;!cat /proc/core*&#34; NULL NULL false
                        if { [regexp -nocase &#34;bd-88|aspen|xcm|$pioneerChassis&#34; \
                                               $DUTs_info(DUT${numDUT},platform)] } {
                            <a name="::SendACmd(29)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;show debug system-dump&#34; 
                            set slotNumber 1
                            foreach slot $DUTs_info(DUT${numDUT},hwList) {
                                if {[regexp -nocase &#34;Empty&#34; $slot]} {
                                    incr slotNumber;
                                    continue;
                                }
                                <a name="::SendACmd(30)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;show debug system-dump slot $slotNumber&#34; 
                                <span class="comment-line">#LK In pioneer slot eeprom is not directly connected to MSM it takes </span>
                                <span class="comment-line"># around 12 seconds to get the slot dump info from IO</span>
                                <span class="comment-line"># hence user will get a prompt and then he will get the dump after 12-30 seconds</span>
                                <span class="comment-line"># below is workaround for same to capture this info</span>
                                if {[regexp -nocase $pioneerChassis $DUTs_info(DUT${numDUT},platform)]} {
                                    <a name="::exSleep(4)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 40
                                    <a name="::SendACmd(31)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;&#34;
                                } 
                                <a name="::SendACmd(32)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;clear debug system-dump slot $slotNumber&#34; 
                                incr slotNumber;
                            }
                        } 
                        <a name="::SendACmd(33)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;clear debug system-dump&#34; NULL NULL false
                        <a name="::SendACmd(34)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;!echo clear_old &gt; /proc/core_dump_info&#34; NULL NULL false
                        <a name="::SendACmd(35)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;!echo clear_old &gt; /proc/core_dump_info_last&#34; NULL NULL false
                        if { ([info exists enableSaveConfigPerTest] ) &amp;&amp; \
                               ([<a name="::CompareRelease(7)"><a href="./misc.tcl.html#::CompareRelease_891">::CompareRelease</a></a> [<a name="::GetVersion(7)"><a href="./misc.tcl.html#::GetVersion_303">::GetVersion</a></a> DUT${numDUT}] 12.1]&gt;=0 ) &amp;&amp; \
                               ($enableSaveConfigPerTest == &#34;yes&#34;) } {
                            if {$msm==&#34;a&#34;} {
                                <a name="::uploadConfigDiff(2)"><a href="./cleanup.tcl.html#::uploadConfigDiff_841">::uploadConfigDiff</a></a>
                            }
                        }

                        set efenceBuf [<a name="::SendACmd(36)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;debug epm show heapdbg&#34;]
                        if {([regexp -nocase &#34;not&#34; $efenceBuf])} {
                            <a name="::result_debug(20)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$efenceBuf&#34;
                        } else {
                            <a name="::result_debug(21)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Efence is enabled for process $efenceBuf&#34;
                            <a name="::result_debug(22)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Disabling efence for all process now&#34;
                            <a name="::SendACmd(37)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;debug epm disable heapdbg process all&#34;
                        }
                        unset efenceBuf
                    }

                    if {[regexp -nocase &#34;core.*&#34; $coreBuf]} {
                        <a name="::report_start_test(2)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;NOTE: found core dump on memoryCard, moving it out using tftp...&#34;
                        <a name="::result_error(5)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;NOTE: found core dump on memoryCard, moving it out using tftp...&#34;
                        <a name="::SendACmd(38)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;configure default delete port all&#34; ;<span class="comment-line"># needed if sw rebooted</span>
                        if {$msm==&#34;a&#34;} {
                            <a name="::ConfigGatewayNetwork(3)"><a href="./SendSwCmd.tcl.html#::ConfigGatewayNetwork_2110">::ConfigGatewayNetwork</a></a>
                        }
                        after 3000
                        global DUT${numDUT}_IP 
                        set dutIp [set DUT${numDUT}_IP]
                        set tarBallIndex 0
                        foreach coreFile $coreBuf {
                            <span class="comment-line">#puts &#34;coreFile:|$coreFile,[regexp -nocase &#34;^core&#34; $coreFile]|&#34;</span>
                            if {[regexp -nocase &#34;^core&#34; $coreFile]} {
                                if {$msm==&#34;a&#34;} {
                                    set connect [set DUT${numDUT}_CONNECT]
                                    <a name="::Login(9)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connect
                                    <a name="::EnableDebugMode(4)"><a href="./misc.tcl.html#::EnableDebugMode_2430">::EnableDebugMode</a></a>
                                    if {$tarBallIndex==0} {
                                        <span class="comment-line">#SendACmd &#34;jerry ems gzip trace&#34;</span>
                                        <a name="::exSleep(5)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 1 ;<span class="comment-line"># needed for device to recover or else truncates cli</span>
                                        set tarBallIndex 1
                                        <a name="::_tftpProcessOutFromA(1)"><a href="./cleanup.tcl.html#::_tftpProcessOutFromA_606">::_tftpProcessOutFromA</a></a> $dutIp $numDUT $msm
                                    }
                                } elseif {$msm==&#34;b&#34;} {
                                    set connect [set DUT${numDUT}_CONNECTB]
                                    <a name="::Login(10)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connect -masterCheck 0 -CheckOperational 0
                                    <a name="::EnableDebugMode(5)"><a href="./misc.tcl.html#::EnableDebugMode_2430">::EnableDebugMode</a></a>
                                    <span class="comment-line">#SendACmd &#34;jerry ems gzip trace&#34;</span>
                                    <a name="::_tftpFromBToA(1)"><a href="./cleanup.tcl.html#::_tftpFromBToA_648">::_tftpFromBToA</a></a> [set DUT${numDUT}_CONNECT] $connect $coreFile $numDUT
                                    if {$tarBallIndex==0} {
                                        <a name="::Login(11)"><a href="./login.tcl.html#::Login_24">::Login</a></a> [set DUT${numDUT}_CONNECT]
                                        <a name="::ConfigGatewayNetwork(4)"><a href="./SendSwCmd.tcl.html#::ConfigGatewayNetwork_2110">::ConfigGatewayNetwork</a></a>
                                        <a name="::exSleep(6)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 2
                                        set tarBallIndex 1
                                        <a name="::_tftpProcessOutFromA(2)"><a href="./cleanup.tcl.html#::_tftpProcessOutFromA_606">::_tftpProcessOutFromA</a></a> $dutIp $numDUT $msm
                                    }
                                }
                                <a name="::_tftpCoresOutFromA(1)"><a href="./cleanup.tcl.html#::_tftpCoresOutFromA_543">::_tftpCoresOutFromA</a></a> [set DUT${numDUT}_CONNECT] $tftpCliMode \
                                             $coreFile $dutIp $msm $numDUT
                            } else {
                                continue
                            }
                        }
                        <a name="::report_end_test(2)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>
                        set connect [set DUT${numDUT}_CONNECT]
                        <a name="::Login(12)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connect
                        <a name="::UnconfigGatewayNetwork(2)"><a href="./SendSwCmd.tcl.html#::UnconfigGatewayNetwork_2356">::UnconfigGatewayNetwork</a></a>
                    }
                }
                <a name="::close_result_file(5)"><a href="./result.tcl.html#::close_result_file_363">::close_result_file</a></a>
            }
        }
    }

    for {set numDUT 1; global DUT${numDUT}_CONNECT} { [info exists DUT${numDUT}_CONNECT] } \
                {incr numDUT ; global DUT${numDUT}_CONNECT} {
        set connect [set DUT${numDUT}_CONNECT]
        <span class="comment-line">#Added following procedure to avoid unnecessary erroes while removing unconfig sw from cfg</span>
        <span class="comment-line">#allCleanup  $numDUT</span>

        foreach msm {a b} {
            if {$msm==&#34;a&#34;||($msm==&#34;b&#34;&amp;&amp;[info exists DUT${numDUT}_CONNECTB])} {
                set fd_res [<a name="::open_result_file(4)"><a href="./result.tcl.html#::open_result_file_276">::open_result_file</a></a> &#34;DUT${numDUT}Log$msm&#34; &#34;a&#34;]
                result_h1 &#34;disabling Electric Fence on DUT$numDUT $msm&#34;
                if {[regexp -nocase $supportedPlatform [<a name="::GetPlatform(5)"><a href="./misc.tcl.html#::GetPlatform_478">::GetPlatform</a></a> DUT$numDUT]]} {
                    if {$msm==&#34;a&#34;} {
                        set connect [set DUT${numDUT}_CONNECT]
                        <a name="::Login(13)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connect
                    } elseif {$msm==&#34;b&#34;} {
                        set connect [set DUT${numDUT}_CONNECTB]
                        <a name="::Login(14)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connect -masterCheck 0 -CheckOperational 0
                    }
                    <a name="::SendACmd(39)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;show config&#34;
                    <a name="::SendACmd(40)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;show memory&#34;

                    if {[info exists efence]} {
                        set goEfence 1
                        if {!([<a name="::CompareRelease(8)"><a href="./misc.tcl.html#::CompareRelease_891">::CompareRelease</a></a> [<a name="::GetVersion(8)"><a href="./misc.tcl.html#::GetVersion_303">::GetVersion</a></a> DUT${numDUT}] 12.0.3]&gt;=0)} {
                            set goEfence 0
                        }
                        if {![regexp -nocase &#34;$chassis&#34; [<a name="::GetPlatform(6)"><a href="./misc.tcl.html#::GetPlatform_478">::GetPlatform</a></a> DUT${numDUT}]]} {
                            set goEfence 0
                        }
                        if {([llength $efence] == 1) &amp;&amp; ([lindex $efence 0] == &#34;no&#34;)} {
                            set goEfence 0
                        }

                        if {$goEfence} {
                            <span class="comment-line"># disable Electric Fence</span>
                            puts &#34;*****************************************************************&#34;
                            puts &#34;*****************************************************************&#34;
                            puts &#34;** Disabling Electric Fence on DUT$numDUT **&#34;
                            puts &#34;*****************************************************************&#34;
                            puts &#34;*****************************************************************&#34;

                            <a name="::EnableDebugMode(6)"><a href="./misc.tcl.html#::EnableDebugMode_2430">::EnableDebugMode</a></a>
                            <a name="::SendACmd(41)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;debug epm disable heapdbg process all&#34;
                            <a name="::exSleep(7)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 10
                            <a name="::DisableDebugMode(2)"><a href="./misc.tcl.html#::DisableDebugMode_2957">::DisableDebugMode</a></a>
                            <span class="comment-line">#CheckReboot $numDUT</span>
                        }
                    }
                    if { ([info exists gHeapTracingProcess] ) &amp;&amp; ($gHeapTracingProcess != &#34;no&#34;) } {
                        if {!([regexp -nocase &#34;$stacking&#34; [<a name="::GetPlatform(7)"><a href="./misc.tcl.html#::GetPlatform_478">::GetPlatform</a></a> DUT${numDUT}]])} {
                            <span class="comment-line"># enable heaptracing only onces in a module regression</span>
                            if { $heapTraceEnabled == &#34;yes&#34; } {
                                if { [regexp -nocase &#34;$chassis&#34; [<a name="::GetPlatform(8)"><a href="./misc.tcl.html#::GetPlatform_478">::GetPlatform</a></a> DUT${numDUT}]] == 1 } {
                                    if { $msm==&#34;b&#34; } {
                                        <a name="::disableHeapTrc(1)"><a href="./bootRomLib.tcl.html#::disableHeapTrc_1462">::disableHeapTrc</a></a> $numDUT &#34;B&#34;
                                    } elseif { $msm==&#34;a&#34; } {
                                        <a name="::disableHeapTrc(2)"><a href="./bootRomLib.tcl.html#::disableHeapTrc_1462">::disableHeapTrc</a></a> $numDUT
                                    }
                                } else {
                                    <a name="::disableHeapTrc(3)"><a href="./bootRomLib.tcl.html#::disableHeapTrc_1462">::disableHeapTrc</a></a> $numDUT
                                }
                            }
                        }
                    }
                }
            }
        }
        set connect [set DUT${numDUT}_CONNECT]
        <a name="::Login(15)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connect -masterCheck 0 -CheckOperational 0
    }
    global harness
    if {![info exists harness]} {
        set harness &#34;tcl&#34;
    }
    if {1 || $harness == &#34;tpb&#34;} {
        global RESWEB
        package forget http 1.0
        package require http
        global sourceFile optionalPath subversion qId autoPath
        set HOST [exec hostname -s]
        set dir [string trimleft [pwd] &#34;$autoPath&#34;]
        puts &#34;create_report_directory $sourceFile no $optionalPath '' $subversion $qId&#34;
        set repDir [<a name="::create_report_directory(1)"><a href="./result.tcl.html#::create_report_directory_890">::create_report_directory</a></a> &#34;$sourceFile&#34; &#34;no&#34; &#34;$optionalPath&#34; &#34;&#34; &#34;$subversion&#34; &#34;$qId&#34;]
        set link &#34;http://${RESWEB}/${dir}/${repDir}/&#34;
        puts &#34;@@@@ TPB TCL Report Link @@@@&#34;
        puts &#34;\&#34;$link\&#34;&#34;
        puts &#34;@@@@ Test Builder END Report Link @@@@&#34;

        if {[info exists returnFlag] &amp;&amp; $returnFlag == &#34;connectionBad&#34;} {
            puts &#34;Hit Check Connections Failure&#34;
            set resDir [<a name="::get_result_dir(1)"><a href="./result.tcl.html#::get_result_dir_189">::get_result_dir</a></a>]
            set link &#34;http://${RESWEB}/${dir}/$resDir/&#34;
            puts &#34;\nResult Directory - Check System Setup for CC failures:\n \&#34;$link\&#34;\n&#34;;
        }

        if {[llength $coreDumpIFiles] &gt;= 1} {
            puts &#34;@@@@ TPB TCL Core Report Link @@@@&#34;
            set myLinkList &#34;&#34;
            foreach cif $coreDumpIFiles {
                lappend myLinkList &#34;${link}${cif}&#34;
            }
            set fullCoreLink [join $myLinkList &#34;!!&#34;]
            puts &#34;$fullCoreLink&#34;
            puts &#34;@@@@ Test Builder END Core Report Link @@@@&#34;
        }
        package forget http
        package require http 1.0
    }
    log_user $_log_user
}

<strong><a name="::::_tftpCoresOutFromA_543">proc <a href="cleanup.tcl-annot.html#::::_tftpCoresOutFromA">::::_tftpCoresOutFromA</a></a></strong> {connect tftpCliMode coreFile dutIp msm numDUT} {
    global DUTs_info
    global CCOV_ONLY

    <a name="::Login(16)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connect
    if {$tftpCliMode==&#34;externalMem&#34;} {
        set myCmd &#34;tftp [lindex $DUTs_info(tftpserverlist) 0] -v [<a name="::GetVrString(3)"><a href="./misc.tcl.html#::GetVrString_3157">::GetVrString</a></a> $numDUT] &#34;
        append myCmd &#34;-p -l /usr/local/ext/$coreFile -r [set coreFile]_$dutIp$msm&#34;
        set tftpCliLegality [<a name="::CheckCmdLegal(1)"><a href="./checkCmdLegality.tcl.html#::CheckCmdLegal_58">::CheckCmdLegal</a></a> &#34;$myCmd&#34;]
    } elseif {$tftpCliMode==&#34;internalMem&#34;} {
        set myCmd &#34;tftp [lindex $DUTs_info(tftpserverlist) 0] -v [<a name="::GetVrString(4)"><a href="./misc.tcl.html#::GetVrString_3157">::GetVrString</a></a> $numDUT] &#34;
        append myCmd &#34;-p -l /usr/local/tmp/$coreFile -r [set coreFile]_$dutIp$msm&#34;
        set tftpCliLegality [<a name="::CheckCmdLegal(2)"><a href="./checkCmdLegality.tcl.html#::CheckCmdLegal_58">::CheckCmdLegal</a></a> &#34;$myCmd&#34;]
    } else {
        <span class="comment-line"># OldCoreDumpMethod(pre-mcKinley) tftp can not be done as core is in /scratch.</span>
        <span class="comment-line"># Using unix tftp</span>
        if {[regexp -nocase default [<a name="::GetVrString(5)"><a href="./misc.tcl.html#::GetVrString_3157">::GetVrString</a></a> $numDUT]]} {
            set vr 2
        } else {
            set vr 0
        }
        set timeout 300
        set myCmd &#34;!tftp [lindex $DUTs_info(tftpserverlist) 0] -v $vr -p &#34;
        append myCmd &#34;-l /scratch/$coreFile -r [set coreFile]_$dutIp$msm&#34;
        set tftpCliLegality [<a name="::CheckCmdLegal(3)"><a href="./checkCmdLegality.tcl.html#::CheckCmdLegal_58">::CheckCmdLegal</a></a> &#34;$myCmd&#34;]
        global connectionTimeout
        set timeout $connectionTimeout
    }
    if {$tftpCliLegality!=&#34;illegal&#34;} {
        <a name="::report_start_test(3)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;$coreFile saved as [set coreFile]_$dutIp$msm&#34;
        <a name="::result_debug(23)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;[set coreFile]_$dutIp$msm successfully put on tftp server&#34;
        <a name="::result_error(6)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;$coreFile saved as [set coreFile]_$dutIp$msm&#34;
        <a name="::report_end_test(3)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>
        set fd_out [open &#34;Tmp/tmp_$dutIp$msm&#34; &#34;w&#34;];
        set targetCore &#34;[set coreFile]_$dutIp$msm&#34;
        puts $fd_out &#34;get [set coreFile]_$dutIp$msm $targetCore&#34;
        puts $fd_out &#34;quit&#34;
        close $fd_out
        if {[catch {exec /usr/bin/tftp [lindex $DUTs_info(tftpserverlist) 0] &lt; ./Tmp/tmp_$dutIp$msm} reason]} {
            <a name="::result_error(7)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;error: $reason&#34;
            return -1
        }
        if {[catch {file rename $targetCore [<a name="::get_result_dir(2)"><a href="./result.tcl.html#::get_result_dir_189">::get_result_dir</a></a>]} reason]} {
            <a name="::result_error(8)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;error: $reason&#34;
            return -1
        }
        file delete ./Tmp/tmp_$dutIp$msm
        <a name="::result_debug(24)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Remove core $coreFile from /usr/local/ext ...&#34;
        if {[regexp -- &#34;present&#34; $DUTs_info(DUT${numDUT},memoryCard)]} {
            <a name="::SendACmd(42)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;rm /usr/local/ext/$coreFile&#34;
        } elseif {$tftpCliMode==&#34;internalMem&#34;} {
            <a name="::SendACmd(43)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;rm /usr/local/tmp/$coreFile&#34;
        } else {
            <a name="::SendACmd(44)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;!rm /scratch/$coreFile&#34;
        }
        global tftpServerLogin tftpServerPasswd tftpServerTftpboot
        <a name="::login_linux(1)"><a href="./linux.tcl.html#::login_linux_16">::login_linux</a></a> [lindex $DUTs_info(tftpserverlist) 0] $tftpServerLogin $tftpServerPasswd
        catch {<a name="::SendACmd(45)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;/bin/rm $tftpServerTftpboot/[set coreFile]_$dutIp$msm&#34; NULL NULL true 1}
    } else {
        <a name="::result_error(9)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Error while tftp core $coreFile&#34;
    }
}

<strong><a name="::::_tftpProcessOutFromA_606">proc <a href="cleanup.tcl-annot.html#::::_tftpProcessOutFromA">::::_tftpProcessOutFromA</a></a></strong> {dutIp numDUT msm} {
    global DUTs_info

    if {$msm==&#34;a&#34;} {
        set myCmd &#34;tftp [lindex $DUTs_info(tftpserverlist) 0] &#34;
        append myCmd &#34;-v [<a name="::GetVrString(6)"><a href="./misc.tcl.html#::GetVrString_3157">::GetVrString</a></a> $numDUT] -p -l process_traces.tgz &#34;
        append myCmd &#34;-r process_traces.tgz_$dutIp$msm&#34;
        set tftpCliLegality [<a name="::CheckCmdLegal(4)"><a href="./checkCmdLegality.tcl.html#::CheckCmdLegal_58">::CheckCmdLegal</a></a> &#34;$myCmd&#34;]
    } elseif {$msm==&#34;b&#34;} {
        set myCmd &#34;tftp [lindex $DUTs_info(tftpserverlist) 0] -v [<a name="::GetVrString(7)"><a href="./misc.tcl.html#::GetVrString_3157">::GetVrString</a></a> $numDUT] &#34;
        append myCmd &#34;-p -l /usr/local/tmp/process_tracesB.tgz -r process_traces.tgz_$dutIp$msm&#34;
        set tftpCliLegality [<a name="::CheckCmdLegal(5)"><a href="./checkCmdLegality.tcl.html#::CheckCmdLegal_58">::CheckCmdLegal</a></a> &#34;$myCmd&#34;]
    }
    if {$tftpCliLegality!=&#34;illegal&#34;} {
        <a name="::report_start_test(4)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;process_traces.tgz saved as process_traces.tgz_$dutIp$msm&#34;
        <a name="::result_debug(25)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;process_traces.tgz_$dutIp$msm successfully put on tftp server&#34;
        <a name="::result_ok(2)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;process_traces.tgz saved as process_traces.tgz_$dutIp$msm&#34;
        <a name="::report_end_test(4)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>
        set fd_out [open &#34;Tmp/tmp_$dutIp$msm&#34; &#34;w&#34;];
        set targetProcess &#34;process_tracesDUT${numDUT}msm${msm}.tgz&#34;
        puts $fd_out &#34;get process_traces.tgz_$dutIp$msm $targetProcess&#34;
        puts $fd_out &#34;quit&#34;
        close $fd_out
        if {[catch {exec /usr/bin/tftp [lindex $DUTs_info(tftpserverlist) 0] &lt; ./Tmp/tmp_$dutIp$msm} reason]} {
            <a name="::result_error(10)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;error: $reason&#34;
            return -1
        }
        if {[catch {file rename $targetProcess [<a name="::get_result_dir(3)"><a href="./result.tcl.html#::get_result_dir_189">::get_result_dir</a></a>]} reason]} {
            <a name="::result_error(11)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;error: $reason&#34;
            return -1
        }
        file delete ./Tmp/tmp_$dutIp$msm
        <a name="::result_debug(26)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Remove process_traces.tgz from DUT...&#34;
        <a name="::SendACmd(46)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;rm process_traces.tgz&#34;
        global tftpServerLogin tftpServerPasswd tftpServerTftpboot
        <a name="::login_linux(2)"><a href="./linux.tcl.html#::login_linux_16">::login_linux</a></a> [lindex $DUTs_info(tftpserverlist) 0] $tftpServerLogin $tftpServerPasswd
        catch {<a name="::SendACmd(47)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;/bin/rm $tftpServerTftpboot/process_traces.tgz_$dutIp$msm&#34; NULL NULL true 1}
    } else {
        <a name="::result_error(12)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Error while tftp process_traces.tgz to process_traces.tgz_$dutIp$msm&#34;
    }
}

<strong><a name="::::_tftpFromBToA_648">proc <a href="cleanup.tcl-annot.html#::::_tftpFromBToA">::::_tftpFromBToA</a></a></strong> {connecta connectb coreFile numDUT} {
    global bcmChassis DUTs_info

    set msmb 0
    if {[regexp -nocase $bcmChassis $DUTs_info(DUT$numDUT,platform)]} {
        ;<span class="comment-line"># 10.0.&lt;slot&gt;.2  MSMA-slot 11, MSMB-slot 12</span>
        if {[regexp -nocase &#34;8810&#34; $DUTs_info(DUT$numDUT,platform)]} {
            set msmb 12
        } else {
            set msmb 8
        }
    } else {
        set msmb 10
    }
    <a name="::Login(17)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connectb -masterCheck 0
    if {[regexp -nocase &#34;present&#34; $DUTs_info(DUT${numDUT},memoryCard)]} {
        <a name="::SendACmd(48)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;!mv /mnt/a/$coreFile /scratch/$coreFile&#34;
        <a name="::Login(18)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connecta
        <a name="::EnableDebugMode(7)"><a href="./misc.tcl.html#::EnableDebugMode_2430">::EnableDebugMode</a></a>
        <a name="::SendACmd(49)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;!tftp -v 1 -g -r /scratch/$coreFile -l /scratch/intern/$coreFile 10.0.$msmb.2&#34;
        <a name="::SendACmd(50)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;mv /usr/local/tmp/$coreFile /usr/local/ext/$coreFile&#34;
        <a name="::SendACmd(51)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;!tftp -v 1 -g -r /config/process_traces.tgz -l /scratch/process_tracesB.tgz 10.0.$msmb.2&#34;
        <a name="::SendACmd(52)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;!mv /scratch/process_tracesB.tgz /scratch/intern/process_tracesB.tgz&#34;
    } else {
        <a name="::SendACmd(53)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;!mv /scratch/intern/$coreFile /scratch/$coreFile&#34;
        <a name="::Login(19)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connecta
        <a name="::EnableDebugMode(8)"><a href="./misc.tcl.html#::EnableDebugMode_2430">::EnableDebugMode</a></a>
        <a name="::SendACmd(54)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;!tftp -v 1 -g -r /scratch/$coreFile -l /scratch/intern/$coreFile 10.0.$msmb.2&#34;
        <a name="::SendACmd(55)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;!tftp -v 1 -g -r /config/process_traces.tgz -l /scratch/process_tracesB.tgz 10.0.$msmb.2&#34;
        <a name="::SendACmd(56)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;!mv /scratch/process_tracesB.tgz /scratch/intern/process_tracesB.tgz&#34;
    }
    <span class="comment-line"># Remove unwatned files in msm-b</span>
    <a name="::Login(20)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connectb -masterCheck 0
    <a name="::SendACmd(57)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;!rm /scratch/$coreFile&#34;
    return
}


<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name:  dumpAllSwitchInfo</span>
<span class="comment-line"># Description:  dump switch, version, vlan, port and edp information of </span>
<span class="comment-line">#	all involved DUTs when getting connectionBad during checkConnection</span>
<span class="comment-line"># Input args: none</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Typical usage: </span>
<span class="comment-line">#           showPortandEDPinfo</span>
<span class="comment-line"># Category: GetSwitchInfo</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::dumpAllSwitchInfo_696">proc <a href="cleanup.tcl-annot.html#::::dumpAllSwitchInfo">::::dumpAllSwitchInfo</a></a></strong> {} {
    global DUTs_info;
    global supportedPlatform

    <span class="comment-line"># ----- Environment variables setup</span>
    set _log_user [log_user];

    for {set numDUT 1; global DUT${numDUT}_CONNECT} { [info exists DUT${numDUT}_CONNECT] } \
                           {incr numDUT ; global DUT${numDUT}_CONNECT} {
        set fd_res [<a name="::open_result_file(5)"><a href="./result.tcl.html#::open_result_file_276">::open_result_file</a></a> &#34;DUT${numDUT}Log&#34; &#34;a&#34;];
        set connect [set DUT${numDUT}_CONNECT];
        <a name="::Login(21)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connect;
        <a name="::result_debug(27)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;&lt;&lt;&lt;&lt;&lt;    after connectionBad   &gt;&gt;&gt;&gt;&gt;&#34;;
        set platform [<a name="::GetPlatform(9)"><a href="./misc.tcl.html#::GetPlatform_478">::GetPlatform</a></a> DUT$numDUT];
        <a name="::result_debug(28)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;===========================show switch all==============================&#34;;
        <a name="::SendACmd(58)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a>	&#34;show switch&#34;;
        <a name="::result_debug(29)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;===========================show version all==============================&#34;;
        <a name="::SendACmd(59)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a>	&#34;show version&#34;;
        <a name="::result_debug(30)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;===========================show vlan==============================&#34;;
        <a name="::SendACmd(60)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a>	&#34;show vlan&#34;;
        <a name="::result_debug(31)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;===========================show fdb==============================&#34;;
        <a name="::SendACmd(61)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a>	&#34;show fdb&#34;;
        if {[regexp -nocase $supportedPlatform $platform]} {
            <a name="::result_debug(32)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;===========================show port info all==============================&#34;;
            <a name="::SendACmd(62)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a>	&#34;show port info&#34;;
            <a name="::result_debug(33)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;=============================edp port all=============================&#34;
            <a name="::SendACmd(63)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a>  &#34;show edp port all&#34;;
        } elseif {[regexp -nocase &#34;BD&#34; $platform]} {
            <span class="comment-line"># --- BD-PC</span>
            <a name="::result_debug(34)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;===========================show port info all==============================&#34;;
            <a name="::SendACmd(64)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a>	&#34;show port 1:1-5:4 info&#34;;
            <a name="::result_debug(35)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;=============================edp port all=============================&#34;
            <a name="::SendACmd(65)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a>	&#34;show edp port 1:1-5:4&#34;;
        } else {
            <span class="comment-line"># --- Summit-PC</span>
            <a name="::result_debug(36)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;===========================show port info all==============================&#34;;
            <a name="::SendACmd(66)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a>	&#34;show port 1-12 info&#34;;
            <a name="::result_debug(37)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;=============================edp port all=============================&#34;
            <a name="::SendACmd(67)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a>	&#34;show edp port 1-12&#34;;
        }
        <a name="::result_debug(38)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;=============================ALL LOGS=============================&#34;
        <a name="::SendACmd(68)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a>	&#34;show log&#34;
        <a name="::close_result_file(6)"><a href="./result.tcl.html#::close_result_file_363">::close_result_file</a></a>
    }

    log_user $_log_user;
}

<strong><a name="::::CaptureErroneousLog_744">proc <a href="cleanup.tcl-annot.html#::::CaptureErroneousLog">::::CaptureErroneousLog</a></a></strong> {buff} {
    if {[regexp -nocase {Port ([0-9]:[0-9]) has encountered a fault condition} $buff matched subStr]} {
        <a name="::SendACmd(69)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;show inline-power info details ports $subStr&#34;
    }
    if {[regexp -nocase &#34;aspendiags&#34; $buff]} {
        <a name="::result_error(13)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Aspen diags have log error msgs&#34;
    }
    return
}

<strong><a name="::::moveCoreDumpsToReportDir_754">proc <a href="cleanup.tcl-annot.html#::::moveCoreDumpsToReportDir">::::moveCoreDumpsToReportDir</a></a></strong> { } {
    global tftpServerList tftpServerLogin tftpServerPasswd tftpServerTftpboot
    global coreDumpFiles
    global reportDir

    if { [llength $coreDumpFiles] == 0 } {
        <a name="::result_debug(39)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;No core dump files found in DUTs&#34;
        return
    }
    pushd $reportDir
    set tftpServer [lindex $tftpServerList 0]
    foreach coreFile $coreDumpFiles {
        set dutCoreFile $coreFile
        <span class="comment-line"># EY-12-01-2009: Changed regexp pattern to handle more than five DUTs.</span>
        regexp -nocase {DUT[0-9]+_(.*)} $coreFile match tftpCoreFile
        lappend tftpCoreFiles $tftpCoreFile
        exec echo &#34;get $tftpCoreFile $dutCoreFile\nquit\n&#34; | /usr/bin/tftp $tftpServer
    }
    popd
    global spawn_id
    set sid $spawn_id
    <a name="::login_linux(3)"><a href="./linux.tcl.html#::login_linux_16">::login_linux</a></a> $tftpServer $tftpServerLogin $tftpServerPasswd
    <a name="::result_debug(40)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Files to be deleted from TFTP server are $coreDumpFiles&#34;
    foreach coreFile $tftpCoreFiles {
        <a name="::result_debug(41)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Removing $coreFile from TFTP server&#34;
        <a name="::linuxSendACmd(1)"><a href="./linux.tcl.html#::linuxSendACmd_268">::linuxSendACmd</a></a> &#34;/bin/rm $tftpServerTftpboot/$coreFile&#34;
    }
    set spawn_id $sid
}

<strong><a name="::::decodeCores_784">proc <a href="cleanup.tcl-annot.html#::::decodeCores">::::decodeCores</a></a></strong> { } {
    global coreDumpFiles reportDir curAutoRoot modName

    if {[llength $coreDumpFiles] == 0 } {
        <a name="::result_debug(42)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;No core dumps to decode&#34;
        return
    }
    set defaultDir &#34;/home/autotest-sc/coreDecode&#34;
    if {![file exists /home/autotest-sc/coreDecode/corePrep.pl]} {
        <a name="::result_debug(43)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Cores present but corePrep.pl is not present in the dir $defaultDir to decode&#34;
        return
    }
    set process_id [pid]
    set decodeDir &#34;/home/autotest-sc/coreDecode/decodes_${process_id}&#34;
    file mkdir $decodeDir
    file copy  $defaultDir/corePrep.pl $decodeDir
    pushd $reportDir
    puts &#34;report_dir is $reportDir&#34;
    set coreFilesFound [glob -nocomplain  *.tgz]
    foreach filename $coreFilesFound {
        file copy $filename $decodeDir
    }
    pushd $decodeDir
    foreach filename $coreFilesFound {
        exec tar -xvf $filename
    }
    set coreFiles [glob -nocomplain *.gz]
    if {[llength $coreFiles] == 0} {
        <a name="::result_debug(44)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Invalid coredump&#34;
        return
    }
    <a name="::login_linux(4)"><a href="./linux.tcl.html#::login_linux_16">::login_linux</a></a> sicily autotest-sc glitterpen
    <a name="::result_debug(45)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Logging into sicily server&#34;
    <a name="::linuxSendACmd(2)"><a href="./linux.tcl.html#::linuxSendACmd_268">::linuxSendACmd</a></a> &#34;cd $decodeDir&#34;
    foreach filename $coreFiles {
        set logfilename [file root $filename]
        set logfilename [$logfilename .log]
        <a name="::linuxSendACmd(3)"><a href="./linux.tcl.html#::linuxSendACmd_268">::linuxSendACmd</a></a> &#34;./corePrep.pl -n $filename | tee -a $logfilename&#34;
        <a name="::exSleep(8)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 10
    }
    set corelogs [glob -nocomplain *.log]
    <a name="::logout(1)"><a href="./logout.tcl.html#::logout_21">::logout</a></a>
    pushd $decodeDir
    if {[llength $corelogs] == 0} {
        <a name="::result_debug(46)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Invalid  coredump&#34;
        return
    }
    foreach logfile $corelogs {
        file copy  $logfile ${curAutoRoot}/Functionaltest/${modName}/${reportDir}
    }

    cd ..
    exec rm -rf  $decodeDir
    return
}


<strong><a name="::::uploadConfigDiff_841">proc  <a href="cleanup.tcl-annot.html#::::uploadConfigDiff">::::uploadConfigDiff</a></a></strong> { } {
    global whichDutNow
    global DUT1_IP 
    global numDUT 
    global tftpServerList tftpServerLogin tftpServerPasswd tftpServerTftpboot
    <a name="::ConfigGatewayNetwork(5)"><a href="./SendSwCmd.tcl.html#::ConfigGatewayNetwork_2110">::ConfigGatewayNetwork</a></a>
    if {[<a name="::CompareRelease(9)"><a href="./misc.tcl.html#::CompareRelease_891">::CompareRelease</a></a> [<a name="::GetVersion(9)"><a href="./misc.tcl.html#::GetVersion_303">::GetVersion</a></a> DUT${numDUT}] 11.4.0.1]&gt;=0} {
        <a name="::SendACmd(70)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;!tar -cvzf /scratch/intern/config_diff_DUT${whichDutNow}.tgz_$DUT1_IP /config/perTest_*.xsf&#34;
    } else {
        <a name="::SendACmd(71)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;!tar -cvzf /scratch/config_diff_DUT${whichDutNow}.tgz_$DUT1_IP /config/perTest_*.xsf&#34;
    }
    <a name="::SendACmd(72)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;tftp [lindex $tftpServerList 0] -v [<a name="::GetVrString(8)"><a href="./misc.tcl.html#::GetVrString_3157">::GetVrString</a></a> $numDUT] -p -l /usr/local/tmp/config_diff_DUT${whichDutNow}.tgz_$DUT1_IP&#34;
    <a name="::SendACmd(73)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;rm /usr/local/tmp/config_diff_DUT${whichDutNow}.tgz_$DUT1_IP&#34;
    <a name="::SendACmd(74)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;rm perTest_*.xsf&#34;
}
<strong><a name="::::moveConfigDiffToReportDir_856">proc <a href="cleanup.tcl-annot.html#::::moveConfigDiffToReportDir">::::moveConfigDiffToReportDir</a></a></strong> { } {
    global tftpServerList tftpServerLogin tftpServerPasswd tftpServerTftpboot
    global reportDir
    global numDUT
    global DUT1_IP
    global enableSaveConfigPerTest
    if { ([info exists enableSaveConfigPerTest] ) &amp;&amp; \
               ([<a name="::CompareRelease(10)"><a href="./misc.tcl.html#::CompareRelease_891">::CompareRelease</a></a> [<a name="::GetVersion(10)"><a href="./misc.tcl.html#::GetVersion_303">::GetVersion</a></a> DUT${numDUT}] 12.1]&gt;=0 )  &amp;&amp;  \
               ($enableSaveConfigPerTest == &#34;yes&#34;)} { 
        pushd $reportDir
        set tftpServer [lindex $tftpServerList 0]
        for {set i 1} {$i &lt;= $numDUT} {incr i 1} {
            exec echo &#34;get config_diff_DUT${i}.tgz_$DUT1_IP\nquit\n&#34; | /usr/bin/tftp $tftpServer
        }
        popd
        global spawn_id
        set sid $spawn_id
        <a name="::login_linux(5)"><a href="./linux.tcl.html#::login_linux_16">::login_linux</a></a> $tftpServer $tftpServerLogin $tftpServerPasswd
        for {set i 1} {$i &lt;= $numDUT} {incr i 1} {
            <a name="::result_debug(47)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Removing config_diff_DUT${i}.tgz_$DUT1_IP from TFTP server&#34;
            <a name="::linuxSendACmd(4)"><a href="./linux.tcl.html#::linuxSendACmd_268">::linuxSendACmd</a></a> &#34;/bin/rm $tftpServerTftpboot/config_diff_DUT${i}.tgz_$DUT1_IP&#34;  
        }
        set spawn_id $sid
    }

}

<strong><a name="::::allCleanup_883">proc <a href="cleanup.tcl-annot.html#::::allCleanup">::::allCleanup</a></a></strong> {numDUT} {

    global DUT${numDUT}_CONNECT
    set connect [set DUT${numDUT}_CONNECT]

    <a name="::Login(22)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connect -CheckOperational 0

    <a name="::SendACmd(75)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;enable port all&#34;
    <a name="::exSleep(9)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 2

    <span class="comment-line"># ----- PROTOCOL SECTION -----</span>
    <a name="::SendACmd(76)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable ospf&#34;
    <a name="::SendACmd(77)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config ospf delete vlan all&#34;
    <a name="::SendACmd(78)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;delete ospf area all&#34;
    <a name="::SendACmd(79)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config ospf routerid automatic&#34;
    <a name="::SendACmd(80)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;unconfigure ospf&#34;

    <a name="::SendACmd(81)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable ospfv3&#34;
    <a name="::SendACmd(82)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config ospfv3 delete vlan all&#34;
    <a name="::SendACmd(83)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;delete ospfv3 area all&#34;
    <a name="::SendACmd(84)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config ospfv3 routerid automatic&#34;
    <a name="::SendACmd(85)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;unconfigure ospfv3&#34;

    <a name="::SendACmd(86)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable mpls&#34;
    <a name="::SendACmd(87)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;delete l2vpn vpls all&#34;
    <a name="::SendACmd(88)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;delete l2vpn vpws all&#34;
    <a name="::SendACmd(89)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;unconfigure mpls&#34;

    <a name="::SendACmd(90)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable pim&#34;
    <a name="::SendACmd(91)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config pim delete vlan all&#34;
    <a name="::SendACmd(92)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable pim ssm vlan all&#34;
    <a name="::SendACmd(93)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;unconfigure pim&#34;

    <a name="::SendACmd(94)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable rip&#34;
    <a name="::SendACmd(95)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable ripng&#34;
    <a name="::SendACmd(96)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;configure rip delete vlan all&#34;
    <a name="::SendACmd(97)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;configure ripng delete vlan all&#34;
    <a name="::SendACmd(98)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;unconfigure rip&#34;
    <a name="::SendACmd(99)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;unconfigure ripng&#34;

    <a name="::SendACmd(100)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable bgp&#34;
    <a name="::SendACmd(101)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;delete bgp neighbor all&#34;
    <a name="::SendACmd(102)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;configure bgp routerid 0.0.0.0&#34;
    <a name="::SendACmd(103)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;configure bgp AS-number 0&#34;

    <a name="::SendACmd(104)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable vrrp&#34;

    <a name="::SendACmd(105)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable netlogin ports all mac&#34;
    <a name="::SendACmd(106)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable netlogin ports all dot1x&#34;
    <a name="::SendACmd(107)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable netlogin ports all web&#34;
    <a name="::SendACmd(108)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable netlogin mac&#34;
    <a name="::SendACmd(109)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable netlogin dot1x&#34;
    <a name="::SendACmd(110)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable netlogin web&#34;
    <a name="::SendACmd(111)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;unconfigure netlogin vlan&#34;

    <a name="::SendACmd(112)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;unconfigure radius&#34;
    <a name="::SendACmd(113)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;unconfigure identity-management&#34;

    <span class="comment-line"># ----- VLAN VMAN VR HAL -----</span>
    <a name="::SendACmd(114)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;unconfig default ipaddress&#34;
    <a name="::SendACmd(115)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;unconfigure ports all redundant&#34;
    <a name="::SendACmd(116)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;configure default delete port all&#34;


    <span class="comment-line"># --- VLAN</span>
    set parameterList &#34;&#34;
    lappend parameterList &#34;{vlanProc {name1}}&#34;
    set resVLANS [<a name="::GetDictValue(1)"><a href="./jsonLib.tcl.html#::GetDictValue_917">::GetDictValue</a></a> -cmd &#34;show vlan&#34; -parameterList $parameterList -debugjson &#34;false&#34;]
    unset parameterList

    foreach vn $resVLANS {
        if {$vn != &#34;Default&#34; &amp;&amp; $vn != &#34;Mgmt&#34;} {
            <a name="::SendACmd(117)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;delete vlan $vn&#34;
        }
    } 
    <span class="comment-line"># --- VMAN</span>
    set parameterList &#34;&#34;
    lappend parameterList &#34;{vlanProc {name1}}&#34;
    set resVMANS [<a name="::GetDictValue(2)"><a href="./jsonLib.tcl.html#::GetDictValue_917">::GetDictValue</a></a> -cmd &#34;show vman&#34; -parameterList $parameterList -debugjson &#34;true&#34;]
    unset parameterList

    foreach vn $resVMANS {
        <a name="::SendACmd(118)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;delete vman $vn&#34;
    }


    set shareName [<a name="::GetColumnValues(1)"><a href="./OptionCheck.tcl.html#::GetColumnValues_593">::GetColumnValues</a></a> &#34;show port sharing&#34; {{0 8}} \
       &#34;==============================================================================&#34; \
       &#34;==============================================================================&#34;]
    if {[llength $shareName]} {
        for {set i 0} {$i&lt;[llength [lindex $shareName 0]]} {incr i} {
            set everyShare [lindex [lindex $shareName 0] $i]
            set name [split $everyShare &#34; &#34;]
            set perShare [lindex $name 0]
            if {$perShare == &#34;        &#34;} {
                continue
            }
            if {![<a name="::::CascadeSharePort(1)"><a href="./vpex.tcl.html#::::CascadeSharePort_767">::::CascadeSharePort</a></a> $numDUT $perShare]} {
                <a name="::SendACmd(119)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable sharing $perShare&#34;
            }
        }
    }


    <a name="::SendACmd(120)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable jumbo-frame por all&#34;
    <a name="::SendACmd(121)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable mac-lockdown-timeout ports all&#34;
    <a name="::SendACmd(122)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable mirroring&#34;

    <span class="comment-line">#SendACmd &#34;configure port &lt;all&gt; ethertype primary&#34;; # no easy global for all ports</span>
    <a name="::SendACmd(123)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;unconfigure vman ethertype secondary&#34;
    <a name="::SendACmd(124)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;unconfigure vman ethertype&#34;
    <a name="::SendACmd(125)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable dot1p examination inner-tag ports all&#34;
    <a name="::SendACmd(126)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;enable dot1p examination ports all&#34;
    <a name="::SendACmd(127)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;enable learning ports all&#34;
    <a name="::SendACmd(128)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;enable flooding all_cast ports all&#34;
    <a name="::SendACmd(129)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;unconfigure access-list&#34;


    global gnssPlatform bcmLynx bcmPlatform
    set platform [<a name="::GetPlatform(10)"><a href="./misc.tcl.html#::GetPlatform_478">::GetPlatform</a></a> DUT${numDUT}];

    if {[regexp -nocase &#34;$bcmPlatform&#34; $platform]} {
        <a name="::SendACmd(130)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;configure dot1p type 0 qp1&#34;
        <a name="::SendACmd(131)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;configure dot1p type 1 qp1&#34;
        <a name="::SendACmd(132)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;configure dot1p type 2 qp1&#34;
        <a name="::SendACmd(133)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;configure dot1p type 3 qp1&#34;
        <a name="::SendACmd(134)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;configure dot1p type 4 qp1&#34;
        <a name="::SendACmd(135)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;configure dot1p type 5 qp1&#34;
        <a name="::SendACmd(136)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;configure dot1p type 6 qp1&#34;
        <a name="::SendACmd(137)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;configure dot1p type 7 qp8&#34;
        <a name="::SendACmd(138)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;delete qosprofile qp2&#34;
        <a name="::SendACmd(139)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;delete qosprofile qp3&#34;
        <a name="::SendACmd(140)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;delete qosprofile qp4&#34;
        <a name="::SendACmd(141)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;delete qosprofile qp5&#34;
        <a name="::SendACmd(142)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;delete qosprofile qp6&#34;
        <a name="::SendACmd(143)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;delete qosprofile qp7&#34;
    }

    if {![regexp -nocase &#34;$bcmLynx&#34; $platform]} {
        set vrName [<a name="::GetColumnValues(2)"><a href="./OptionCheck.tcl.html#::GetColumnValues_593">::GetColumnValues</a></a> &#34;show virtual-router&#34; {{0 32}} &#34;Router *VLANs&#34; &#34;Flags :&#34;]
        if {[llength $vrName]} { 
            for {set i 0} {$i&lt;[llength [lindex $vrName 0]]} {incr i} {
                set everyVr [lindex [lindex $vrName 0] $i]
                if {[string trim $everyVr] == &#34;&#34;} {continue;}
                set name [split $everyVr &#34; &#34;]
                set perVrName [lindex $name 0]
                if {$perVrName == &#34;KEY_NOT_FOUND&#34;} {continue;}
                if {[regexp -nocase &#34;\[\-]{2,32}&#34; $perVrName]} {continue;}
                if {$perVrName != &#34;VR-Default&#34; &amp;&amp; $perVrName != &#34;VR-Mgmt&#34; \
                                              &amp;&amp; $perVrName != &#34;VR-Control&#34;} {
                    <a name="::SendACmd(144)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;delete virtual-router $perVrName&#34;
                }

            } 
        }
    }

    <span class="comment-line"># ----  EAPS</span>
    <a name="::SendACmd(145)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable eaps&#34;
    set eapsName [<a name="::GetColumnValues(3)"><a href="./OptionCheck.tcl.html#::GetColumnValues_593">::GetColumnValues</a></a> &#34;show eaps&#34; {{0 20}} &#34;Domain *State&#34; &#34;Flags :&#34;]
    if {[llength $eapsName]} {
        for {set i 0} {$i&lt;[llength [lindex $eapsName 0]]} {incr i} {
            set eapsLine [lindex [lindex $eapsName 0] $i]
            if {[string trim $eapsLine] == &#34;&#34; || $eapsLine == &#34;*&#34;} {continue;}
            set eapsWords [split $eapsLine &#34; &#34;]
            set eapsWord0 [lindex $eapsWords 0]
            if {[regexp -nocase &#34;\[\-]{2,20}&#34; $eapsWord0]} {continue;}
            if {$eapsWord0 == &#34;KEY_NOT_FOUND&#34;} {continue;}
            <a name="::SendACmd(146)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;delete eaps $eapsWord0&#34;
        }
    }    
    set eapsShare [<a name="::GetColumnValues(4)"><a href="./OptionCheck.tcl.html#::GetColumnValues_593">::GetColumnValues</a></a> &#34;show eaps share&#34; {{0 13}} &#34;Shared-port *Mode&#34; \
        &#34;.*#.*&#34;]
    if {[llength $eapsShare]} {
        for {set i 0} {$i&lt;[llength [lindex $eapsShare 0]]} {incr i} {
            set eapsLine [lindex [lindex $eapsShare 0] $i]
            if {[string trim $eapsLine] == &#34;&#34;} {continue;}
            set eapsWords [split $eapsLine &#34; &#34;]
            set eapsWord0 [lindex $eapsWords 0]
            if {[regexp -nocase &#34;\[\-]{2,20}&#34; $eapsWord0]} {continue;}
            if {$eapsWord0 == &#34;KEY_NOT_FOUND&#34;} {continue;}
            <a name="::SendACmd(147)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;delete eaps shared-port $eapsWord0&#34;
        }
    } else {
        puts &#34;MISSED ALL shares&#34;
    }

    <span class="comment-line"># ---- STPD</span>
    <a name="::SendACmd(148)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable stpd&#34;
    set stpdName [<a name="::GetColumnValues(5)"><a href="./OptionCheck.tcl.html#::GetColumnValues_593">::GetColumnValues</a></a> &#34;show stpd&#34; {{0 20}} &#34;Name *Tag&#34; &#34;Total number of&#34;]
    if {[llength $stpdName]} {
        for {set i 0} {$i&lt;[llength [lindex $stpdName 0]]} {incr i} {
            set stpdLine [lindex [lindex $stpdName 0] $i]
            if {[string trim $stpdLine] == &#34;&#34;} {continue;}
            set stpdWords [split $stpdLine &#34; &#34;]
            set stpdWord0 [lindex $stpdWords 0]
            if {$stpdWord0 == &#34;s0&#34;} {
                continue;
            }
            if {$stpdWord0 == &#34;KEY_NOT_FOUND&#34;} {continue;}
            if {[regexp -nocase &#34;\[\-]{2,20}&#34; $stpdWord0]} {continue;}
            <a name="::SendACmd(149)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;delete stpd $stpdWord0&#34;
        }
    }
    <span class="comment-line">#</span>
    <span class="comment-line">#  Add code to remove PVLAN</span>
    <span class="comment-line">#</span>
}
<span class="comment-line"># -----------------------------------------------------------------------------</span>
<span class="comment-line"># proc CleanTestBedCfgs</span>
<span class="comment-line">#</span>
<span class="comment-line"># args: no in put arg</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage:  CleanTestBedCfgs</span>
<span class="comment-line">#</span>
<span class="comment-line"># -----------------------------------------------------------------------------</span>
<strong><a name="::::CleanTestBedCfgs_1102">proc <a href="cleanup.tcl-annot.html#::::CleanTestBedCfgs">::::CleanTestBedCfgs</a></a></strong> {} {
    set cleancliList &#34;&#34;
    for {set i 1} {$i&lt;30} {incr i} {
        global DUT${i}_CONNECT
        if {[info exists DUT${i}_CONNECT]} {
            lappend cleancliList &#34;allCleanup $i&#34;
        }
    }
    <span class="comment-line"># All data storage is off b/c this is not really test data... just a tool</span>
    <a name="::_setShowOutput(1)"><a href="./SendSwCmd.tcl.html#::_setShowOutput_3101">::_setShowOutput</a></a> -screen on -log on -res_fmt on
    puts &#34;\n#########################################################################&#34;
    puts &#34;               S T A R T I N G     PARALLEL CLI CLEANUP&#34;
    puts &#34;#########################################################################\n&#34;
    <a name="::MultiTask(1)"><a href="./multiTask.tcl.html#::MultiTask_39">::MultiTask</a></a> $cleancliList
    puts &#34;\n#########################################################################&#34;
    puts &#34;                F I N I S H E D    PARALLEL CLI CLEANUP&#34;
    puts &#34;#########################################################################&#34;
    <a name="::_setShowOutput(2)"><a href="./SendSwCmd.tcl.html#::_setShowOutput_3101">::_setShowOutput</a></a> -screen on -log on -res_fmt on

}
</pre>
<hr>
<div class="index-selector">
	<a href="index_main.html#byfilename">file name</a> 
 | 
	<a href="index_main.html#byprocname">procedure name</a> 
 | 
	<a href="index_main.html#bycall">procedure call</a> 
 | 
	<a href="index_annot_full.html">annotation</a> 

<br>
<cite>File generated 2018-06-14 at 17:09.</cite>
</div>

</body>
</html>
