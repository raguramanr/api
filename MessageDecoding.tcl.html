<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/transitional.dtd">
<!-- Generated by TclDoc @@VERSION@@ -->
<html>
<head>
  <title>MessageDecoding.tcl</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="default.css">
</head>
<body class="src-html">
<div class="index-selector">
<!-- index for tcl source files -->
	Index by: 
	<a href="index_main.html#MessageDecoding.tcl">file name</a> | 
	<a href="index_main.html#byprocname">procedure name</a> | 
	<a href="index_main.html#bycall">procedure call</a> | 
	<a href="index_annot_full.html">annotation</a>

</div>
<hr>

<p><strong>MessageDecoding.tcl</strong>&nbsp;&nbsp;<span class="filetype-link">(<a href="MessageDecoding.tcl-annot.html">annotations</a> | <a href="MessageDecoding.tcl.txt">original source</a>)</span>
</p>
<pre class="src-code">

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetDestMacAddress</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the 6 bytes destination mac address from mac header.</span>
<span class="comment-line">#     Any packet/frame does not matter</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: 6 byte hex string</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#             GetDestMacAddress frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetDestMacAddress_19">proc <a href="MessageDecoding.tcl-annot.html#::::GetDestMacAddress">::::GetDestMacAddress</a></a></strong> { rawFrame } {
   return [string range $rawFrame 0 16]
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetSourceMacAddress</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the 6 bytes source mac address from mac header.</span>
<span class="comment-line">#     Any packet/frame does not matter</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: 6 byte hex string</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#             GetSourceMacAddress frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetSourceMacAddress_40">proc <a href="MessageDecoding.tcl-annot.html#::::GetSourceMacAddress">::::GetSourceMacAddress</a></a></strong> { rawFrame } {
   return [string range $rawFrame 18 34]
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetSenderMacAddress</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the 6 bytes mac address from the sender</span>
<span class="comment-line">#     harware address in ARP protocol. Supports tagged frames too.</span>
<span class="comment-line">#     Any packet/frame does not matter</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: 6 byte hex string or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#             GetSenderMacAddress frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetSenderMacAddress_62">proc <a href="MessageDecoding.tcl-annot.html#::::GetSenderMacAddress">::::GetSenderMacAddress</a></a></strong> { rawFrame } {
  set type [string range $rawFrame 36 40]
  switch -- $type \
    &#34;08 06&#34; {
    return [string range $rawFrame 66 82]
  } &#34;81 00&#34; {
    return [string range $rawFrame 78 94] ;<span class="comment-line"># tagged frame</span>
  } default {
    <a name="::result_debug(1)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: $type&#34;
    <span class="comment-line">#just return the type</span>
    return -1
  }
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetIpOption</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get IP header option.</span>
<span class="comment-line">#     IP options include standard ip option beyond 20 bytes header length.</span>
<span class="comment-line">#     Supports tagged frames too.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame, optionName</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Hex value of optionName or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetIpOption frame RouterAlertOption</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetIpOption_94">proc <a href="MessageDecoding.tcl-annot.html#::::GetIpOption">::::GetIpOption</a></a></strong> { rawFrame optionName } {
   set type [string range $rawFrame 36 40]

   <span class="comment-line"># if tagged, get rid of type and tag field from 36 to 47</span>
   if {$type == &#34;81 00&#34;} {
     set leftRawFrame [string range $rawFrame 0 35] 
     set rightRawFrame [string range $rawFrame 48 [string length $rawFrame]] 
     set rawFrame [format &#34;%s%s&#34; $leftRawFrame $rightRawFrame]
   }

   switch -- $optionName {
      &#34;RouterAlertOption&#34; {
         return [string range $rawFrame 102 112]
      } &#34;RecordRouteOption&#34; {
         <span class="comment-line"># (Ted) change the pointer to the correct length</span>
         <span class="comment-line">#set pointerValue [string trimleft [string range $rawFrame 108 109] 0]</span>
         set pointerValue [string trimleft [string range $rawFrame 105 106] 0]
         set pointerValue [<a name="::hextodec(1)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> $pointerValue] 
	 if {$pointerValue &lt; 0} {
	     ;<span class="comment-line"># pointerValue == -1 if hextodec is passed blank entry</span>
	     ;<span class="comment-line"># hextodec passed blank entry if trimleft is passed 00 (APL)</span>
	     return -1
	 }
         <span class="comment-line">#set pointerValue [expr $pointerValue - 4]     </span>
         set pointerValue [expr $pointerValue - 3]
         return [string range $rawFrame 102 [expr 109 + [expr $pointerValue * 3]]]
      } &#34;TimeStampOption&#34; {
         set pointerValue [string trimleft [string range $rawFrame 108 109] 0]
         set pointerValue [<a name="::hextodec(2)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> $pointerValue]
	 if {$pointerValue &lt; 0} {
	      return -1
	 }	 
         return [string range $rawFrame 102 [expr 102 + [expr $pointerValue - 1]*3 - 2]]
      } &#34;StreamIDOption&#34; {
         return [string range $rawFrame 102 112]
      } &#34;SecurityOption&#34; {
         return [string range $rawFrame 102 133]
      }  &#34;EndOfOptionListOption&#34; {
         return [string range $rawFrame 102 103]
      } default {
         <a name="::result_debug(2)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown optionName supplied: $optionName&#34;
         <span class="comment-line">#just return the type</span>
         return -1
      }
   }
}  

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetTargetMacAddress</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the 6 bytes mac address from the target</span>
<span class="comment-line">#     harware address in ARP protocol. Supports tagged frames too.</span>
<span class="comment-line">#     Any packet/frame does not matter</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: 6 byte hex string or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetTargetMacAddress frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetTargetMacAddress_159">proc <a href="MessageDecoding.tcl-annot.html#::::GetTargetMacAddress">::::GetTargetMacAddress</a></a></strong> { rawFrame } {
  set type [string range $rawFrame 36 40]
  switch -- $type \
    &#34;08 06&#34; {
    return [string range $rawFrame 96 112]
  } &#34;88 8E&#34; { ;<span class="comment-line"># EAPOL Frame</span>
    return [string range $rawFrame 96 112]
  } &#34;81 00&#34; {
    return [string range $rawFrame 108 124] ;<span class="comment-line"># tagged frame</span>
  } default {
    <a name="::result_debug(3)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: $type&#34;
    <span class="comment-line">#just return the type</span>
    return -1
  }
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetTTL</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the decimal ttl value from an ip packet header</span>
<span class="comment-line">#     Supports tagged frames too.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Integer or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetTTL frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetTTL_192">proc <a href="MessageDecoding.tcl-annot.html#::::GetTTL">::::GetTTL</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;08 00&#34; {
      return [<a name="::hextodec(3)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 66 67]]         
   }  &#34;81 00&#34; {
      return [<a name="::hextodec(4)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 78 79]]      ;<span class="comment-line">#tagged frame   </span>
   } default {
      <a name="::result_debug(4)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: $type&#34;
      <span class="comment-line">#just return the type</span>
      return -1
   }
   
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetICMPType</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the decimal icmp type value from an icmp packet header</span>
<span class="comment-line">#     Supports tagged frames too.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Integer or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetICMPType frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetICMPType_224">proc <a href="MessageDecoding.tcl-annot.html#::::GetICMPType">::::GetICMPType</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;08 00&#34; {
      return [<a name="::hextodec(5)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 102 103]]         
   }  &#34;81 00&#34; {
      return [<a name="::hextodec(6)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 114 115]]      ;<span class="comment-line">#tagged frame   </span>
   } default {
      <a name="::result_debug(5)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown IP Type: $type&#34;
      <span class="comment-line">#just return the type</span>
      return -1
   }
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetICMPCode</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the decimal icmp code value from an icmp packet header</span>
<span class="comment-line">#     Supports tagged frames too.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Integer or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetICMPCode frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetICMPCode_255">proc <a href="MessageDecoding.tcl-annot.html#::::GetICMPCode">::::GetICMPCode</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;08 00&#34; {
      return [<a name="::hextodec(7)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 105 106]]         
   }  &#34;81 00&#34; {
      return [<a name="::hextodec(8)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 117 118]]      ;<span class="comment-line">#tagged frame   </span>
   } default {
      <a name="::result_debug(6)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown IP Type: $type&#34;
      <span class="comment-line">#just return the type</span>
      return -1
   }
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetICMPId</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the decimal icmp id value from an icmp packet header</span>
<span class="comment-line">#     Supports tagged frames too.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: short Integer or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetICMPId frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetICMPId_286">proc <a href="MessageDecoding.tcl-annot.html#::::GetICMPId">::::GetICMPId</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;08 00&#34; {
      return [<a name="::GetShortIntOffset(1)"><a href="./MessageDecoding.tcl.html#::GetShortIntOffset_832">::GetShortIntOffset</a></a> $rawFrame 114]         
   }  &#34;81 00&#34; {
      return [<a name="::GetShortIntOffset(2)"><a href="./MessageDecoding.tcl.html#::GetShortIntOffset_832">::GetShortIntOffset</a></a> $rawFrame 126]      ;<span class="comment-line">#tagged frame   </span>
   } default {
      <a name="::result_debug(7)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown IP Type: $type&#34;
      <span class="comment-line">#just return the type</span>
      return -1
   }
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetICMPSequence</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the decimal icmp sequence value from an icmp packet header</span>
<span class="comment-line">#     Supports tagged frames too.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Short integer or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetICMPSequence frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetICMPSequence_317">proc <a href="MessageDecoding.tcl-annot.html#::::GetICMPSequence">::::GetICMPSequence</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;08 00&#34; {
      return [<a name="::GetShortIntOffset(3)"><a href="./MessageDecoding.tcl.html#::GetShortIntOffset_832">::GetShortIntOffset</a></a> $rawFrame 120]         
   }  &#34;81 00&#34; {
      return [<a name="::GetShortIntOffset(4)"><a href="./MessageDecoding.tcl.html#::GetShortIntOffset_832">::GetShortIntOffset</a></a> $rawFrame 132]      ;<span class="comment-line">#tagged frame   </span>
   } default {
      <a name="::result_debug(8)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown IP Type: $type&#34;
      <span class="comment-line">#just return the type</span>
      return -1
   }
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetTOSHex</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the hex value of TOS field from an ip packet header</span>
<span class="comment-line">#     Supports tagged frames too.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: 2 byte hex value or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetTOSHex frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetTOSHex_348">proc <a href="MessageDecoding.tcl-annot.html#::::GetTOSHex">::::GetTOSHex</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;08 00&#34; {
      return [string range $rawFrame 45 46]       
   }  &#34;81 00&#34; {
      return [string range $rawFrame 57 58]      ;<span class="comment-line">#tagged frame   </span>
   } default {
      <a name="::result_debug(9)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: $type&#34;
      <span class="comment-line">#just return the type</span>
      return -1
   }
   
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetIpTotalLength</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the decimal value of length from an ip packet header</span>
<span class="comment-line">#     Supports tagged frames too.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Integer or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetIpTotalLength frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetIpTotalLength_380">proc <a href="MessageDecoding.tcl-annot.html#::::GetIpTotalLength">::::GetIpTotalLength</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;08 00&#34; {
      return [<a name="::GetShortIntOffset(5)"><a href="./MessageDecoding.tcl.html#::GetShortIntOffset_832">::GetShortIntOffset</a></a> $rawFrame 48]   
   }   &#34;81 00&#34; {
      return [<a name="::GetIpTotalLength(1)"><a href="./MessageDecoding.tcl.html#::GetIpTotalLength_380">::GetIpTotalLength</a></a> [string range $rawFrame 12 end ]]          ;<span class="comment-line"># tagged  </span>
   } default {
      <a name="::result_debug(10)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: $type&#34;
      return -1
   }
   
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetSourceIPAddress</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the source IP address a.b.c.d from an ip packet header</span>
<span class="comment-line">#     Supports tagged frames too.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: IP Address or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetSourceIPAddress frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetSourceIPAddress_411">proc <a href="MessageDecoding.tcl-annot.html#::::GetSourceIPAddress">::::GetSourceIPAddress</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;08 00&#34; {
      return [<a name="::GetIPAddressOffset(1)"><a href="./MessageDecoding.tcl.html#::GetIPAddressOffset_885">::GetIPAddressOffset</a></a> $rawFrame 78]          ;<span class="comment-line">#source address   </span>
   }   &#34;81 00&#34; {
      return [<a name="::GetSourceIPAddress(1)"><a href="./MessageDecoding.tcl.html#::GetSourceIPAddress_411">::GetSourceIPAddress</a></a> [string range $rawFrame 12 end ]]     ;<span class="comment-line">#source address, tagged  </span>
   }   &#34;08 06&#34; {
      return [<a name="::GetIPAddressOffset(2)"><a href="./MessageDecoding.tcl.html#::GetIPAddressOffset_885">::GetIPAddressOffset</a></a> $rawFrame 84]          ;<span class="comment-line">#source address   </span>
   }   &#34;88 8E&#34; {
       <a name="::result_debug(11)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;EAPOL Frame-NO SRC IP&#34;
       return -1
   } default {
      <a name="::result_debug(12)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: $type&#34;
      return -1
   }
   
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetDestIPAddress</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the destination IP address a.b.c.d from an ip packet header</span>
<span class="comment-line">#     Supports tagged frames too.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: IP Address or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetDestIPAddress frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetDestIPAddress_447">proc <a href="MessageDecoding.tcl-annot.html#::::GetDestIPAddress">::::GetDestIPAddress</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;08 00&#34; {
      return [<a name="::GetIPAddressOffset(3)"><a href="./MessageDecoding.tcl.html#::GetIPAddressOffset_885">::GetIPAddressOffset</a></a> $rawFrame 90]          ;<span class="comment-line">#dest address   </span>
   }   &#34;81 00&#34; {
      return [<a name="::GetDestIPAddress(1)"><a href="./MessageDecoding.tcl.html#::GetDestIPAddress_447">::GetDestIPAddress</a></a> [string range $rawFrame 12 end ]]          ;<span class="comment-line">#dest address for tagged frame   </span>
   }   &#34;08 06&#34; {
      return [<a name="::GetIPAddressOffset(4)"><a href="./MessageDecoding.tcl.html#::GetIPAddressOffset_885">::GetIPAddressOffset</a></a> $rawFrame 114]          ;<span class="comment-line">#dest address </span>
   }   &#34;88 8E&#34; {
       <a name="::result_debug(13)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;EAPOL Frame-NO DEST IP&#34;
       return -1  
   } default {
      <a name="::result_debug(14)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: $type&#34;
      return -1
   }
   
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetTagId</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the 12 bit decimal value of tag id from a tagged frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Short integer or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetTagId frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetTagId_482">proc <a href="MessageDecoding.tcl-annot.html#::::GetTagId">::::GetTagId</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;81 00&#34; {
         return [<a name="::GetShortInt(1)"><a href="./MessageDecoding.tcl.html#::GetShortInt_810">::GetShortInt</a></a> &#34;0[string range $rawFrame 43 46]&#34; ]
      } &#34;88 A8&#34; {
	 return [<a name="::GetShortInt(2)"><a href="./MessageDecoding.tcl.html#::GetShortInt_810">::GetShortInt</a></a> &#34;0[string range $rawFrame 43 46]&#34; ]
      } &#34;91 00&#34; {
         return [<a name="::GetShortInt(3)"><a href="./MessageDecoding.tcl.html#::GetShortInt_810">::GetShortInt</a></a> &#34;0[string range $rawFrame 43 46]&#34; ]
      } &#34;default&#34; {
         <a name="::result_debug(15)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Not a tag packet: $type. Wanted Tag&#34;
         return -1
      }
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetIPFragmentFlags</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to fragmentation flags from a tagged/untagged IP packet</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: 2 byte hex value or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#     set prevPktFragFlag [GetIPFragmentFlags $dataFrame]</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetIPFragmentFlags_513">proc <a href="MessageDecoding.tcl-annot.html#::::GetIPFragmentFlags">::::GetIPFragmentFlags</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;08 00&#34; {
      return [<a name="::hextodec(9)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 60 61]]
   }   &#34;81 00&#34; {
      return [<a name="::hextodec(10)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 72 73]]
   } default {
      <a name="::result_debug(16)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: $type&#34;
      return -1
   }
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetIPFragmentOffset</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to fragmentation offset from a tagged/untagged IP packet</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Integer or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#     set fragOffset [GetIPFragmentOffset $rawFrame]</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetIPFragmentOffset_543">proc <a href="MessageDecoding.tcl-annot.html#::::GetIPFragmentOffset">::::GetIPFragmentOffset</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;08 00&#34; {
      return [expr [<a name="::hextodec(11)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 63 64]]*8]   ;<span class="comment-line"># in bits</span>
   }   &#34;81 00&#34; {
      return [expr [<a name="::hextodec(12)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 75 76]]*8]   ;<span class="comment-line"># in bits</span>
   } default {
      <a name="::result_debug(17)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: $type&#34;
      return -1
   }
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetIPSourcePort</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the decimal source port from tcp/udp packet header</span>
<span class="comment-line">#     Supports tagged frames too.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># Return value: Short integer or -1 on error</span>
<span class="comment-line"># GetIPSourcePort frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetIPSourcePort_573">proc <a href="MessageDecoding.tcl-annot.html#::::GetIPSourcePort">::::GetIPSourcePort</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;08 00&#34; {
      return [<a name="::GetShortIntOffset(6)"><a href="./MessageDecoding.tcl.html#::GetShortIntOffset_832">::GetShortIntOffset</a></a> $rawFrame 102]
   }   &#34;81 00&#34; {
      return [<a name="::GetIPSourcePort(1)"><a href="./MessageDecoding.tcl.html#::GetIPSourcePort_573">::GetIPSourcePort</a></a> [string range $rawFrame 12 end ]]          ;<span class="comment-line"># for tagged frame   </span>
   } default {
      <a name="::result_debug(18)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: $type&#34;
      return -1
   }
   
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetIPDestPort</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the decimal destination port from tcp/udp packet header</span>
<span class="comment-line">#     Supports tagged frames too.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Short integer or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetIPDestPort frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetIPDestPort_604">proc <a href="MessageDecoding.tcl-annot.html#::::GetIPDestPort">::::GetIPDestPort</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;08 00&#34; {
      return [<a name="::GetShortIntOffset(7)"><a href="./MessageDecoding.tcl.html#::GetShortIntOffset_832">::GetShortIntOffset</a></a> $rawFrame 108]
   }   &#34;81 00&#34; {
      return [<a name="::GetIPDestPort(1)"><a href="./MessageDecoding.tcl.html#::GetIPDestPort_604">::GetIPDestPort</a></a> [string range $rawFrame 12 end ]]          ;<span class="comment-line"># for tagged frame   </span>
   } default {
      <a name="::result_debug(19)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: $type&#34;
      return -1
   }
   
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetIPTCPBGPType</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the type of tcp type in a bgp control packet</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: 2 bytes hex string or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetIPTCPBGPType frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetIPTCPBGPType_635">proc <a href="MessageDecoding.tcl-annot.html#::::GetIPTCPBGPType">::::GetIPTCPBGPType</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;08 00&#34; {
      return [<a name="::hextodec(13)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 216 217]]
   }   &#34;81 00&#34; {
      return [<a name="::hextodec(14)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 228 229]]
   } default {
      <a name="::result_debug(20)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: $type&#34;
      return -1
   }
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetBGPNotificationErrorCode</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the error code from a BGP notification control packet</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: 2 bytes hex string or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetBGPNotificationErrorCode frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetBGPNotificationErrorCode_665">proc <a href="MessageDecoding.tcl-annot.html#::::GetBGPNotificationErrorCode">::::GetBGPNotificationErrorCode</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;08 00&#34; {
      return [<a name="::hextodec(15)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 219 220]]
   }   &#34;81 00&#34; {
      return [<a name="::hextodec(16)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 231 232]]
   } default {
      <a name="::result_debug(21)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: $type&#34;
      return -1
   }
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetBGPUpdateOriginTypes</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the origin types from a BGP update control packet</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: List of integers or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetBGPUpdateOriginTypes frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetBGPUpdateOriginTypes_695">proc <a href="MessageDecoding.tcl-annot.html#::::GetBGPUpdateOriginTypes">::::GetBGPUpdateOriginTypes</a></a></strong> {rawFrame} {
   set messageType [<a name="::GetMessageType(1)"><a href="./MessageDecoding.tcl.html#::GetMessageType_992">::GetMessageType</a></a> $rawFrame]
   set origins &#34;&#34;
   if {$messageType==&#34;IP_BGPv4_UPDATE&#34;} {
      set type [string range $rawFrame 36 40]
      <span class="comment-line"># if tagged, get rid of type and tag field from 36 to 47</span>
      if {$type == &#34;81 00&#34;} {
        set leftRawFrame [string range $rawFrame 0 35]
        set rightRawFrame [string range $rawFrame 48 [string length $rawFrame]]
        set rawFrame [format &#34;%s%s&#34; $leftRawFrame $rightRawFrame]
      }
      set routeLengths [<a name="::GetBGPUpdateLengths(1)"><a href="./bgp.tcl.html#::GetBGPUpdateLengths_2076">::GetBGPUpdateLengths</a></a> $rawFrame]
      set originStartLoc 240    ;<span class="comment-line"># First origin found at 240 in a IP_TCP_BGP packet</span>
      set startLoc 210
      <a name="::result_debug(22)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;the routeLengths $routeLengths&#34;
      for {set i 0} {$i&lt;[llength $routeLengths]} {incr i} {
         lappend origins [string range $rawFrame [expr $originStartLoc] [expr $originStartLoc+1]]
         set originStartLoc [expr $startLoc+[expr [lindex $routeLengths $i]*3]+30]
<span class="comment-line">#         result_debug &#34;the origins $origins and originStartLoc $originStartLoc&#34;</span>
         incr startLoc [expr [lindex $routeLengths $i]*3]
      }
   }
   return $origins
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetBGPNotificationErrorSubcode</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the notification error sub code from a BGP notification control packet</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: 2 hex byte string or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetBGPNotificationErrorSubcode frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetBGPNotificationErrorSubcode_737">proc <a href="MessageDecoding.tcl-annot.html#::::GetBGPNotificationErrorSubcode">::::GetBGPNotificationErrorSubcode</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;08 00&#34; {
      return [<a name="::hextodec(17)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 222 223]]
   }   &#34;81 00&#34; {
      return [<a name="::hextodec(18)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 234 235]]
   } default {
      <a name="::result_debug(23)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: $type&#34;
      return -1
   }
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetDot1pPriority</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the hex value of dot1p tag priority from tagged mac frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Integer</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetDot1pPriority frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetDot1pPriority_766">proc <a href="MessageDecoding.tcl-annot.html#::::GetDot1pPriority">::::GetDot1pPriority</a></a></strong> { rawFrame } {
   set tmp [string range $rawFrame 42 42]
   set priority [expr 0x$tmp / 2 ]
   <a name="::result_debug(24)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;--- priority=$priority&#34;
   return $priority
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetByteOffset</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the decimal value of a byte from a given offset in a asciihexdata</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: asciiHexData: Hex data to scan from, offsetStart: start of the offset to get a byte</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Integer</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetByteOffset frame 40</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetByteOffset_789">proc <a href="MessageDecoding.tcl-annot.html#::::GetByteOffset">::::GetByteOffset</a></a></strong> { asciiHexData offsetStart } {
   set offsetEnd [expr $offsetStart + 1]
   return [<a name="::hextodec(19)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $asciiHexData $offsetStart $offsetEnd]]
} 

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetShortInt</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the integer value of a 2 bytes hex data</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: asciiHexData: Hex data to scan from</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Integer</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetShortInt asciiHexData</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetShortInt_810">proc <a href="MessageDecoding.tcl-annot.html#::::GetShortInt">::::GetShortInt</a></a></strong> { asciiHexData } {
   set byte1 [<a name="::hextodec(20)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $asciiHexData 0 1]]
   set byte0 [<a name="::hextodec(21)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $asciiHexData 3 4]]
   return [expr $byte1 * 256 + $byte0]
}      

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetShortIntOffset</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the integer value of a 2 bytes hex data at a given offset value</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: asciiHexData: Hex data to scan from, offsetStart:Start of the offset to get bytes from</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: short Integer</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetShortIntOffset asciiHexData offsetStart</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetShortIntOffset_832">proc <a href="MessageDecoding.tcl-annot.html#::::GetShortIntOffset">::::GetShortIntOffset</a></a></strong> { asciiHexData  offsetStart} {
   set offsetEnd [expr $offsetStart + 5]
   set shortIntHex [string range $asciiHexData $offsetStart $offsetEnd]      
   return [<a name="::GetShortInt(4)"><a href="./MessageDecoding.tcl.html#::GetShortInt_810">::GetShortInt</a></a> $shortIntHex]
} 

<span class="comment-line">################################################################# </span>
<span class="comment-line"># Procedure Name: GetIntOffset</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the integer value of a 4 bytes hex data at a given offset value</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: asciiHexData: Hex data to scan from, offsetStart:Start of the offset to get bytes from</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return Value: Integer</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetIntOffset asciiHexData offsetStart</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetIntOffset_854">proc <a href="MessageDecoding.tcl-annot.html#::::GetIntOffset">::::GetIntOffset</a></a></strong> { asciiHexData  offsetStart} {
   set offsetEnd [expr $offsetStart + 4]
   set shortIntHex1 [string range $asciiHexData $offsetStart $offsetEnd]
   set offsetStart  [expr $offsetStart + 6]
   set offsetEnd [expr $offsetStart + 4]
   set shortIntHex0 [string range $asciiHexData $offsetStart $offsetEnd]
   set shortInt1 [<a name="::GetShortInt(5)"><a href="./MessageDecoding.tcl.html#::GetShortInt_810">::GetShortInt</a></a> $shortIntHex1]
   set shortInt0 [<a name="::GetShortInt(6)"><a href="./MessageDecoding.tcl.html#::GetShortInt_810">::GetShortInt</a></a> $shortIntHex0]
   <span class="comment-line">#puts &#34;HexOffsets:|$shortIntHex1|$shortIntHex0|$shortInt1|$shortInt0&#34;</span>
   set temp [expr abs(double($shortInt1 * 65536)) + $shortInt0]
   regexp {[0-9]*} $temp out
   return $out
}

<span class="comment-line">################################################################# </span>
<span class="comment-line"># Procedure Name: GetIPAddressOffset</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the ip address of the form a.b.c.d a</span>
<span class="comment-line">#     given offset value from a rawFrame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame: Hex data to scan from, offsetStart:Start of the offset to get bytes from</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return Value: IpAddress</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetIPAddressOffset asciiHexData offsetStart</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetIPAddressOffset_885">proc <a href="MessageDecoding.tcl-annot.html#::::GetIPAddressOffset">::::GetIPAddressOffset</a></a></strong> { rawFrame offsetStart} {
   set offsetEnd [expr $offsetStart + 11]
   set IP [string range $rawFrame $offsetStart $offsetEnd]
   <span class="comment-line">#puts &#34;IPAddress: $IP&#34;   </span>
   return [<a name="::byte2IpAddr(1)"><a href="./ePTUtils.tcl.html#::byte2IpAddr_166">::byte2IpAddr</a></a> $IP]
}


<span class="comment-line">################################################################# </span>
<span class="comment-line"># Procedure Name: DecodeEapolFrame</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to decode an EAPoL Packet</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame: Hex data to scan from, offsetStart:Start of the offset to get bytes from</span>
<span class="comment-line"># Output args: </span>
<span class="comment-line"># Return Value: Complete EAP Frame Type</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#   Decoding a EAPoL frames in GetMessageType</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::DecodeEapolFrame_907">proc <a href="MessageDecoding.tcl-annot.html#::::DecodeEapolFrame">::::DecodeEapolFrame</a></a></strong> { rawFrame } {

    set ver [string range $rawFrame 42 43]
    set type [string range $rawFrame 45 46]

    switch -- $type \
       &#34;00&#34;  {
        set returnVal &#34;EAP_V$ver&#34; 
        set eapCode [string range $rawFrame 54 55]  ;<span class="comment-line"># Req(1) Resp(2) Succ(3) Fail(4)</span>
        set eapType [string range $rawFrame 66 67]  ;<span class="comment-line"># Identity(1) Notify(2)</span>
		                                    ;<span class="comment-line"># NAK(3) MD5-Chal(4) One Time Pass(5) </span>
                                                    ;<span class="comment-line"># GenricTokenCard(6) TLS(13)</span>
        <a name="::result_debug(25)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DEBUG:ver:$ver type:$type  eapCode:$eapCode  eapType:$eapType&#34;

        switch -- $eapCode \
          &#34;01&#34; {
           set returnVal &#34;[set returnVal]_REQUEST&#34;
	} &#34;02&#34; {
           set returnVal &#34;[set returnVal]_RESPONSE&#34;
	} &#34;03&#34; {
	    set returnVal &#34;[set returnVal]_SUCCESS&#34;
	} &#34;04&#34; {
           set returnVal &#34;[set returnVal]_FAILURE&#34;
	} default {
	    <a name="::result_debug(26)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Warning unknown EAP Code&#34;
	    set returnVal &#34;[set returnVal]_$eapCode&#34;
	}
    
        switch -- $eapType \
          &#34;01&#34; {
           set returnVal &#34;[set returnVal]_IDENTITY&#34;
	} &#34;02&#34; {
           set returnVal &#34;[set returnVal]_NOTIFY&#34;
	} &#34;03&#34; {
	   set returnVal &#34;[set returnVal]_NAK&#34;
	} &#34;04&#34; {
           set returnVal &#34;[set returnVal]_MD5_CHAL&#34;
	} &#34;05&#34; {
           set returnVal &#34;[set returnVal]_ONE_TIME_PASSWORD&#34;
	} &#34;06&#34; {
           set returnVal &#34;[set returnVal]_GENERIC_TOKEN_CARD&#34;
	} &#34;0D&#34; {
           set returnVal &#34;[set returnVal]_TLS&#34;
	} default {
	    set returnVal &#34;[set returnVal]_$eapType&#34;
	    <a name="::result_debug(27)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Warning unknown EAP Data Type&#34;
	}

	return $returnVal

    }  &#34;01&#34;  { 
	return &#34;EAPOL_START&#34;
    }  &#34;02&#34;  { 
	return &#34;EAPOL_LOGOFF&#34;
    }  &#34;03&#34;  { 
	return &#34;EAPOL_KEY&#34;
    }  &#34;04&#34;  { 
	return &#34;EAPOL_ENCAP_ASF_ALERT&#34;
    }  default  {
	<a name="::result_debug(28)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: Ver:$ver EAPOL_$type&#34;
	return &#34;EAPOL_$type&#34;
    }
}


<span class="comment-line">################################################################# </span>
<span class="comment-line"># Procedure Name: GetMessageType</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the type of protocol and specific type in</span>
<span class="comment-line">#     that protocol. Currently, this proc supports, ICMP, IGMP, DVMRP, </span>
<span class="comment-line">#     RIP, PIM, OSPF, TCP, UDP, ARP and IPX extensively.</span>
<span class="comment-line">#     Supports tagged frames too.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Automation supported message type or &#34;FAIL&#34; in error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetMessageType frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>

<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetMessageType_992">proc <a href="MessageDecoding.tcl-annot.html#::::GetMessageType">::::GetMessageType</a></a></strong> { rawFrame } {
   
   set type [string range $rawFrame 36 40]
   <span class="comment-line"># if tagged, get rid of type and tag field from 36 to 47</span>
   if {$type == &#34;81 00&#34;} {
     set leftRawFrame [string range $rawFrame 0 35] 
     set rightRawFrame [string range $rawFrame 48 [string length $rawFrame]] 
     set rawFrame [format &#34;%s%s&#34; $leftRawFrame $rightRawFrame]
   }

   <span class="comment-line">#Assuming MPLS contains the IP packet. 8847 is for carrying unicast layer 3 packets.</span>
   set type [string range $rawFrame 36 40]
   if {$type == &#34;88 47&#34;} {
     set leftRawFrame [string range $rawFrame 0 35] 
     set rightRawFrame [string range $rawFrame 54 [string length $rawFrame]] 
     set rawFrame [format &#34;%s%s %s %s&#34; $leftRawFrame 08 00 $rightRawFrame]
   }

   set type [string range $rawFrame 36 40]
   
<span class="comment-line">#   result_debug &#34;the type $type&#34;</span>
   switch -- $type \
      &#34;08 00&#34; {
         set IpType [string range $rawFrame 69 70]
         switch -- $IpType \
            &#34;01&#34;  { 
               return &#34;IP_ICMP&#34;
         }  &#34;02&#34;  {
            set version [string range $rawFrame 102 102]
            set RouterAlertStatus [string range $rawFrame 42 43]
            if {$RouterAlertStatus == &#34;46&#34;} {
            set type [string range $rawFrame 114 115]
            <span class="comment-line">#puts &#34;type:$type&#34;</span>
            } else {
            set type [string range $rawFrame 102 103]
            <span class="comment-line">#puts &#34;type:$type&#34;</span>
            }
            
            
            switch -glob -- $type \
               &#34;11&#34;  { 
                  return &#34;IP_IGMPv2_QUERRY&#34;
            }  &#34;12&#34;  { 
                  return &#34;IP_IGMPv1_REPORT&#34;
            }  &#34;13&#34;  { 
                  set MinorMajorVersion [string range $rawFrame 120 124]
                  if {$MinorMajorVersion == &#34;FF 03&#34;} {
                     <span class="comment-line">#version 3</span>
                     set subType [string range $rawFrame 105 106]
                     switch -- $subType \
                        &#34;01&#34; {
                           return &#34;IP_DVMRPv3_PROBE&#34;
                     }  &#34;02&#34; {
                           return &#34;IP_DVMRPv3_REPORT&#34;
                     }  &#34;07&#34; {
                           return &#34;IP_DVMRPv3_PRUNE&#34;
                     }  &#34;08&#34; {
                           return &#34;IP_DVMRPv3_GRAFT&#34;
                     }  &#34;09&#34; {
                           return &#34;IP_DVMRPv3_GRAFT_ACK&#34;
                     }  default   {
                           <a name="::result_debug(29)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;IP_DVMRPv3_$subType&#34;
                           return &#34;IP_DVMRPv3_$subType&#34;     
                     }
                  } else {
                     set subType [string range $rawFrame 105 106]
                     switch -- $subType \
                        &#34;01&#34; {
                           return &#34;IP_DVMRPv${<a name="::version(1)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_RESPONSE&#34;
                     }  &#34;02&#34; {
                           return &#34;IP_DVMRPv${<a name="::version(2)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_REQUEST&#34;
                     }  &#34;03&#34; {
                           return &#34;IP_DVMRPv${<a name="::version(3)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_NONMEMBER_REPORT&#34;
                     }  default   {
                           <a name="::result_debug(30)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;IP_DVMRPv${<a name="::version(4)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_$subType&#34;
                           return &#34;IP_DVMRPv${<a name="::version(5)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_$subType&#34;     
                     }
                  }                  
            }  &#34;16&#34;  { 
                  return &#34;IP_IGMPv2_REPORT&#34;
            }  &#34;17&#34;  { 
                  return &#34;IP_IGMPv2_LEAVE&#34;
            }  default  { 
                  <a name="::result_debug(31)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: IP_IGMP_$type&#34;
                  return &#34;IP_IGMP_$type&#34;
            }
               
         }  &#34;06&#34;  {
            set srcPort [<a name="::GetIPSourcePort(2)"><a href="./MessageDecoding.tcl.html#::GetIPSourcePort_573">::GetIPSourcePort</a></a> $rawFrame]
            set dstPort [<a name="::GetIPDestPort(2)"><a href="./MessageDecoding.tcl.html#::GetIPDestPort_604">::GetIPDestPort</a></a> $rawFrame]
            <span class="comment-line">#result_debug &#34;The srcPort $srcPort and dstPort $dstPort&#34;</span>
            if {$srcPort==&#34;179&#34;||$dstPort==&#34;179&#34;} {    ;<span class="comment-line"># Start port for BGP is 179</span>
               set bgpType [<a name="::GetIPTCPBGPType(1)"><a href="./MessageDecoding.tcl.html#::GetIPTCPBGPType_635">::GetIPTCPBGPType</a></a> $rawFrame ]
            } else {
               set bgpType &#34;&#34;
            }
            switch -- $bgpType \
               &#34;1&#34;  { 
                  return &#34;IP_BGPv4_OPEN&#34;
            }  &#34;2&#34;  { 
                  return &#34;IP_BGPv4_UPDATE&#34;
            }  &#34;3&#34;  { 
                  return &#34;IP_BGPv4_NOTIFICATION&#34;
            }  &#34;4&#34;  { 
                  return &#34;IP_BGPv4_KEEPALIVE&#34;
            }  default  {
               return &#34;IP_TCP&#34;            
            }
         }  &#34;11&#34;  {
               set portSource [<a name="::GetShortIntOffset(8)"><a href="./MessageDecoding.tcl.html#::GetShortIntOffset_832">::GetShortIntOffset</a></a> $rawFrame 102]
               set portDest [<a name="::GetShortIntOffset(9)"><a href="./MessageDecoding.tcl.html#::GetShortIntOffset_832">::GetShortIntOffset</a></a> $rawFrame 108]
               if { ($portSource == &#34;520&#34;) &amp;&amp; ($portDest == &#34;520&#34;) } {
                  set command [string range $rawFrame 126 127]
                  set version [<a name="::hextodec(22)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 129 130]]
                  switch -- $command \
                     &#34;01&#34;   {
                        return &#34;IP_RIPv${<a name="::version(6)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_REQUEST&#34;
                  }  &#34;02&#34;   {
                        return &#34;IP_RIPv${<a name="::version(7)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_REPLY&#34;
                  }  default   {
                        return &#34;IP_RIPv${<a name="::version(8)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_$command&#34;     
                  }
               } elseif { ($portSource == &#34;646&#34;) || ($portDest == &#34;646&#34;) } {
                  set command [string range $rawFrame 156 160]
                  switch -- $command \
                     &#34;00 01&#34;   {
                        return &#34;LDP Notification Message&#34;
                  }  &#34;01 00&#34;   {
                        return &#34;LDP Hello Message&#34;
                  }  &#34;02 00&#34;   {
                        return &#34;LDP Initialization Message&#34;
                  }  &#34;02 01&#34;   {
                        return &#34;LDP Keep Alive Message&#34;
                  }  &#34;03 00&#34;   {
                        return &#34;LDP Address Message&#34;
                  }  &#34;03 01&#34;   {
                        return &#34;LDP Address Withdraw Message&#34;
                  }  &#34;04 00&#34;   {
                        return &#34;LDP Label Mapping Message&#34;
                  }  &#34;04 01&#34;   {
                        return &#34;LDP Label Request Message&#34;
                  }  &#34;04 04&#34;   {
                        return &#34;LDP Label Abort request Message&#34;
                  }  &#34;04 02&#34;   {
                        return &#34;LDP Label Withdraw Message&#34;
                  }  &#34;04 03&#34;   {
                        return &#34;LDP Label Release Message&#34;
                  }  default   {
                        return &#34;LDP Message Type Not Known&#34;     
                  }
               } elseif {($portSource == &#34;3503&#34;) || ($portDest == &#34;3503&#34;)} {
                  set command [string range $rawFrame 138 139]
                  switch -- $command \
                     &#34;01&#34;   {
                        <a name="::result_debug(32)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;mpls echo request&#34;
                        return &#34;MPLS Echo Request&#34;
                  }  &#34;02&#34;   {
                        set returnCode [string range $rawFrame 144 145]
                        <a name="::result_debug(33)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;mpls echo reply&#34;
                        return &#34;MPLS Echo Reply&#34;
                  } 
               } else {
                  return &#34;IP_UDP&#34;
               }
         }  &#34;59&#34;  {
            set type [string range $rawFrame 105 106]
            set version [string range $rawFrame 103 103]
            switch -- $type \
               &#34;01&#34;  { 
                  return &#34;IP_OSPFv${<a name="::version(9)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_HELLO&#34;
            }  &#34;02&#34;  { 
                  return &#34;IP_OSPFv${<a name="::version(10)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_DATABASE&#34;
            }  &#34;03&#34;  { 
                  return &#34;IP_OSPFv${<a name="::version(11)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_LINK_REQUEST&#34;
            }  &#34;04&#34;  { 
                  return &#34;IP_OSPFv${<a name="::version(12)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_LINK_UPDATE&#34;
            }  &#34;05&#34;  { 
                  return &#34;IP_OSPFv${<a name="::version(13)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_LINK_ACK&#34;
            }  default  { 
                  <a name="::result_debug(34)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: IP_OSPFv${<a name="::version(14)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_$type&#34;
                  return &#34;IP_OSPFv${<a name="::version(15)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_$type&#34;
            }
         }  &#34;67&#34;  {
            set type [string range $rawFrame 103 103]
            set version [string range $rawFrame 102 102]
            switch -- $type \
               &#34;0&#34;  { 
                  return &#34;IP_PIMv${<a name="::version(16)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_HELLO&#34;
            }  &#34;1&#34;  { 
                  set nullReg [string range $rawFrame 114 114]
                  if {$nullReg==4} {
                     return &#34;IP_PIMv${<a name="::version(17)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_NULL_REGISTER&#34;                  
                  } else {
                     return &#34;IP_PIMv${<a name="::version(18)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_REGISTER&#34;
                  }
            }  &#34;2&#34;  { 
                  return &#34;IP_PIMv${<a name="::version(19)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_REGISTER_STOP&#34;
            }  &#34;3&#34;  { 
                  return &#34;IP_PIMv${<a name="::version(20)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_JOIN_PRUNE&#34;
            }  &#34;4&#34;  { 
                  return &#34;IP_PIMv${<a name="::version(21)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_BOOTSTRAP&#34;
            }  &#34;5&#34;  { 
                  return &#34;IP_PIMv${<a name="::version(22)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_ASSERT&#34;
            }  &#34;6&#34;  { 
                  return &#34;IP_PIMv${<a name="::version(23)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_GRAFT&#34;
            }  &#34;7&#34;  { 
                  return &#34;IP_PIMv${<a name="::version(24)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_GRAFT_ACK&#34;
            }  &#34;8&#34;  { 
                  return &#34;IP_PIMv${<a name="::version(25)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_CANDIDATE_RP_AD&#34;
            }  default  { 
                  <a name="::result_debug(35)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: IP_PIMv${<a name="::version(26)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_$type&#34;
                  return &#34;IP_PIMv${<a name="::version(27)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_$type&#34;
            }

         } &#34;70&#34; { <span class="comment-line">#VRRP packet</span>
             return &#34;VRRP_PACKET&#34;
         }  &#34;2E&#34; { 
            set ihL [string range $rawFrame 43 43]
            if {$ihL == &#34;5&#34; } {
               set parVal [string range $rawFrame 105 106]
            } elseif {$ihL == &#34;6&#34; } {
	       set parVal [string range $rawFrame 117 118]
            }
            switch $parVal {
               &#34;01&#34; {return &#34;RSVP Path Message&#34; }
               &#34;02&#34; {return &#34;RSVP Resv Message&#34; }
               &#34;03&#34; {return &#34;RSVP PathErr Message&#34; } 
               &#34;04&#34; {return &#34;RSVP ResvErr Message&#34; }
               &#34;05&#34; {return &#34;RSVP PathTear Message&#34; }
               &#34;06&#34; {return &#34;RSVP ResvTear Message&#34; }
               &#34;07&#34; {return &#34;RSVP ResvConf Message&#34; }
               &#34;0C&#34; {return &#34;RSVP Bundle Message&#34; }
               &#34;0D&#34; {return &#34;RSVP Ack Message&#34;}
               &#34;0F&#34; {return &#34;RSVP SRefresh Message&#34; } 
               &#34;14&#34; {
                     set cType [string range $rawFrame 135 136]
                     if {$cType == &#34;01&#34;} {
                        return &#34;RSVP Hello_Request Message&#34; 
                     } elseif {$cType == &#34;02&#34; } {
                        return &#34;RSVP Hello_Ack Message&#34;
                     }
                    }
               &#34;default&#34; {return &#34;Not a Valid RSVP Message $parVal $ihL&#34; }
            }
         } default  {
               <a name="::result_debug(36)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: IP_$IpType&#34;
               return &#34;IP_$IpType&#34;
         }
   }  &#34;08 06&#34; {
         set op [string range $rawFrame 60 64]
         switch -- $op \
            &#34;00 01&#34;  { 
               return &#34;ARP_REQUEST&#34;
         }  &#34;00 02&#34;  { 
               return &#34;ARP_REPLY&#34;
         }  &#34;00 03&#34;  { 
               return &#34;RARP_REQUEST&#34;
         }  &#34;00 04&#34;  { 
               return &#34;RARP_REPLY&#34;
         }  default  {
               <a name="::result_debug(37)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: ARP_$op&#34;
               return &#34;ARP_$op&#34;
         }
   }  &#34;88 8E&#34; { ;<span class="comment-line"># EAPOL Frame</span>
	 return [<a name="::DecodeEapolFrame(1)"><a href="./MessageDecoding.tcl.html#::DecodeEapolFrame_907">::DecodeEapolFrame</a></a> $rawFrame]
   }  &#34;00 26&#34; {
         <span class="comment-line">#EMISTP and DOT1D</span>
         set type [GetBPDUType $rawFrame]
         <a name="::result_debug(38)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;the type $type&#34;
         switch -- $type \
            &#34;00&#34;  { 
               return &#34;BPDU_CONFIG&#34;
         }  &#34;80&#34;  { 
               return &#34;BPDU_NOTIFICATION&#34;
         }  default  {
               <a name="::result_debug(39)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: BPDU_$type&#34;
               return &#34;BPDU_$type&#34;
         }
   }  &#34;00 27&#34; {
         <span class="comment-line">#DOT1W</span>
         set type [GetBPDUType $rawFrame]
         switch -- $type \
            &#34;02&#34;  {
               return &#34;BPDU_CONFIG_DOT1W&#34;
         }  &#34;80&#34;  { 
               return &#34;BPDU_NOTIFICATION_DOT1W&#34;
         }  default  {
               <a name="::result_debug(40)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: BPDU_$type&#34;
               return &#34;BPDU_$type&#34;
         }
   } &#34;00 69&#34; {
         <span class="comment-line">#DOT1S</span>
         set type [GetBPDUType $rawFrame]
         switch -- $type \
            &#34;02&#34;  {
               return &#34;BPDU_CONFIG_DOT1S&#34;
         }  &#34;80&#34;  {
               return &#34;BPDU_NOTIFICATION_DOT1S&#34;
         }  default  {
               <a name="::result_debug(41)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: BPDU_$type&#34;
               return &#34;BPDU_$type&#34;
         }
   }  &#34;00 32&#34; {
         <span class="comment-line"># PVST-PLUS</span>
         set type [GetBPDUType $rawFrame &#34;1&#34;]
         switch -- $type \
            &#34;00&#34;  { 
               return &#34;BPDU_CONFIG_PVST&#34;
         }  &#34;80&#34;  { 
               return &#34;BPDU_NOTIFICATION_PVST&#34;
         }  default  {
               <a name="::result_debug(42)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: BPDU_$type&#34;
               return &#34;BPDU_$type&#34;
         }         
   }  &#34;00 33&#34; {
         <span class="comment-line"># PVST-DOT1W</span>
         set type [GetBPDUType $rawFrame &#34;1&#34;]
         switch -- $type \
            &#34;00&#34;  { 
               return &#34;BPDU_CONFIG_PVST_DOT1W&#34;
         }   &#34;02&#34;  { 
               return &#34;BPDU_CONFIG_PVST_DOT1W&#34;
         }  &#34;80&#34;  { 
               return &#34;BPDU_NOTIFICATION_PVST_DOT1W&#34;
         }  default  {
               <a name="::result_debug(43)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: BPDU_$type&#34;
               return &#34;BPDU_$type&#34;
         }         
   } &#34;81 37&#34; {
      set op [string range $rawFrame 135 136]
      switch -- $op \
         &#34;01&#34;  {
            if {[string range $rawFrame 90 94] == &#34;04 53&#34;} {
               return &#34;ENETII_IPXRIP_REQUEST&#34;
            } elseif {[string range $rawFrame 90 94] == &#34;04 52&#34;} {
               return &#34;ENETII_IPXSAP_REQUEST&#34;
            } 
         } &#34;02&#34;  { 
            if {[string range $rawFrame 90 94] == &#34;04 53&#34;} {
               return &#34;ENETII_IPXRIP_REPLY&#34;
            } elseif {[string range $rawFrame 90 94] == &#34;04 52&#34;} {
               return &#34;ENETII_IPXSAP_REPLY&#34;
            }
         } &#34;04&#34; {
            if {[string range $rawFrame 90 94] == &#34;04 52&#34;} {
               return &#34;ENETII_IPXSAP_GNSREPLY&#34;
            }
         } default  {
            if {[string range $rawFrame 90 94] == &#34;04 53&#34;} {
                  return &#34;ENETII_IPXRIP&#34;
            } elseif {[string range $rawFrame 90 94] == &#34;04 52&#34;} {
               return &#34;ENETII_IPXSAP&#34;
            } else {
               <a name="::result_debug(44)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unkown ENETII Type: [string range $rawFrame 90 94]&#34;
               return &#34;FAIL&#34;
            }
         }
      } &#34;86 DD&#34; {
        set proto [string range $rawFrame 60 61]
        switch -- $proto \
           &#34;11&#34; {
                <a name="::result_debug(45)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;IPV6 - UDP Packet&#34;
                set srcPort [string range $rawFrame 162 166]
                set dstPort [string range $rawFrame 168 172]
                if { $srcPort == $dstPort &amp;&amp; $srcPort == &#34;02 09&#34; } {
                   <a name="::result_debug(46)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;RIPng packet&#34;
                   set cmd [string range $rawFrame 186 187]
                   if { $cmd == &#34;01&#34; } {
                       return &#34;RIPNG_REQUEST&#34;
                   } else {
                       return &#34;RIPNG_UPDATE&#34;
                   }
                }
        }
      } default {
         set ether_proto [string range $rawFrame 42 49]
         <span class="comment-line">#result_debug &#34;the ether_proto:|$ether_proto|&#34;</span>
         switch -regexp $ether_proto \
            &#34;E0 E0 03&#34; {
                set ripOrSap [string range $rawFrame 99 103]
                set reqOrRep [string range $rawFrame 144 145]
                if {($ripOrSap == &#34;04 53&#34;) &amp;&amp; ($reqOrRep == &#34;01&#34;)} {
                   return &#34;ENET8022_IPXRIP_REQUEST&#34;
                } elseif {($ripOrSap == &#34;04 53&#34;) &amp;&amp; ($reqOrRep == &#34;02&#34;)} {
                   return &#34;ENET8022_IPXRIP_REPLY&#34; 
                } elseif {($ripOrSap == &#34;04 52&#34;) &amp;&amp; ($reqOrRep == &#34;01&#34;)} {
                   return &#34;ENET8022_IPXSAP_REQUEST&#34;
                } elseif {($ripOrSap == &#34;04 52&#34;) &amp;&amp; ($reqOrRep == &#34;02&#34;)} {
                   return &#34;ENET8022_IPXSAP_REPLY&#34;
                } elseif {($ripOrSap == &#34;04 52&#34;) &amp;&amp; ($reqOrRep == &#34;04&#34;)} {
                   return &#34;ENET8022_IPXSAP_GNSREPLY&#34;
                } elseif {$ripOrSap == &#34;04 53&#34;} {
                   return &#34;ENET8022_IPXRIP&#34;
                } elseif {$ripOrSap == &#34;04 52&#34;} {
                   return &#34;ENET8022_IPXSAP&#34;
                } else {
                   <a name="::result_debug(47)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown ENET8022 Type: $ether_proto&#34;
                   return &#34;FAIL&#34;
                }
            } &#34;FF FF.*&#34; {
               ;<span class="comment-line"># No LLC for 802.3, IPX header(FFFF) directly after length</span>
               set ripOrSap [string range $rawFrame 90 94]
               set reqOrRep [string range $rawFrame 135 136]
               if {($ripOrSap == &#34;04 53&#34;) &amp;&amp; ($reqOrRep == &#34;01&#34;)} {
                  return &#34;ENET8023_IPXRIP_REQUEST&#34;
               } elseif {($ripOrSap == &#34;04 53&#34;) &amp;&amp; ($reqOrRep == &#34;02&#34;)} {
                  return &#34;ENET8023_IPXRIP_REPLY&#34; 
               } elseif {($ripOrSap == &#34;04 52&#34;) &amp;&amp; ($reqOrRep == &#34;02&#34;)} {
                  return &#34;ENET8023_IPXSAP_REPLY&#34;
               } elseif {($ripOrSap == &#34;04 52&#34;) &amp;&amp; ($reqOrRep == &#34;01&#34;)} {
                  return &#34;ENET8023_IPXSAP_REQUEST&#34;
               } elseif {($ripOrSap == &#34;04 52&#34;) &amp;&amp; ($reqOrRep == &#34;04&#34;)} {
                   return &#34;ENET8023_IPXSAP_GNSREPLY&#34;
               } elseif {$ripOrSap == &#34;04 53&#34;} {
                  return &#34;ENET8023_IPXRIP&#34;
               } elseif {$ripOrSap == &#34;04 52&#34;} {
                  return &#34;ENET8023_IPXSAP&#34;
               } else {
                  <a name="::result_debug(48)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown ENET8023 Type: $ether_proto&#34;
                  return &#34;FAIL&#34;
               }
            } &#34;AA AA 03&#34; {
             set ripOrSap [string range $rawFrame 114 118]
             set reqOrRep [string range $rawFrame 159 160]
	     set edp [string range $rawFrame 114 115]
	     <a name="::result_debug(49)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;EDP 114-115 was $edp&#34;
             if {($ripOrSap == &#34;04 53&#34;) &amp;&amp; ($reqOrRep == &#34;01&#34;)} {
                return &#34;ENETSNAP_IPXRIP_REQUEST&#34;
             } elseif {($ripOrSap == &#34;04 53&#34;) &amp;&amp; ($reqOrRep == &#34;02&#34;)} {
                return &#34;ENETSNAP_IPXRIP_REPLY&#34; 
             } elseif {($ripOrSap == &#34;04 52&#34;) &amp;&amp; ($reqOrRep == &#34;02&#34;)} {
                return &#34;ENETSNAP_IPXSAP_REPLY&#34;
             } elseif {($ripOrSap == &#34;04 52&#34;) &amp;&amp; ($reqOrRep == &#34;01&#34;)} {
                return &#34;ENETSNAP_IPXSAP_REQUEST&#34;
             } elseif {($ripOrSap == &#34;04 52&#34;) &amp;&amp; ($reqOrRep == &#34;04&#34;)} {
                return &#34;ENETSNAP_IPXSAP_GNSREPLY&#34;
             } elseif {$ripOrSap == &#34;04 53&#34;} {
                return &#34;ENETSNAP_IPXRIP&#34;
             } elseif {$ripOrSap == &#34;04 52&#34;} {
                return &#34;ENETSNAP_IPXSAP&#34;
             } elseif {$edp == &#34;99&#34;} {
		 return &#34;EDP&#34;
             } else {
                <a name="::result_debug(50)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown ENETSNAP Type: $ether_proto&#34;
                return &#34;FAIL&#34;
             }
         } default {
            <a name="::result_debug(51)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: $type&#34;
            <span class="comment-line">#just return the type</span>
            return $type
         }
   }
}

<span class="comment-line">################################################################# </span>
<span class="comment-line"># Procedure Name: GetMacCRC</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">##     This proc is used to get the hex value of MAC CRC</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: hex string</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetMacCRC rawFrame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetMacCRC_1462">proc <a href="MessageDecoding.tcl-annot.html#::::GetMacCRC">::::GetMacCRC</a></a></strong> {rawFrame} {
    set frameLength [string length $rawFrame]
    return [string range $rawFrame [expr $frameLength - 5] end ]
}

<span class="comment-line">################################################################# </span>
<span class="comment-line"># Procedure Name: GetIPHeaderChecksum</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the 2 byte hex checksum from an ip packet header</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: hex string or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetIPHeaderChecksum rawFrame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetIPHeaderChecksum_1483">proc <a href="MessageDecoding.tcl-annot.html#::::GetIPHeaderChecksum">::::GetIPHeaderChecksum</a></a></strong> {rawFrame} {
set type [string range $rawFrame 36 40]
   switch $type {
      &#34;08 00&#34; { return [string range $rawFrame 72 76] }
      &#34;81 00&#34; { return [string range $rawFrame 84 88] }    ;<span class="comment-line">#tagged frame</span>
      default {
          <a name="::result_debug(52)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: $type (not IP packet)&#34;
          return -1
      }
   }
}

<span class="comment-line">################################################################# </span>
<span class="comment-line"># Procedure Name: CheckTTLExpired</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to check if the ttl is expired in ip header</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: 1 on success or 0 on failure</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># CheckTTLExpired rawFrame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::CheckTTLExpired_1511">proc <a href="MessageDecoding.tcl-annot.html#::::CheckTTLExpired">::::CheckTTLExpired</a></a></strong> { rawFrame } {
   set arrayframe [split $rawFrame];
   if { ([lindex $arrayframe 23] == &#34;01&#34;) &amp;&amp; ([lindex $arrayframe 34] == &#34;03&#34;) } {
       return 1;               
   } elseif { ([lindex $arrayframe 23] == &#34;01&#34;) &amp;&amp; ([lindex $arrayframe 34] == &#34;0B&#34;) } {
       return 1;     
   } else {
       return 0;    
   }
}

<span class="comment-line">################################################################# </span>
<span class="comment-line"># Procedure Name: GetVrrpPacketType</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the VRRP packet type</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: packet type</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># set packetType [GetVrrpPacketType $rawFrame]</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                        </span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetVrrpPacketType_1538">proc <a href="MessageDecoding.tcl-annot.html#::::GetVrrpPacketType">::::GetVrrpPacketType</a></a></strong> { rawFrame } {
     set packetType [<a name="::hextodec(23)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string index $rawFrame 103]]
     return $packetType
}

<span class="comment-line">################################################################# </span>
<span class="comment-line"># Procedure Name: GetVrrpId</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the VRRP ID</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: VRID</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># set packetType [GetVrrpId $rawFrame]</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                        </span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetVrrpId_1559">proc <a href="MessageDecoding.tcl-annot.html#::::GetVrrpId">::::GetVrrpId</a></a></strong> { rawFrame } {
     set vrid [<a name="::hextodec(24)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 105 106]]
     return $vrid
}

<span class="comment-line">################################################################# </span>
<span class="comment-line"># Procedure Name: GetVrrpIpAddress</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the virtual IP address from VRRP packet</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: VRID</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># set packetType [GetVrrpId $rawFrame]</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                        </span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetVrrpIpAddress_1580">proc <a href="MessageDecoding.tcl-annot.html#::::GetVrrpIpAddress">::::GetVrrpIpAddress</a></a></strong> { rawFrame } {
   set offsetStart 126
   set offsetEnd [expr $offsetStart + 11]
   set IP [string range $rawFrame $offsetStart $offsetEnd]
   return [<a name="::byte2IpAddr(2)"><a href="./ePTUtils.tcl.html#::byte2IpAddr_166">::byte2IpAddr</a></a> $IP]
}

<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name: CheckMoreFragBit</span>
<span class="comment-line">#</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to check the fragmentation flags for both  tagged/untagged IP packet</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: 1 on pass or 0 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#     set prevPktFragFlag [CheckMoreFragBit $dataFrame]</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::CheckMoreFragBit_1603">proc <a href="MessageDecoding.tcl-annot.html#::::CheckMoreFragBit">::::CheckMoreFragBit</a></a></strong> {rawFrame} {
     set type [string range $rawFrame 36 40]
     switch -- $type \
       &#34;81 00&#34; {
          set flags [string range $rawFrame 72 72]
	  if { ($flags == &#34;2&#34;) || ($flags == &#34;3&#34;) || \
             ($flags == &#34;6&#34;) || ($flags == &#34;7&#34;) }   {
            return 1
          } else {
            return 0
          }
       } &#34;08 00&#34; {
          set flags [string range $rawFrame 60 60]
	  if { ($flags == &#34;2&#34;) || ($flags == &#34;3&#34;) || \
             ($flags == &#34;6&#34;) || ($flags == &#34;7&#34;) }   {
            return 1
          } else {
            return 0
          }
       } default {
           <a name="::result_debug(53)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: $type&#34;
           return 0
       }
}
</pre>
<hr>
<div class="index-selector">
	<a href="index_main.html#byfilename">file name</a> 
 | 
	<a href="index_main.html#byprocname">procedure name</a> 
 | 
	<a href="index_main.html#bycall">procedure call</a> 
 | 
	<a href="index_annot_full.html">annotation</a> 

<br>
<cite>File generated 2018-06-14 at 17:09.</cite>
</div>

</body>
</html>
