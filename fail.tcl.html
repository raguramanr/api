<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/transitional.dtd">
<!-- Generated by TclDoc @@VERSION@@ -->
<html>
<head>
  <title>fail.tcl</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="default.css">
</head>
<body class="src-html">
<div class="index-selector">
<!-- index for tcl source files -->
	Index by: 
	<a href="index_main.html#fail.tcl">file name</a> | 
	<a href="index_main.html#byprocname">procedure name</a> | 
	<a href="index_main.html#bycall">procedure call</a> | 
	<a href="index_annot_full.html">annotation</a>

</div>
<hr>

<p><strong>fail.tcl</strong>&nbsp;&nbsp;<span class="filetype-link">(<a href="fail.tcl-annot.html">annotations</a> | <a href="fail.tcl.txt">original source</a>)</span>
</p>
<pre class="src-code">


<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: do_text_fail</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line"># Reads in report and prints it in human-readable form to out.</span>
<span class="comment-line">#     </span>
<span class="comment-line">#     </span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: fd, test, data, res, cTest, sum</span>
<span class="comment-line"># Output args: l</span>
<span class="comment-line"># return value: none</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#     do_text_fail $fd $t $d $r $cTest level $sum</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::do_text_fail_21">proc <a href="fail.tcl-annot.html#::::do_text_fail">::::do_text_fail</a></a></strong> {fd test data res cTest l sum} {
	upvar $l level
        global tcl_platform
        global failList
        global tCount
    
<span class="comment-line">#puts &#34;@@@@@ test=$test&#34;</span>
<span class="comment-line">#puts &#34;@@@@@ res=$res&#34;</span>
<span class="comment-line">#puts &#34;@@@@@ count=$tCount&#34;</span>
<span class="comment-line">#puts &#34;@@@@@ level=$level,  l=$l\n&#34;</span>
<span class="comment-line">#puts &#34;@@@@@ data=$data&#34;</span>

 if {($res == &#34;0&#34;)} {
   if {$tCount == 0} {
       lappend failList $cTest
       <span class="comment-line">#puts &#34; #@#@#@#@#@@##@##@#@#@ added base test to fail list&#34;</span>
       incr tCount 1
       <span class="comment-line">#puts &#34; new count = $tCount&#34;</span>
   }
   if { $tCount == 1 } {
          puts $fd &#34;Failed on Test $cTest&#34;
          puts $sum &#34;Failed on Test $cTest&#34;
         <span class="comment-line"># puts &#34;@#@#@#@#@#@#@#@#@#@# just printed test failed&#34;</span>
          incr tCount 1
         <span class="comment-line"># puts &#34;new count = $tCount&#34;</span>
             }


    if {[llength $data] &gt; 0} {
		set dores 0
	} else {
		set dores 1
	}

	for {set i 0} {$i &lt; $level} {incr i} {
		puts -nonewline $fd &#34;  &#34;
                puts -nonewline $sum &#34;  &#34;
	}
	set pos [expr {$level * 2}]
<span class="comment-line">#split the line out to make it more readable</span>
   set splitFlag &#34;false&#34;
   if {$dores} {
      while {[expr [string length $test] + $pos] &gt; 70 } {
      	for {set len 65} {$len &gt; 10} {incr len -1 } {         
            set char [string range $test $len $len]
            if {$char == &#34; &#34;} { break }
         }
         if {$len &lt; 15} {set len 65}
         puts $fd [string range $test 0 $len]
         puts $sum [string range $test 0 $len]
         set test [string range $test [expr $len + 1] end]
         for {set i 0} {$i &lt; $level} {incr i} {
      		puts -nonewline $fd &#34;  &#34;
                puts -nonewline $sum &#34;  &#34;
   	   }
      	puts -nonewline $fd &#34;    &#34;
        puts -nonewline $sum &#34;    &#34;
   	   set splitFlag &#34;true&#34;
      }
   if {$splitFlag == &#34;true&#34;} {incr pos 4}
   }
   
	puts -nonewline $fd $test
        puts -nonewline $sum $test
	incr pos [string length $test]
	
	set i [expr {78 - $pos - 8}]
	while {$i &gt; 0} {
		puts -nonewline $fd &#34; &#34;
                puts -nonewline $sum &#34; &#34;
		incr i -1
	}

	if {$dores} {
		if { ($fd == &#34;stdout&#34;) &amp;&amp; ($tcl_platform(platform) == &#34;unix&#34;) } {
			if {$res} {
				puts $fd &#34;\[\033\[1;32m  OK  \033\[0m\]&#34;
			} else {
				puts $fd &#34;\[\033\[1;31mFAILED\033\[0m\]&#34;
			}
		} else {
			if {$res} {
				puts $fd &#34;\[  OK  \]&#34;
                                puts $sum &#34;\[  OK  \]&#34;
			} else {
				puts $fd &#34;\[FAILED\]&#34;
                                puts $sum &#34;\[FAILED\]&#34;
			}
		}
	} else {
		puts $fd &#34;&#34;
                puts $sum &#34;&#34;

	}
 }
        

	incr level 1
	foreach {t d r} $data {
                <a name="::do_text_fail(1)"><a href="./fail.tcl.html#::do_text_fail_21">::do_text_fail</a></a> $fd $t $d $r $cTest level $sum
	}
	incr level -1
}
<span class="comment-line">###################################################################################</span>

</pre>
<hr>
<div class="index-selector">
	<a href="index_main.html#byfilename">file name</a> 
 | 
	<a href="index_main.html#byprocname">procedure name</a> 
 | 
	<a href="index_main.html#bycall">procedure call</a> 
 | 
	<a href="index_annot_full.html">annotation</a> 

<br>
<cite>File generated 2018-06-14 at 17:09.</cite>
</div>

</body>
</html>
