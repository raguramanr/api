<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/transitional.dtd">
<!-- Generated by TclDoc @@VERSION@@ -->
<html>
<head>
  <title>snmpESRPLib.tcl</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="default.css">
</head>
<body class="src-html">
<div class="index-selector">
<!-- index for tcl source files -->
	Index by: 
	<a href="index_main.html#snmpESRPLib.tcl">file name</a> | 
	<a href="index_main.html#byprocname">procedure name</a> | 
	<a href="index_main.html#bycall">procedure call</a> | 
	<a href="index_annot_full.html">annotation</a>

</div>
<hr>

<p><strong>snmpESRPLib.tcl</strong>&nbsp;&nbsp;<span class="filetype-link">(<a href="snmpESRPLib.tcl-annot.html">annotations</a> | <a href="snmpESRPLib.tcl.txt">original source</a>)</span>
</p>
<pre class="src-code">

<span class="comment-line">#################################################################</span>
<span class="comment-line">#  Procedure Name: snmpConvertStrToOid</span>
<span class="comment-line">#  </span>
<span class="comment-line">#  Description:</span>
<span class="comment-line">#    This procedure converts the given string to SNMP OID format</span>
<span class="comment-line">#      (VLAN1  is converted to 5.86.76.65.78.49)</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Input Variables:</span>
<span class="comment-line">#    str  - String for which the corresponding OID to be found out</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Optional Args:</span>
<span class="comment-line">#    None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Output Variables: </span>
<span class="comment-line">#     None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Variables:</span>
<span class="comment-line">#     SNMP OID </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Possible Usage:</span>
<span class="comment-line">#     snmpConvertStrToOid &#34;VLAN1&#34;</span>
<span class="comment-line">################################################################</span>
<strong><a name="::::snmpConvertStrToOid_24">proc <a href="snmpESRPLib.tcl-annot.html#::::snmpConvertStrToOid">::::snmpConvertStrToOid</a></a></strong> {str} {
  set res [split $str &#34;&#34;]
  lappend oid &#34;[string length $str].&#34;
  foreach char $res {
     lappend oid &#34;[scan $char %c].&#34;
  }
  return &#34;[string trim $oid &#34;.&#34;]&#34;

}

<span class="comment-line">#################################################################</span>
<span class="comment-line">#  Procedure Name: snmpConvertIpAddrFormat</span>
<span class="comment-line">#  </span>
<span class="comment-line">#  Description:</span>
<span class="comment-line">#    This procedure converts the given IP address in dotted </span>
<span class="comment-line">#    notation to SNMP compatible format.</span>
<span class="comment-line">#      (10.10.0.1  is converted to &#34;a a 0 1&#34;</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Input Variables:</span>
<span class="comment-line">#    ipaddr  - IP address in the dotted notation</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Optional Args:</span>
<span class="comment-line">#    None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Output Variables: </span>
<span class="comment-line">#     None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Variables:</span>
<span class="comment-line">#     Formatted IP address</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Possible Usage:</span>
<span class="comment-line">#     snmpConvertIpAddrFormat &#34;10.10.0.1&#34;</span>
<span class="comment-line">################################################################</span>
<strong><a name="::::snmpConvertIpAddrFormat_57">proc <a href="snmpESRPLib.tcl-annot.html#::::snmpConvertIpAddrFormat">::::snmpConvertIpAddrFormat</a></a></strong> {ipaddr} {
   regexp {([0-9]+)\.([0-9]+)\.([0-9]+)\.([0-9]+)} $ipaddr r(0) r(1) r(2) r(3) r(4)
   foreach i { 1 2 3 4 } {
      set r($i) [<a name="::dectohex(1)"><a href="./ePTUtils.tcl.html#::dectohex_470">::dectohex</a></a> $r($i)]
      if { [string length $r($i)] == 1 } {
         set r($i) &#34;0$r($i)&#34;
      }
   } 
   return [string toupper &#34;$r(1) $r(2) $r(3) $r(4)&#34;]
}


<span class="comment-line">####################################################################</span>
<span class="comment-line">#  Procedure Name: snmpMacToEdpNeighbourId</span>
<span class="comment-line">#  </span>
<span class="comment-line">#  Description:</span>
<span class="comment-line">#    This procedure converts the given MAC address to EDP </span>
<span class="comment-line">#    neighbour ID </span>
<span class="comment-line">#     (0A:1A:1A:FE:DF:AA is converted to &#34;0.0.10.26.26.254.223.170&#34;</span>
<span class="comment-line">#     Two zeros are prepended to the converted MAC address.</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Input Variables:</span>
<span class="comment-line">#    mac - MAC address</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Optional Args:</span>
<span class="comment-line">#    None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Output Variables: </span>
<span class="comment-line">#     None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Variables:</span>
<span class="comment-line">#     Formatted EDP neighbour ID</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Possible Usage:</span>
<span class="comment-line">#     snmpMacToEdpNeighbourId &#34;0A:1A:1A:FE:DF:AA&#34;</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::snmpMacToEdpNeighbourId_93">proc <a href="snmpESRPLib.tcl-annot.html#::::snmpMacToEdpNeighbourId">::::snmpMacToEdpNeighbourId</a></a></strong> {mac} {

   regexp -nocase {([0-9|A-F]+):([0-9|A-F]+):([0-9|A-F]+):([0-9|A-F]+):([0-9|A-F]+):([0-9|A-F]+)} $mac r(0) r(1) r(2) r(3) r(4) r(5) r(6)
   foreach i { 1 2 3 4 5 6 } {
      set r($i) [<a name="::hextodec(1)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> $r($i)]
   }
 
   <span class="comment-line"># --- Prepend two zeros to the converted MAC address</span>
   return &#34;0.0.$r(1).$r(2).$r(3).$r(4).$r(5).$r(6)&#34;
}

<span class="comment-line">####################################################################</span>
<span class="comment-line">#  Procedure Name: snmpMacToEsrpNeighbourId</span>
<span class="comment-line">#  </span>
<span class="comment-line">#  Description:</span>
<span class="comment-line">#    This procedure converts the given MAC address to ESRP</span>
<span class="comment-line">#    neighbour ID </span>
<span class="comment-line">#     (0A:1A:1A:FE:DF:AA is converted to &#34;10.26.26.254.223.170&#34;</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Input Variables:</span>
<span class="comment-line">#    mac - MAC address</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Optional Args:</span>
<span class="comment-line">#    None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Output Variables: </span>
<span class="comment-line">#     None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Variables:</span>
<span class="comment-line">#     Formatted ESRP neighbour ID</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Possible Usage:</span>
<span class="comment-line">#     snmpMacToEsrpNeighbourId &#34;0A:1A:1A:FE:DF:AA&#34;</span>
<span class="comment-line">##################################################################</span>

<strong><a name="::::snmpMacToEsrpNeighbourId_128">proc <a href="snmpESRPLib.tcl-annot.html#::::snmpMacToEsrpNeighbourId">::::snmpMacToEsrpNeighbourId</a></a></strong> {mac} {
   regexp -nocase {([0-9|A-F]+):([0-9|A-F]+):([0-9|A-F]+):([0-9|A-F]+):([0-9|A-F]+):([0-9|A-F]+)} $mac r(0) r(1) r(2) r(3) r(4) r(5) r(6)

   foreach i { 1 2 3 4 5 6 } {
      set r($i) [<a name="::hextodec(2)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> $r($i)]
   }

   return &#34;$r(1).$r(2).$r(3).$r(4).$r(5).$r(6)&#34;
}

<span class="comment-line">########################################################################</span>
<span class="comment-line">#  Procedure Name: snmpGetEsrpTransitions</span>
<span class="comment-line">#  </span>
<span class="comment-line">#  Description:</span>
<span class="comment-line">#    This procedures gets the no.of ESRP transitions to MASTER or SLAVE</span>
<span class="comment-line">#    state </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Input Variables:</span>
<span class="comment-line">#    session     - Session identifier which identifies the connection </span>
<span class="comment-line">#                  with the DUT</span>
<span class="comment-line">#    group       - ESRP group value</span>
<span class="comment-line">#    vlanid      - VLAN identifier to retrieve the ESRP table for a VLAN </span>
<span class="comment-line">#    state       - Transitions to Master or Slave. Possible values are</span>
<span class="comment-line">#                  &#34;master&#34; or &#34;slave&#34;</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Optional Args:</span>
<span class="comment-line">#    fd         - File descriptor for logging the debug statements</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Output Variables: </span>
<span class="comment-line">#     None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Variables:</span>
<span class="comment-line">#    0       - On failure </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Possible Usage:</span>
<span class="comment-line">#    snmpGetEsrpTransitions -session $sessionid -vlanid $vlan_id \</span>
<span class="comment-line">#                       -state &#34;slave&#34; -fd $fd_res</span>
<span class="comment-line">#######################################################################</span>

<strong><a name="::::snmpGetEsrpTransitions_167">proc <a href="snmpESRPLib.tcl-annot.html#::::snmpGetEsrpTransitions">::::snmpGetEsrpTransitions</a></a></strong> {args} {
   <a name="::parse_args(1)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> snmpGetEsrpTransitions $args {
      session &#34;&#34;
      state &#34;&#34;
      vlanid &#34;&#34;
      group &#34;1&#34;
      fd &#34;NULL&#34;
   }

   set func &#34;snmpGetEsrpTransitions:&#34;

   if { $vlanid == &#34;&#34; || $session == &#34;&#34;} {
       error &#34;$func vlan id and session must be specified&#34;
       return 0
   }

   set state [string tolower $state]
   if { !([string compare $state &#34;master&#34;] == 0 ||
          [string compare $state &#34;slave&#34;] == 0) } {
       error &#34;$func possible value for state is master or slave&#34;
       return 0
   }

   <a name="::snmpDebug(1)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func state-$state vlanid-$vlanid group-$group -Start&#34; $fd

   <a name="::result_debug(1)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\n-- Checking ESRP table for number of transitions of \
                      the VLAN $vlanid --&#34;

   if { $state == &#34;master&#34; } {
      set request &#34;extremeEsrpNumTransitionsToMaster.$vlanid.$group&#34;
   } else {
      set request &#34;extremeEsrpNumTransitionsToSlave.$vlanid.$group&#34;
   }

   set result [snmpGet -session $session -oid $request]
   <a name="::snmpDebug(2)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet for ESRP transition is $result&#34; $fd

   set noTrans [<a name="::snmpUtilGetVal(1)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]

   <a name="::snmpDebug(3)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func ESRP transition to $state for VLAN $vlanid is \
                  $noTrans&#34; $fd
   
   <a name="::snmpDebug(4)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - End&#34; $fd
   return $noTrans
}


<span class="comment-line">########################################################################</span>
<span class="comment-line">#  Procedure Name: snmpCheckEsrpTable</span>
<span class="comment-line">#  </span>
<span class="comment-line">#  Description:</span>
<span class="comment-line">#    This procedures checks the SNMP ESRP table (extremeEsrpTable) </span>
<span class="comment-line">#    for the existence of given ESRP table parameters.</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Input Variables:</span>
<span class="comment-line">#    session     - Session identifier which identifies the connection </span>
<span class="comment-line">#                  with the DUT</span>
<span class="comment-line">#    vlanid      - VLAN identifier to retrieve the ESRP table for a VLAN </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Optional Args:</span>
<span class="comment-line">#    status     - Status of the ESRP table entry (active or not exist)</span>
<span class="comment-line">#    group      - ESRP group value</span>
<span class="comment-line">#    ports      - No. of active ports in this ESRP enabled VLAN</span>
<span class="comment-line">#    trackports - No. of tracked ports in this VLAN</span>
<span class="comment-line">#    trackroute - No. of IP routes tracked by this VLAN</span>
<span class="comment-line">#    trackping  - No. of pings to a destination address, tracked by this</span>
<span class="comment-line">#                 VLAN</span>
<span class="comment-line">#    state      - ESRP state (master / slave / neutral )</span>
<span class="comment-line">#    timer      - ESRP hello timer value</span>
<span class="comment-line">#    priority   - ESRP priority for this VLAN</span>
<span class="comment-line">#    intports   - No. of active internal ports in the ESRP neighbour</span>
<span class="comment-line">#    ipaddr     - IP address assigned to this VLAN</span>
<span class="comment-line">#    algorithm  - ESRP election algorithm configured for this VLAN</span>
<span class="comment-line">#                 Possible values are</span>
<span class="comment-line">#                    * ports-track-priority-mac</span>
<span class="comment-line">#                    * track-ports-priority-mac</span>
<span class="comment-line">#                    * priority-ports-track-mac</span>
<span class="comment-line">#                    * priority-track-ports-mac</span>
<span class="comment-line">#                    * priority-mac-only</span>
<span class="comment-line">#    tomaster   - Number of ESRP state transitions to master</span>
<span class="comment-line">#    toslave    - Number of ESRP state transitions to slave</span>
<span class="comment-line">#    fd         - File descriptor for logging the debug statements</span>
<span class="comment-line">#    comment    - Comment to be logged in the log file    </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Output Variables: </span>
<span class="comment-line">#     None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Variables:</span>
<span class="comment-line">#    0       - On failure </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Possible Usage:</span>
<span class="comment-line">#    snmpCheckEsrpTable -session $sessionid -vlanid $vlan_id \</span>
<span class="comment-line">#                       -ipaddr 10.0.0.5 -ports 2 \</span>
<span class="comment-line">#                       -trackping 10 -state &#34;master&#34; -fd $fd_res</span>
<span class="comment-line">#######################################################################</span>

<strong><a name="::::snmpCheckEsrpTable_263">proc <a href="snmpESRPLib.tcl-annot.html#::::snmpCheckEsrpTable">::::snmpCheckEsrpTable</a></a></strong> {args} {
   <a name="::parse_args(2)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> snmpCheckEsrpTable $args {
      session &#34;&#34;
      status &#34;enabled&#34;
      vlanid &#34;&#34;
      group &#34;1&#34;
      ports &#34;&#34;
      trackports &#34;&#34;
      trackroute &#34;&#34;
      trackping &#34;&#34;
      state &#34;&#34;
      timer &#34;&#34;
      priority &#34;&#34;
      ipaddr &#34;&#34;
      algorithm &#34;&#34;
      tomaster &#34;&#34;
      toslave &#34;&#34;
      intports &#34;&#34;
      comment &#34;snmpCheckEsrpTable&#34;
      fd &#34;NULL&#34;
   }

   set func &#34;snmpCheckEsrpTable:&#34;

   if { $vlanid == &#34;&#34; || $session == &#34;&#34;} {
       error &#34;$func vlan id and session must be specified&#34;
       return 0
   }

   <a name="::snmpDebug(5)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func status-$status vlanid-$vlanid group-$group \
                    -Start&#34; $fd

   <a name="::result_debug(2)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\n-- Checking ESRP table for the VLAN $vlanid --&#34;

   <a name="::report_start_test(1)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;$comment&#34;

   set result [snmpGet -session $session \
                       -oid extremeEsrpRowStatus.$vlanid.$group]
   <a name="::snmpDebug(6)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet for row status is $result&#34; $fd

   set retStatus [<a name="::snmpUtilGetVal(2)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> inttext $result]

   <a name="::snmpDebug(7)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func ESRP status for VLAN $vlanid is $retStatus&#34; $fd
  
   if { $status == &#34;enabled&#34; } {
      set needVal &#34;active&#34;
   } else {
      set needVal &#34;notexist&#34;
   }

   if { $retStatus == &#34;&#34; } {
      set retStatus &#34;notexist&#34;
   }

   <a name="::snmpDebug(8)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func Given ESRP status is $status, got $retStatus&#34; $fd

   if { $retStatus == $needVal } {
      <a name="::result_ok(1)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;ESRP status is $retStatus. Wanted $needVal. PASS&#34;     
   } else {
      <a name="::result_error(1)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;ESRP status is $retStatus. Wanted $needVal. FAIL&#34;     
   }  

   <span class="comment-line"># --- Check the ESRP hello timer value</span>
   if {$timer != &#34;&#34; } {
      set result [snmpGet -session $session \
                       -oid extremeEsrpHelloTimer.$vlanid.$group]
      <a name="::snmpDebug(9)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func snmpGet - $result&#34; $fd
 
      set retVal [<a name="::snmpUtilGetVal(3)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(10)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func ESRP hello timer for VLAN $vlanid is $retVal&#34; $fd
      if { $retVal == $timer } {
          <a name="::result_ok(2)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;ESRP hello timer value $retVal, expected $timer. PASS&#34;
      } else {
          <a name="::result_error(2)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;ESRP hello timer value $retVal, expected $timer. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the ESRP states</span>
   if { $state != &#34;&#34; } {
      set result [snmpGet -session $session \
                       -oid extremeEsrpState.$vlanid.$group]
      <a name="::snmpDebug(11)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func snmpGet - $result&#34; $fd

      set retVal [<a name="::snmpUtilGetVal(4)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> inttext $result]
      <a name="::snmpDebug(12)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func ESRP state for VLAN $vlanid is $retVal&#34; $fd
      if { [regexp -nocase $retVal $state] } {
          <a name="::result_ok(3)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;ESRP state is $retVal, expected $state. PASS&#34;
      } else {
          <a name="::result_error(3)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;ESRP state is $retVal, expected $state. FAIL&#34;
      }

   }

   <span class="comment-line"># --- Check the ESRP election algorithm</span>
   if { $algorithm != &#34;&#34; } {
      set result [snmpGet -session $session \
                       -oid extremeEsrpElectionAlgorithm.$vlanid.$group]
      <a name="::snmpDebug(13)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func snmpGet - $result&#34; $fd

      set retVal [<a name="::snmpUtilGetVal(5)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> inttext $result]
      <a name="::snmpDebug(14)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func ESRP master election algorithm for VLAN \
                     $vlanid is $retVal&#34; $fd
      if { [string compare [string tolower $retVal] \
                           [string tolower $algorithm]] == 0 } {
          <a name="::result_ok(4)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;ESRP master election algorithm is $retVal, \
                     expected $algorithm. PASS&#34;
      } else {
          <a name="::result_error(4)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;ESRP master election algorithm is $retVal, \
                        expected $algorithm. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the ESRP enabled active ports</span>
   if { $ports != &#34;&#34; } {
      set result [snmpGet -session $session \
                       -oid extremeEsrpActivePorts.$vlanid.$group]
      <a name="::snmpDebug(15)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func snmpGet - $result&#34; $fd

      set retVal [<a name="::snmpUtilGetVal(6)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(16)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func number of active ports in ESRP for VLAN \
                     $vlanid is $retVal&#34; $fd
      if { $ports == $retVal } {
          <a name="::result_ok(5)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;No.of active ports is $retVal, expected $ports. PASS&#34;
      } else {
          <a name="::result_error(5)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;No.of active ports is $retVal, expected $ports. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the ESRP priority</span>
   if { $priority != &#34;&#34; } {
      set result [snmpGet -session $session \
                       -oid extremeEsrpPriority.$vlanid.$group]
      <a name="::snmpDebug(17)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func snmpGet - $result&#34; $fd

      set retVal [<a name="::snmpUtilGetVal(7)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(18)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func ESRP priority for VLAN $vlanid is $retVal&#34; $fd
      if { $priority == $retVal } {
          <a name="::result_ok(6)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;ESRP priority is $retVal, expected $priority. PASS&#34;
      } else {
          <a name="::result_error(6)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;ESRP priority is $retVal, expected $priority. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check no.of ports tracked by this vlan</span>
   if { $trackports != &#34;&#34; } {
      set result [snmpGet -session $session \
                       -oid extremeEsrpTrackedActivePorts.$vlanid.$group]
      <a name="::snmpDebug(19)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet - $result&#34; $fd

      set retVal [<a name="::snmpUtilGetVal(8)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(20)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func number of tracked active ports for VLAN \
                     $vlanid is $retVal&#34; $fd
      if { $trackports == $retVal } {
          <a name="::result_ok(7)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;No.of tracked active ports is $retVal, \
                     expected $trackports. PASS&#34;
      } else {
          <a name="::result_error(7)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;No.of tracked active ports is $retVal, \
                        expected $trackports. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check no.of IP routes tracked by this vlan</span>
   if { $trackroute != &#34;&#34; } {
      set result [snmpGet -session $session \
                       -oid extremeEsrpTrackedIpRoutes.$vlanid.$group]
      <a name="::snmpDebug(21)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet - $result&#34; $fd

      set retVal [<a name="::snmpUtilGetVal(9)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(22)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func number of tracked IP routes for VLAN \
                     $vlanid is $retVal&#34; $fd
      if { $trackroute == $retVal } {
          <a name="::result_ok(8)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;No.of tracked IP route is $retVal, expected \
                     $trackroute. PASS&#34;
      } else {
          <a name="::result_error(8)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;No.of tracked IP route is $retVal, \
                        expected $trackroute. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check no.of pings to destination, tracked by this vlan</span>
   if { $trackping != &#34;&#34; } {
      set result [snmpGet -session $session \
                       -oid extremeEsrpTrackedPings.$vlanid.$group]
      <a name="::snmpDebug(23)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet - $result&#34; $fd

      set retVal [<a name="::snmpUtilGetVal(10)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(24)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func number of tracked pings for VLAN \
                     $vlanid is $retVal&#34; $fd
      if { $trackping == $retVal } {
          <a name="::result_ok(9)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;No.of tracked ping is $retVal, \
                     expected $trackping. PASS&#34;
      } else {
          <a name="::result_error(9)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;No.of tracked ping is $retVal, expected \
                        $trackping. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check no.of ESRP state transitions as master</span>
   if { $tomaster != &#34;&#34; } {
      set result [snmpGet -session $session \
                       -oid extremeEsrpNumTransitionsToMaster.$vlanid.$group]
      <a name="::snmpDebug(25)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet - $result&#34; $fd

      set retVal [<a name="::snmpUtilGetVal(11)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(26)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func number of ESRP state transition to \
                      master is $retVal&#34; $fd
      if { $tomaster == $retVal } {
          <a name="::result_ok(10)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;No.of ESRP state transition to MASTER is $retVal, \
                     expected $tomaster. PASS&#34;
      } else {
          <a name="::result_error(10)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;No.of ESRP state transition to MASTER is \
                        $retVal, expected $tomaster. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check no.of ESRP state transitions as slave</span>
   if { $toslave != &#34;&#34; } {
      set result [snmpGet -session $session \
                       -oid extremeEsrpNumTransitionsToSlave.$vlanid.$group]
      <a name="::snmpDebug(27)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet - $result&#34; $fd

      set retVal [<a name="::snmpUtilGetVal(12)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(28)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func number of ESRP state transition to SLAVE is \
                     $retVal&#34; $fd
      if { $toslave == $retVal } {
          <a name="::result_ok(11)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;No.of ESRP state transition to SLAVE is $retVal, \
                     expected $toslave. PASS&#34;
      } else {
          <a name="::result_error(11)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;No.of ESRP state transition to master is \
                        $retVal, expected $toslave. FAIL&#34;
      }
   }



   <span class="comment-line"># --- Check IP address configured for this vlan</span>
   if { $ipaddr != &#34;&#34; } {
     
      <span class="comment-line"># ---- Convert the given IP address to SNMP output format</span>
      <span class="comment-line">#      30.0.0.1 --&gt; 1E 00 00 01</span>
      set cookedIpAddr [<a name="::snmpConvertIpAddrFormat(1)"><a href="./snmpESRPLib.tcl.html#::snmpConvertIpAddrFormat_57">::snmpConvertIpAddrFormat</a></a> $ipaddr]  
      <a name="::snmpDebug(29)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func given IP address is $ipaddr, cooked is \
                     $cookedIpAddr&#34; $fd
      
      set result [snmpGet -session $session \
                       -oid extremeEsrpNetAddress.$vlanid.$group]
      <a name="::snmpDebug(30)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func snmpGet - $result&#34; $fd
      set retVal [<a name="::snmpUtilGetVal(13)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> hex $result]
      <a name="::snmpDebug(31)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func retrieved IP address is $retVal&#34; $fd
      if { [regexp -nocase $cookedIpAddr $retVal] } {
          <a name="::result_ok(12)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;IP address for ESRP enabled VLAN is $retVal, \
                     expected $cookedIpAddr. PASS&#34;
      } else {
          <a name="::result_error(12)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;IP address for ESRP enabled VLAN is $retVal, \
                        expected $cookedIpAddr. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the ESRP neighbour internal active ports</span>
   if { $intports != &#34;&#34; } {
      set result [snmpGet -session $session \
                       -oid extremeEsrpInternalActivePorts.$vlanid.$group]
      <a name="::snmpDebug(32)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet - $result&#34; $fd
      set retVal [<a name="::snmpUtilGetVal(14)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(33)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func number of active internal ports in ESRP for \
                      VLAN $vlanid is $retVal&#34; $fd
      if { $intports == $retVal } {
          <a name="::result_ok(13)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;No.of active internal ports is $retVal, expected \
                     $intports. PASS&#34;
      } else {
          <a name="::result_error(13)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;No.of active internal ports is $retVal, \
                        expected $intports. FAIL&#34;
      }
   }

   <a name="::report_end_test(1)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>

   <a name="::snmpDebug(34)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - End\n&#34; $fd
}

<span class="comment-line">########################################################################</span>
<span class="comment-line">#  Procedure Name: snmpCheckEsrpNeighborTable</span>
<span class="comment-line">#  </span>
<span class="comment-line">#  Description:</span>
<span class="comment-line">#    This procedures checks the SNMP ESRP neighbour table </span>
<span class="comment-line">#    (extremeEsrpNeighborTable) for the existence of given </span>
<span class="comment-line">#    ESRP table parameters.</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Input Variables:</span>
<span class="comment-line">#    session     - Session identifier which identifies the connection </span>
<span class="comment-line">#                  with the DUT</span>
<span class="comment-line">#    vlanid      - VLAN identifier to retrieve the ESRP table for a VLAN </span>
<span class="comment-line">#    neighid     - ESRP neighbour identifier</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Optional Args:</span>
<span class="comment-line">#    group      - ESRP group value</span>
<span class="comment-line">#    timer      - ESRP neighbour hello timer value</span>
<span class="comment-line">#    trackports - No. of tracked ports in the ESRP neighbour</span>
<span class="comment-line">#    trackroute - No. of IP routes tracked by the ESRP neighbour</span>
<span class="comment-line">#    state      - ESRP neighbour state (master / slave / neutral )</span>
<span class="comment-line">#    priority   - ESRP neighbour priority for this VLAN</span>
<span class="comment-line">#    intports   - No. of active internal ports in the ESRP neighbour</span>
<span class="comment-line">#    ports      - No. of active ports in the ESRP neighbour</span>
<span class="comment-line">#    ipaddr     - ESRP neighbour IP address</span>
<span class="comment-line">#    algorithm  - ESRP neighbour election algorithm</span>
<span class="comment-line">#                 Possible values are</span>
<span class="comment-line">#                    * ports-track-priority-mac</span>
<span class="comment-line">#                    * track-ports-priority-mac</span>
<span class="comment-line">#                    * priority-ports-track-mac</span>
<span class="comment-line">#                    * priority-track-ports-mac</span>
<span class="comment-line">#                    * priority-mac-only</span>
<span class="comment-line">#</span>
<span class="comment-line">#    fd         - File descriptor for logging the debug statements</span>
<span class="comment-line">#    comment    - Comment to be logged in the log file    </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Output Variables: </span>
<span class="comment-line">#     None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Variables:</span>
<span class="comment-line">#    0       - On failure </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Possible Usage:</span>
<span class="comment-line">#    snmpCheckEsrpNeighborTable -session $sessionid -vlanid $vlan_id \</span>
<span class="comment-line">#                               -neighid &#34;00:01:02:AE:FF:DE&#34; \</span>
<span class="comment-line">#                               -timer 10 -fd $fd_res</span>
<span class="comment-line">#######################################################################</span>
<strong><a name="::::snmpCheckEsrpNeighborTable_589">proc <a href="snmpESRPLib.tcl-annot.html#::::snmpCheckEsrpNeighborTable">::::snmpCheckEsrpNeighborTable</a></a></strong> {args} {
   <a name="::parse_args(3)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> snmpCheckEsrpNeighborTable $args {
      session &#34;&#34;
      vlanid &#34;&#34;
      group &#34;1&#34;
      neighid &#34;&#34;
      timer &#34;&#34;
      state &#34;&#34;
      algorithm &#34;&#34;
      priority &#34;&#34;
      trackports &#34;&#34;
      trackroute &#34;&#34;
      ports &#34;&#34;
      intports &#34;&#34;
      ipaddr &#34;&#34;
      comment &#34;snmpCheckEsrpNeighborTable&#34;
      fd &#34;NULL&#34;
   }

   set func &#34;snmpCheckEsrpNeighborTable:&#34;

   if { $vlanid == &#34;&#34; || $session == &#34;&#34; || $neighid == &#34;&#34;} {
       error &#34;$func vlanid, session and neighbour ID must be specified&#34;
       return 0
   }

   <a name="::snmpDebug(35)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func vlanid-$vlanid group-$group neighid-$neighid -Start&#34; $fd

   <a name="::result_debug(3)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\n-- Checking ESRP neighbor table for the VLAN $vlanid ID \
                      $neighid --&#34;

   <a name="::report_start_test(2)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;$comment&#34;

   set neighbourId [<a name="::snmpMacToEsrpNeighbourId(1)"><a href="./snmpESRPLib.tcl.html#::snmpMacToEsrpNeighbourId_128">::snmpMacToEsrpNeighbourId</a></a> $neighid]
   <a name="::snmpDebug(36)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func neighbour ID is $neighid --&gt; $neighbourId&#34;
  
   if {$timer != &#34;&#34; } {
      set result [snmpGet -session $session \
                       -oid extremeEsrpNeighborHelloTimer.$vlanid.$group.$neighbourId]
      <a name="::snmpDebug(37)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func snmpGet - $result&#34; $fd
      set retVal [<a name="::snmpUtilGetVal(15)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      if { $retVal == $timer } {
          <a name="::result_ok(14)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;ESRP neighbour hello timer value $retVal, \
                     expected $timer. PASS&#34;
      } else {
          <a name="::result_error(14)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;ESRP neighbour hello timer value $retVal, \
                        expected $timer. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the ESRP neighbour states</span>
   if { $state != &#34;&#34; } {
      set result [snmpGet -session $session \
                    -oid extremeEsrpNeighborState.$vlanid.$group.$neighbourId]
      <a name="::snmpDebug(38)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet - $result&#34; $fd

      set retVal [<a name="::snmpUtilGetVal(16)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> inttext $result]
      <a name="::snmpDebug(39)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func ESRP neighbour state for VLAN $vlanid is \
                     $retVal&#34; $fd
      if { [regexp -nocase $retVal $state] } {
          <a name="::result_ok(15)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;ESRP neighbour state is $retVal, expected $state. PASS&#34;
      } else {
          <a name="::result_error(15)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;ESRP neighbour state is $retVal, expected $state. FAIL&#34;
      }

   }

   <span class="comment-line"># --- Check no.of ports tracked by this vlan</span>
   if { $trackports != &#34;&#34; } {
      set result [snmpGet -session $session \
                       -oid extremeEsrpNeighborTrackedActivePorts.$vlanid.$group.$neighbourId]
      <a name="::snmpDebug(40)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet - $result&#34; $fd
      set retVal [<a name="::snmpUtilGetVal(17)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(41)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func number of tracked active ports for VLAN \
                     $vlanid is $retVal&#34; $fd
      if { $trackports == $retVal } {
          <a name="::result_ok(16)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;No.of tracked active ports is $retVal, \
                     expected $trackports. PASS&#34;
      } else {
          <a name="::result_error(16)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;No.of tracked active ports is $retVal, \
                        expected $trackports. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the ESRP neighbour priority</span>
   if { $priority != &#34;&#34; } {
      set result [snmpGet -session $session \
                       -oid extremeEsrpNeighborPriority.$vlanid.$group.$neighbourId]
      <a name="::snmpDebug(42)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet - $result&#34; $fd

      set retVal [<a name="::snmpUtilGetVal(18)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(43)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func ESRP neighbour priority for VLAN \
                     $vlanid is $retVal&#34; $fd
      if { $priority == $retVal } {
          <a name="::result_ok(17)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;ESRP neighbour priority is $retVal, \
                     expected $priority. PASS&#34;
      } else {
          <a name="::result_error(17)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;ESRP neighbour priority is $retVal, \
                        expected $priority. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check no.of IP routes tracked by neighbour of thie ESRP vlan</span>
   if { $trackroute != &#34;&#34; } {
      set result [snmpGet -session $session \
                       -oid extremeEsrpNeighborTrackedIpRoutes.$vlanid.$group.$neighbourId]
     
      <a name="::snmpDebug(44)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet - $result&#34; $fd
      set retVal [<a name="::snmpUtilGetVal(19)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(45)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func number of tracked IP routes for VLAN \
                     $vlanid is $retVal&#34; $fd
      if { $trackroute == $retVal } {
          <a name="::result_ok(18)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;No.of tracked IP route is $retVal, \
                     expected $trackroute. PASS&#34;
      } else {
          <a name="::result_error(18)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;No.of tracked IP route is $retVal, \
                        expected $trackroute. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the ESRP neighbour election algorithm</span>
   if { $algorithm != &#34;&#34; } {
      set result [snmpGet -session $session \
                       -oid extremeEsrpNeighborElectionAlgorithm.$vlanid.$group.$neighbourId]
      <a name="::snmpDebug(46)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet - $result&#34; $fd
      set retVal [<a name="::snmpUtilGetVal(20)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> inttext $result]
      <a name="::snmpDebug(47)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func ESRP neighbour master election \
                     algorithm for VLAN $vlanid is $retVal&#34; $fd
      if { [string compare [string tolower $retVal] \
                           [string tolower $algorithm]] == 0 } {
          <a name="::result_ok(19)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;ESRP neighbour master election algorithm is $retVal, \
                     expected $algorithm. PASS&#34;
      } else {
          <a name="::result_error(19)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;ESRP neighbour master election algorithm is $retVal, \
                        expected $algorithm. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the ESRP neighbour enabled active ports</span>
   if { $ports != &#34;&#34; } {
      set result [snmpGet -session $session \
                       -oid extremeEsrpNeighborActivePorts.$vlanid.$group.$neighbourId]
      set retVal [<a name="::snmpUtilGetVal(21)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(48)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func number of active ports in ESRP for VLAN $vlanid \
                     is $retVal&#34; $fd
      if { $ports == $retVal } {
          <a name="::result_ok(20)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;No.of active ports is $retVal, expected $ports. PASS&#34;
      } else {
          <a name="::result_error(20)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;No.of active ports is $retVal, expected $ports. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the ESRP neighbour internal active ports</span>
   if { $intports != &#34;&#34; } {
      set result [snmpGet -session $session \
                       -oid extremeEsrpNeighborInternalActivePorts.$vlanid.$group.$neighbourId]
      <a name="::snmpDebug(49)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet - $result&#34; $fd
      set retVal [<a name="::snmpUtilGetVal(22)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(50)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func number of active internal ports in ESRP for \
                     VLAN $vlanid is $retVal&#34; $fd
      if { $intports == $retVal } {
          <a name="::result_ok(21)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;No.of active internal ports is $retVal, \
                     expected $intports. PASS&#34;
      } else {
          <a name="::result_error(21)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;No.of active internal ports is $retVal, \
                        expected $intports. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check IP address configured for the ESRP neighbour</span>
   if { $ipaddr != &#34;&#34; } {
     
      <span class="comment-line"># ---- Convert the given IP address to SNMP output format</span>
      <span class="comment-line">#      30.0.0.1 --&gt; 1E 00 00 01</span>
      set cookedIpAddr [<a name="::snmpConvertIpAddrFormat(2)"><a href="./snmpESRPLib.tcl.html#::snmpConvertIpAddrFormat_57">::snmpConvertIpAddrFormat</a></a> $ipaddr]  
      <a name="::snmpDebug(51)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func given IP address is $ipaddr, \
                      cooked is $cookedIpAddr&#34; $fd
      
      set result [snmpGet -session $session \
                          -oid extremeEsrpNeighborNetAddress.$vlanid.$group.$neighbourId]
      <a name="::snmpDebug(52)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet - $result&#34; $fd
      set retVal [<a name="::snmpUtilGetVal(23)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> hex $result]
      <a name="::snmpDebug(53)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func retrieved IP address is $retVal&#34; $fd
      if { [regexp -nocase $cookedIpAddr $retVal] } {
          <a name="::result_ok(22)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;IP address for ESRP neighbour is $retVal, \
                     expected $cookedIpAddr. PASS&#34;
      } else {
          <a name="::result_error(22)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;IP address for ESRP neighbour is $retVal, \
                        expected $cookedIpAddr. FAIL&#34;
      }
   }

   <a name="::report_end_test(2)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>

   <a name="::snmpDebug(54)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - End\n&#34; $fd
}

<span class="comment-line">########################################################################</span>
<span class="comment-line">#  Procedure Name: snmpCheckEsrpTrackVlanTable</span>
<span class="comment-line">#  </span>
<span class="comment-line">#  Description:</span>
<span class="comment-line">#    This procedures checks whether the VLAN track table exists for the</span>
<span class="comment-line">#    given VLAN identifier or not. This proecdure checks the</span>
<span class="comment-line">#    row status of the SNMP table extremeEsrpTrackVlanTable</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Input Variables:</span>
<span class="comment-line">#    session     - Session identifier which identifies the connection </span>
<span class="comment-line">#                  with the DUT</span>
<span class="comment-line">#    vlanid      - VLAN identifier to retrieve the ESRP track vlan table</span>
<span class="comment-line">#                  for a VLAN </span>
<span class="comment-line">#    trackvlan   - VLAN identifier of the tracked vlan</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Optional Args:</span>
<span class="comment-line">#    group      - ESRP group value</span>
<span class="comment-line">#    state      - Whether the track vlan table exists or not</span>
<span class="comment-line">#    fd         - File descriptor for logging the debug statements</span>
<span class="comment-line">#    comment    - Comment to be logged in the log file    </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Output Variables: </span>
<span class="comment-line">#     None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Variables:</span>
<span class="comment-line">#    0       - On failure </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Possible Usage:</span>
<span class="comment-line">#    snmpCheckEsrpTrackVlanTable -session $sessionid -vlanid $vlan_id \</span>
<span class="comment-line">#                                -trackvlan $track_vlan_id \</span>
<span class="comment-line">#                                -state &#34;notexist&#34; -fd $fd_res</span>
<span class="comment-line">#######################################################################</span>
<strong><a name="::::snmpCheckEsrpTrackVlanTable_818">proc <a href="snmpESRPLib.tcl-annot.html#::::snmpCheckEsrpTrackVlanTable">::::snmpCheckEsrpTrackVlanTable</a></a></strong> {args} {
   <a name="::parse_args(4)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> snmpCheckEsrpTrackVlanTable $args {
      session &#34;&#34;
      vlanid &#34;&#34;
      trackvlan &#34;&#34;
      group &#34;1&#34;
      state &#34;active&#34;
      comment &#34;snmpCheckEsrpTrackVlanTable&#34;
      fd &#34;NULL&#34;
   }

   set func &#34;snmpCheckEsrpTrackVlanTable:&#34;

   if { $vlanid == &#34;&#34; || $session == &#34;&#34; || $trackvlan == &#34;&#34;} {
       error &#34;$func vlanid, session and trackvlan must be specified&#34;
       return 0
   }

   <a name="::snmpDebug(55)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func vlanid-$vlanid group-$group trackvlan-$trackvlan \
                    state-$state -Start&#34; $fd

   <a name="::result_debug(4)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\n-- Checking ESRP tracked vlan table for the VLAN \
                      $trackvlan in the VLAN $vlanid --&#34;

   <a name="::report_start_test(3)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;$comment&#34;

   set result [snmpGet -session $session \
                       -oid extremeEsrpTrackVlanRowStatus.$vlanid.$group.$trackvlan]
   <a name="::snmpDebug(56)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet -$result&#34; $fd
  
   <span class="comment-line"># ---- Check whether the entry exists. If not exists, then say notexist</span>

   if { [regexp -nocase &#34;.*No Such Instance.*&#34; $result] } {
      set retVal &#34;notexist&#34;
   } else {    
      set retVal [<a name="::snmpUtilGetVal(24)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> inttext $result]
   }
   <a name="::snmpDebug(57)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func ESRP track vlan row status for vlan \
                  $trackvlan is $retVal&#34;
   if { [regexp -nocase $retVal $state]} {
        <a name="::result_ok(23)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;ESRP track vlan ($trackvlan) status is $retVal, \
                   expected $state. PASS&#34;
   } else {
        <a name="::result_ok(24)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;ESRP track vlan ($trackvlan) status is $retVal, \
                   expected $state. FAIL&#34;
   }

   <a name="::report_end_test(3)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>

   <a name="::snmpDebug(58)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - End\n&#34; $fd
}

<span class="comment-line">########################################################################</span>
<span class="comment-line">#  Procedure Name: snmpCheckEsrpTrackIpRouteTable</span>
<span class="comment-line">#  </span>
<span class="comment-line">#  Description:</span>
<span class="comment-line">#    This procedures checks whether the track IP route table exists for the</span>
<span class="comment-line">#    given VLAN identifier or not. This proecdure checks the</span>
<span class="comment-line">#    row status of the SNMP table extremeEsrpTrackIpRouteTable</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Input Variables:</span>
<span class="comment-line">#    session     - Session identifier which identifies the connection </span>
<span class="comment-line">#                  with the DUT</span>
<span class="comment-line">#    vlanid      - VLAN identifier to retrieve the ESRP track IP route table</span>
<span class="comment-line">#                  for a VLAN </span>
<span class="comment-line">#    ipaddr      - Tracked IP address</span>
<span class="comment-line">#    mask        - Tracked IP address mask</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Optional Args:</span>
<span class="comment-line">#    group      - ESRP group value</span>
<span class="comment-line">#    state      - Whether the track IP route table exists or not</span>
<span class="comment-line">#    fd         - File descriptor for logging the debug statements</span>
<span class="comment-line">#    comment    - Comment to be logged in the log file    </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Output Variables: </span>
<span class="comment-line">#     None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Variables:</span>
<span class="comment-line">#    0       - On failure </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Possible Usage:</span>
<span class="comment-line">#    snmpCheckEsrpTrackIpRouteTable -session $sessionid -vlanid $vlan_id \</span>
<span class="comment-line">#                                   -ipaddr &#34;10.10.0.1&#34; -mask &#34;255.255.0.0&#34;\</span>
<span class="comment-line">#                                   -state &#34;notexist&#34; -fd $fd_res</span>
<span class="comment-line">#######################################################################</span>
<strong><a name="::::snmpCheckEsrpTrackIpRouteTable_903">proc <a href="snmpESRPLib.tcl-annot.html#::::snmpCheckEsrpTrackIpRouteTable">::::snmpCheckEsrpTrackIpRouteTable</a></a></strong> {args} {
   <a name="::parse_args(5)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> snmpCheckEsrpTrackIpRouteTable $args {
      session &#34;&#34;
      vlanid &#34;&#34;
      group &#34;1&#34;
      ipaddr &#34;&#34;
      mask &#34;&#34;
      state &#34;active&#34;
      comment &#34;snmpCheckEsrpTrackIpRouteTable&#34;
      fd &#34;NULL&#34;
   }

   set func &#34;snmpCheckEsrpTrackIpRouteTable:&#34;

   if { $vlanid == &#34;&#34; || $session == &#34;&#34; || $ipaddr == &#34;&#34; || $mask == &#34;&#34;} {
       error &#34;$func vlanid, session, IP address and mask must be specified&#34;
       return 0
   }

   <a name="::snmpDebug(59)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func vlanid-$vlanid group-$group ipaddr-$ipaddr \
                    mask-$mask state-$state -Start&#34; $fd

   <a name="::result_debug(5)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\n-- Checking ESRP tracked IP route table for IP address \
                      $ipaddr/$mask in the VLAN $vlanid --&#34;

   <a name="::report_start_test(4)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;$comment&#34;

   set result [snmpGet -session $session \
                       -oid extremeEsrpTrackIpRouteRowStatus.$vlanid.$group.$ipaddr.$mask]
   <a name="::snmpDebug(60)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet -$result&#34; $fd
  
   <span class="comment-line"># ---- Check whether the entry exists. If not exists, then say notexist</span>

   if { [regexp -nocase &#34;.*No Such Instance.*&#34; $result] } {
      set retVal &#34;notexist&#34;
   } else {    
      set retVal [<a name="::snmpUtilGetVal(25)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> inttext $result]
   }
   <a name="::snmpDebug(61)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func ESRP track IP route table row status for IP addr \
                  $ipaddr/$mask is $retVal&#34;
   if { [regexp -nocase $retVal $state]} {
        <a name="::result_ok(25)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;ESRP track IP route ($ipaddr/$mask) status is $retVal, \
                   expected $state. PASS&#34;
   } else {
        <a name="::result_ok(26)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;ESRP track IP route ($ipaddr/$mask) status is $retVal, \
                   expected $state. FAIL&#34;
   }

   <a name="::report_end_test(4)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>

   <a name="::snmpDebug(62)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - End\n&#34; $fd
}

<span class="comment-line">########################################################################</span>
<span class="comment-line">#  Procedure Name: snmpCheckEdpTable</span>
<span class="comment-line">#  </span>
<span class="comment-line">#  Description:</span>
<span class="comment-line">#    This procedures checks the SNMP EDP table (extremeEdpTable) </span>
<span class="comment-line">#    for the existence of given EDP table parameters.</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Input Variables:</span>
<span class="comment-line">#    session     - Session identifier which identifies the connection </span>
<span class="comment-line">#                  with the DUT</span>
<span class="comment-line">#    port        - EDP port on which EDP neighbor exists</span>
<span class="comment-line">#    neighid     - EDP neighbour identifier (MAC address)</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Optional Args:</span>
<span class="comment-line">#    neighname  - Device name of the EDP neighbor</span>
<span class="comment-line">#    neighver   - Software version of the EDP neighbor</span>
<span class="comment-line">#    neighslot  - Number of slot in the EDP neighbor device</span>
<span class="comment-line">#    neighport  - Port number on which the EDP neighbor connected</span>
<span class="comment-line">#    age        - Time since EDP neighbor entry created (in sec)</span>
<span class="comment-line">#    fd         - File descriptor for logging the debug statements</span>
<span class="comment-line">#    comment    - Comment to be logged in the log file    </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Output Variables: </span>
<span class="comment-line">#     None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Variables:</span>
<span class="comment-line">#    0       - On failure </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Possible Usage:</span>
<span class="comment-line">#    snmpCheckEdpTable -session $sessionid -port [GetATrunkPort 2 1] \</span>
<span class="comment-line">#                       -neighid &#34;00:AA:BB:CC:DD:EE&#34;  \</span>
<span class="comment-line">#                       -neighname &#34;Summit48i&#34; \</span>
<span class="comment-line">#                       -neighslot 1 \</span>
<span class="comment-line">#                       -neighport 5 \</span>
<span class="comment-line">#                       -age 10 -fd $fd_res</span>
<span class="comment-line">#######################################################################</span>

<strong><a name="::::snmpCheckEdpTable_993">proc <a href="snmpESRPLib.tcl-annot.html#::::snmpCheckEdpTable">::::snmpCheckEdpTable</a></a></strong> {args} {
   <a name="::parse_args(6)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> snmpCheckEdpTable $args {
      session &#34;&#34;
      <a name="::port(1)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> &#34;&#34; 
      neighid &#34;&#34;
      neighname &#34;&#34;
      neighver &#34;&#34;
      neighslot &#34;&#34;
      neighport &#34;&#34;
      age &#34;&#34;
      comment &#34;snmpCheckEdpTable&#34;
      fd &#34;NULL&#34;
   }

   set func &#34;snmpCheckEdpTable:&#34;

   if { $port == &#34;&#34; || $session == &#34;&#34; || $neighid == &#34;&#34;} {
       error &#34;$func port, session, neighbor ID must be specified&#34;
       return 0
   }

   <a name="::snmpDebug(63)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func port-$port neighid-$neighid -Start&#34; $fd

   <a name="::result_debug(6)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\n-- Checking EDP table in the port $port --&#34;

   <a name="::report_start_test(5)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;$comment&#34;

   <span class="comment-line"># --- Convert MAC address to EDP neighbour ID</span>
   set neighId [<a name="::snmpMacToEdpNeighbourId(1)"><a href="./snmpESRPLib.tcl.html#::snmpMacToEdpNeighbourId_93">::snmpMacToEdpNeighbourId</a></a> $neighid]
   <a name="::snmpDebug(64)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func EDP neighbour ID is $neighId&#34; $fd

   <span class="comment-line"># --- Convert the port number to SNMP compatible port number,</span>
   <span class="comment-line">#     if the switch is multi slot switch</span>

   set portNo [<a name="::snmpUtilParsePortList(1)"><a href="./snmplib.tcl.html#::snmpUtilParsePortList_1988">::snmpUtilParsePortList</a></a> $port]
   <a name="::snmpDebug(65)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func parsed port is $portNo&#34; $fd

   <span class="comment-line"># --- Check the EDP neighbour port number</span>
   if {$neighport != &#34;&#34; } {
      set result [snmpGet -session $session \
                       -oid extremeEdpNeighborPort.$portNo.$neighId]
      <a name="::snmpDebug(66)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet - $result&#34; $fd

      set retVal [<a name="::snmpUtilGetVal(26)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(67)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func EDP neighbour port no is $retVal&#34; $fd

      if { $retVal == $neighport } {
          <a name="::result_ok(27)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;EDP neighbour port no is $retVal, expected $neighport. PASS&#34;
      } else {
          <a name="::result_error(23)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;EDP neighbour port no is $retVal, \
                        expected $neighport. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the EDP neighbour system name</span>
   if {$neighname != &#34;&#34; } {
      set result [snmpGet -session $session \
                       -oid extremeEdpNeighborName.$portNo.$neighId]
      <a name="::snmpDebug(68)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet - $result&#34; $fd

      set retVal [<a name="::snmpUtilGetVal(27)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> str $result]
      <a name="::snmpDebug(69)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func EDP neighbour system name is $retVal&#34; $fd

      if { [string compare [string tolower $retVal] \
                           [string tolower $neighname]] == 0} {
          <a name="::result_ok(28)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;EDP neighbour system name is $retVal, \
                     expected $neighname. PASS&#34;
      } else {
          <a name="::result_error(24)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;EDP neighbour system name is $retVal, \
                        expected $neighname. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the EDP neighbour software version </span>
   if {$neighver != &#34;&#34; } {
      set result [snmpGet -session $session \
                      -oid extremeEdpNeighborSoftwareVersion.$portNo.$neighId]
      <a name="::snmpDebug(70)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet - $result&#34; $fd

      set retVal [<a name="::snmpUtilGetVal(28)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> str $result]
      <a name="::snmpDebug(71)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func EDP neighbour software version is $retVal&#34; $fd

      if { [string compare [string tolower $retVal] \
                           [string tolower $neighver]] == 0} {
          <a name="::result_ok(29)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;EDP neighbour software version is $retVal, \
                     expected $neighver. PASS&#34;
      } else {
          <a name="::result_error(25)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;EDP neighbour software version is $retVal, \
                        expected $neighver. FAIL&#34;
      }
   }

   if {$neighslot != &#34;&#34; } {
      set result [snmpGet -session $session \
                       -oid extremeEdpNeighborSlot.$portNo.$neighId]
      <a name="::snmpDebug(72)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet - $result&#34; $fd

      set retVal [<a name="::snmpUtilGetVal(29)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(73)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func EDP neighbour no.of slot is $retVal&#34; $fd

      if { $neighslot == $retVal } {
          <a name="::result_ok(30)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;EDP neighbour no.of slot is $retVal, \
                     expected $neighslot. PASS&#34;
      } else {
          <a name="::result_error(26)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;EDP neighbour no.of slot is $retVal, \
                        expected $neighslot. FAIL&#34;
      }
   }


   if { $age != &#34;&#34;} {
      set result [snmpGet -session $session \
                       -oid extremeEdpEntryAge.$portNo.$neighId]
      <a name="::snmpDebug(74)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet - $result&#34; $fd

      set retVal [<a name="::snmpUtilGetVal(30)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(75)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func EDP entry age is $retVal&#34; $fd
      <span class="comment-line"># ---- Age can be given as range. For example, 50 sec to 60 sec</span>
      <span class="comment-line">#      can be given as 50-60. Determine, whether age is given as</span>
      <span class="comment-line">#      range or not</span>
      if {[regexp -nocase {([0-9]+)\-([0-9]+)} $age res age1 age2] == 1 } {
         if { $retVal &gt;= $age1 &amp;&amp; $retVal &lt;= $age2 } {
            <a name="::result_ok(31)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;EDP age is $retVal, expected is between \
                       $age1 to $age2 seconds. PASS&#34;
         } else {
            <a name="::result_error(27)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;EDP age is $retVal, expected is between \
                          $age1 to $age2 seconds. FAIL&#34;
         }
      } else {
         if { $retVal == $age } {
            <a name="::result_ok(32)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;EDP age is $retVal, expected is $age seconds. PASS&#34;
         } else {
            <a name="::result_error(28)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;EDP age is $retVal, expected is $age seconds. FAIL&#34;
         }
      }
   }

   <a name="::report_end_test(5)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>

   <a name="::snmpDebug(76)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - End\n&#34; $fd
}

<span class="comment-line">########################################################################</span>
<span class="comment-line">#  Procedure Name: snmpCheckEdpNeighborTable</span>
<span class="comment-line">#  </span>
<span class="comment-line">#  Description:</span>
<span class="comment-line">#    This procedures checks the SNMP EDP table (extremeEdpNeighborTable) </span>
<span class="comment-line">#    for the existence of given EDP table parameters.</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Input Variables:</span>
<span class="comment-line">#    session     - Session identifier which identifies the connection </span>
<span class="comment-line">#                  with the DUT</span>
<span class="comment-line">#    port        - EDP port on which this neighbor exists</span>
<span class="comment-line">#    neighid     - EDP neighbour identifier (MAC address)</span>
<span class="comment-line">#    vlanname    - Name of the VLAN on which this neighbor exists</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Optional Args:</span>
<span class="comment-line">#    vlanid     - EDP neighbor VLAN identifier</span>
<span class="comment-line">#    ipaddr     - IP address assigned to the EDP neighbor</span>
<span class="comment-line">#    fd         - File descriptor for logging the debug statements</span>
<span class="comment-line">#    comment    - Comment to be logged in the log file    </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Output Variables: </span>
<span class="comment-line">#     None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Variables:</span>
<span class="comment-line">#    0       - On failure </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Possible Usage:</span>
<span class="comment-line">#    snmpCheckEdpNeighborTable -session $sessionid -port [GetATrunkPort 1 2] \</span>
<span class="comment-line">#                       -neighid &#34;10:AA:BB:CC:DD:EE&#34; -vlanname &#34;VLAN1&#34; \</span>
<span class="comment-line">#                       -ipaddr &#34;10.0.0.1&#34; -vlanid 23 -fd $fd_res</span>
<span class="comment-line">#######################################################################</span>

<strong><a name="::::snmpCheckEdpNeighborTable_1167">proc <a href="snmpESRPLib.tcl-annot.html#::::snmpCheckEdpNeighborTable">::::snmpCheckEdpNeighborTable</a></a></strong> {args} {
   <a name="::parse_args(7)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> snmpCheckEdpNeighborTable $args {
      session &#34;&#34;
      <a name="::port(2)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> &#34;&#34; 
      neighid &#34;&#34;
      vlanname &#34;&#34;
      vlanid &#34;&#34;
      ipaddr &#34;&#34;
      comment &#34;snmpCheckEdpNeighborTable&#34;
      fd &#34;NULL&#34;
   }

   set func &#34;snmpCheckEdpNeighborTable:&#34;

   if { $port == &#34;&#34; || $session == &#34;&#34; || $neighid == &#34;&#34; || $vlanname == &#34;&#34;} {
       error &#34;$func port, session, neighbor ID, vlan name must be specified&#34;
       return 0
   }

   <a name="::snmpDebug(77)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func port-$port neighid-$neighid vlanname-$vlanname \
                    -Start&#34; $fd

   <a name="::result_debug(7)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\n-- Checking EDP neighbour table in the port $port for \
                      neighbor $neighid and vlan $vlanname --&#34;

   <a name="::report_start_test(6)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;$comment&#34;

   <span class="comment-line"># --- Convert MAC address to EDP neighbour ID</span>
   set neighId [<a name="::snmpMacToEdpNeighbourId(2)"><a href="./snmpESRPLib.tcl.html#::snmpMacToEdpNeighbourId_93">::snmpMacToEdpNeighbourId</a></a> $neighid]
   <a name="::snmpDebug(78)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func EDP neighbour ID is $neighId&#34; $fd

   <span class="comment-line"># --- Convert the port number to SNMP compatible port number,</span>
   <span class="comment-line">#     if the switch is multi slot switch</span>

   set portNo [<a name="::snmpUtilParsePortList(2)"><a href="./snmplib.tcl.html#::snmpUtilParsePortList_1988">::snmpUtilParsePortList</a></a> $port]

   set vlanOid [<a name="::snmpConvertStrToOid(1)"><a href="./snmpESRPLib.tcl.html#::snmpConvertStrToOid_24">::snmpConvertStrToOid</a></a> $vlanname]
   <a name="::snmpDebug(79)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func $vlanname is converted as oid $vlanOid&#34;

   <span class="comment-line"># --- Check the EDP neighbour vlan identifier </span>
   if {$vlanid != &#34;&#34; } {

      set result [snmpGet -session $session \
                       -oid extremeEdpNeighborVlanId.$portNo.$neighId.$vlanOid]
      <a name="::snmpDebug(80)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet - $result&#34; $fd

      set retVal [<a name="::snmpUtilGetVal(31)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(81)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func EDP neighbour vlan id is $retVal&#34; $fd

      if { $retVal == $vlanid } {
          <a name="::result_ok(33)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;EDP neighbour vlan id is $retVal, expected $vlanid. PASS&#34;
      } else {
          <a name="::result_error(29)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;EDP neighbour vlan id is $retVal, expected \
                        $vlanid. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the EDP neighbour vlan identifier </span>
   if {$ipaddr != &#34;&#34; } {
      set result [snmpGet -session $session \
                       -oid extremeEdpNeighborVlanIpAddress.$portNo.$neighId.$vlanOid]
      <a name="::snmpDebug(82)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet - $result&#34; $fd

      set retVal [<a name="::snmpUtilGetVal(32)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> ipaddr $result]
      <a name="::snmpDebug(83)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func EDP neighbour vlan IP address is $retVal&#34; $fd

      if { $retVal == $ipaddr } {
          <a name="::result_ok(34)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;EDP neighbour vlan IP address is $retVal, \
                     expected $ipaddr. PASS&#34;
      } else {
          <a name="::result_error(30)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;EDP neighbour vlan IP address is $retVal, \
                        expected $ipaddr. FAIL&#34;
      }
   }

   <a name="::report_end_test(6)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>

   <a name="::snmpDebug(84)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - End\n&#34; $fd
}

<span class="comment-line">#################################################################</span>
<span class="comment-line">#  Procedure Name: snmpChangeEdpPortStatus</span>
<span class="comment-line">#  </span>
<span class="comment-line">#  Description:</span>
<span class="comment-line">#    This procedures enables or disables EDP on a port</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Input Variables:</span>
<span class="comment-line">#    session   - Session identifier which identifies the connection </span>
<span class="comment-line">#                with the DUT</span>
<span class="comment-line">#    port      - Port number on which EDP to be enbaled or disabled</span>
<span class="comment-line">#    status    - Status indicating whether the EDP is to</span>
<span class="comment-line">#                be enabled or disabled. </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Optional Args:</span>
<span class="comment-line">#    fd - File descriptor of open log file</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Output Variables: </span>
<span class="comment-line">#     None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Variables:</span>
<span class="comment-line">#    0 - On failure </span>
<span class="comment-line">#    1 - On success</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Possible Usage:</span>
<span class="comment-line">#    snmpChangeEdpPortStatus -session $session -port 5 -state &#34;disable&#34;</span>
<span class="comment-line">################################################################</span>

<strong><a name="::::snmpChangeEdpPortStatus_1274">proc <a href="snmpESRPLib.tcl-annot.html#::::snmpChangeEdpPortStatus">::::snmpChangeEdpPortStatus</a></a></strong> {args} {
   <a name="::parse_args(8)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> snmpChangeEdpPortStatus $args {
      session &#34;&#34;
      status &#34;&#34;
      <a name="::port(3)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> &#34;&#34;
      fd &#34;NULL&#34;
   }

   set func &#34;snmpChangeEdpPortStatus&#34;

   if { $session == &#34;&#34; || $status == &#34;&#34; || $port == &#34;&#34;} {
       error &#34;$func SNMP session id, status and port number must be specified&#34;
       return 0
   }

   set status [string tolower $status]

   <a name="::result_debug(8)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\n-- Changing EDP status to $status --&#34;

   if { $status == &#34;enable&#34; } {
      set state 1
   } elseif { $status == &#34;disable&#34; } {
      set state 2
   } else {
      error &#34;$func - status value should be either enable or disable&#34;
      return 0
   }

   <span class="comment-line"># --- Convert the port number, if the switch has multiple blades</span>
   set portNo [<a name="::snmpUtilParsePortList(3)"><a href="./snmplib.tcl.html#::snmpUtilParsePortList_1988">::snmpUtilParsePortList</a></a> $port]
   <a name="::snmpDebug(85)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func Parsed port is $portNo&#34; $fd

   <a name="::snmpDebug(86)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func session-$session status-$status \
                     port-$port - Start&#34; $fd 
   <span class="comment-line"># ----- Change the IP forwarding state of the switch instead</span>
   set result [snmpSet -session $session -oid extremeEdpPortState.$portNo \
                         -type i -val $state]
   <a name="::snmpDebug(87)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func - snmpSet - $result&#34; $fd

   <a name="::snmpDebug(88)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - End\n&#34; $fd

   return 1
}

<span class="comment-line">#################################################################</span>
<span class="comment-line">#  Procedure Name: snmpCheckEdpPortStatus</span>
<span class="comment-line">#  </span>
<span class="comment-line">#  Description:</span>
<span class="comment-line">#    This procedures checks whether EDP is enabled or disabled</span>
<span class="comment-line">#    on a port</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Input Variables:</span>
<span class="comment-line">#    session   - Session identifier which identifies the connection </span>
<span class="comment-line">#                with the DUT</span>
<span class="comment-line">#    port      - Port number on which EDP to be enbaled or disabled</span>
<span class="comment-line">#    status    - Status indicating whether the EDP status is to</span>
<span class="comment-line">#                be checked for enabled or disabled. </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Optional Args:</span>
<span class="comment-line">#    fd - File descriptor of open log file</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Output Variables: </span>
<span class="comment-line">#     None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Variables:</span>
<span class="comment-line">#    0 - On failure </span>
<span class="comment-line">#    1 - On success</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Possible Usage:</span>
<span class="comment-line">#    snmpCheckEdpPortStatus -session $session -port 5 -state &#34;disable&#34;</span>
<span class="comment-line">################################################################</span>

<strong><a name="::::snmpCheckEdpPortStatus_1346">proc <a href="snmpESRPLib.tcl-annot.html#::::snmpCheckEdpPortStatus">::::snmpCheckEdpPortStatus</a></a></strong> {args} {
   <a name="::parse_args(9)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> snmpCheckEdpPortStatus $args {
      session &#34;&#34;
      status &#34;&#34;
      <a name="::port(4)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> &#34;&#34;
      comment &#34;snmpCheckEdpPortStatus&#34;
      fd &#34;NULL&#34;
   }

   set func &#34;snmpCheckEdpPortStatus&#34;

   if { $session == &#34;&#34; || $status == &#34;&#34; || $port == &#34;&#34;} {
       error &#34;$func SNMP session id, status and port number must be specified&#34;
       return 0
   }

   <a name="::report_start_test(7)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;$comment&#34;

   <a name="::snmpDebug(89)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func session-$session status-$status port-$port \
                    - Start&#34; $fd 
   set status [string tolower $status]

   <a name="::result_debug(9)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\n-- Checking EDP status $status on port $port --&#34;

   <span class="comment-line"># --- If EDP is enabled on a port, the value returned in SNMP is</span>
   <span class="comment-line">#     true, else it is false. So manipulate the incoming status</span>
   <span class="comment-line">#     value</span>

   if { $status == &#34;enabled&#34; } {
      set edpStatus &#34;true&#34;
   } elseif { $status == &#34;disabled&#34; } {
      set edpStatus &#34;false&#34;
   } else {
      error &#34;$func - status value should be either enabled or disabled&#34;
      <a name="::report_end_test(7)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>
      return 0
   }

   <span class="comment-line"># --- Convert the port number, if the switch has multiple blades</span>
   set portNo [<a name="::snmpUtilParsePortList(4)"><a href="./snmplib.tcl.html#::snmpUtilParsePortList_1988">::snmpUtilParsePortList</a></a> $port]
   <a name="::snmpDebug(90)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func Parsed port is $portNo&#34; $fd

   <span class="comment-line"># --- Get the EDP status for the given port number</span>
   set result [snmpGet -session $session \
                       -oid extremeEdpPortState.$portNo]
   <a name="::snmpDebug(91)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet - $result&#34; $fd
   
   set retVal [<a name="::snmpUtilGetVal(33)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> boolean $result]
   <a name="::snmpDebug(92)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func - EDP state in port $portNo is $retVal&#34; $fd
 
   if { $edpStatus == $retVal } {
      <a name="::result_ok(35)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;EDP status on port $portNo is $retVal, \
                 expected $edpStatus. PASS&#34;
   } else {
      <a name="::result_error(31)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;EDP status on port $portNo is $retVal, \
                    expected $edpStatus. FAIL&#34;
   }

   <a name="::snmpDebug(93)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - End\n&#34; $fd
   <a name="::report_end_test(8)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>

   return 1
}
</pre>
<hr>
<div class="index-selector">
	<a href="index_main.html#byfilename">file name</a> 
 | 
	<a href="index_main.html#byprocname">procedure name</a> 
 | 
	<a href="index_main.html#bycall">procedure call</a> 
 | 
	<a href="index_annot_full.html">annotation</a> 

<br>
<cite>File generated 2018-06-14 at 17:09.</cite>
</div>

</body>
</html>
