<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/transitional.dtd">
<!-- Generated by TclDoc @@VERSION@@ -->
<html>
<head>
  <title>mpls.tcl annotations</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="default.css">
</head>
<body class="src-html">
<div class="index-selector">
<!-- index for tcl source files -->
	Index by: 
	<a href="index_main.html#mpls.tcl">file name</a> | 
	<a href="index_main.html#byprocname">procedure name</a> | 
	<a href="index_main.html#bycall">procedure call</a> | 
	<a href="index_annot_full.html">annotation</a>

</div>
<hr>

<h2><a href="mpls.tcl.html">mpls.tcl</a> Annotations</h2>
Created from <strong><code>/root/automation/Lib/mpls.tcl</strong></code>
<hr>

<table class="proc-summary">
<tr>
<!-- -------------------- PROCEDURE SUMMARY -------------------- -->
<th><a name="proc_summary">Procedure Summary</a></th>
</tr>
<tr><td><code><a href="#::::CheckMplsDuts">::::CheckMplsDuts</a> { dutList testNo time1 }</code><p class="summary">################################################################# 
 Procedure Name: CheckMplsDuts   
 Description: Decide whether to skip an mpls test based on license
      
 Input args: dutList <= list of required dut for this test case
             testNo <= test case numbers
             time1  <= time of test case start
 Output args: none
 Return value: Global array initialized
 Typical usage: 
	CheckMplsDuts "1 2" $testNo $time1      
 Category: Utility
#################################################################</p></td></tr>
<tr><td><code><a href="#::::CheckMplsLicenses">::::CheckMplsLicenses</a> { testNo time1 {scriptWiseSkip 0} }</code><p class="summary">################################################################# 
 Procedure Name: CheckMplsLicenses   
 Description: Inits the MPLSInfo array:
           MPLSInfo(DUT#,enabled) 0|1  (More can be added as needed)

           ALSO will skipTest if no mpls is enabled or dut1 is a bcom
      
 Input args: none
 Output args: none
 Return value: Global array initialized
 Typical usage: 
	CheckMplsLicenses      
 Category: Utility
#################################################################</p></td></tr>
<tr><td><code><a href="#::::CheckStreamMatrix">::::CheckStreamMatrix</a> {  }</code><p class="summary">--------------------------------------------------------------------------
 in vpls certain tests use a mesh of predefined streams
   at the beginning of these tests make sure the mess is configured

 --------------------------------------------------------------------------</p></td></tr>
<tr><td><code><a href="#::::CleanupSingleOSPFVlanWithMPLS">::::CleanupSingleOSPFVlanWithMPLS</a> { vlanArea {vlanName vlan1} {OspfMplsCleanup true} }</code><p class="summary">#################################################################
 Procedure Name: CleanupSingleOSPFVlanWithMPLS

 Description: ospf topology specific proc that is used to cleanup single ospf vlan cinfiguration
              for a given area.</p></td></tr>
<tr><td><code><a href="#::::ClearStreamMatrix">::::ClearStreamMatrix</a> {  }</code><p class="summary">-------------------------------------------------------------------------
 If any stream is sent the matrix is wiped from the ixia config
    so it is necessary to unset the TrafficPrimed to 0
    if the ixia is used.</p></td></tr>
<tr><td><code><a href="#::::DecodeMPLSFrameLabel">::::DecodeMPLSFrameLabel</a> { args }</code><p class="summary">################################################################# 
 Procedure Name: DecodeMPLSFrameLabel
   
 Description:
          -get label |  type

 Input args:  args
 Output args: 
 Return value: 
 Typical usage:
 set Mpls_Type_2 [DecodeMPLSFrameLabel -get type -frame "$frame"]
 set Mpls_Ingress_Label [DecodeMPLSFrameLabel -get label -frame "$frame"]

 Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput
                          VerifyTraffic)
 Category: CaptureTraffic
#################################################################</p></td></tr>
<tr><td><code><a href="#::::GetMplsStaticLabel">::::GetMplsStaticLabel</a> { args }</code><p class="summary">#################################################################
 Procedure Name: GetMplsStaticLabel
 Description:  Configure matching ingress and egress tags between
               Pionner and Genesis platforms which support different
               Tag ranges

 Input args: args
 Output args: none
 Return value: newLabel
 Typical usage:
       SendACmd "configure mpls static lsp to-chennai-static egress \
       [GetMplsStaticLabel -nextHopDUT 2 -baseLabel 32 -direction egress] \
       egress-vlan chennai-link next-hop 150.151.1.1 ingress \
       [GetMplsStaticLabel -baseLabel 29 -direction ingress] \
       ingress-vlan core-mumbai"

 Category: DUTConfig
#################################################################</p></td></tr>
<tr><td><code><a href="#::::MulDutVplsCleanup">::::MulDutVplsCleanup</a> { args }</code><p class="summary"></p></td></tr>
<tr><td><code><a href="#::::MulDutVplsSetup">::::MulDutVplsSetup</a> { args }</code><p class="summary">#################################################################
 Procedure Name: MulDutVplsSetup

 Description:
 This procedure creates  a variable number of pseudo wire/service
      pairs on a multi-node  test bed.</p></td></tr>
<tr><td><code><a href="#::::PrimeVPLSTraffic">::::PrimeVPLSTraffic</a> {  }</code><p class="summary">-------------------------------------------------------------------------
 Set up the matrix of streams for the 1.3.x vpls tests

 -------------------------------------------------------------------------</p></td></tr>
<tr><td><code><a href="#::::SetupMPLSLine2.3">::::SetupMPLSLine2.3</a> {  }</code><p class="summary"></p></td></tr>
<tr><td><code><a href="#::::SetupSingleOSPFVlanWithPrefix">::::SetupSingleOSPFVlanWithPrefix</a> { vlan1IP vlanArea portList dutID {vlanName vlan1} {enableOSPF true} {tag {}} {AreaType {}} }</code><p class="summary">#################################################################
 Procedure Name: SetupSingleOSPFVlanWithPrefix

 Description: ospf topology specific proc that is used to setup a single ospf vlan
              for a given area with prefix


 Input args:  vlan1IP, vlanArea, portList, dutID, vlanName, enableOSPF, tag
 Output args: None.</p></td></tr>
</table>
<p>
<!-- -------------------- PROCEDURE DETAIL -------------------- -->
<table class="proc-details">
<tr>
  <th><a name="proc_detail">Procedure Detail</a></th>
</tr>
</table>
<h3  class="details-header"><a name="::::CheckMplsDuts">::::CheckMplsDuts</a></h3>
<pre class="details-procdef">proc  ::::CheckMplsDuts { dutList testNo time1 }</pre>
<dl  class="details-desc">
<dd>################################################################# 
 Procedure Name: CheckMplsDuts   
 Description: Decide whether to skip an mpls test based on license
      
 Input args: dutList <= list of required dut for this test case
             testNo <= test case numbers
             time1  <= time of test case start
 Output args: none
 Return value: Global array initialized
 Typical usage: 
	CheckMplsDuts "1 2" $testNo $time1      
 Category: Utility
#################################################################
  <dl  class="props" id="proc-props">
<dt>Defined in:</dt>
<dd><a href="mpls.tcl.html#::::CheckMplsDuts_188">mpls.tcl, line 188</a></dd>
</dl></dd>
</dl>


<h3  class="details-header"><a name="::::CheckMplsLicenses">::::CheckMplsLicenses</a></h3>
<pre class="details-procdef">proc  ::::CheckMplsLicenses { testNo time1 {scriptWiseSkip 0} }</pre>
<dl  class="details-desc">
<dd>################################################################# 
 Procedure Name: CheckMplsLicenses   
 Description: Inits the MPLSInfo array:
           MPLSInfo(DUT#,enabled) 0|1  (More can be added as needed)

           ALSO will skipTest if no mpls is enabled or dut1 is a bcom
      
 Input args: none
 Output args: none
 Return value: Global array initialized
 Typical usage: 
	CheckMplsLicenses      
 Category: Utility
#################################################################
  <dl  class="props" id="proc-props">
<dt>Defined in:</dt>
<dd><a href="mpls.tcl.html#::::CheckMplsLicenses_16">mpls.tcl, line 16</a></dd>
</dl></dd>
</dl>


<h3  class="details-header"><a name="::::CheckStreamMatrix">::::CheckStreamMatrix</a></h3>
<pre class="details-procdef">proc  ::::CheckStreamMatrix {  }</pre>
<dl  class="details-desc">
<dd>--------------------------------------------------------------------------
 in vpls certain tests use a mesh of predefined streams
   at the beginning of these tests make sure the mess is configured

 --------------------------------------------------------------------------
  <dl  class="props" id="proc-props">
<dt>Defined in:</dt>
<dd><a href="mpls.tcl.html#::::CheckStreamMatrix_1435">mpls.tcl, line 1435</a></dd>
</dl></dd>
</dl>


<h3  class="details-header"><a name="::::CleanupSingleOSPFVlanWithMPLS">::::CleanupSingleOSPFVlanWithMPLS</a></h3>
<pre class="details-procdef">proc  ::::CleanupSingleOSPFVlanWithMPLS { vlanArea {vlanName vlan1} {OspfMplsCleanup true} }</pre>
<dl  class="details-desc">
<dd>#################################################################
 Procedure Name: CleanupSingleOSPFVlanWithMPLS

 Description: ospf topology specific proc that is used to cleanup single ospf vlan cinfiguration
              for a given area.


 Input args:  vlanArea, vlanName true/false
 Output args: None.
 Return vlaue: none
 Typical usage:
         CleanupSingleOSPFVlanWithMPLS $area vlan1

 Category: Setup
#################################################################
  <dl  class="props" id="proc-props">
<dt>Defined in:</dt>
<dd><a href="mpls.tcl.html#::::CleanupSingleOSPFVlanWithMPLS_1297">mpls.tcl, line 1297</a></dd>
</dl></dd>
</dl>


<h3  class="details-header"><a name="::::ClearStreamMatrix">::::ClearStreamMatrix</a></h3>
<pre class="details-procdef">proc  ::::ClearStreamMatrix {  }</pre>
<dl  class="details-desc">
<dd>-------------------------------------------------------------------------
 If any stream is sent the matrix is wiped from the ixia config
    so it is necessary to unset the TrafficPrimed to 0
    if the ixia is used.  PrimeVPLSTraffic will have to 
    be run to re-init the matrix
 ------------------------------------------------------------------------
  <dl  class="props" id="proc-props">
<dt>Defined in:</dt>
<dd><a href="mpls.tcl.html#::::ClearStreamMatrix_1448">mpls.tcl, line 1448</a></dd>
</dl></dd>
</dl>


<h3  class="details-header"><a name="::::DecodeMPLSFrameLabel">::::DecodeMPLSFrameLabel</a></h3>
<pre class="details-procdef">proc  ::::DecodeMPLSFrameLabel { args }</pre>
<dl  class="details-desc">
<dd>################################################################# 
 Procedure Name: DecodeMPLSFrameLabel
   
 Description:
          -get label |  type

 Input args:  args
 Output args: 
 Return value: 
 Typical usage:
 set Mpls_Type_2 [DecodeMPLSFrameLabel -get type -frame "$frame"]
 set Mpls_Ingress_Label [DecodeMPLSFrameLabel -get label -frame "$frame"]

 Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput
                          VerifyTraffic)
 Category: CaptureTraffic
#################################################################
  <dl  class="props" id="proc-props">
<dt>Defined in:</dt>
<dd><a href="mpls.tcl.html#::::DecodeMPLSFrameLabel_1903">mpls.tcl, line 1903</a></dd>
</dl></dd>
</dl>


<h3  class="details-header"><a name="::::GetMplsStaticLabel">::::GetMplsStaticLabel</a></h3>
<pre class="details-procdef">proc  ::::GetMplsStaticLabel { args }</pre>
<dl  class="details-desc">
<dd>#################################################################
 Procedure Name: GetMplsStaticLabel
 Description:  Configure matching ingress and egress tags between
               Pionner and Genesis platforms which support different
               Tag ranges

 Input args: args
 Output args: none
 Return value: newLabel
 Typical usage:
       SendACmd "configure mpls static lsp to-chennai-static egress \
       [GetMplsStaticLabel -nextHopDUT 2 -baseLabel 32 -direction egress] \
       egress-vlan chennai-link next-hop 150.151.1.1 ingress \
       [GetMplsStaticLabel -baseLabel 29 -direction ingress] \
       ingress-vlan core-mumbai"

 Category: DUTConfig
#################################################################
  <dl  class="props" id="proc-props">
<dt>Defined in:</dt>
<dd><a href="mpls.tcl.html#::::GetMplsStaticLabel_1328">mpls.tcl, line 1328</a></dd>
</dl></dd>
</dl>


<h3  class="details-header"><a name="::::MulDutVplsCleanup">::::MulDutVplsCleanup</a></h3>
<pre class="details-procdef">proc  ::::MulDutVplsCleanup { args }</pre>
<dl  class="details-desc">
<dd>
  <dl  class="props" id="proc-props">
<dt>Defined in:</dt>
<dd><a href="mpls.tcl.html#::::MulDutVplsCleanup_965">mpls.tcl, line 965</a></dd>
</dl></dd>
</dl>


<h3  class="details-header"><a name="::::MulDutVplsSetup">::::MulDutVplsSetup</a></h3>
<pre class="details-procdef">proc  ::::MulDutVplsSetup { args }</pre>
<dl  class="details-desc">
<dd>#################################################################
 Procedure Name: MulDutVplsSetup

 Description:
 This procedure creates  a variable number of pseudo wire/service
      pairs on a multi-node  test bed.  Each pseudo wire will have a service
      A variable number of services can be configured.  OSPF and LDP
      are setup by default

      NOTE: The starting VPLS ID is always 50 + $j (j incr number of vpls's)

 Input args: args
      numTrunks "1" 
      numServiceVlan "1"
      nonDefaultArg "none"
      vlanVman "vlan"
      noEcmp "0"
      numDuts "2"
      config  "line"
      numVpls "1"
      mtu "1500" 
      tagPattern "tagged"
      portPattern "continuous"
      vlanTagNums "static"
      routing "ospf"
      addVPLS "1"
      

 Input args: args
   -numTrunks "1"          <= number of trunks connected between DUts
   -numServiceVlan "1"     <= number of service Vlan/Vman used 
   -nonDefaultArg "none"   <= the ability to set non-default vpls values
   -vlanVman "vlan"        <= vpls can be configured in conjunction with vmans
   -numDuts  "2"	          <= number of Duts used for vpls setup 
   -config  "line"         <= connection of Duts in the setup, 
           for ex if numDuts=3 and config=line, then
           the script will configure trunk connection as below
           DUT1<===>DUT2<===>DUT3
           if config=loop then the configuation would be 
           DUT1<===>DUT2<===>DUT3
             ^                 ^
             |		           |	
				  -----------------		
   -numVpls  "10"          <= number of vpls sessions to be used for testcase
   -noEcmp "1"             <= the value set to 1 indicates  ospf route costs
                              between DUTs are different, otherwise 0,
                              default is 0 indicates ECMP
   -mtu  "1500"            <= value of size of mtu to be given if 
                           nonDefaultArg is provided as varMtu
                           value ranges between 1492 to 9216
  Note : Make sure that number of vpls and number of service vlans are equal
         This will have a one tone mapping with service vlan to vpls
         For vman not more than two vpls sessions could be created using this proc
         Only 1 vman is allowed port port, therefore vmans are limited by the number
         of ports on each switch

   -tagPattern  "tagged" <= many cases will require a mix of tagged and
                                        untagged ports on a service vlan
           "untagged" <=> all vlans untagged
           "tagged" <=> all vlans tagged 
           "untag-tag" <=> 1st vlan untag rest tagged 

   -portPattern "continuous" <= many cases require different port patterns
           "continuousOne" <=> port index 1 on each vlan on each DUT
           "continuousTwo" <=> port index 1 and 2 on each vlan on each DUT
           "alternate" <=> alternate portA on odd vlans portB on even vlans

   -vlanTagNums "static"  <= vlan tag to create on each DUT
           "static" <=> same vlan tags on each dut
           "incr" <=> increment the vlan tags on each dut
                   tags incr by 100, starting at 600 on dut1

   -routing "ospf" <= choose the routing infrastructure
           "ospf" <=> use ospf routing to bring up the infrastructure
           "static" <=> use static routes to create reachability

   -addVPLS "1" <= Other modules may want to use this library with only the
                   basic MPLS setup.  This option allows the skipping of VPLS
                   Setup
   -prot "ldp"  <==== provide to the protocol with which the PW is constructed
                      other protocol option  "rsvp"
   -srcDut "1"  <==== Specify tht estarting dut number of the rsvp-tunnel 
   -destDut "3" <===== Specify the destination Dut of the rsvp-tunnel
   -testNo      "none"  <=== Added verify code so test can be aborted if config fails ex. $testNo
   -time1       "none"  <=== ex $time1 from parent proc
   -verify      "no" <=== switch to turn on verification
   -exitOnVFail "no" <=== choice to exit the parent test case if any of the config fails
   -startTime   "30" <=== time to delay before starting to verify the network
   -failTime    "75" <=== time to continue checking before failing case.
    Note :provide addVPLS  0 for rsvp protocol 

 Output args: none
 Typical usage:
	 MulDutVplsSetup  -numTrunks "1" \
               -numServiceVlan "1" \
               -numDuts  "2" \
               -config  "line" \
               -nonDefaultArg "none" \
               -vlanVman "vlan" \
	             -numVpls  "10" \	
               -noEcmp "1" \
               -tagPattern "tagged" \
               -portPattern "continuous" \
               -mtu "1500" \
               -vlanTagNums "static" \
               -routing "ospf" \
               -addVPLS "1" \
               -prot "ldp" \
               -srcDut "1" \
               -destDut "3"

 Category Types (SetupSwitch,GetSwitchInfo,SendTraffic,CaptureTraffic,
                 SetupTestTool,VerifySwitchOutput,Utility,VerifyTraffic)
 Category: SetupSwitch
#################################################################
  <dl  class="props" id="proc-props">
<dt>Defined in:</dt>
<dd><a href="mpls.tcl.html#::::MulDutVplsSetup_319">mpls.tcl, line 319</a></dd>
</dl></dd>
</dl>


<h3  class="details-header"><a name="::::PrimeVPLSTraffic">::::PrimeVPLSTraffic</a></h3>
<pre class="details-procdef">proc  ::::PrimeVPLSTraffic {  }</pre>
<dl  class="details-desc">
<dd>-------------------------------------------------------------------------
 Set up the matrix of streams for the 1.3.x vpls tests

 -------------------------------------------------------------------------
  <dl  class="props" id="proc-props">
<dt>Defined in:</dt>
<dd><a href="mpls.tcl.html#::::PrimeVPLSTraffic_1456">mpls.tcl, line 1456</a></dd>
</dl></dd>
</dl>


<h3  class="details-header"><a name="::::SetupMPLSLine2.3">::::SetupMPLSLine2.3</a></h3>
<pre class="details-procdef">proc  ::::SetupMPLSLine2.3 {  }</pre>
<dl  class="details-desc">
<dd>
  <dl  class="props" id="proc-props">
<dt>Defined in:</dt>
<dd><a href="mpls.tcl.html#::::SetupMPLSLine2.3_1135">mpls.tcl, line 1135</a></dd>
</dl></dd>
</dl>


<h3  class="details-header"><a name="::::SetupSingleOSPFVlanWithPrefix">::::SetupSingleOSPFVlanWithPrefix</a></h3>
<pre class="details-procdef">proc  ::::SetupSingleOSPFVlanWithPrefix { vlan1IP vlanArea portList dutID {vlanName vlan1} {enableOSPF true} {tag {}} {AreaType {}} }</pre>
<dl  class="details-desc">
<dd>#################################################################
 Procedure Name: SetupSingleOSPFVlanWithPrefix

 Description: ospf topology specific proc that is used to setup a single ospf vlan
              for a given area with prefix


 Input args:  vlan1IP, vlanArea, portList, dutID, vlanName, enableOSPF, tag
 Output args: None.
 Return vlaue: none
 Typical usage:
         SetupSingleOSPFVlanWithPrefix 100.101.10.1/24  $area [MapDUTPortId 1] 1 "vlan1"

 Category: Setup
#################################################################
  <dl  class="props" id="proc-props">
<dt>Defined in:</dt>
<dd><a href="mpls.tcl.html#::::SetupSingleOSPFVlanWithPrefix_1253">mpls.tcl, line 1253</a></dd>
</dl></dd>
</dl>

<hr>
<div class="index-selector">
	<a href="index_main.html#byfilename">file name</a> 
 | 
	<a href="index_main.html#byprocname">procedure name</a> 
 | 
	<a href="index_main.html#bycall">procedure call</a> 
 | 
	<a href="index_annot_full.html">annotation</a> 

<br>
<cite>File generated 2018-06-14 at 17:09.</cite>
</div>

</body>
</html>
