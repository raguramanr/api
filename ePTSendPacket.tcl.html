<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/transitional.dtd">
<!-- Generated by TclDoc @@VERSION@@ -->
<html>
<head>
  <title>ePTSendPacket.tcl</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="default.css">
</head>
<body class="src-html">
<div class="index-selector">
<!-- index for tcl source files -->
	Index by: 
	<a href="index_main.html#ePTSendPacket.tcl">file name</a> | 
	<a href="index_main.html#byprocname">procedure name</a> | 
	<a href="index_main.html#bycall">procedure call</a> | 
	<a href="index_annot_full.html">annotation</a>

</div>
<hr>

<p><strong>ePTSendPacket.tcl</strong>&nbsp;&nbsp;<span class="filetype-link">(<a href="ePTSendPacket.tcl-annot.html">annotations</a> | <a href="ePTSendPacket.tcl.txt">original source</a>)</span>
</p>
<pre class="src-code">
<span class="comment-line">##################################################################</span>
<span class="comment-line"># $RCSfile: SendPacket.tcl,v $ - </span>
<span class="comment-line">#</span>
<span class="comment-line"># Copyright (c) 2000 by Extreme Networks Inc.</span>
<span class="comment-line"># </span>
<span class="comment-line"># Revision control history</span>
<span class="comment-line"># ------------------------</span>
<span class="comment-line"># $Header: /export/cvsroot/automation/Lib/SendPacket.tcl,v 2.37.6.38 2010/08/24 01:39:49 ghundertmark Exp $</span>
<span class="comment-line">#</span>
<span class="comment-line"># Extreme Networks modification history</span>
<span class="comment-line"># -------------------------------------</span>
<span class="comment-line"># $Log: SendPacket.tcl,v $</span>
<span class="comment-line"># Revision 2.37.6.38  2010/08/24 01:39:49  ghundertmark</span>
<span class="comment-line"># Merge branch 12_4 to trunk</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.38  2010/08/24 01:39:49  ghundertmark</span>
<span class="comment-line"># Merge branch 12_4 to trunk</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.37  2009/08/27 19:03:20  lagrawal</span>
<span class="comment-line"># merge from dev branch</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.36  2009/07/07 22:39:01  lagrawal</span>
<span class="comment-line"># removed extra empty line causing issue in some procs</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.35.2.5  2010/06/16 05:37:28  nellinivasu</span>
<span class="comment-line"># udfRepeat default value is set to 1.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.35.2.4  2010/05/26 06:02:16  anarayanan</span>
<span class="comment-line"># udfRepeat parameter added for CFM Frame support</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.35.2.3  2009/08/10 08:46:27  rperumal</span>
<span class="comment-line"># Considered vlan tag to calculate ipTotalLength in proc SendIgmpFrame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.35.2.2  2009/07/07 22:37:02  lagrawal</span>
<span class="comment-line"># removed extra empty line causing issue in some procs</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.35.2.1  2009/07/07 21:35:28  lagrawal</span>
<span class="comment-line"># fixed merge issue extra line was causing a issue</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.35  2009/07/01 10:55:46  nellinivasu</span>
<span class="comment-line"># Merged From Branch 'branch-dev_v12-1-rel4'</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.34  2009/06/05 00:25:06  jramarao</span>
<span class="comment-line"># Merged from DEV after May 26 2009</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.33  2009/05/14 18:02:23  lagrawal</span>
<span class="comment-line"># Clean up tcl syntax</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.32  2009/04/14 00:48:47  lagrawal</span>
<span class="comment-line"># merge from dev branch</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.31  2009/03/18 21:48:26  jramarao</span>
<span class="comment-line"># From branch-dev_v12-1-rel4</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.30  2008/11/20 22:59:01  jramarao</span>
<span class="comment-line"># lengthOverride</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.29.2.2  2008/11/24 11:38:11  slakshmanan</span>
<span class="comment-line"># Added TOS, UserPriority and priority to &#34;sendIgmpFrame&#34;</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.29.2.1  2008/10/20 20:04:20  lagrawal</span>
<span class="comment-line"># added lengthOverride to function ixiaConf_2Ports_ip use can set the value true/false to overide length/keep it same when sending packet , override packet simetime is treated as bad packet</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.29.2.6  2009/05/11 20:07:49  mhannon</span>
<span class="comment-line"># backed out last change</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.29.2.5  2009/05/11 19:54:20  mhannon</span>
<span class="comment-line"># added -frameSizeMAX -frameSizeMIN  to biSendFrame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.29.2.4  2009/04/03 09:29:27  lagrawal</span>
<span class="comment-line"># merge from branch-pioneer2_dev-v12-1-rel4 to branch-dev_v12-1-rel4</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.29.2.3  2009/03/31 23:36:13  lagrawal</span>
<span class="comment-line"># merge from branch-pioneer_dev-v12-1-rel4</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.29.2.2.2.2  2009/02/17 21:48:10  ghundertmark</span>
<span class="comment-line"># add protocolTag to enable 88a8 in the ethertype offset another proc.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.29.2.2.2.1  2009/02/17 21:43:19  ghundertmark</span>
<span class="comment-line"># add protocolTag to enable 88a8 in the ethertype offset.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.29.2.2  2008/11/24 11:38:11  slakshmanan</span>
<span class="comment-line"># Added TOS, UserPriority and priority to &#34;sendIgmpFrame&#34;</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.29.2.1  2008/10/20 20:04:20  lagrawal</span>
<span class="comment-line"># added lengthOverride to function ixiaConf_2Ports_ip use can set the value true/false to overide length/keep it same when sending packet , override packet simetime is treated as bad packet</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.29  2008/09/19 22:29:26  lagrawal</span>
<span class="comment-line"># merge from fixes</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.28  2008/08/05 03:44:05  lagrawal</span>
<span class="comment-line"># Add option to skip the default ipTotalLength calculation in SendIgmpFrame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.27.4.1  2008/05/21 12:20:23  nellinivasu</span>
<span class="comment-line"># Added ipTotalLength to the proc SendIgmpFrame.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.27  2008/04/29 06:27:43  nellinivasu</span>
<span class="comment-line"># srcIpMask &amp; dstIpMask options added in proc SendIgmpFrame.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.26  2008/01/04 00:44:09  achilukuri</span>
<span class="comment-line"># Added variable ZeroStats to get the correct tx-Tx pkts count when simultaneously tx  and rx from 2 ports</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.25  2007/10/11 22:23:11  achilukuri</span>
<span class="comment-line"># Added dataPattern option to SendIgmpFrame proc</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.24  2007/03/02 10:20:15  nellinivasu</span>
<span class="comment-line"># Modified proc SendArpFrame to support destHwAddr in ARP payload.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.23  2007/01/25 19:26:09  achilukuri</span>
<span class="comment-line"># Release  Q3FY07_11.6 Phase 1 commit</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.21.2.1  2007/01/24 13:11:55  aprakasham</span>
<span class="comment-line"># Added UDF options to Proc SendArpframe</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.22  2007/01/19 22:30:43  jramarao</span>
<span class="comment-line"># SendArpRequest procedure corrected</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.21.2.1  2007/01/24 13:11:55  aprakasham</span>
<span class="comment-line"># Added UDF options to Proc SendArpframe</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.21  2006/12/20 18:49:26  dsuk</span>
<span class="comment-line"># exos-Q2FY07-rel11_5-12202006 release commit</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.20  2006/11/11 00:03:20  skumar</span>
<span class="comment-line"># DHCP changes from Justus</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.19  2006/10/13 18:01:58  skumar</span>
<span class="comment-line"># Added FrameRate option</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.18.2.1  2006/11/01 22:33:07  dsuk</span>
<span class="comment-line"># added frameSizeMIN and frameSizeMAX arguments</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.18  2006/08/25 16:36:20  djain</span>
<span class="comment-line"># Merged from branch 11_4</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.17.2.1  2006/08/23 11:13:14  nellinivasu</span>
<span class="comment-line"># Added sClass in proc SendIpFrame for BGP Graceful restart test cases.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.17  2006/06/30 22:35:33  ghundertmark</span>
<span class="comment-line"># Q4FY06 Release commit</span>
<span class="comment-line">#</span>
<span class="comment-line"># Changes made to debug ixia transmission problem.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.15  2006/05/29 13:19:30  nellinivasu</span>
<span class="comment-line"># Changes made to debug ixia transmission problem.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.14  2006/05/26 12:17:33  nellinivasu</span>
<span class="comment-line"># Changes made to debug ixia transmission problem.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.13  2006/02/15 14:42:08  eyoung</span>
<span class="comment-line"># Modified SendArpRequest to temporarily disable ARP protocol server.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.12  2005/12/21 22:24:18  smohanty</span>
<span class="comment-line"># Commit for Release 12</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.11  2005/11/30 02:26:37  skumar</span>
<span class="comment-line"># Supply srcHwAddr option</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.10.4.1  2005/11/08 01:55:03  dsuk</span>
<span class="comment-line"># added tag parameter to SendDhcpFrame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.10  2005/09/19 21:52:29  skumar</span>
<span class="comment-line"># Fix the dontTx condition</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.9  2005/09/16 02:05:10  skumar</span>
<span class="comment-line"># Added dontTx arg. Default 0. Used for ONLY stream config</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.8  2005/06/29 16:57:54  cshaw</span>
<span class="comment-line"># Release exos-br-10</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.7  2005/03/09 22:21:23  alim</span>
<span class="comment-line"># Add saMode and daMode for SendArpFrame so we can increment</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.6  2004/09/30 00:59:25  mverma</span>
<span class="comment-line"># Exos Rel7 check in.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.5.2.1  2004/09/08 00:27:27  skumar</span>
<span class="comment-line"># Added args for ACL support</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.5  2004/07/28 18:34:49  skumar</span>
<span class="comment-line"># Add udf args to SendIpFrame procs</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.4  2004/06/16 20:09:52  cshaw</span>
<span class="comment-line"># merge from main trunk again for ixOS3.70 stuff</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.52  2004/01/24 01:48:49  mverma</span>
<span class="comment-line"># Add new options, tagMode and tagRepeat to biSendFrame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.51  2003/12/18 02:55:32  skumar</span>
<span class="comment-line"># Set default rxPortId to 0 to avoid messing with rx ports config unnecessarily in SendIpFrame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.50  2003/10/31 16:27:59  skumar</span>
<span class="comment-line"># Make tolernace in SendFrameToOtherPort to be 4%.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.49  2003/08/18 19:35:38  skumar</span>
<span class="comment-line"># Call ixia_groupPorts with addition params needed for ixiaGenMap.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.48  2003/07/25 18:02:58  cshaw</span>
<span class="comment-line"># Merged from br-1-6</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.47  2003/07/13 00:46:00  skumar</span>
<span class="comment-line"># Added better debugability info.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.46.6.1  2003/07/01 22:33:55  cshaw</span>
<span class="comment-line"># Add new options, tagMode and tagRepeat to SendIpFrame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.3  2004/05/03 23:40:32  skumar</span>
<span class="comment-line"># Send Incremental/decremental igmp reports</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.2  2004/04/01 21:57:03  skumar</span>
<span class="comment-line"># Commit as part of release5</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.6.1  2003/08/20 03:20:05  cshaw</span>
<span class="comment-line"># trunk-exos release</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.4.2  2003/07/17 17:08:00  cshaw</span>
<span class="comment-line"># Add new options, tagMode and tagRepeat to SendIpFrame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37.4.1  2003/06/23 21:28:45  cshaw</span>
<span class="comment-line"># Merged in EW trunk</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.46  2003/04/18 19:30:22  autotest</span>
<span class="comment-line"># Changes as taken from br-1-3.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.45.6.1  2003/04/14 19:36:18  autotest</span>
<span class="comment-line"># Add tagmode, tagRepeat and saCount,daCount.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.45  2003/02/06 03:19:33  tquach</span>
<span class="comment-line"># add more option on dhcp frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.44  2002/12/10 22:50:22  skumar</span>
<span class="comment-line"># Merged from br-1-0.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.43.2.4  2002/12/10 21:07:27  skumar</span>
<span class="comment-line"># Put comments, Merged from br-1-0.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.43.2.3  2002/12/05 00:40:06  skumar</span>
<span class="comment-line"># Add dClass for ospf specific tests.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.43.2.2  2002/11/07 19:21:19  tquach</span>
<span class="comment-line"># add new function biSendFrame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.43.2.1  2002/11/05 20:23:33  eyoung</span>
<span class="comment-line"># Modified SendArpRequest to use SaveAndSetProtocolServer and</span>
<span class="comment-line"># RestoreSavedProtocolServer functions.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.43.2.3  2002/12/05 00:40:06  skumar</span>
<span class="comment-line"># Add dClass for ospf specific tests.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.43.2.2  2002/11/07 19:21:19  tquach</span>
<span class="comment-line"># add new function biSendFrame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.43.2.1  2002/11/05 20:23:33  eyoung</span>
<span class="comment-line"># Modified SendArpRequest to use SaveAndSetProtocolServer and</span>
<span class="comment-line"># RestoreSavedProtocolServer functions.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.43  2002/10/29 23:57:31  skumar</span>
<span class="comment-line"># Include sNode in SendIpxFrames call.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.42  2002/10/14 21:12:03  aleu</span>
<span class="comment-line"># give dest ip ($requestIp) in parameters of DisableProtocolServer{} to clean up the addressItem</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.41  2002/09/15 23:52:29  autotest</span>
<span class="comment-line"># added parameter for new flow redirect test cases.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.40  2002/08/27 21:35:06  eyoung</span>
<span class="comment-line"># Enhanced SendIpFrame to allow address counts to be specified when doing MAC or IP address incrementing.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.39  2002/07/29 19:22:53  skumar</span>
<span class="comment-line"># Add headers.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.38  2002/07/19 00:33:27  skumar</span>
<span class="comment-line"># Put a after 500 in SendArpFrame.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37  2002/06/28 17:11:49  aleu</span>
<span class="comment-line"># change rxPort to be same as txPort in SendIgmpFrame{}</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36  2002/05/25 02:04:15  tquach</span>
<span class="comment-line"># put percentage in sendarp</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.35  2002/05/06 21:38:41  aleu</span>
<span class="comment-line"># remove usage of all cardSpeed global var</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.34  2002/04/22 18:01:59  skumar</span>
<span class="comment-line"># Send rxProto for correct l2 learning pkt in SendIpxPacket.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.33  2002/04/10 17:10:35  skumar</span>
<span class="comment-line"># Add startCardNum to sendFrame.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.32  2002/04/01 18:51:15  skumar</span>
<span class="comment-line"># Expose frameRate via SendFrame.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.31  2002/03/28 21:25:24  aleu</span>
<span class="comment-line"># enable tcpConfig{} to set seqNum, syn/fin/ack/rst flags</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.30  2002/03/28 18:21:14  skumar</span>
<span class="comment-line"># Fix dependency with startCardNum.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.29  2002/03/20 19:42:58  tquach</span>
<span class="comment-line"># change function name and code from getframepercentsent to sendframetoother port</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.28  2002/01/22 00:06:42  tquach</span>
<span class="comment-line"># Add arp increment</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.27  2001/12/12 01:00:46  tquach</span>
<span class="comment-line"># Fix problem with learning address</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.26  2001/12/06 19:49:47  tnguyen</span>
<span class="comment-line"># Add some options needed in new performance module</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.25  2001/09/28 20:50:41  aleu</span>
<span class="comment-line"># remove redundent calls in GetFramePercentSent()</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.24  2001/09/12 23:21:07  tquach</span>
<span class="comment-line"># Add UDF feature</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.23  2001/07/19 22:27:55  skumar</span>
<span class="comment-line"># Changes in SendIpxPacket in order to fix udf problem on IXIA GBIC.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.22  2001/06/20 00:04:03  Autotest</span>
<span class="comment-line"># Remove bracket</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.21  2001/06/18 21:56:03  Autotest</span>
<span class="comment-line"># Add tagpriority</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.20  2001/06/10 01:36:44  skumar</span>
<span class="comment-line"># Added a new function SendFrameFromMultiplePorts.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.19  2001/06/07 00:51:03  skumar</span>
<span class="comment-line"># Minor arg additions to various calls.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.18  2001/06/06 21:06:17  Autotest</span>
<span class="comment-line"># Add comment</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.17  2001/05/04 19:59:05  tquach</span>
<span class="comment-line"># Send some initial package before collect information</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.16  2001/05/03 01:20:45  tquach</span>
<span class="comment-line"># Add getframepercentsent function</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.15  2001/04/13 23:00:20  skumar</span>
<span class="comment-line"># Put the direction 1Way in SendIpx...</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.14  2001/03/21 18:25:07  aleu</span>
<span class="comment-line"># add frameSizeType stream option in SendIpFrame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.13  2001/02/16 23:35:03  aleu</span>
<span class="comment-line"># *** empty log message ***</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.12  2001/01/14 02:26:54  tquach</span>
<span class="comment-line"># Add DHCP procedure</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.9  2000/11/21 01:25:28  skumar</span>
<span class="comment-line"># Changed the direction flag to be &#34;2Way&#34; in sendIpx.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.8  2000/11/03 23:14:30  tnguyen</span>
<span class="comment-line"># Add info message</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.7  2000/10/25 18:49:29  skumar</span>
<span class="comment-line"># Added SendGnsRequests related to IPX suite.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.6  2000/09/24 22:59:01  skumar</span>
<span class="comment-line"># Added proper SendLearn flag based on rxPortId value, added SendIpxFrames.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.5  2000/09/12 22:58:26  tnguyen</span>
<span class="comment-line"># Add special logic to response to arp request with unicast dest mac address</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.4  2000/08/13 18:25:05  tnguyen</span>
<span class="comment-line"># Add goodCheckSum option to SendIgmpFrame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.3  2000/08/10 22:06:13  skumar</span>
<span class="comment-line"># Fixed default option to &#34;destMac&#34; and added ipOptions in SendIpFrame.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.2  2000/08/04 22:25:32  tnguyen</span>
<span class="comment-line"># Global change of commonly used funtions to conform with new conventions</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.1  2000/08/04 18:26:13  tnguyen</span>
<span class="comment-line"># Initial uncommented version</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">##################################################################</span>

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: SendFrame</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: Sends mac frame from a txPortId to rxPortId</span>
<span class="comment-line">#     </span>
<span class="comment-line">#     </span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: txPortId, rxPortId, protocol, protocol, sourceMac, destMac, numFrames</span>
<span class="comment-line">#             frameSize, frameSizeType, dataPattern, streamType, fcsError, saMode, daMode</span>
<span class="comment-line">#             percentage, tag, tagPriority, frameRate</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#             SendFrame $txPortId</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: SendTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::SendFrame_402">proc <a href="ePTSendPacket.tcl-annot.html#::::SendFrame">::::SendFrame</a></a></strong> {args} {
<span class="comment-line">#puts &#34;----Enter into SendFrame --------------&#34;  </span>
 <a name="::parse_args(1)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> SendFrame $args {
      txPortId &#34;1&#34;
      rxPortId &#34;0&#34;
      <a name="::protocol(1)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a> &#34;mac&#34;
      sourceMac &#34;default&#34;
      destMac &#34;default&#34;
      numFrames &#34;1&#34;
      frameSize &#34;64&#34;
      frameSizeType &#34;sizeFixed&#34;
      frameSizeMAX &#34;1518&#34;
      frameSizeMIN &#34;64&#34;
      dataPattern &#34;1234&#34;
      ethernetType &#34;noType&#34;
      frameType &#34;08 00&#34;
      streamType &#34;stopStream&#34;
      fcsError &#34;good&#34;
      saMode &#34;idle&#34;
      daMode &#34;idle&#34;
      saCount &#34;&#34;
      daCount &#34;&#34;
      percentage &#34;100&#34;
      tag &#34;none&#34;
      tagPriority &#34;0&#34;	      
      protocolTagId &#34;null&#34;
      frameRate &#34;null&#34;
      tagMode &#34;vIdle&#34;
      tagRepeat 1
      udfEnable &#34;false&#34;
      udfInitval &#34;00&#34;
      udfOffset &#34;0&#34;
      udfCountertype &#34;c8&#34;
      udfContinuousCount &#34;false&#34;
      udfRepeat &#34;1&#34;
      protoOffsetEnable &#34;false&#34;
      protoOffset &#34;14&#34;
      userDefTag &#34;&#34;
      dontTx &#34;0&#34;
      ZeroStats &#34;yes&#34;
   }
   global portMappingList

   set portList [lindex $portMappingList [expr $txPortId-1]]
   <a name="::result_debug(1)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;INFO: DUT[lindex $portList 2] [lindex $portList 1] ingresses from portId [lindex $portList 0]&#34;

   
   global portMappingList

   set portList [lindex $portMappingList [expr $txPortId-1]]
   <a name="::result_debug(2)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;INFO: DUT[lindex $portList 2] [lindex $portList 1] ingresses from portId [lindex $portList 0]&#34;
<span class="comment-line">#puts &#34;--------------------------- l1 -----------------------------&#34; </span>
  <a name="::MapIxiaPortId(1)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $txPortId txChasisId txCard txPort
<span class="comment-line">#puts &#34;--------------------------- l2 -----------------------------&#34; </span>
   if {$rxPortId == 0} {
      set sendLearn &#34;false&#34;
      set rxPort [<a name="::MapIxiaPortId(2)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $txPortId rxChasisId rxCard rxPo]
   } else {
      set sendLearn &#34;true&#34;
      <a name="::MapIxiaPortId(3)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $rxPortId rxChasisId rxCard rxPort
   }
   
<span class="comment-line">#puts &#34;--------------------------- l3 -----------------------------&#34; </span>
   set numIxiaCd [<a name="::::GetNumIxiaCd(1)"><a href="./SystemSetup.tcl.html#::::GetNumIxiaCd_546">::::GetNumIxiaCd</a></a> $txPortId]
<span class="comment-line">#puts &#34;--------------------------- l4 -----------------------------&#34; </span>
   
   if {$tag != &#34;none&#34; } { set wTag &#34;true&#34; } else {set wTag &#34;false&#34; }
   global startCardNum
   set frameSent [<a name="::ixiaConf_2Ports(1)"><a href="./ePTTx.tcl.html#::ixiaConf_2Ports_690">::ixiaConf_2Ports</a></a> -numIxiaCd $numIxiaCd -rate $frameRate \
                  -txChas $txChasisId -txCard $txCard -txPort $txPort -startCardNum $startCardNum \
                  -rxChas $rxChasisId -rxCard $rxCard -rxPort $rxPort -sendLearn $sendLearn \
                  -protocol $protocol -numFrames $numFrames -frameSize $frameSize -frameSizeType $frameSizeType \
                  -frameSizeMAX $frameSizeMAX -frameSizeMIN $frameSizeMIN \
                  -dataPattern $dataPattern -streamType $streamType -fcsError $fcsError \
		  -frameType $frameType -ethernetType $ethernetType -protocolTagId $protocolTagId \
                  -inSaMac $sourceMac -saMode $saMode -inDaMac $destMac -daMode $daMode \
                  -percentage $percentage -wTag $wTag -tagNo $tag -tagPriority $tagPriority \
                  -tagMode $tagMode -tagRepeat $tagRepeat -saCount $saCount -daCount $daCount \
		  -udfEnable $udfEnable -udfInitval $udfInitval -udfOffset $udfOffset -dontTx $dontTx \
                  -udfRepeat $udfRepeat \
		  -udfCountertype $udfCountertype -udfContinuousCount $udfContinuousCount -protoOffsetEnable $protoOffsetEnable -protoOffset $protoOffset \
          -userDefTag $userDefTag -ZeroStats $ZeroStats]
  if {$streamType != &#34;contPacket&#34; &amp;&amp; $numFrames &gt; 100 &amp;&amp; $dontTx==0} {
    <a name="::ixiaCheckTxDone(1)"><a href="./ePTMisc.tcl.html#::ixiaCheckTxDone_334">::ixiaCheckTxDone</a></a> $txChasisId $txCard $txPort $numFrames $txPortId
  }
  return $frameSent            
}



<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: SendFrameFromMultiplePorts</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: Used to send uni/bi directional mac frames in a number of paired ports.</span>
<span class="comment-line">#     </span>
<span class="comment-line">#     </span>
<span class="comment-line"># Input args:</span>
<span class="comment-line">#      - &lt;txPortId&gt;   - Sending ixia portId</span>
<span class="comment-line">#      - &lt;rxPortId&gt;   - Receiving ixia portId</span>
<span class="comment-line">#      - &lt;direction&gt;  - direction of the mac traffic flow &#34;1Way&#34;/&#34;2Way&#34;</span>
<span class="comment-line">#      - &lt;numFrames&gt;  - Number of mac frames to be sent</span>
<span class="comment-line">#      - &lt;protocol&gt;   - protocol to be used to send mac frames (default mac but sometimes usr specified for protocol based vlan)</span>
<span class="comment-line">#      - &lt;frameSize&gt;  - frame size to be used default 64</span>
<span class="comment-line">#      - &lt;frameSizeType&gt;    - frame size type fixed or random (sizeFixed/sizeRandom)</span>
<span class="comment-line">#      - &lt;dataPattern&gt;   - data pattern to be used to pad</span>
<span class="comment-line">#      - &lt;destIp&gt;     - destination IP address           </span>
<span class="comment-line">#      - &lt;numFrames&gt;  - how many to send</span>
<span class="comment-line">#      - &lt;streamType&gt; - type of the stream stopStream/contStream...</span>
<span class="comment-line">#      - &lt;fcsError&gt; - fcsError in the ixia frame send</span>
<span class="comment-line">#      - &lt;saMode&gt;     - source side sending mode</span>
<span class="comment-line">#      - &lt;daMode&gt;     - receive side sending mode</span>
<span class="comment-line">#      - &lt;percentage&gt; - percentage of the line rate to be sent default 100</span>
<span class="comment-line">#      - &lt;tag&gt;        - tag value to be used if tagged vlan</span>
<span class="comment-line">#      - &lt;applyFilter&gt; - flag to indicate if filter/filterPallette to be applied on the receiving buffer</span>
<span class="comment-line">#</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: Retruns the frame sent</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#             SendFrameFromMultiplePorts $txPortId $rxPortId</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: SendTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::SendFrameFromMultiplePorts_526">proc <a href="ePTSendPacket.tcl-annot.html#::::SendFrameFromMultiplePorts">::::SendFrameFromMultiplePorts</a></a></strong> {args} {
   <a name="::parse_args(2)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> SendFrame $args {
      txPortId &#34;1&#34;
      rxPortId &#34;2&#34;
      direction &#34;1Way&#34;
      numFrames &#34;1&#34;
      <a name="::protocol(2)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a> &#34;mac&#34;
      frameSize &#34;64&#34;
      frameSizeType &#34;sizeFixed&#34;
      dataPattern &#34;1234&#34;
      streamType &#34;stopStream&#34;
      fcsError &#34;good&#34;
      saMode &#34;idle&#34;
      daMode &#34;idle&#34;
      percentage &#34;100&#34;
      tag &#34;none&#34;
      applyFilter &#34;0&#34;
      dontTx &#34;0&#34;
   }
   
   <a name="::MapIxiaPortId(4)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $txPortId txChasisId txCard txPort
   <a name="::MapIxiaPortId(5)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $rxPortId rxChasisId rxCard rxPort

   set sendLearn &#34;true&#34;
   set numIxiaCd [<a name="::::GetNumIxiaCd(2)"><a href="./SystemSetup.tcl.html#::::GetNumIxiaCd_546">::::GetNumIxiaCd</a></a> $rxPortId] 
   if {$tag != &#34;none&#34; } { set wTag &#34;true&#34; } else {set wTag &#34;false&#34; }
  
   if {$txCard &lt;= $rxCard} {set startCardNum $txCard} else {set startCardNum $rxCard}
   
   <a name="::ixiaConf_groupPorts(1)"><a href="./ePTTx.tcl.html#::ixiaConf_groupPorts_461">::ixiaConf_groupPorts</a></a> -numIxiaCd $numIxiaCd -startCardNum $startCardNum -txPortId $txPortId -rxPortId $rxPortId \
                       -sendLearn $sendLearn -applyFilter $applyFilter -protocol $protocol \
                       -numFrames $numFrames -frameSize $frameSize -frameSizeType $frameSizeType \
                       -dataPattern $dataPattern -streamType $streamType -fcsError $fcsError \
                       -saMode $saMode -daMode $daMode -dontTx $dontTx \
                       -percentage $percentage -wTag $wTag -tagNo $tag

  if {$streamType != &#34;contPacket&#34; &amp;&amp; $numFrames &gt; 100 &amp;&amp; $dontTx==0} {
    <a name="::ixiaCheckTxDone(2)"><a href="./ePTMisc.tcl.html#::ixiaCheckTxDone_334">::ixiaCheckTxDone</a></a> $txChasisId $txCard $txPort $numFrames $txPortId
  }    
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: SendIpFrame</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: Used to send ip packets</span>
<span class="comment-line">#     </span>
<span class="comment-line">#     </span>
<span class="comment-line"># Input args: args</span>
<span class="comment-line"># clearStats &#34;yes&#34;. By default the receive stats on the transmitting port will be cleared. Set this option to &#34;no&#34;</span>
<span class="comment-line"># if you don't want the receive stats of the port ot be cleared</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: Retruns the packet sent</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#               set frameSent [SendIpFrame -txPortId 1 -destMac $destmac -sourceIp $srcIp -destIp $destaddr -ttl $ttl];</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: SendTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::SendIpFrame_587">proc <a href="ePTSendPacket.tcl-annot.html#::::SendIpFrame">::::SendIpFrame</a></a></strong> {args} {
   <a name="::parse_args(3)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> SendIpFrame $args {
     <a name="::protocol(3)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a> &#34;ip&#34;
     txPortId &#34;1&#34;
     rxPortId &#34;0&#34;
     sourceMac &#34;default&#34;
     destMac &#34;00 E0 2B 00 00 01&#34;
     sourceIp &#34;127.0.0.1&#34;
     destIp &#34;127.0.0.1&#34;
     gatewayIp &#34;127.0.0.1&#34;
     dIpMask &#34;255.255.255.0&#34;
     sIpMask &#34;255.255.255.0&#34;
     dClass &#34;classC&#34;
     sClass &#34;classC&#34;
     sourcePort &#34;00&#34;
     destPort &#34;00&#34;
     ttl &#34;64&#34;
     goodChecksum &#34;true&#34;
     numFrames &#34;1&#34;
     frameSize &#34;64&#34;
     frameSizeType &#34;sizeFixed&#34;
     frameSizeMAX &#34;1518&#34;
     frameSizeMIN &#34;64&#34;
     ipOptions &#34;&#34;
     frameRate &#34;default&#34;
     frameType &#34;08 00&#34;
     dataPattern &#34;0000&#34;
     streamType &#34;stopStream&#34;
     fcsError &#34;good&#34;
     tag &#34;none&#34;
     tagMode &#34;vIdle&#34;
     tagRepeat &#34;1&#34;
     protocolTagId &#34;null&#34;
     TOS &#34;default&#34;
     userPriority &#34;0&#34;
     percentage &#34;100&#34;
     priority &#34;0&#34;
     saMode &#34;idle&#34;
     daMode &#34;idle&#34;
     saCount &#34;&#34;
     daCount &#34;&#34;
     ipSaMode &#34;ipIdle&#34;
     ipDaMode &#34;ipIdle&#34;
     ipSaCount &#34;&#34;
     ipDaCount &#34;&#34;
     dontFrag &#34;true&#34;
     tcpSynFlag &#34;false&#34;
     tcpFinFlag &#34;false&#34;
     tcpRstFlag &#34;false&#34;
     tcpAckFlag &#34;false&#34;
     tcpPushFlag &#34;false&#34;
     tcpUrgFlag &#34;false&#34;
     tcpSeqNum &#34;0&#34;
     type &#34;8&#34;
     code &#34;0&#34;
     id &#34;0&#34;
     sequence &#34;00000000&#34;
     direction &#34;1Way&#34;
     maxResponseTime &#34;100&#34;
     groupAddr &#34;224.0.0.1&#34;
     applyFilter &#34;0&#34;
     udfEnable &#34;false&#34;
     udfInitval &#34;00&#34;
     udfOffset &#34;0&#34;
     udfCountertype &#34;c8&#34;
     udfContinuousCount &#34;false&#34;
     protoOffsetEnable &#34;false&#34;
     protoOffset &#34;14&#34;
     userDefTag &#34;&#34;
     clearStats &#34;yes&#34;
     dontTx &#34;0&#34;
   }
   
   set numIxiaCd [<a name="::::GetNumIxiaCd(3)"><a href="./SystemSetup.tcl.html#::::GetNumIxiaCd_546">::::GetNumIxiaCd</a></a> $txPortId]
   <a name="::MapIxiaPortId(6)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $txPortId chasisId card port
   if {$rxPortId==0} {
      set rxPortId $txPortId
   }
   <a name="::MapIxiaPortId(7)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $rxPortId ch c rxPort
   global portMappingList

   set portList [lindex $portMappingList [expr $txPortId-1]]
   <a name="::result_debug(3)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;INFO: DUT[lindex $portList 2] [lindex $portList 1] ingresses from portId [lindex $portList 0]&#34;
   if {$tag != &#34;none&#34; } { set wTag &#34;true&#34; } else {set wTag &#34;false&#34; }
   global startCardNum
   set frameSent [<a name="::ixiaConf_2Ports_ip(1)"><a href="./ePTL3Tx.tcl.html#::ixiaConf_2Ports_ip_867">::ixiaConf_2Ports_ip</a></a> -numIxiaCd $numIxiaCd \
              -txChas $chasisId -txCard $card -txPort $port -startCardNum $startCardNum \
              -rxChas $ch -rxCard $c -rxPort $rxPort -frameType $frameType \
              -ipProtocol $protocol -sMacAddr $sourceMac -dMacAddr $destMac \
              -sIpAddr $sourceIp -dIpAddr $destIp -dDutIpAddr $gatewayIp -ttl $ttl \
              -pSrcPort $sourcePort -pDstPort $destPort -frameSizeType $frameSizeType \
              -frameSizeMAX $frameSizeMAX -frameSizeMIN $frameSizeMIN \
	      -goodChecksum $goodChecksum -numFrames $numFrames -frameSize $frameSize \
	      -frameRate $frameRate -dataPattern $dataPattern -streamType $streamType \
	      -fcsError $fcsError -wTag $wTag -tagNo $tag -tagNo $tag -tagMode $tagMode -tagRepeat $tagRepeat \
	      -TOS $TOS -userPriority $userPriority -protocolTagId $protocolTagId \
	      -percentage $percentage -priority $priority -ipOptions $ipOptions -direction $direction \
              -saMode $saMode -saCount $saCount -daMode $daMode -daCount $daCount \
              -ipSaMode $ipSaMode -ipSaCount $ipSaCount -ipDaMode $ipDaMode -ipDaCount $ipDaCount \
              -dIpMask $dIpMask sIpMask $sIpMask -dClass $dClass -sClass $sClass \
              -dontFrag $dontFrag -tcpSeqNum $tcpSeqNum -tcpSynFlag $tcpSynFlag -tcpFinFlag $tcpFinFlag \
              -tcpPushFlag $tcpPushFlag -tcpUrgFlag $tcpUrgFlag \
              -tcpRstFlag $tcpRstFlag -tcpAckFlag $tcpAckFlag -sequence $sequence -type $type -code $code \
              -id $id -applyFilter $applyFilter -maxResponseTime $maxResponseTime -groupAddr $groupAddr \
              -udfEnable $udfEnable -udfInitval $udfInitval -udfOffset $udfOffset -udfCountertype $udfCountertype -udfContinuousCount $udfContinuousCount \
              -clearStats $clearStats -dontTx $dontTx \
              -protoOffsetEnable $protoOffsetEnable -protoOffset $protoOffset \
          -userDefTag $userDefTag]
                                  
  if {$streamType != &#34;contPacket&#34; &amp;&amp; $numFrames &gt; 100 &amp;&amp; $dontTx==0} {
    <a name="::ixiaCheckTxDone(3)"><a href="./ePTMisc.tcl.html#::ixiaCheckTxDone_334">::ixiaCheckTxDone</a></a> $chasisId $card $port $numFrames $txPortId
  }  
  return $frameSent           
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: SendGnsRequests</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: Sends IPX GNS request for all ethernet types ethernetII, ieee8023, ieee8022, iee8023snap.</span>
<span class="comment-line">#              Internally calls SendIpxFrames to send GNS request</span>
<span class="comment-line">#     </span>
<span class="comment-line"># Input args: args</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: Retruns the frame sent</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#         set packet [SendGnsRequests -txPortId 1 -dNetwork &#34;00 00 12 37&#34; -etherType ieee8022 -sendLearn &#34;true&#34; \</span>
<span class="comment-line">#                     -serverType &#34;00 04&#34;]</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: SendTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::SendGnsRequests_722">proc <a href="ePTSendPacket.tcl-annot.html#::::SendGnsRequests">::::SendGnsRequests</a></a></strong> {args} {
   <a name="::parse_args(4)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> SendGnsRequests $args {
      txPortId &#34;1&#34;
      dNetwork &#34;00 00 00 00&#34;
      numRequests &#34;1&#34;
      etherType &#34;ethernetII&#34;
      sendLearn &#34;true&#34;
      serverType &#34;4&#34;
      sourceNodeCounterMode &#34;0&#34;
      destNodeCounterMode &#34;0&#34;
   }
   set dNode &#34;FF FF FF FF FF FF&#34;
   set sSocket &#34;socketSap&#34;
   set dSocket &#34;socketSap&#34;
   set udfCounterType &#34;c32&#34;
   regsub -all &#34; &#34; [format %04s [string trimleft $serverType &#34; 0&#34;]] &#34;0&#34; serverType
   set udfInitVal &#34;00 03 [string range $serverType 0 1] [string range $serverType 2 3]&#34;
   switch -- $etherType {
      &#34;ethernetII&#34; -
      &#34;ieee8023&#34; {
         set udfOffset &#34;44&#34;
      }
      &#34;ieee8022&#34; {
         <span class="comment-line"># These changes are required since IXIA Gbic does not support udf on odd numbers</span>
         <span class="comment-line"># Kludge to start udf1 from 46 and udf2 from 50.</span>
         set udfOffset &#34;46&#34;   ;<span class="comment-line"># used to be 47</span>
         set udfInitVal &#34;52 00 03 [string range $serverType 0 1] [string range $serverType 2 3]&#34;
      }
      &#34;ieee8023snap&#34; {
         set udfOffset &#34;52&#34;
      }
      default {
         <a name="::result_debug(4)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;unknown etherType: $etherType&#34;
         return -1;
      }
   }
   set frameSent [<a name="::SendIpxFrames(1)"><a href="./ePTSendPacket.tcl.html#::SendIpxFrames_791">::SendIpxFrames</a></a> -txPortId $txPortId -etherType $etherType \
              -dNetwork $dNetwork -dSocket $dSocket -dNode $dNode -sSocket $sSocket \
              -sendLearn $sendLearn -enableUdf &#34;true&#34; -numFrames $numRequests \
              -sourceNodeCounterMode $sourceNodeCounterMode \
              -destNodeCounterMode $destNodeCounterMode \
              -udfOffset $udfOffset -udfCounterType $udfCounterType -udfInitVal &#34;$udfInitVal&#34;]

   return $frameSent   
}


<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: SendIpxFrames</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: Sends IPX packets for all ethernet types ethernetII, ieee8023, ieee8022, iee8023snap.</span>
<span class="comment-line">#              Internally calls SendIpxFrames to send GNS request</span>
<span class="comment-line">#     </span>
<span class="comment-line"># Input args: args</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: Retruns the frame sent</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#  set packet [SendIpxFrames -txPortId $txPortId -rxPortId 9 -sNetwork &#34;00 00 $txPortNw&#34; \</span>
<span class="comment-line">#               -sSocket &#34;socketRipx&#34;  -dNetwork $ixiaFormattedNw -dNode &#34;00 A3 F1 00 00 01&#34; \</span>
<span class="comment-line">#               -etherType $etherProto -sendLearn &#34;true&#34; \</span>
<span class="comment-line">#               -dSocket &#34;socketRipx&#34; -packetType &#34;typeNcp&#34;]</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: SendTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::SendIpxFrames_791">proc <a href="ePTSendPacket.tcl-annot.html#::::SendIpxFrames">::::SendIpxFrames</a></a></strong> {args} {
   <a name="::parse_args(5)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> SendIpxFrames $args {
      direction &#34;1Way&#34;
      txPortId &#34;1&#34;
      rxPortId &#34;0&#34;
      etherType &#34;ethernetII&#34;
      rxProto &#34;ethernetII&#34;
      sNetwork &#34;00 00 00 00&#34;
      sSocket &#34;4000&#34;
      dNetwork &#34;00 00 00 00&#34;
      sNode &#34;00 00 00 00 00 00&#34;
      dNode &#34;00 00 00 00 00 00&#34;
      dSocket &#34;4000&#34;
      packetType &#34;typeUnknown&#34;
      numFrames &#34;1&#34;
      frameSize &#34;64&#34;
      frameRate &#34;default&#34;
      dataPattern &#34;0000&#34;
      streamType &#34;stopStream&#34;
      fcsError &#34;good&#34;
      tag &#34;none&#34;
	   tagCfi &#34;resetCFI&#34;
      tagMode &#34;vIdle&#34;
	   tagRepeat &#34;1&#34;
	   userPriority &#34;0&#34;
      percentage &#34;100&#34;
      priority &#34;0&#34;
      sendLearn &#34;true&#34;
      saMode &#34;idle&#34;
      daMode &#34;idle&#34;
      chid &#34;1&#34;
      enableUdf &#34;false&#34;
      udfOffset &#34;52&#34;
      udfCounterType &#34;c32&#34;
      udfInitVal &#34;08 00&#34;
      sourceNodeCounterMode &#34;0&#34;
      destNodeCounterMode &#34;0&#34;

   }

   if {$tag != &#34;none&#34; } { set wTag &#34;true&#34; } else {set wTag &#34;false&#34; }
   set frameSent [<a name="::ixia_SendIpxPackets(1)"><a href="./IpxUtil.tcl.html#::ixia_SendIpxPackets_288">::ixia_SendIpxPackets</a></a> -direction $direction -txPortId $txPortId -rxPortId $rxPortId \
              -etherType $etherType -sNetwork $sNetwork -sSocket $sSocket -sNode $sNode \
              -dNetwork $dNetwork -dSocket $dSocket -dNode $dNode -rxProto $rxProto \
              -packetType $packetType -numFrames $numFrames -frameSize $frameSize \
              -frameRate $frameRate -dataPattern $dataPattern -streamType $streamType \
              -fcsError $fcsError -wTag $wTag -tagNo $tag -tagCfi $tagCfi \
              -sourceNodeCounterMode $sourceNodeCounterMode \
              -destNodeCounterMode $destNodeCounterMode \
              -tagMode $tagMode -tagRepeat $tagRepeat -userPriority $userPriority \
              -percentage $percentage -priority $priority -sendLearn $sendLearn \
              -saMode $saMode -daMode $daMode -chid $chid -enableUdf $enableUdf \
              -offset $udfOffset -counterType $udfCounterType -initVal $udfInitVal]
  return $frameSent
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: SendIgmpFrame</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: Sends IGMP join/leave packet based on argument type</span>
<span class="comment-line">#</span>
<span class="comment-line">#     </span>
<span class="comment-line"># Input args: args</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: Retruns the frame sent</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#        set frameSent [SendIgmpFrame -txPortId $txPortId -type $joinGroup -destMac $destMacMulticast \</span>
<span class="comment-line">#                        -sourceIp $clientIP1   -destIp $multicastIP -groupAddr $multicastIP ]</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: SendTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::SendIgmpFrame_867">proc <a href="ePTSendPacket.tcl-annot.html#::::SendIgmpFrame">::::SendIgmpFrame</a></a></strong> {args} {
   <a name="::parse_args(6)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> SendIgmpFrame $args {
     txPortId &#34;1&#34;
     sourceMac &#34;default&#34;
	  destMac &#34;default&#34;
	  sourceIp &#34;127.0.0.1&#34;
	  destIp &#34;127.0.0.1&#34;
	  ttl &#34;1&#34;
            TOS &#34;default&#34;
            priority &#34;0&#34;
            userPriority &#34;0&#34;
     numFrames &#34;1&#34;
     frameSize &#34;64&#34;
     dontFrag &#34;true&#34;
     ipTotalLength &#34;default&#34;
     ipDaMode &#34;ipIdle&#34;
     ipDaCount &#34;&#34;
	  tag &#34;none&#34;
	  type &#34;22&#34;
	  maxResponseTime &#34;64&#34;
	  groupAddr &#34;224.0.0.1&#34;
        igmpMode &#34;Fixed&#34;
        igmpRepeatCount &#34;&#34;
	  goodChecksum &#34;true&#34;
     streamType &#34;stopStream&#34;
     frameRate &#34;default&#34;
     udfEnable &#34;false&#34;
     udfInitval &#34;00&#34;
     udfOffset &#34;0&#34;
     udfCountertype &#34;c8&#34;
     udfContinuousCount &#34;false&#34;
     dataPattern &#34;0000&#34;	 
     srcIpMask &#34;255.255.255.0&#34;
     dstIpMask &#34;255.255.255.0&#34; 
     lengthOverride &#34;&#34;
   }
   global portMappingList

   if {$ipTotalLength == &#34;default&#34;} {
       if {$tag!=&#34;none&#34;} {
       set MACHeaderLength &#34;22&#34;
       } else {
       set MACHeaderLength &#34;18&#34;
       }
       set ipTotalLength [expr $frameSize - $MACHeaderLength]
   }


   set portList [lindex $portMappingList [expr $txPortId-1]]
   <a name="::result_debug(5)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;INFO: DUT[lindex $portList 2] [lindex $portList 1] ingresses from portId [lindex $portList 0]&#34;
   <a name="::result_debug(6)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Sending a igmp ($type) on portId $txPortId to group $destIp&#34;
   if {$destMac == &#34;default&#34;} {
      set destMac [<a name="::GetMulticastMac(1)"><a href="./misc.tcl.html#::GetMulticastMac_605">::GetMulticastMac</a></a> $destIp]
   }
   set numIxiaCd [<a name="::::GetNumIxiaCd(4)"><a href="./SystemSetup.tcl.html#::::GetNumIxiaCd_546">::::GetNumIxiaCd</a></a> $txPortId]
   <a name="::MapIxiaPortId(8)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $txPortId chasisId card port
   if {$tag != &#34;none&#34; } { set wTag &#34;true&#34; } else {set wTag &#34;false&#34; }
   global startCardNum
   set frameSent [<a name="::ixiaConf_2Ports_ip(2)"><a href="./ePTL3Tx.tcl.html#::ixiaConf_2Ports_ip_867">::ixiaConf_2Ports_ip</a></a> -numIxiaCd $numIxiaCd \
              -txChas $chasisId -txCard $card -txPort $port -startCardNum $startCardNum \
              -rxChas $chasisId -rxCard $card -rxPort $port -streamType $streamType \
              -ipProtocol &#34;igmp&#34; -sMacAddr $sourceMac -dMacAddr $destMac -frameRate $frameRate \
              -sIpAddr $sourceIp -dIpAddr $destIp -ttl $ttl -goodChecksum $goodChecksum \
              -ipDaMode $ipDaMode -ipDaCount $ipDaCount -igmpMode $igmpMode -igmpRepeatCount $igmpRepeatCount \
	      -numFrames $numFrames -frameSize $frameSize -wTag $wTag -tagNo $tag -type $type -dataPattern $dataPattern \
              -maxResponseTime $maxResponseTime -groupAddr $groupAddr -ipTotalLength $ipTotalLength \
              -dontFrag $dontFrag -sIpMask $srcIpMask -dIpMask $dstIpMask\
           -udfEnable $udfEnable -udfInitval $udfInitval -udfOffset $udfOffset -udfCountertype $udfCountertype -udfContinuousCount $udfContinuousCount -lengthOverride $lengthOverride -TOS $TOS -priority $priority -userPriority $userPriority]
   <a name="::result_debug(7)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;IGMPSent: $frameSent&#34;
   return $frameSent
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: SendArpFrame</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: Sends ARP packet from txPortId to rxPortId</span>
<span class="comment-line">#</span>
<span class="comment-line">#     </span>
<span class="comment-line"># Input args: args</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: Retruns the frame sent</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#          set frameSent [SendArpFrame -txPortId $portIdTx -sourceIp $srcIp -destIp $destIp -numFrames $nArpFrames];</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: SendTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::SendArpFrame_959">proc <a href="ePTSendPacket.tcl-annot.html#::::SendArpFrame">::::SendArpFrame</a></a></strong> {args} {
   <a name="::parse_args(7)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> SendArpFrame $args {
     txPortId &#34;1&#34;
     type &#34;arpRequest&#34;
     sourceMac &#34;default&#34;
     destMac &#34;FF FF FF FF FF FF&#34;
     saMode &#34;idle&#34;
     daMode &#34;idle&#34;
     sourceIp &#34;127.0.0.1&#34;
     destIp &#34;127.0.0.1&#34;
     arpSaMode &#34;arpIdle&#34;
     arpDaMode &#34;arpIdle&#34;
     numFrames &#34;1&#34;
     frameSize &#34;64&#34;
     frameRate &#34;default&#34;
     streamType &#34;stopStream&#34;
     srcHwAddr &#34;default&#34;
     destHwAddr &#34;default&#34;
     srcHwAddrMode &#34;arpIdle&#34;
     srcHwAddrRepeat &#34;1&#34;
     destHwAddrMode &#34;arpIdle&#34;
     destHwAddrRepeat &#34;1&#34;
     tag &#34;none&#34;
     arpSaRepeat &#34;1&#34;
     arpDaRepeat &#34;1&#34;
     percentage &#34;0.01&#34;
     udfEnable &#34;false&#34;
     udfInitval &#34;00&#34;
     udfOffset &#34;0&#34;
     udfCountertype &#34;c8&#34;
     udfContinuousCount &#34;false&#34;
     dontTx &#34;0&#34;
   }
   
   global portMappingList

   set portList [lindex $portMappingList [expr $txPortId-1]]
   <a name="::result_debug(8)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;INFO: DUT[lindex $portList 2] [lindex $portList 1] ingresses from portId [lindex $portList 0]&#34;
   set numIxiaCd [<a name="::::GetNumIxiaCd(5)"><a href="./SystemSetup.tcl.html#::::GetNumIxiaCd_546">::::GetNumIxiaCd</a></a> $txPortId]
   set rxPo [<a name="::MapIxiaPortId(9)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $txPortId chasisId card port]
   if {$tag != &#34;none&#34; } { set wTag &#34;true&#34; } else {set wTag &#34;false&#34; }
   global startCardNum
   return [<a name="::ixiaConf_2Ports_arp(1)"><a href="./ePTL3Tx.tcl.html#::ixiaConf_2Ports_arp_582">::ixiaConf_2Ports_arp</a></a> -numIxiaCd $numIxiaCd \
              -txChas $chasisId -txCard $card -txPort $port -startCardNum $startCardNum \
              -rxChas $chasisId -rxCard $card -rxPort $rxPo -frameRate $frameRate \
              -operation $type -sMacAddr $sourceMac -dMacAddr $destMac \
              -sIpAddr $sourceIp -dIpAddr $destIp -numFrames $numFrames \
	      -saMode $saMode -daMode $daMode -srcHwAddr $srcHwAddr -destHwAddr $destHwAddr \
	      -destHwAddrMode $destHwAddrMode -destHwAddrRepeat $destHwAddrRepeat \
	      -wTag $wTag -tagNo $tag -frameSize $frameSize -streamType $streamType \
	      -arpSaMode $arpSaMode -arpDaMode $arpDaMode -percentage $percentage \
	      -arpSaRepeat $arpSaRepeat -arpDaRepeat $arpDaRepeat -srcHwAddrMode $srcHwAddrMode \
              -srcHwAddrRepeat $srcHwAddrRepeat -dontTx $dontTx -udfEnable $udfEnable \
              -udfInitval $udfInitval -udfOffset $udfOffset -udfCountertype $udfCountertype \
              -udfContinuousCount $udfContinuousCount]
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: SendDhcpFrame</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: Sends DHCP frame from txPortId to rxPortId</span>
<span class="comment-line">#</span>
<span class="comment-line">#     </span>
<span class="comment-line"># Input args:</span>
<span class="comment-line">#      - &lt;txPortId&gt;   - Sending portId</span>
<span class="comment-line">#      - &lt;sourceMac&gt;  - source Mac</span>
<span class="comment-line">#      - &lt;destMac&gt;    - destination Mac</span>
<span class="comment-line">#      - &lt;sourceIp&gt;   - source IP address</span>
<span class="comment-line">#      - &lt;destIp&gt;     - destination IP address           </span>
<span class="comment-line">#      - &lt;numFrames&gt;  - how many to send</span>
<span class="comment-line">#      - &lt;streamType&gt; - how to send the frame</span>
<span class="comment-line">#      - &lt;clientHwAddr&gt; - gateway mac</span>
<span class="comment-line">#      - &lt;opcode&gt;     - DHCP code</span>
<span class="comment-line">#      - &lt;optionCodeList&gt; - DHCP option</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: Retruns the frame sent</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#          set frameSent [SendArpFrame -txPortId $portIdTx -sourceIp $srcIp -destIp $destIp -numFrames $nArpFrames];</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: SendTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::SendDhcpFrame_1045">proc <a href="ePTSendPacket.tcl-annot.html#::::SendDhcpFrame">::::SendDhcpFrame</a></a></strong> {args} {
   <a name="::parse_args(8)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> SendDhcpFrame $args {
     txPortId &#34;1&#34;
     sourceMac &#34;default&#34;
     destMac &#34;00 E0 2B 00 00 01&#34;
     sourceIp &#34;127.0.0.1&#34;
     destIp &#34;127.0.0.1&#34;
     sourcePort &#34;68&#34;
     destPort &#34;67&#34;
     numFrames &#34;1&#34;
     streamType &#34;stopStream&#34;
     fcsError &#34;good&#34;
     saMode &#34;idle&#34;
     daMode &#34;idle&#34;
     maxResponseTime &#34;100&#34;
     clientHwAddr &#34;00 00 86 52 55 CB&#34;
     clientIpAddr &#34;0.0.0.0&#34;
     yourIpAddr &#34;0.0.0.0&#34;
     opCode &#34;dhcpBootRequest&#34;
     optionCodeList &#34;{dhcpMessageType dhcpDiscover}&#34;
     tag &#34;none&#34;
     dontTx &#34;0&#34;
   }
   global portMappingList
<span class="comment-line">#     puts &#34;INSIDE SEND DHCP OPTIONS : $optionCodeList&#34;</span>

   set portList [lindex $portMappingList [expr $txPortId-1]]
   <a name="::result_debug(9)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;INFO: DUT[lindex $portList 2] [lindex $portList 1] ingresses from portId [lindex $portList 0]&#34;

   
   global portMappingList

   set portList [lindex $portMappingList [expr $txPortId-1]]
   <a name="::result_debug(10)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;INFO: DUT[lindex $portList 2] [lindex $portList 1] ingresses from portId [lindex $portList 0]&#34;
   set numIxiaCd [<a name="::::GetNumIxiaCd(6)"><a href="./SystemSetup.tcl.html#::::GetNumIxiaCd_546">::::GetNumIxiaCd</a></a> $txPortId]
   set rxPo [<a name="::MapIxiaPortId(10)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $txPortId chasisId card port]
   if {$tag != &#34;none&#34; } { set wTag &#34;true&#34; } else {set wTag &#34;false&#34; }
   global startCardNum
   set frameSent [<a name="::ixiaConf_2Ports_Dhcp(1)"><a href="./ePTL3Tx.tcl.html#::ixiaConf_2Ports_Dhcp_337">::ixiaConf_2Ports_Dhcp</a></a> -numIxiaCd $numIxiaCd \
              -txChas $chasisId -txCard $card -txPort $port -startCardNum $startCardNum \
              -rxChas $chasisId -rxCard $card -rxPort $rxPo \
              -sMacAddr $sourceMac -dMacAddr $destMac -sIpAddr $sourceIp -dIpAddr $destIp \
	      -srcPort $sourcePort -dstPort $destPort -numFrames $numFrames -streamType $streamType -fcsError $fcsError \
	      -saMode $saMode -daMode $daMode -opCode $opCode \
	      -optionCodeList $optionCodeList -clientHwAddr $clientHwAddr \
	      -clientIpAddr $clientIpAddr -yourIpAddr $yourIpAddr -wTag $wTag -tagNo $tag -dontTx $dontTx]
                    
   if {$streamType != &#34;contPacket&#34; &amp;&amp; $numFrames &gt; 100 &amp;&amp; $dontTx==0} {
     <a name="::ixiaCheckTxDone(4)"><a href="./ePTMisc.tcl.html#::ixiaCheckTxDone_334">::ixiaCheckTxDone</a></a> $chasisId $card $port $numFrames $txPortId
   }    
   return $frameSent           
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: SendArpRequest</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: Sends ARP request from ixPortId for a given IP address. It returns the</span>
<span class="comment-line">#              replier mac address</span>
<span class="comment-line">#</span>
<span class="comment-line">#     </span>
<span class="comment-line"># Input args:</span>
<span class="comment-line">#      - &lt;txPortId&gt; - Sending portId</span>
<span class="comment-line">#      - &lt;myIp&gt; - source Ip address</span>
<span class="comment-line">#      - &lt;requestIp&gt; - destination Ip address</span>
<span class="comment-line">#      - &lt;rxPortId&gt; - optional receiving portId. Will enable protocol server</span>
<span class="comment-line">#                     on this port if greater than 0, so it can reply to arp request</span>
<span class="comment-line">#      - &lt;numTries&gt; - maximum number of tries before quiting and return</span>
<span class="comment-line">#  Output Variables:</span>
<span class="comment-line">#      - none</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Value:</span>
<span class="comment-line">#      - return the target MAC address if there is a reply, otherwise</span>
<span class="comment-line">#        &#34;NO_ARP_REPLY&#34;</span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#          set frameSent [SendArpRequest $rxPortId $destIp &#34;194.1.1.1&#34; -numTries &#34;2&#34;];</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: SendTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::SendArpRequest_1127">proc <a href="ePTSendPacket.tcl-annot.html#::::SendArpRequest">::::SendArpRequest</a></a></strong> {txPortId myIp requestIp {tag &#34;none&#34;} {rxPortId 0} {numTries 2} {returnFrame 0}} {
     if { 0 } {
   if {$rxPortId &gt; 0} {
      <span class="comment-line"># Instead of the DUT replying to ARP requests, the caller wants the IXIA to reply.</span>
      <a name="::SaveAndSetProtocolServer(1)"><a href="./ixiaProtSrv.tcl.html#::SaveAndSetProtocolServer_1235">::SaveAndSetProtocolServer</a></a> $rxPortId $requestIp $requestIp ixInfo -arpService true;
   } else {
      <span class="comment-line"># With certain types of IXIA cards (e.g. LM1000T-5 running at 1 Gbps), if a</span>
      <span class="comment-line"># protocol server is enabled, packets destined for that protocol server won't be</span>
      <span class="comment-line"># available in the capture buffer.  Instead, they get returned as &#34;blank&#34; frames</span>
      <span class="comment-line"># to IXIA's TCL HAL.  Since this function relies on ARP replies being in the</span>
      <span class="comment-line"># capture buffer, the ARP protocol server will be temporarily disabled.</span>
      <span class="comment-line">#SaveAndSetProtocolServer $txPortId $requestIp $requestIp ixInfo -arpService false;</span>
      <a name="::SaveAndSetProtocolServer(2)"><a href="./ixiaProtSrv.tcl.html#::SaveAndSetProtocolServer_1235">::SaveAndSetProtocolServer</a></a> $txPortId $myIp  $requestIp ixInfo -arpService false;
   }
}
   <a name="::StartPortsCapture(1)"><a href="./ePTRx.tcl.html#::StartPortsCapture_820">::StartPortsCapture</a></a> $txPortId;
   for {set index 0} {$index &lt; $numTries} { incr index } {
      set frameSent [<a name="::SendArpFrame(1)"><a href="./ePTSendPacket.tcl.html#::SendArpFrame_959">::SendArpFrame</a></a> -txPortId $txPortId -sourceIp $myIp -destIp $requestIp -tag $tag];
      <span class="comment-line"># Ecooper change</span>
      <a name="::result_debug(11)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Sleeping for 500 ms.&#34;;
      after 500;
      <a name="::result_debug(12)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Sending an arp request to $requestIp from $myIp on portId $txPortId:&#34;;
      <a name="::result_debug(13)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$frameSent&#34;;
      set receivedList [<a name="::GetCapturedFrames(1)"><a href="./ePTRx.tcl.html#::GetCapturedFrames_982">::GetCapturedFrames</a></a> $txPortId];
      foreach frameReceived $receivedList {
         <a name="::result_debug(14)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Frames received on portId $txPortId:&#34;;
         <a name="::result_debug(15)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$frameReceived&#34;;
         set messageType [<a name="::GetMessageType(1)"><a href="./MessageDecoding.tcl.html#::GetMessageType_992">::GetMessageType</a></a> $frameReceived];
         if {$messageType == &#34;ARP_REPLY&#34; } {
            <span class="comment-line">#assume the reply is for us</span>
<span class="comment-line">#            RestoreSavedProtocolServer ixInfo;</span>
            set mac [<a name="::GetSourceMacAddress(1)"><a href="./MessageDecoding.tcl.html#::GetSourceMacAddress_40">::GetSourceMacAddress</a></a> $frameReceived];
            <a name="::result_debug(16)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Got an arp reply from $requestIp ($mac) on [expr $index + 1] tries&#34;;
            if {$returnFrame == 1} {
                return $frameReceived;
            } else {
                return $mac;
            }
         } elseif {$messageType == &#34;ARP_REQUEST&#34; } {
            <span class="comment-line">#this is done specifically for multinetting on BD, since the BD</span>
            <span class="comment-line">#will send out and arp request in response to an arp request</span>
            <a name="::result_debug(17)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;SourceIp: [<a name="::GetSourceIPAddress(1)"><a href="./MessageDecoding.tcl.html#::GetSourceIPAddress_411">::GetSourceIPAddress</a></a> $frameReceived] DestIp: [<a name="::GetDestIPAddress(1)"><a href="./MessageDecoding.tcl.html#::GetDestIPAddress_447">::GetDestIPAddress</a></a> $frameReceived]&#34;;
            set mac [<a name="::GetSourceMacAddress(2)"><a href="./MessageDecoding.tcl.html#::GetSourceMacAddress_40">::GetSourceMacAddress</a></a> $frameReceived];
            set frameSent [<a name="::SendArpFrame(2)"><a href="./ePTSendPacket.tcl.html#::SendArpFrame_959">::SendArpFrame</a></a> -txPortId $txPortId -destMac $mac -type &#34;arpReply&#34; \
                          -sourceIp $myIp -destIp $requestIp -tag $tag];
            <a name="::result_debug(18)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Got an arp request. Sending an arp reply to $requestIp:&#34;;
            <a name="::result_debug(19)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$frameSent&#34;;
         }
      }
   }
<span class="comment-line">#   RestoreSavedProtocolServer ixInfo;</span>
   <a name="::result_debug(20)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;No arp reply after $numTries tries for $requestIp&#34;;
   return &#34;NO_ARP_REPLY&#34;;
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: SendFrameToOtherPort</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: Sends IP packets from txPortId to rxPortId and checks for </span>
<span class="comment-line">#              number of packet sent equals number of packet received.</span>
<span class="comment-line">#</span>
<span class="comment-line">#     </span>
<span class="comment-line"># Input args:</span>
<span class="comment-line">#      - &lt;txPortId&gt;   - Sending portId</span>
<span class="comment-line">#      - &lt;rxPortId&gt;   - Receiving portId</span>
<span class="comment-line">#      - &lt;destMac&gt;    - Destination mac address</span>
<span class="comment-line">#      - &lt;sourceIp&gt;   - Source IP Address</span>
<span class="comment-line">#      - &lt;destIp&gt;     - Destination IP Address      </span>
<span class="comment-line">#      - &lt;percentage&gt; - Percentage of the line rate to be sent default 100         </span>
<span class="comment-line">#      - &lt;destPort&gt;   - Port number of destination </span>
<span class="comment-line">#      - &lt;frameSize&gt;  - Size of the package</span>
<span class="comment-line">#  Output Variables:</span>
<span class="comment-line">#      - none</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Value:</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#          SendFrameToOtherPort -txPortId 1 -rxPortId 8 -destMac $dut1mac \</span>
<span class="comment-line">#                     -sourceIp &#34;10.10.1.17&#34; -destIp &#34;10.20.1.2&#34; \</span>
<span class="comment-line">#                     -destPortnumber 80 -frameSize &#34;120&#34; -protocol $protocol</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: SendTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::SendFrameToOtherPort_1215">proc <a href="ePTSendPacket.tcl-annot.html#::::SendFrameToOtherPort">::::SendFrameToOtherPort</a></a></strong> {args} {
   <a name="::parse_args(9)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> SendFrameToOtherPort $args {
      txPortId &#34;1&#34;
      rxPortId &#34;0&#34;
      destMac &#34;default&#34;
      sourceIp &#34;127.0.0.1&#34;
      destIp &#34;127.0.0.1&#34;
      percentage &#34;100&#34;
      destPortnumber &#34;0&#34;
      srcPortnumber &#34;0&#34;
      <a name="::protocol(4)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a> &#34;tcp&#34;
      frameSize &#34;64&#34;
      dataPattern &#34;0102030405&#34;
      flag &#34;no&#34;
   }   

   <span class="comment-line"># ----- Environment variables setup</span>
   global DUTs_info;
   global DUT1_CONNECT;
   global DUT2_CONNECT;

   <span class="comment-line"># ----- Test variables setup</span>
   set txport $txPortId;
   set rxport $rxPortId;

   set dip $destIp;
   set srip $sourceIp; 

   <span class="comment-line"># ----- send a stream of IP frames</span>
   <span class="comment-line"># Send 10,000 frames at the begining because of the problem</span>
   if {$flag == &#34;yes&#34;} {
       set frameSent [<a name="::SendIpFrame(1)"><a href="./ePTSendPacket.tcl.html#::SendIpFrame_587">::SendIpFrame</a></a> -protocol $protocol -txPortId $txport -destMac $destMac \
                  -destIp $dip -sourceIp $srip -dataPattern $dataPattern \
                  -numFrames 10000 -percentage $percentage -destPort $destPortnumber \
                  -sourcePort $srcPortnumber -frameSize $frameSize];                     
      sleep 5
   }
   
   <a name="::ClearPortsStats(1)"><a href="./ePTRx.tcl.html#::ClearPortsStats_951">::ClearPortsStats</a></a> &#34;$txport $rxport&#34;;
   set frameSent [<a name="::SendIpFrame(2)"><a href="./ePTSendPacket.tcl.html#::SendIpFrame_587">::SendIpFrame</a></a> -protocol $protocol -txPortId $txport -destMac $destMac \
                  -destIp $dip -sourceIp $srip -dataPattern $dataPattern \
                  -numFrames 100000 -percentage $percentage -destPort $destPortnumber \
                  -sourcePort $srcPortnumber -frameSize $frameSize];         
   sleep 5;               
   <a name="::result_debug(21)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;frame($protocol) sent: $frameSent&#34;;
   set numSent [<a name="::GetNumFramesSent(1)"><a href="./ePTRx.tcl.html#::GetNumFramesSent_1324">::GetNumFramesSent</a></a> $txport];
   set numRece [<a name="::GetNumFramesReceived(1)"><a href="./ePTRx.tcl.html#::GetNumFramesReceived_1346">::GetNumFramesReceived</a></a> $rxport];

   if {$numSent &gt; $numRece} {
       set diff [expr (100 - (($numRece * 100)/$numSent))];
   } else {
       set diff 0;
   }    
   set percent 4;
   <a name="::result_debug(22)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;No. Sent = $numSent : Received = $numRece : Percent = $diff&#34;;  
   if {$diff &lt;= $percent} {
       <a name="::report_start_test(1)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;No. of sent frames = $numSent and recieved frames = $numRece&#34;;
       <a name="::result_ok(1)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;No. of sent frames = $numSent and recieved frames = $numRece&#34;;
   } else {
       <a name="::report_start_test(2)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;Warning: No. of sent frames &lt;$numSent&gt; is different than recieved frames &lt;$numRece&gt;&#34;;   
       <a name="::result_error(1)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Warning: No. of sent frames &lt;$numSent&gt; is different than recieved frames &lt;$numRece&gt;&#34;;   
   } 
   <a name="::report_end_test(1)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>;
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: biSendFrame</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: Sends bidirectional mac frame from a txPortId to rxPortId</span>
<span class="comment-line">#     </span>
<span class="comment-line"># Input args: txPortId, rxPortId, protocol, protocol, sourceMac, destMac, numFrames</span>
<span class="comment-line">#             frameSize, frameSizeType, dataPattern, streamType, fcsError, saMode, daMode</span>
<span class="comment-line">#             percentage, tag, tagPriority, frameRate</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#             biSendFrame $txPortId</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: SendTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::biSendFrame_1296">proc <a href="ePTSendPacket.tcl-annot.html#::::biSendFrame">::::biSendFrame</a></a></strong> {args} {
   <a name="::parse_args(10)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> SendFrame $args {
      txPortId &#34;1&#34;
      rxPortId &#34;0&#34;
      <a name="::protocol(5)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a> &#34;mac&#34;
      sourceMac &#34;default&#34;
      destMac &#34;default&#34;
      numFrames &#34;1&#34;
      frameSize &#34;64&#34;
      frameSizeType &#34;sizeFixed&#34;
      dataPattern &#34;1234&#34;
      frameType &#34;08 00&#34;
      ethernetType &#34;noType&#34;
      streamType &#34;stopStream&#34;
      fcsError &#34;good&#34;
      saMode &#34;idle&#34;
      daMode &#34;idle&#34;
      saCount &#34;&#34;
      daCount &#34;&#34;
      percentage &#34;100&#34;
      tag &#34;none&#34;
      tagPriority &#34;0&#34;	      
      frameRate &#34;null&#34;
      direction &#34;2Way&#34;
      tagMode &#34;vIdle&#34;
      tagRepeat 1
      dontTx &#34;0&#34;

   }
   
   <a name="::MapIxiaPortId(11)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $txPortId txChasisId txCard txPort
   if {$rxPortId == 0} {
      set sendLearn &#34;false&#34;
      set rxPort [<a name="::MapIxiaPortId(12)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $txPortId rxChasisId rxCard rxPo]
   } else {
      set sendLearn &#34;true&#34;
      <a name="::MapIxiaPortId(13)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $rxPortId rxChasisId rxCard rxPort
   }
   
  set numIxiaCd [<a name="::::GetNumIxiaCd(7)"><a href="./SystemSetup.tcl.html#::::GetNumIxiaCd_546">::::GetNumIxiaCd</a></a> $txPortId]
   
   if {$tag != &#34;none&#34; } { set wTag &#34;true&#34; } else {set wTag &#34;false&#34; }
   global startCardNum
   set frameSent [<a name="::ixiaConf_2Ports(2)"><a href="./ePTTx.tcl.html#::ixiaConf_2Ports_690">::ixiaConf_2Ports</a></a> -numIxiaCd $numIxiaCd -rate $frameRate \
                  -txChas $txChasisId -txCard $txCard -txPort $txPort \
		  -startCardNum $startCardNum -rxChas $rxChasisId \
		  -rxCard $rxCard -rxPort $rxPort -sendLearn $sendLearn \
		  -frameType $frameType -ethernetType $ethernetType \
                  -protocol $protocol -numFrames $numFrames \
		  -frameSize $frameSize -frameSizeType $frameSizeType \
                  -dataPattern $dataPattern -streamType $streamType \
		  -fcsError $fcsError -inSaMac $sourceMac -saMode $saMode \
		  -inDaMac $destMac -daMode $daMode -percentage $percentage \
		  -wTag $wTag -tagNo $tag -tagPriority $tagPriority \
                  -tagMode $tagMode -tagRepeat $tagRepeat -direction $direction \
                  -saCount $saCount -daCount $daCount -dontTx $dontTx ]
   if {$streamType != &#34;contPacket&#34; &amp;&amp; $numFrames &gt; 100 &amp;&amp; $dontTx==0} {
       <a name="::ixiaCheckTxDone(5)"><a href="./ePTMisc.tcl.html#::ixiaCheckTxDone_334">::ixiaCheckTxDone</a></a> $txChasisId $txCard $txPort $numFrames $txPortId
   }
  return $frameSent            
}
</pre>
<hr>
<div class="index-selector">
	<a href="index_main.html#byfilename">file name</a> 
 | 
	<a href="index_main.html#byprocname">procedure name</a> 
 | 
	<a href="index_main.html#bycall">procedure call</a> 
 | 
	<a href="index_annot_full.html">annotation</a> 

<br>
<cite>File generated 2018-06-14 at 17:09.</cite>
</div>

</body>
</html>
