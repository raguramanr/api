<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/transitional.dtd">
<!-- Generated by TclDoc @@VERSION@@ -->
<html>
<head>
  <title>ixiaL3TxIpv6.tcl</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="default.css">
</head>
<body class="src-html">
<div class="index-selector">
<!-- index for tcl source files -->
	Index by: 
	<a href="index_main.html#ixiaL3TxIpv6.tcl">file name</a> | 
	<a href="index_main.html#byprocname">procedure name</a> | 
	<a href="index_main.html#bycall">procedure call</a> | 
	<a href="index_annot_full.html">annotation</a>

</div>
<hr>

<p><strong>ixiaL3TxIpv6.tcl</strong>&nbsp;&nbsp;<span class="filetype-link">(<a href="ixiaL3TxIpv6.tcl-annot.html">annotations</a> | <a href="ixiaL3TxIpv6.tcl.txt">original source</a>)</span>
</p>
<pre class="src-code">

<span class="comment-line"># Procedure Name: ixiaConf_2Ports_ipv6</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#       Set up an ixia port to send IP packets (tcp/udp/icmpv6)</span>
<span class="comment-line"># Input args: args</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#        set frameSent [ixiaConf_2Ports_ipv6 -numIxiaCd $numIxiaCd \</span>
<span class="comment-line">#               -txChas $chasisId -txCard $card -txPort $port          \</span>
<span class="comment-line">#               -startCardNum $startCardNum -rxChas $ch -rxCard $c  \</span>
<span class="comment-line">#               -rxPort $rxPort -ipProtocol $protocol -sMacAddr $sourceMac \</span>
<span class="comment-line">#               -dMacAddr $destMac -sIpAddr $sourceIp -dIpAddr $destIp  \</span>
<span class="comment-line">#               -pSrcPort $sourcePort -pDstPort $destPort  \</span>
<span class="comment-line">#               -frameSizeType $frameSizeType -nHeader $nHeader \</span>
<span class="comment-line">#               -goodChecksum $goodChecksum -numFrames $numFrames \</span>
<span class="comment-line">#               -frameSize $frameSize -frameRate $frameRate        \</span>
<span class="comment-line">#               -dataPattern $dataPattern -streamType $streamType \</span>
<span class="comment-line">#               -fcsError $fcsError -wTag $wTag -tagNo $tag  \</span>
<span class="comment-line">#               -userPriority $userPriority -percentage $percentage  \</span>
<span class="comment-line">#               -priority $priority  -direction $direction -saMode $saMode  \</span>
<span class="comment-line">#               -daMode $daMode -ipSaMode $ipSaMode -ipDaMode $ipDaMode  \</span>
<span class="comment-line">#               -tcpSeqNum $tcpSeqNum -tcpSynFlag $tcpSynFlag             \</span>
<span class="comment-line">#               -tcpFinFlag $tcpFinFlag  -tcpRstFlag $tcpRstFlag  \</span>
<span class="comment-line">#               -tcpAckFlag $tcpAckFlag -sequence $sequence \</span>
<span class="comment-line">#               -type $type -code $code -id $id -applyFilter $applyFilter  \</span>
<span class="comment-line">#               -maxResponseTime $maxResponseTime -groupAddr $groupAddr \</span>
<span class="comment-line">#               -udfEnable $udfEnable -udfInitval $udfInitval -udfOffset $udfOffset \</span>
<span class="comment-line">#               -udfCountertype $udfCountertype ]</span>
<span class="comment-line"># Category: SendTraffic</span>
<span class="comment-line">##################################################################</span>

<strong><a name="::::ixiaConf_2Ports_ipv6_32">proc <a href="ixiaL3TxIpv6.tcl-annot.html#::::ixiaConf_2Ports_ipv6">::::ixiaConf_2Ports_ipv6</a></a></strong> {args} {
	<a name="::parse_args(1)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> ixiaConf_2Ports_ipv6 $args {
      numIxiaCd &#34;1&#34;
      startCardNum &#34;1&#34;
      direction &#34;1Way&#34;
         txChas &#34;1&#34;
         txCard &#34;1&#34;
         txPort &#34;1&#34;
         rxChas &#34;1&#34;
         rxCard &#34;1&#34;
         rxPort &#34;2&#34;
      <span class="comment-line">#ipProtocol &#34;ip&#34;</span>
      ipProtocol &#34;ipV6&#34;
      nHeader &#34;tcp&#34;
      pSrcPort &#34;0&#34;
      pDstPort &#34;0&#34;
      <span class="comment-line">#	sMacAddr &#34;default&#34;</span>
      <span class="comment-line">#  dMacAddr &#34;00 00 00 00 00 02&#34;</span>
      sMacAddr &#34;default&#34;
      dMacAddr &#34;00 e0 2b 00 00 01&#34;
      sIpAddr &#34;3555:5555:6666:6666:7777:7777:8888:8888&#34;
      dIpAddr &#34;FE80:0:0:0:201:3FF:FE00:100&#34;
      dDutIpAddr &#34;default&#34;
      sIpMask &#34;ffff:ffff:ffff:ffff:0000:0000:0000:0000&#34;
      dIpMask &#34;ffff:ffff:ffff:ffff:0000:0000:0000:0000&#34;
      <span class="comment-line">#sClass &#34;classC&#34;</span>
      <span class="comment-line">#dClass &#34;classC&#34;</span>
      <span class="comment-line">#ttl &#34;64&#34;</span>
      <span class="comment-line">#goodChecksum &#34;true&#34;</span>
      <span class="comment-line">#ipOptions &#34;&#34;</span>
      <span class="comment-line">#ipTotalLength &#34;default&#34;</span>
      <span class="comment-line">#TOS &#34;default&#34;</span>
      trafficClass &#34;3&#34;
      flowLabel &#34;0&#34;
      hopLimit &#34;255&#34;
      numFrames &#34;1&#34;
      <span class="comment-line">#frameSize &#34;68&#34;</span>
      frameSize &#34;128&#34;
      frameSizeType &#34;sizeFixed&#34;
      frameRate &#34;default&#34;
      dataPattern &#34;0000&#34;
      <span class="comment-line">#dataPattern &#34;userpattern&#34;</span>
      <span class="comment-line">#frameType &#34;08 00&#34;</span>
      frameType &#34;86 DD&#34;
      streamType &#34;stopStream&#34;
      fcsError &#34;good&#34;
      wTag &#34;false&#34;
      tagNo &#34;002&#34;
      tagCfi &#34;resetCFI&#34;
      tagMode &#34;vIdle&#34;
      tagRepeat &#34;1&#34;
      userPriority &#34;0&#34;
      applyFilter &#34;0&#34;
      percentage &#34;100&#34;
      priority &#34;0&#34;
      <span class="comment-line">#sendArp &#34;false&#34;</span>
      <span class="comment-line">#numArpFrames &#34;2&#34;</span>
      saMode &#34;idle&#34;
      daMode &#34;idle&#34;
      saCount &#34;&#34;
      daCount &#34;&#34;
      <span class="comment-line">#ipSaMode &#34;ipIdle&#34;</span>
      <span class="comment-line">#ipDaMode &#34;ipIdle&#34;</span>
      ipSaMode &#34;ipV6Idle&#34;
      ipDaMode &#34;ipV6Idle&#34;
      ipSaCount &#34;&#34;
      ipDaCount &#34;&#34;
      <span class="comment-line">#dontFrag &#34;true&#34;</span>
      tcpSynFlag &#34;false&#34;
      tcpFinFlag &#34;false&#34;
      tcpRstFlag &#34;false&#34;
      tcpAckFlag &#34;false&#34;
      tcpPushFlag &#34;false&#34;
      tcpUrgFlag &#34;false&#34;
      tcpSeqNum &#34;0&#34;
      type &#34;8&#34;
      code &#34;0&#34;
      id &#34;0&#34;
      sequence &#34;0&#34;
      maxResponseTime &#34;100&#34;
      <span class="comment-line">#igmpMode &#34;Fixed&#34;</span>
      <span class="comment-line">#igmpRepeatCount &#34;&#34;</span>
      <span class="comment-line">#groupAddr &#34;224.0.0.1&#34;</span>
      <span class="comment-line">#ipApplication &#34;ip&#34;	</span>
      <span class="comment-line">#ripCommand &#34;ripRequest&#34;</span>
      <span class="comment-line">#ripVersion &#34;2&#34;</span>
      <span class="comment-line">#ripAuthen &#34;&#34;</span>
      <span class="comment-line">#ripAuthenType &#34;2&#34;</span>
      <span class="comment-line">#ripNumRoute &#34;1&#34;</span>
      <span class="comment-line">#ripRouteFamilyId {2}</span>
      <span class="comment-line">#ripRouteIp {0.0.0.0}</span>
      <span class="comment-line">#ripRouteTag {00}</span>
      <span class="comment-line">#ripRouteMask {0.0.0.0}</span>
      <span class="comment-line">#ripRouteNextHop {0.0.0.0}</span>
      <span class="comment-line">#ripRouteMetric {16}</span>
      chid &#34;1&#34;
      udfEnable &#34;false&#34;
      udfInitval &#34;00&#34;
      udfOffset &#34;0&#34;
      udfCountertype &#34;c8&#34;
      udfContinuousCount &#34;false&#34;
      udfUpdown &#34;uuuu&#34;
      udfRepeat &#34;1&#34;
      udfStep &#34;1&#34;
      clearStats &#34;yes&#34;
      dontTx &#34;0&#34;
      invalidUdpChk &#34;0&#34;
   }

	<a name="::result_debug(1)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;@@@ ixiaConf_2Ports_ipv6: numFrames=$numFrames,\
                             ipDaMode=$ipDaMode, sIpAddr=$sIpAddr&#34;
        
	global spawn_id
	global one2oneArray
	global preambleSize
	<a name="::globalSetDefault(1)"><a href="./ePTUtils.tcl.html#::globalSetDefault_1">::globalSetDefault</a></a>
	protocolStackSetDefault

	set date [clock format [clock seconds] -format &#34;%m-%d-%Y %I.%M.%S%p&#34;]
	<a name="::result_debug(2)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\n*** date=$date&#34;
	set time1 [clock seconds]

	set enableUDF4DVMRP 0
	if {$ipProtocol == &#34;dvmrp&#34; } {
		set ipProtocol &#34;ipV6&#34;
      		set enableUDF4DVMRP 1
	}
	
	set enablepimdm 0
      	if {$ipProtocol == &#34;pim-dm&#34; } {
      		set ipProtocol &#34;ipV6&#34;
      		set enablepimdm 1
   	}

	set patternOffset		30
	set preambleSize		8
	
	<span class="comment-line"># create mapping</span>

	<a name="::map(1)"><a href="./ePTClient.tcl.html#::map_366">::map</a></a> new -type			one2one
	<a name="::map(2)"><a href="./ePTClient.tcl.html#::map_366">::map</a></a> config -type		one2one
	<a name="::map(3)"><a href="./ePTClient.tcl.html#::map_366">::map</a></a> add $txChas $txCard $txPort $rxChas $rxCard $rxPort
	if { $direction == &#34;2Way&#34; } {
		<a name="::map(4)"><a href="./ePTClient.tcl.html#::map_366">::map</a></a> add $rxChas $rxCard $rxPort $txChas $txCard $txPort
	}

	<span class="comment-line">#if { $sendArp == &#34;true&#34; } {</span>
	 <span class="comment-line">#     set numLearnFrames 2</span>
      	 <span class="comment-line">#     learn config -numframes $numLearnFrames</span>
         <span class="comment-line">#     send_arp_frames one2oneArray</span>
        <span class="comment-line"># }</span>


	<span class="comment-line"># Config streams for validation traffic</span>

	set counter	0
    set pList [lsort [array names one2oneArray]]
    <span class="comment-line"># Code to verify that lsort has worked correctly</span>
    set element1 [lindex [split [lindex $pList 0] &#34;,&#34;] 1]
    set element2 [lindex [split [lindex $pList 1] &#34;,&#34;] 1]
    if {$element2 &lt; $element1} {
        set portList &#34;[lindex $pList 1] [lindex $pList 0]&#34;
        puts &#34;------------\nlsort failed!\nSorted List: $pList\nNew portlist: $portList&#34;
    } else {
        set portList $pList
    }
    foreach txMap $portList {
	scan $txMap	&#34;%d,%d,%d&#34; chid c p
	<a name="::port(1)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> get	$chid $c $p
	set txSpeed	[<a name="::port(2)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> cget -speed]
	<a name="::stream(1)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> setDefault
	<a name="::stream(2)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -numFrames	$numFrames
	<a name="::stream(3)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -name		S_${c}_${p}
	<a name="::stream(4)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -framesize	$frameSize
	<span class="comment-line">#random size</span>
	if {$frameSizeType == &#34;sizeRandom&#34;} {
		<a name="::stream(5)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -frameSizeType	$frameSizeType
		<a name="::stream(6)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -frameSizeMAX	1500
		<a name="::stream(7)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -frameSizeMIN	128
	}
	<a name="::decideLoopCount(1)"><a href="./ePTMisc.tcl.html#::decideLoopCount_499">::decideLoopCount</a></a>	$numFrames $streamType
	if { $frameRate == &#34;default&#34; } {
		set frameRate [<a name="::decideFrameRate(1)"><a href="./ePTMisc.tcl.html#::decideFrameRate_423">::decideFrameRate</a></a> $txSpeed $frameSize $percentage]
	} else {
		set percentage [<a name="::decidePercentage(1)"><a href="./ePTMisc.tcl.html#::decidePercentage_471">::decidePercentage</a></a> $txSpeed $frameSize $frameRate]
	}
	<a name="::stream(8)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -rateMode			usePercentRate
	<a name="::stream(9)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -percentPacketRate	$percentage		
	<a name="::result_debug(3)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;@@@ frameRate=$frameRate&#34;

	<span class="comment-line">#set ifg [calculateGap $frameRate $frameSize $preambleSize $txSpeed]</span>

	<a name="::stream(10)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -fcs			$fcsError
<span class="comment-line">#	stream config -ifg                      $ifg</span>
<span class="comment-line">#      	stream config -isg                      $ifg</span>
<span class="comment-line">#      	stream config -ibg                      $ifg</span>
	<a name="::stream(11)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -fir			false
	<a name="::stream(12)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -patternType		nonRepeat
	<a name="::stream(13)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -dataPattern		userpattern 
   <a name="::stream(14)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -pattern        $dataPattern
	<a name="::stream(15)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -frameType		$frameType
	set srcAddr				[<a name="::port(3)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> cget -MacAddress]
	set rxMap				$one2oneArray($txMap)
	scan [join $rxMap]			&#34;%d %d %d&#34; rxch rxc rxp
	<a name="::port(4)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> get				$rxch $rxc $rxp	
	set destAddr				[<a name="::port(5)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> cget -MacAddress]
	<a name="::stream(16)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -saRepeatCounter		$saMode
	<a name="::stream(17)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -daRepeatCounter		$daMode
	if {$saMode != &#34;idle&#34;} {
		if {$saCount == &#34;&#34;} {
			<a name="::stream(18)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -numSA $numFrames
		} else {
			<a name="::stream(19)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -numSA $saCount
		}
	}
	if {$daMode != &#34;idle&#34;} {
		if {$daCount == &#34;&#34;} {
			<a name="::stream(20)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -numDA $numFrames
		} else {
			<a name="::stream(21)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -numDA $daCount
		}
	}
	if { $sMacAddr == &#34;default&#34; } {
		<a name="::stream(22)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -sa $srcAddr
	} else {
		<a name="::stream(23)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -sa $sMacAddr
	}
	if {[llength $dMacAddr]&gt;2} {
		set dMacAdd $dMacAddr
	} else {
		set dMacAdd [lindex $dMacAddr $counter]
	}
	if {$counter==0} {
		if {[llength $dMacAddr]&gt;2} {
			set dMacAddToFilter $dMacAddr
		} else {
			set dMacAddToFilter [lindex $dMacAddr 1]
		}
	 } else {
        	 set dMacAddToFilter [lindex $dMacAddr 0]
      	}

		
	if {[regexp -nocase &#34;01 00 5e&#34; $dMacAddr]} {
		set destAddr $dMacAdd
	}

	<a name="::stream(24)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -da 			$dMacAdd
	<a name="::protocol(1)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a> setDefault
	<a name="::protocol(2)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a> config -ethernetType		ethernetII
	<span class="comment-line">#protocol config -name                  ip</span>
	<a name="::protocol(3)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a> config -name                   ipV6
	<a name="::protocol(4)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a> config -enable802dot1qTag      [lindex $wTag $counter]
	
	<span class="comment-line">#switch $ipApplication {</span>
	<span class="comment-line">#&#34;rip&#34;   { protocol config -appName Rip }</span>
        <span class="comment-line">#&#34;ip&#34; -</span>
        <span class="comment-line">#default { protocol config -appName ip }</span>
        <span class="comment-line">#}</span>

	<a name="::ipV6(1)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a> setDefault
	
	<a name="::ipV6(2)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a> config -trafficClass		$trafficClass
	<a name="::ipV6(3)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a> config -flowLabel			$flowLabel
	<a name="::ipV6(4)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a> config -hopLimit			$hopLimit

	set myDestIpAddr &#34;&#34;
	if { ($chid == $txChas) &amp;&amp; ($c == $txCard) &amp;&amp; ($p == $txPort) } {
		<span class="comment-line">#ip config -sourceClass         $sClass</span>

		<a name="::ipV6(5)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a> config -sourceAddr		$sIpAddr
		<a name="::ipV6(6)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a> config -sourceMask		$sIpMask
		<span class="comment-line">#ip config -destClass  		$dClass</span>
		<a name="::ipV6(7)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a> config -destAddr		$dIpAddr
		<a name="::ipV6(8)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a> config -destMask		$dIpMask
		set myDestIpAddr $dIpAddr
	} else {
		<span class="comment-line">#ip config -sourceClass 	$dClass</span>
		<a name="::ipV6(9)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a> config -sourceAddr		$dIpAddr
		<a name="::ipV6(10)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a> config -sourceMask 	$dIpMask
		<span class="comment-line">#ip config -destClass           $sClass</span>
		<a name="::ipV6(11)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a> config -destAddr		$sIpAddr
		<a name="::ipV6(12)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a> config -destMask		$sIpMask
		set myDestIpAddr $sIpAddr
		
	}
	<a name="::ipV6(13)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a> config -nextHeader                 $nHeader
	<a name="::ipV6(14)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a> config -sourceAddrMode		$ipSaMode
	<a name="::ipV6(15)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a> config -sourceAddrRepeatCount	1
	<a name="::ipV6(16)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a> config -destAddrMode		$ipDaMode
	<a name="::ipV6(17)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a> config -destAddrRepeatCount      	1
        <span class="comment-line"># uncommentd dmacadd</span>
     <span class="comment-line">#	ipV6 config -destMacAddr               $dMacAddr</span>
	<span class="comment-line">#ip config -destDutIpAddr		$dDutIpAddr</span>
	if {$ipSaMode != &#34;ipV6Idle&#34;} {
		if {$ipSaCount == &#34;&#34;} {
			<a name="::ipV6(18)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a> config -sourceAddrRepeatCount $numFrames
		} else {
			<a name="::ipV6(19)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a> config -sourceAddrRepeatCount $ipSaCount
		}
	}

	if {$ipDaMode != &#34;ipV6Idle&#34;} {
		if {$ipDaCount == &#34;&#34;} {
			<a name="::ipV6(20)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a> config -destAddrRepeatCount $numFrames
		} else {
			<a name="::ipV6(21)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a> config -destAddrRepeatCount $ipDaCount
		}
	}

	<span class="comment-line">#ip config -ipProtocol			$ipProtocol</span>
	<span class="comment-line">#ip config -ttl				$ttl</span>
	<span class="comment-line">#ip config -useValidChecksum		$goodChecksum</span>
         <span class="comment-line">#ipV6  config            -enableSourceSyncFromPpp            false	</span>
         <span class="comment-line">#ipV6  config            -enableDestSyncFromPpp              false</span>
	<a name="::ipV6(22)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a>  clearAllExtensionHeaders 

   switch $nHeader {
      &#34;tcp&#34;  { <a name="::tcpConfig(1)"><a href="./ePTL3Tx.tcl.html#::tcpConfig_1477">::tcpConfig</a></a> $chid $c $p $pSrcPort $pDstPort $tcpSeqNum  \
                        $tcpSynFlag $tcpFinFlag \
                        $tcpRstFlag $tcpAckFlag $tcpPushFlag $tcpUrgFlag}
      
      &#34;udp&#34;  { <a name="::udpConfig(1)"><a href="./ePTL3Tx.tcl.html#::udpConfig_1507">::udpConfig</a></a> $chid $c $p $pSrcPort $pDstPort $invalidUdpChk}
      
      &#34;icmpV6&#34; { <a name="::icmp(1)"><a href="./ePTClient.tcl.html#::icmp_1450">::icmp</a></a> setDefault; <a name="::icmpConfig(1)"><a href="./ePTL3Tx.tcl.html#::icmpConfig_1525">::icmpConfig</a></a> $chid $c $p $type $code $id $sequence}
      &#34;58&#34;     { <a name="::icmp(2)"><a href="./ePTClient.tcl.html#::icmp_1450">::icmp</a></a> setDefault; <a name="::icmpConfig(2)"><a href="./ePTL3Tx.tcl.html#::icmpConfig_1525">::icmpConfig</a></a> $chid $c $p $type $code $id $sequence}
   }
<span class="comment-line">######### NOTE: MOVED THIS COMMENTED CODE OUT OF THE SWITCH BECAUSE IT WAS BREAKING THE SWITCH</span>
<span class="comment-line">#               &#34;igmp&#34; { igmpConfig $chid $c $p $groupAddr $type $maxResponseTime \</span>
<span class="comment-line">#                                $igmpMode $igmpRepeatCount</span>
<span class="comment-line">#                 if {$type==18} {</span>
<span class="comment-line">#                       igmp config -version 1</span>
<span class="comment-line">#                       igmp config -maxResponseTime 0</span>
<span class="comment-line">#                       igmp set $chid $c $p</span>
<span class="comment-line">#                 }</span>
<span class="comment-line">#                       }</span>
   <a name="::ipV6(23)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a>  addExtensionHeader 		$nHeader
   
   <a name="::ipV6(24)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a>  set               		$chid $c $p

	<span class="comment-line">#if {$dontFrag == &#34;true&#34; } {</span>
		<span class="comment-line">#ip config -fragment		1</span>
	<span class="comment-line"># } else {</span>
		<span class="comment-line">#ip config -fragment 		0</span>
	<span class="comment-line">#}</span>
	
	<span class="comment-line">#if {[string length $ipOptions]} {</span>
		<span class="comment-line">#ip config -options		$ipOptions</span>
	<span class="comment-line">#}		</span>

	 <span class="comment-line">#if {$TOS != &#34;default&#34; } {</span>
         <span class="comment-line">#          puts &#34;TOS |$TOS|&#34;</span>
         <span class="comment-line">#     set precedence [expr [expr $TOS&amp;0x80]==0x80]   \</span>
                 [expr [expr $TOS&amp;0x40]==0x40][expr [expr $TOS&amp;0x20]==0x20]b
         <span class="comment-line">#     puts &#34;Precedence |$precedence|&#34;</span>
         <span class="comment-line">#     set key(000b) routine</span>
         <span class="comment-line">#     set key(001b) priority</span>
         <span class="comment-line">#     set key(010b) immediate</span>
         <span class="comment-line">#     set key(011b) flash</span>
         <span class="comment-line">#     set key(100b) flashOverride</span>
         <span class="comment-line">#     set key(101b) criticEcp</span>
         <span class="comment-line">#     set key(110b) internetControl</span>
         <span class="comment-line">#     set key(111b) networkControl</span>
         <span class="comment-line">#	if {([expr $TOS &amp; 0x10] == 0x10)} {</span>
         <span class="comment-line">#      	ip config -delay                 1</span>
         <span class="comment-line">#   	} else { ip config -delay           0 }</span>
         <span class="comment-line">#	if {([expr $TOS &amp; 0x08] == 0x08)} {</span>
         <span class="comment-line">#   	ip config -throughput            1</span>
         <span class="comment-line">#  	} else { ip config -throughput      0 }</span>
         <span class="comment-line"># 	if {([expr $TOS &amp; 0x04] == 0x04)} {</span>
         <span class="comment-line">#     	ip config -reliability                        1</span>
         <span class="comment-line">#  	} else { ip config -reliability              0 }</span>
         <span class="comment-line">#	 ip config -precedence                    $key($precedence)</span>
         <span class="comment-line">#       }</span>
         <span class="comment-line">#	if {$ipTotalLength != &#34;default&#34; } {</span>
         <span class="comment-line">#	ip config -lengthOverride &#34;true&#34;</span>
         <span class="comment-line">#	ip config -totalLength  $ipTotalLength</span>
        <span class="comment-line"># 	ip config -identifier 6558 ;#14700</span>
      	<span class="comment-line">#		}</span>

	 <a name="::ipV6(25)"><a href="./ePTClient.tcl.html#::ipV6_1593">::ipV6</a></a> set                                  $chid $c $p




	        
<span class="comment-line">#		 if  { $ipApplication == &#34;rip&#34; } {</span>
<span class="comment-line">#        	rip setDefault</span>
<span class="comment-line">#        	rip config -command     $ripCommand</span>
<span class="comment-line">#        	rip config -version     $ripVersion</span>
<span class="comment-line">#</span>
<span class="comment-line"># #       	ripRoute setDefault</span>
<span class="comment-line">#        	for {set index 0} {$index &lt; $ripNumRoute } {incr index} {</span>
<span class="comment-line">#         	 set routeID [expr $index + 1]</span>
<span class="comment-line">#         	 result_debug &#34;Setting route $routeID to [lindex $ripRouteIp $index]&#34;</span>
<span class="comment-line">#         	 ripRoute config -familyId [lindex $ripRouteFamilyId $index ]</span>
<span class="comment-line">#         	 ripRoute config -routeTag [lindex $ripRouteTag $index ]</span>
<span class="comment-line">#          	ripRoute config -ipAddress [lindex $ripRouteIp $index ]</span>
<span class="comment-line">#         	 ripRoute config -subnetMask [lindex $ripRouteMask $index ]</span>
<span class="comment-line">#          	ripRoute config -nextHop [lindex $ripRouteNextHop $index ]</span>
<span class="comment-line">#         	 ripRoute config -metric [lindex $ripRouteMetric $index ]</span>
<span class="comment-line">#          	ripRoute set $routeID</span>
<span class="comment-line">#        	}</span>
<span class="comment-line"># #      	rip set         $chid $c $p</span>
<span class="comment-line"># #	     }</span>
	
        <a name="::vlan(1)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a>                         setDefault
	<a name="::vlan(2)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> config -cfi			$tagCfi
	<a name="::vlan(3)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> config -mode			$tagMode
	<a name="::vlan(4)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> config -repeat			$tagRepeat
        <a name="::vlan(5)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> config            -maskval                            &#34;0000XXXXXXXXXXXX&#34;
	<a name="::vlan(6)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> config -userPriority  		$userPriority
	
	if {[lindex $wTag $counter]==&#34;true&#34;} {
		<a name="::vlan(7)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> config -vlanID		[lindex $tagNo $counter]
		<a name="::vlan(8)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> set 			$chid $c $p
	}
	
	incr counter
	 <span class="comment-line">#overwrite the ip protocol into igmp protocol, so the datapattern \</span>
         <span class="comment-line"># can go right after the ip header and not after   \</span>
         <span class="comment-line"># igmp header is used igmp directly</span>
      	if { $enableUDF4DVMRP } {
         <a name="::udf(1)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> setDefault
         <a name="::udf(2)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -enable &#34;true&#34;
         <a name="::udf(3)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -initval &#34;02&#34;
         <a name="::udf(4)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -offset 23
         <a name="::udf(5)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -countertype &#34;c8&#34;
         <a name="::udf(6)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> set 1
      	}
	
	if {$enablepimdm} {
         <a name="::udf(7)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> setDefault
         <a name="::udf(8)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -enable &#34;true&#34;
         <a name="::udf(9)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -initval &#34;67&#34;
         <a name="::udf(10)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -offset 23
         <a name="::udf(11)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -countertype &#34;c8&#34;
         <a name="::udf(12)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> set 1
      }
   <span class="comment-line"># Define UDF package </span>
   if {$udfEnable == &#34;true&#34;} {
      set inter 0
      foreach udfOffs $udfOffset {
         <a name="::udf(13)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -enable &#34;true&#34;
         <a name="::udf(14)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -continuousCount [lindex $udfContinuousCount $inter]
         <a name="::udf(15)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -initval [lindex $udfInitval $inter]
         <a name="::udf(16)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -offset [lindex $udfOffset $inter]
         <a name="::udf(17)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -countertype [lindex $udfCountertype $inter]
         <a name="::udf(18)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -updown [lindex $udfUpdown $inter]
         <a name="::udf(19)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -repeat [lindex $udfRepeat $inter]
         <a name="::udf(20)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -step [lindex $udfStep $inter]
         incr inter
         <a name="::udf(21)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> set $inter
      }
   }

         <a name="::protocolOffset(1)"><a href="./ePTClient.tcl.html#::protocolOffset_816">::protocolOffset</a></a>               setDefault        
         <a name="::protocolOffset(2)"><a href="./ePTClient.tcl.html#::protocolOffset_816">::protocolOffset</a></a>               config            -enable                             false
         <a name="::protocolOffset(3)"><a href="./ePTClient.tcl.html#::protocolOffset_816">::protocolOffset</a></a>               config            -offset                             14
         <a name="::protocolOffset(4)"><a href="./ePTClient.tcl.html#::protocolOffset_816">::protocolOffset</a></a>               config            -userDefinedTag                     &#34;00 00&#34;
         <a name="::protocolOffset(5)"><a href="./ePTClient.tcl.html#::protocolOffset_816">::protocolOffset</a></a>               set               $chid $c $p

		
	<a name="::stream(25)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> set				$chid $c $p 1
	<span class="comment-line">#set packet group to default, otherwise will cause ICMP bad CRC</span>

      	packetGroup setDefault
      	packetGroup setTx                      $chid $c $p 1
		
   <span class="comment-line"># Define filter &amp; capture</span>

	<a name="::filter(1)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterEnable	true
      	<a name="::filter(2)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerEnable	true
	if {$applyFilter} {
		
	<a name="::filter(3)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -userDefinedStat1Enable	true
	
	<span class="comment-line"># In case of mcast fwding, dont care of SA1 value</span>
	
	if {[regexp -nocase &#34;01 00 5e&#34; $dMacAddr]} {
	
	<a name="::filter(4)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -userDefinedStat1SA	anyPattern
	} else {
	<a name="::filter(5)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -userDefinedStat1SA       addr1
	}
	} else {
	<a name="::filter(6)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -userDefinedStat1Enable   false
	}
	
     	 <a name="::filter(7)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -userDefinedStat1DA      addr1
	<a name="::filter(8)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterPattern	anyPattern
	<a name="::filter(9)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerPattern	anyPattern
	<a name="::filter(10)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerDA		anyAddr
	<a name="::filter(11)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterDA		anyAddr
	<a name="::filter(12)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -userDefinedStat1Pattern	pattern1
	<a name="::filter(13)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> set				$rxch $rxc $rxp
	
	<a name="::filterPallette(1)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> config -DA1		$destAddr
	<a name="::filterPallette(2)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> config -matchType1	matchIpDAEthernetII

	set fir &#34;&#34;
	set sec &#34;&#34;
      	set thi &#34;&#34;
      	set fou &#34;&#34;	
	
	scan $myDestIpAddr %d.%d.%d.%d fir sec thi fou
	if {($fir!=&#34;&#34;)&amp;&amp;($sec!=&#34;&#34;)&amp;&amp;($thi!=&#34;&#34;)&amp;&amp;($fou!=&#34;&#34;)} {
         set pattern1 [string toupper [format &#34;%02x %02x %02x %02x&#34;  \
                            $fir $sec $thi $fou]]
      	} else {
         set pattern1 &#34;&#34;
      	}

	
	<a name="::filterPallette(3)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> config -pattern1		$pattern1
	<a name="::filterPallette(4)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> config -SA1		$dMacAddToFilter
	<a name="::filterPallette(5)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> config -patternOffset1	$patternOffset
	<a name="::filterPallette(6)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> set			$rxch $rxc $rxp
	}

	<a name="::writeConfigToHardware(1)"><a href="./mapping.tcl.html#::writeConfigToHardware_148">::writeConfigToHardware</a></a> 			one2oneArray

	if {$clearStats == &#34;yes&#34;} {
		<a name="::zeroPortStats(1)"><a href="./mapping.tcl.html#::zeroPortStats_130">::zeroPortStats</a></a> $txChas $txCard $txPort
	}

	set pList &#34;&#34;
   	lappend pList &#34;$txChas $txCard $txPort&#34;
   	lappend pList &#34;$rxch $rxc $rxp&#34;
   	<a name="::ixStartCapture(1)"><a href="./mapping.tcl.html#::ixStartCapture_106">::ixStartCapture</a></a> pList
	
	
	 if {!$dontTx} {
		
		<a name="::startTx(1)"><a href="./mapping.tcl.html#::startTx_94">::startTx</a></a> one2oneArray
	
		set time2 [clock seconds]
		<a name="::stream(26)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> get $txChas $txCard $txPort 1
      		set streamSent [<a name="::stream(27)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> cget -packetView]

		<a name="::result_debug(4)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;*** Time for Ixia TX setup =  \
                                        [expr $time2-$time1] secs&#34;

		 <span class="comment-line"># Make sure TX done</span>
		
		if { $streamType == &#34;stopStream&#34; } {
		if { ($saMode != &#34;contIncrement&#34;) &amp;&amp; ($saMode != &#34;contDecrement&#34;) &amp;&amp;
              	($daMode != &#34;contIncrement&#34;) &amp;&amp; ($daMode != &#34;contDecrement&#34;) } {
      				
		<a name="::ixiaCheckTxDone(1)"><a href="./ePTMisc.tcl.html#::ixiaCheckTxDone_334">::ixiaCheckTxDone</a></a> $txChas $txCard $txPort $numFrames $txPort
            			
		<span class="comment-line">#Reset the filter</span>

            	if { $direction == &#34;2Way&#34; } {
               	<a name="::ixiaCheckTxDone(2)"><a href="./ePTMisc.tcl.html#::ixiaCheckTxDone_334">::ixiaCheckTxDone</a></a> $rxChas $rxCard $rxPort $numFrames $txPort
            	}
			
		<span class="comment-line"># Reset the filters</span>
	         
		if {$applyFilter} {
            	<a name="::result_debug(5)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;resetting the UDS1 settings&#34;
            	foreach txMap [lsort [array names one2oneArray]] {
               	scan $txMap                              &#34;%d,%d,%d&#34; chid c p
               	set rxMap                                $one2oneArray($txMap)
               	scan [join $rxMap]                       &#34;%d %d %d&#34; rxch rxc rxp
               	<a name="::filter(14)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -userDefinedStat1Enable    false
               	<a name="::filter(15)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -userDefinedStat2Enable    false
               	<a name="::filter(16)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> set $rxch $rxc $rxp
               	<a name="::filterPallette(7)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> setDefault
              	<a name="::filterPallette(8)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> set $rxch $rxc $rxp
            	}
            	<a name="::writeConfigToHardware(2)"><a href="./mapping.tcl.html#::writeConfigToHardware_148">::writeConfigToHardware</a></a> one2oneArray
         	}
      }
      }
      after 1000
      set time3 [clock seconds]
      <a name="::result_debug(6)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;*** Time for Ixia TX done = [expr $time3-$time2] secs\n&#34;
      return $streamSent
      } else {
      return &#34;&#34;
      }
      }
  		
</pre>
<hr>
<div class="index-selector">
	<a href="index_main.html#byfilename">file name</a> 
 | 
	<a href="index_main.html#byprocname">procedure name</a> 
 | 
	<a href="index_main.html#bycall">procedure call</a> 
 | 
	<a href="index_annot_full.html">annotation</a> 

<br>
<cite>File generated 2018-06-14 at 17:09.</cite>
</div>

</body>
</html>
