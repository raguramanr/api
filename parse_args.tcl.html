<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/transitional.dtd">
<!-- Generated by TclDoc @@VERSION@@ -->
<html>
<head>
  <title>parse_args.tcl</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="default.css">
</head>
<body class="src-html">
<div class="index-selector">
<!-- index for tcl source files -->
	Index by: 
	<a href="index_main.html#parse_args.tcl">file name</a> | 
	<a href="index_main.html#byprocname">procedure name</a> | 
	<a href="index_main.html#bycall">procedure call</a> | 
	<a href="index_annot_full.html">annotation</a>

</div>
<hr>

<p><strong>parse_args.tcl</strong>&nbsp;&nbsp;<span class="filetype-link">(<a href="parse_args.tcl-annot.html">annotations</a> | <a href="parse_args.tcl.txt">original source</a>)</span>
</p>
<pre class="src-code">

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: parse_args   </span>
<span class="comment-line"># Description: </span>
<span class="comment-line">#	This function accepts a arguments list and a definition list.</span>
<span class="comment-line">#	Uers pass it the name of the function who is having it's arguments parsed, a</span>
<span class="comment-line"># 	list of argumets (usually the $args variable), and then a list of</span>
<span class="comment-line"># 	definitions. The definition list is in the form of { variable default</span>
<span class="comment-line"># 	variable default ... }.   </span>
<span class="comment-line"># Input args: func_name arg_list def_list</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: list of strings unknownArgs</span>
<span class="comment-line"># Typical usage: </span>
<span class="comment-line">#	proc CheckForwarding {args} {</span>
<span class="comment-line">#		parse_args CheckForwarding $args {</span>
<span class="comment-line">#		     txPortId &#34;1&#34;</span>
<span class="comment-line">#		     rxPortId &#34;0&#34;</span>
<span class="comment-line">#		     protocol &#34;mac&#34;</span>
<span class="comment-line">#		     tag      &#34;none&#34;</span>
<span class="comment-line">#		     generateArpReq &#34;1&#34;</span>
<span class="comment-line">#		     inSaMac &#34;default&#34;</span>
<span class="comment-line">#		     inDaMac &#34;FF:FF:FF:FF:FF:FF&#34;</span>
<span class="comment-line">#		     sIpAddr &#34;127.0.0.1&#34;</span>
<span class="comment-line">#		     dIpAddr &#34;127.0.0.1&#34;</span>
<span class="comment-line">#	}	   </span>
<span class="comment-line"># Category: Utility</span>
<span class="comment-line">##################################################################</span>

<strong><a name="::::parse_args_29">proc <a href="parse_args.tcl-annot.html#::::parse_args">::::parse_args</a></a></strong> {args} {
    global TrafficGen MAIN
    set noComplain 0
    switch [llength $args] {
        2 { error &#34;no value given for parameter \&#34;def_list\&#34; to \&#34;parse_args\&#34;&#34; }
        1 { error &#34;no value given for parameter \&#34;arg_list\&#34; to \&#34;parse_args\&#34;&#34; }
        0 { error &#34;no value given for parameter \&#34;func_name\&#34; to \&#34;parse_args\&#34;&#34; }
        default {
            if {[lindex $args 0] == &#34;-noComplain&#34;} {
                set noComplain 1
            }
            set tmp [expr [llength $args] - 3]
            if {$tmp &gt; 1} { set tmp 1 }

            set func_name [lindex $args $tmp]
            incr tmp
            set arg_list [lindex $args $tmp]
            incr tmp
            set def_list [lindex $args $tmp]
        }
    }

    set trafficProc 0
    set trafficArgs {txPortId rxPortId protocol tag sourceMac destMac percentage frameRate streamType}

    <span class="comment-line"># Set the default values from the definition list</span>
    foreach {opt def} $def_list {
        uplevel [list set $opt $def]
        if {[lsearch -exact $trafficArgs $opt] &gt;= 0} {
            incr trafficProc;
            if {!$MAIN(IxiaReady) &amp;&amp; [regexp -nocase &#34;ix&#34; $TrafficGen]} {
                <span class="comment-line">#In i_main traffic is turned off by default. Get ready for traffic</span>
                <a name="::::smallIxiaInit(1)"><a href="./swConf.tcl.html#::::smallIxiaInit_1778">::::smallIxiaInit</a></a>
                set MAIN(skipIxInit) 0; set MAIN(IxiaReady) 1;
            }
        }
    }

    set unknownArgs &#34;&#34;
    foreach {arg val} $arg_list {
        set found 0
        foreach {opt def} $def_list {
            if {(&#34;$arg&#34; == &#34;-$opt&#34;)||(&#34;$arg&#34; == &#34;$opt&#34;)} {
                <span class="comment-line"># The arg is in the definition list.  Set the arg value.</span>
                uplevel [list set $opt $val]
                set found 1
            }
        }
        if {$trafficProc &gt;= 3 &amp;&amp; ($TrafficGen == &#34;ixvm&#34; || $TrafficGen == &#34;stcvm&#34;)} {
            if {$arg == &#34;-percentage&#34;} {
               uplevel [list set percentage &#34;.001&#34;]
            }
            if {$arg == &#34;-frameRate&#34;} {
               uplevel [list set frameRate &#34;100&#34;]
            }
        }
        if {!$found} {
            lappend unknownArgs $arg
            lappend unknownArgs $val

            if {$noComplain} {
                continue
            }

            set msg &#34;Bad argument `$arg' to function `$func_name'. Must be one of &#34;
            set length [expr {[llength $def_list] / 2}]
            for {set i 0} {$i &lt; ($length - 1)} {incr i} {
                append msg &#34;[lindex $def_list [expr $i * 2]], &#34;
            }
            append msg &#34;or [lindex $def_list [expr $i * 2]].&#34;
            error $msg
        }
    }
    return $unknownArgs
} ;<span class="comment-line"># parse_args</span>
</pre>
<hr>
<div class="index-selector">
	<a href="index_main.html#byfilename">file name</a> 
 | 
	<a href="index_main.html#byprocname">procedure name</a> 
 | 
	<a href="index_main.html#bycall">procedure call</a> 
 | 
	<a href="index_annot_full.html">annotation</a> 

<br>
<cite>File generated 2018-06-14 at 17:09.</cite>
</div>

</body>
</html>
