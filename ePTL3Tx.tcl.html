<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/transitional.dtd">
<!-- Generated by TclDoc @@VERSION@@ -->
<html>
<head>
  <title>ePTL3Tx.tcl</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="default.css">
</head>
<body class="src-html">
<div class="index-selector">
<!-- index for tcl source files -->
	Index by: 
	<a href="index_main.html#ePTL3Tx.tcl">file name</a> | 
	<a href="index_main.html#byprocname">procedure name</a> | 
	<a href="index_main.html#bycall">procedure call</a> | 
	<a href="index_annot_full.html">annotation</a>

</div>
<hr>

<p><strong>ePTL3Tx.tcl</strong>&nbsp;&nbsp;<span class="filetype-link">(<a href="ePTL3Tx.tcl-annot.html">annotations</a> | <a href="ePTL3Tx.tcl.txt">original source</a>)</span>
</p>
<pre class="src-code">
<span class="comment-line">#################################################################</span>
<span class="comment-line"># $RCSfile: ixiaL3Tx.tcl,v $ - </span>
<span class="comment-line">#</span>
<span class="comment-line"># Copyright (c) 1999 by Extreme Networks Inc.</span>
<span class="comment-line"># </span>
<span class="comment-line"># Revision control history</span>
<span class="comment-line"># ------------------------</span>
<span class="comment-line"># $Header: /export/cvsroot/automation/Lib/ixiaL3Tx.tcl,v 2.36.6.29 2010/08/24 01:39:52 ghundertmark Exp $</span>
<span class="comment-line"># Extreme Networks modification history</span>
<span class="comment-line"># -------------------------------------</span>
<span class="comment-line"># $Log: ixiaL3Tx.tcl,v $</span>
<span class="comment-line"># Revision 2.36.6.29  2010/08/24 01:39:52  ghundertmark</span>
<span class="comment-line"># Merge branch 12_4 to trunk</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.29  2010/08/24 01:39:52  ghundertmark</span>
<span class="comment-line"># Merge branch 12_4 to trunk</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.28  2009/07/07 22:39:02  lagrawal</span>
<span class="comment-line"># removed extra empty line causing issue in some procs</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.27.2.1  2009/07/07 22:37:04  lagrawal</span>
<span class="comment-line"># removed extra empty line causing issue in some procs</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.27  2009/07/01 10:55:41  nellinivasu</span>
<span class="comment-line"># Merged From Branch 'branch-dev_v12-1-rel4'</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.26  2009/06/05 00:25:09  jramarao</span>
<span class="comment-line"># Merged from DEV after May 26 2009</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.25  2009/05/15 17:03:04  lagrawal</span>
<span class="comment-line"># Add protocol tag id</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.24  2009/04/15 13:26:19  nellinivasu</span>
<span class="comment-line"># Merged From Branch 'branch-dev_v12-1-rel4'</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.23  2009/03/18 21:48:28  jramarao</span>
<span class="comment-line"># From branch-dev_v12-1-rel4</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.21.18.2  2009/02/24 12:12:23  nellinivasu</span>
<span class="comment-line"># Merged From Branch 'branch-pioneer2_dev-v12-1-rel4'</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.21.18.4  2009/04/15 13:18:29  nellinivasu</span>
<span class="comment-line"># With non default ipTotalLength, Set lengthOverride to false for XMV ixia card type in function ixiaConf_2Ports_ip,if not it is treated as bad packet.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.21.18.3  2009/04/03 09:29:29  lagrawal</span>
<span class="comment-line"># merge from branch-pioneer2_dev-v12-1-rel4 to branch-dev_v12-1-rel4</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.21.18.1.4.2  2009/02/24 12:05:06  nellinivasu</span>
<span class="comment-line"># With non default ipTotalLength, Set lengthOverride to false for XMS ixia card type in function ixiaConf_2Ports_ip,if not it is treated as bad packet.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.21.18.1.4.1  2009/02/17 21:49:14  ghundertmark</span>
<span class="comment-line"># add protocolTag to enable 88a8 in the ethertype offset</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.21.18.1  2008/10/20 20:00:57  lagrawal</span>
<span class="comment-line"># added lengthOverride to function ixiaConf_2Ports_ip use can set the value true/false to overide length/keep it same when sending packet , override packet simetime is treated as bad packet</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.21.18.4  2009/04/15 13:18:29  nellinivasu</span>
<span class="comment-line"># With non default ipTotalLength, Set lengthOverride to false for XMV ixia card type in function ixiaConf_2Ports_ip,if not it is treated as bad packet.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.21.18.3  2009/04/03 09:29:29  lagrawal</span>
<span class="comment-line"># merge from branch-pioneer2_dev-v12-1-rel4 to branch-dev_v12-1-rel4</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.21.18.1.4.2  2009/02/24 12:05:06  nellinivasu</span>
<span class="comment-line"># With non default ipTotalLength, Set lengthOverride to false for XMS ixia card type in function ixiaConf_2Ports_ip,if not it is treated as bad packet.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.21.18.1.4.1  2009/02/17 21:49:14  ghundertmark</span>
<span class="comment-line"># add protocolTag to enable 88a8 in the ethertype offset</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.21.18.1  2008/10/20 20:00:57  lagrawal</span>
<span class="comment-line"># added lengthOverride to function ixiaConf_2Ports_ip use can set the value true/false to overide length/keep it same when sending packet , override packet simetime is treated as bad packet</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.21  2007/04/30 12:23:19  ghundertmark</span>
<span class="comment-line"># Add txperc to frameformat for L3</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.20  2007/03/02 10:22:19  nellinivasu</span>
<span class="comment-line"># Modified proc ixiaConf_2Ports_arp to support destHwAddr in ARP payload.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.19  2007/02/21 01:42:46  achilukuri</span>
<span class="comment-line"># Merging  Q3FY07-11.6-Phase-2</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.18  2007/01/25 19:26:09  achilukuri</span>
<span class="comment-line"># Release  Q3FY07_11.6 Phase 1 commit</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.17.2.1  2007/01/24 13:14:10  aprakasham</span>
<span class="comment-line"># Added UDF options in Proc ixiaConf_2Ports_arp</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.17  2006/11/14 04:53:15  dsuk</span>
<span class="comment-line"># Q2FY07 11.5 Phase 2 Merge</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.16  2006/11/11 00:06:42  skumar</span>
<span class="comment-line"># Justs' DHCP specific commit</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.15.2.1  2006/11/01 22:33:07  dsuk</span>
<span class="comment-line"># added frameSizeMIN and frameSizeMAX arguments</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.15  2006/09/29 22:38:16  djain</span>
<span class="comment-line"># Commit for Release Q1FY07-Rel11.4</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.14.2.1  2006/09/19 19:37:53  smohanty</span>
<span class="comment-line"># Added Mac address for default src or dest mac in the debug info</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.14  2006/06/30 22:35:34  ghundertmark</span>
<span class="comment-line"># Q4FY06 Release commit</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.13  2006/06/09 06:12:28  nellinivasu</span>
<span class="comment-line"># Changes made to debug ixia transmission problem.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.12  2006/05/30 05:41:02  nellinivasu</span>
<span class="comment-line"># Changes made to debug ixia transmission problem.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.11  2006/05/29 13:19:30  nellinivasu</span>
<span class="comment-line"># Changes made to debug ixia transmission problem.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.10  2006/05/18 21:12:48  skumar</span>
<span class="comment-line"># Support multiple udfs in _ip</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.9  2006/04/15 00:25:08  skumar</span>
<span class="comment-line"># Use lsort based on dictio</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.8.4.2  2006/05/12 02:14:54  smohanty</span>
<span class="comment-line"># Supported Generation of QinQ (double tag) packets from ixia</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.8.4.1  2006/04/17 22:56:36  smohanty</span>
<span class="comment-line"># Added display of the Tx packet component for ip, mac and dhcp packets</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.8  2005/12/21 22:24:18  smohanty</span>
<span class="comment-line"># Commit for Release 12</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.7  2005/11/30 02:27:23  skumar</span>
<span class="comment-line"># updates for srcHwAddr, decideLoopCount for ORT long tests</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.6.4.2  2005/10/12 01:51:38  skumar</span>
<span class="comment-line"># Fix wrong spelling in couint</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.6.4.1  2005/10/12 00:43:57  skumar</span>
<span class="comment-line"># Added workaround for &gt; 16Mil pkt count</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.6.4.3  2005/11/08 01:52:33  dsuk</span>
<span class="comment-line"># added tag parameter to ixiaConf_2Ports_Dhcp</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.6.4.2  2005/10/12 01:51:38  skumar</span>
<span class="comment-line"># Fix wrong spelling in couint</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.6.4.1  2005/10/12 00:43:57  skumar</span>
<span class="comment-line"># Added workaround for &gt; 16Mil pkt count</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.6  2005/09/16 02:05:10  skumar</span>
<span class="comment-line"># Added dontTx arg. Default 0. Used for ONLY stream config</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.5  2005/06/29 16:57:55  cshaw</span>
<span class="comment-line"># Release exos-br-10</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.4  2004/09/30 00:59:26  mverma</span>
<span class="comment-line"># Exos Rel7 check in.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.3.2.1  2004/09/08 00:31:17  skumar</span>
<span class="comment-line"># Added more args for ACL support</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.3  2004/07/28 19:44:43  skumar</span>
<span class="comment-line"># Use udf definitions</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.2  2004/05/03 23:41:02  skumar</span>
<span class="comment-line"># Changes w.r.t. incremental igmp reports</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.6.1  2003/08/20 03:20:05  cshaw</span>
<span class="comment-line"># trunk-exos release</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.4.2  2003/08/14 00:35:42  cshaw</span>
<span class="comment-line"># Merged in trunk for 3.65 related changes</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.46  2003/07/25 18:02:58  cshaw</span>
<span class="comment-line"># Merged from br-1-6</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.45.6.1  2003/07/19 21:37:56  skumar</span>
<span class="comment-line"># Added support for ix 3.65, removed deprecated calls.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36.4.1  2003/06/23 21:28:45  cshaw</span>
<span class="comment-line"># Merged in EW trunk</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.45  2003/04/18 19:34:47  autotest</span>
<span class="comment-line"># Changes as taken from br-1-3.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.44.6.1  2003/04/14 19:41:42  autotest</span>
<span class="comment-line"># Add arp repeat options</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.44  2003/02/06 03:19:50  tquach</span>
<span class="comment-line"># add more option on dhcp frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.43  2002/09/03 23:36:43  swang</span>
<span class="comment-line"># undid the previous change</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.42  2002/08/30 01:26:11  swang</span>
<span class="comment-line"># change 'arp config -destHardwareAddr' from '00 00 00 00 00 00' to 'FF FF FF FF FF FF'</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.41  2002/08/27 21:33:29  eyoung</span>
<span class="comment-line"># Enhanced ixia_Conf_2Ports_ip to allow address counts to be specified when doing MAC or IP address incrementing.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.40  2002/08/21 22:45:10  tquach</span>
<span class="comment-line"># Need to clear the port stat before sending the packets else ixiachecktxdone will not work correctly</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.39  2002/08/09 01:29:54  skumar</span>
<span class="comment-line"># Optimize ixStartCapture per EY suggestion.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.38  2002/07/26 22:59:53  aleu</span>
<span class="comment-line"># add description header for each proc</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.37  2002/07/19 00:33:54  skumar</span>
<span class="comment-line"># Chnage ixStartPortCapture to ixStartCapture.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.36  2002/07/10 18:34:08  aleu</span>
<span class="comment-line"># comment out  lines of &#34;ixiaConf_clearStat $c&#34;</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.35  2002/05/06 21:25:36  aleu</span>
<span class="comment-line"># remove all cardSpeed global var</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.34  2002/03/28 21:25:22  aleu</span>
<span class="comment-line"># enable tcpConfig{} to set seqNum, syn/fin/ack/rst flags</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.33  2002/03/28 18:25:20  skumar</span>
<span class="comment-line"># Fix dependency on startCardNum.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.32  2002/03/25 19:01:48  aleu</span>
<span class="comment-line"># change ixiaConf_2Ports_arp{}'s default percentage to be 0.01 from 100</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.31  2002/01/22 00:05:26  tquach</span>
<span class="comment-line"># Add arp increment</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.30  2001/12/06 19:49:48  tnguyen</span>
<span class="comment-line"># Add some options needed in new performance module</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.29  2001/10/25 23:46:55  skumar</span>
<span class="comment-line"># Make sure right igmp ver1 for v1 join.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.28  2001/09/12 23:21:14  tquach</span>
<span class="comment-line"># Add UDF feature</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.27  2001/06/08 00:54:04  Autotest</span>
<span class="comment-line"># More checks to avoid error condition-sk.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.26  2001/06/07 00:49:53  skumar</span>
<span class="comment-line"># Put filter to Rx if applyFilter set else not in IP forwarding.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.25  2001/06/01 02:15:47  skumar</span>
<span class="comment-line"># Changes to take care bi-directional frames send.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.24  2001/04/25 01:00:55  skumar</span>
<span class="comment-line"># Added few lines to support udf for pim-dm.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.23  2001/04/19 22:54:07  aleu</span>
<span class="comment-line"># minor change</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.22  2001/03/21 18:30:52  aleu</span>
<span class="comment-line"># add rip &amp; ripRoute ixia commands</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.21  2001/03/21 01:41:02  aleu</span>
<span class="comment-line"># add frameSizeType stream option in ixiaConf_2Ports_ip</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.20  2001/02/18 21:41:55  sphomsakha</span>
<span class="comment-line"># Add dontFragment variable</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.19  2001/01/23 04:02:03  tnguyen</span>
<span class="comment-line"># Change to support ixia 3.1 for udf</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.18  2001/01/18 03:57:50  tnguyen</span>
<span class="comment-line"># Add ipTotalLength and fix pattern configuration for 3.1</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.17  2001/01/14 02:20:27  tquach</span>
<span class="comment-line"># Add DHCP procedure</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.16  2000/11/06 16:41:08  jfan</span>
<span class="comment-line"># Fix a bug for ipSaMode and merge for conflict</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.15  2000/11/02 23:55:12  skumar</span>
<span class="comment-line"># Put length check on ipOptions field to avoid bug in ixia 3.1 ver.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.14  2000/09/25 18:28:31  tnguyen</span>
<span class="comment-line"># Remove 2portsNum_adjust,</span>
<span class="comment-line"># call capturing only on Tx and Rx ports instead of all cards</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.13  2000/09/12 22:57:19  tnguyen</span>
<span class="comment-line"># Remove function to print data out to file, will print out at another place</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.12  2000/08/12 02:20:25  skumar</span>
<span class="comment-line"># Added ipOptions, Fixed Tag problem in 2Way IP forwarding.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.11  2000/08/04 18:28:09  jfan</span>
<span class="comment-line"># Fix a bug: Do ixiaCheckTxDone only if the streamType is &#34;stopStream&#34;</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.10  2000/06/06 21:38:08  tnguyen</span>
<span class="comment-line"># Add TOS and Vlan priority</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.9  2000/05/25 16:18:19  tnguyen</span>
<span class="comment-line"># Default value for -ipSaMode or -ipDaMode &#34;ipIdle&#34; not &#34;idle&#34;</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.8  2000/05/17 00:41:51  tnguyen</span>
<span class="comment-line"># Add option to return data frames instead writing to a file</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.7  2000/05/08 22:22:36  jfan</span>
<span class="comment-line"># Solve the conflict after updating for 2.6</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.6  2000/04/28 17:25:38  jlequang</span>
<span class="comment-line"># Fist stage of incorporating old BD-extension to Thanh's</span>
<span class="comment-line"># new enhancement.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.5  2000/04/07 00:23:48  tnguyen</span>
<span class="comment-line"># Various modifications to the whole project in Lib, L2 and L3.  Commit changes for all these folders at the same time.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.3  2000/02/07 23:50:13  jfan</span>
<span class="comment-line"># Add for udp, tcp &amp; icmp</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.2  1999/10/27 21:58:59  jfan</span>
<span class="comment-line"># Modify IxiaTx functions as interface changed.  Replace &#34;Input&#34; dir to &#34;Exp&#34; dir.  Replace &#34;Tmp\in_xxx&#34; to &#34;Tmp_tmp_xxx&#34;</span>
<span class="comment-line">#</span>
<span class="comment-line"># Revision 2.1  1999/09/27 22:32:33  jfan</span>
<span class="comment-line"># no message</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">##################################################################</span>

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: ixiaConf_2Ports_Dhcp   </span>
<span class="comment-line"># Description: </span>
<span class="comment-line">#	Set up an ixia port to send DHCP packets based on given</span>
<span class="comment-line">#	opCode and optionCodeList parameters		     </span>
<span class="comment-line"># Input args: args</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Typical usage: </span>
<span class="comment-line">#	set frameSent [ixiaConf_2Ports_Dhcp -numIxiaCd $numIxiaCd \</span>
<span class="comment-line">#              -txChas $chasisId -txCard $card -txPort $port -startCardNum $startCardNum \</span>
<span class="comment-line">#              -rxChas $chasisId -rxCard $card -rxPort $rxPo \</span>
<span class="comment-line">#              -sMacAddr $sourceMac -dMacAddr $destMac \</span>
<span class="comment-line">#	       -numFrames $numFrames -streamType $streamType -fcsError $fcsError \</span>
<span class="comment-line">#	       -saMode $saMode -daMode $daMode -opCode $opCode \</span>
<span class="comment-line">#	       -optionCodeList $optionCodeList -clientHwAddr $clientHwAddr ]    </span>
<span class="comment-line"># Category: SendTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::ixiaConf_2Ports_Dhcp_337">proc <a href="ePTL3Tx.tcl-annot.html#::::ixiaConf_2Ports_Dhcp">::::ixiaConf_2Ports_Dhcp</a></a></strong> {args} {
   <a name="::parse_args(1)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> ixiaConf_2Ports_Dhcp $args {
      numIxiaCd &#34;1&#34;
      startCardNum &#34;1&#34;
      direction &#34;1Way&#34;
      txChas &#34;1&#34;
      txCard &#34;1&#34;
      txPort &#34;1&#34;
      rxChas &#34;1&#34;
      rxCard &#34;1&#34;
      rxPort &#34;2&#34;
      sMacAddr &#34;00 00 86 52 55 CB&#34;
      dMacAddr &#34;FF FF FF FF FF FF&#34;
      sIpAddr &#34;0.0.0.0&#34;
      dIpAddr &#34;255.255.255.255&#34;
      srcPort &#34;68&#34;
      dstPort &#34;67&#34;
      numFrames &#34;1&#34;
      dataPattern &#34;0000&#34;
      streamType &#34;stopStream&#34;
      fcsError &#34;good&#34;
      saMode &#34;idle&#34;
      daMode &#34;idle&#34;
      chid &#34;1&#34;
      clientHwAddr &#34;00 00 86 52 55 CB&#34;
      clientIpAddr &#34;0.0.0.0&#34;
      frameSize &#34;342&#34;
      yourIpAddr &#34;0.0.0.0&#34;
      opCode &#34;dhcpBootRequest&#34;
      optionCodeList &#34;{dhcpMessageType dhcpDiscover}&#34;
      dontTx &#34;0&#34;
      wTag &#34;false&#34;
      tagNo &#34;002&#34;
      tagCfi &#34;resetCFI&#34;
      tagMode &#34;vIdle&#34;
      tagRepeat &#34;1&#34;
   }
                       
   global spawn_id
   global one2oneArray
   global macBroadcast
   global preambleSize
<span class="comment-line">#   globalSetDefault</span>
<span class="comment-line">#   protocolStackSetDefault</span>

   set date [clock format [clock seconds] -format &#34;%m-%d-%Y %I.%M.%S%p&#34;]
<span class="comment-line">#   result_debug &#34;\n*** date=$date&#34;</span>
   set time1 [clock seconds]

   set streamType				stopStream
   set patternOffset				32
   set macBroadcast				{FF FF FF FF FF FF}
   set preambleSize				8

   <span class="comment-line"># Create mapping</span>
<span class="comment-line">#   map new -type				one2one</span>
<span class="comment-line">#   map config -type 				one2one</span>

   if { $direction == &#34;2Way&#34; } {
<span class="comment-line">#puts &#34;--------------------- ll3 -----------------&#34;</span>
      <a name="::map(1)"><a href="./ePTClient.tcl.html#::map_366">::map</a></a> add $txChas $txCard $txPort $rxChas $rxCard $rxPort $rxChas $rxCard $rxPort $txChas $txCard $txPort
<span class="comment-line">#puts &#34;--------------------- ll4 -----------------&#34;</span>
   } else  {
      <a name="::map(2)"><a href="./ePTClient.tcl.html#::map_366">::map</a></a> add $txChas $txCard $txPort $rxChas $rxCard $rxPort
   }


   <span class="comment-line"># Config streams for validation traffic</span>
<span class="comment-line">#   foreach txMap [lsort -dictionary [array names one2oneArray]] {</span>
<span class="comment-line">#     scan $txMap				&#34;%d,%d,%d&#34; chid c p</span>
<span class="comment-line">#     port get					$chid $c $p</span>
<span class="comment-line">#      set txSpeed				[port cget -speed]</span>
      set txSpeed				100
      <span class="comment-line">## configure streams</span>
<span class="comment-line">#      stream setDefault</span>
      <a name="::stream(1)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -rateMode                   usePercentRate
      <a name="::stream(2)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -asyncIntEnable             true
      <a name="::stream(3)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -percentPacketRate          50
      <a name="::stream(4)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -numFrames			$numFrames
<span class="comment-line">#      stream config -name 			S_${c}_${p}</span>
      <a name="::stream(5)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -framesize			$frameSize
      <a name="::stream(6)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -frameSizeType              sizeFixed
      <a name="::decideLoopCount(1)"><a href="./ePTMisc.tcl.html#::decideLoopCount_499">::decideLoopCount</a></a> $numFrames $streamType
      <a name="::port(1)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> get					$txChas $txCard $txPort
      set srcAddr				[<a name="::port(2)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> cget -MacAddress]
      after 200
<span class="comment-line">#      set rxMap					$one2oneArray($txMap)</span>
<span class="comment-line">#      scan [join $rxMap]			&#34;%d %d %d&#34; rxch rxc rxp</span>
      <a name="::port(3)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> get					$rxChas $rxCard $rxPort
      set destAddr				[<a name="::port(4)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> cget -MacAddress]
       after 200   
      <a name="::stream(7)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -saRepeatCounter $saMode 
      <a name="::stream(8)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -daRepeatCounter $daMode 
      if { $saMode != &#34;idle&#34; } { <a name="::stream(9)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -numSA $numFrames }
      if { $daMode != &#34;idle&#34; } { <a name="::stream(10)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -numDA $numFrames }
      if { $sMacAddr == &#34;default&#34; } {
          set sTmpMacAddr $srcAddr
      } else { 
          set sTmpMacAddr $sMacAddr
      }				    
      <a name="::stream(11)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -sa 		       $sTmpMacAddr
      <a name="::stream(12)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -da 	               $dMacAddr
      
      <span class="comment-line">## ip header</span>
      <span class="comment-line">#ip setDefault</span>
      <a name="::ip(1)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -ipProtocol                     udp
      <span class="comment-line"># other ip info</span>
      <a name="::ip(2)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -destIpAddr                     $dIpAddr
      <a name="::ip(3)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -destIpAddrMode                 ipIdle
      <a name="::ip(4)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -sourceIpAddr                   $sIpAddr
      <a name="::ip(5)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -sourceIpAddrMode               ipIdle
<span class="comment-line">#      ip set                                    $chid $c $p</span>


      <a name="::udp(1)"><a href="./ePTClient.tcl.html#::udp_2089">::udp</a></a> config -sourcePort	[format %04x $srcPort]
      <a name="::udp(2)"><a href="./ePTClient.tcl.html#::udp_2089">::udp</a></a> config -destPort	[format %04x $dstPort]
<span class="comment-line">#      udp set $chid $c $p</span>


      <span class="comment-line">## set up protocol</span>
<span class="comment-line">#      protocol setDefault</span>
      <a name="::protocol(1)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a> config -ethernetType		ethernetII
      <a name="::protocol(2)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a> config -name			ip
      <a name="::protocol(3)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a> config -appName			Dhcp

      <span class="comment-line">## DHCP packet format</span>
<span class="comment-line">#      dhcp setDefault</span>
      <a name="::dhcp(1)"><a href="./ePTClient.tcl.html#::dhcp_1231">::dhcp</a></a> config -opCode                         $opCode
<span class="comment-line">#      dhcp config -hwType                         dhcpEthernet10Mb</span>
      <a name="::dhcp(2)"><a href="./ePTClient.tcl.html#::dhcp_1231">::dhcp</a></a> config -hwType                         01
      <a name="::dhcp(3)"><a href="./ePTClient.tcl.html#::dhcp_1231">::dhcp</a></a> config -transactionID                  &#34;8a9ab8e8&#34;
      <a name="::dhcp(4)"><a href="./ePTClient.tcl.html#::dhcp_1231">::dhcp</a></a> config -seconds                        7680
<span class="comment-line">#      dhcp config -flags                          dhcpNoBroadcast</span>
      <a name="::dhcp(5)"><a href="./ePTClient.tcl.html#::dhcp_1231">::dhcp</a></a> config -flags                          0000
      <a name="::dhcp(6)"><a href="./ePTClient.tcl.html#::dhcp_1231">::dhcp</a></a> config -clientIpAddr                   $clientIpAddr
      <a name="::dhcp(7)"><a href="./ePTClient.tcl.html#::dhcp_1231">::dhcp</a></a> config -yourIpAddr                     $yourIpAddr
      <a name="::dhcp(8)"><a href="./ePTClient.tcl.html#::dhcp_1231">::dhcp</a></a> config -serverIpAddr                   0.0.0.0
      <a name="::dhcp(9)"><a href="./ePTClient.tcl.html#::dhcp_1231">::dhcp</a></a> config -relayAgentIpAddr               0.0.0.0
      <a name="::dhcp(10)"><a href="./ePTClient.tcl.html#::dhcp_1231">::dhcp</a></a> config -clientHwAddr                   $clientHwAddr
<span class="comment-line">#      dhcp config -optionCodeList                 $optionCodeList</span>
      lappend optionCodeList dhcpIPAddrLeaseTime 1200
      lappend optionCodeList dhcpEnd ff
<span class="comment-line">#      dhcp config -optionData                     {{dhcpIPAddrLeaseTime 1200}}</span>
      <a name="::dhcp(11)"><a href="./ePTClient.tcl.html#::dhcp_1231">::dhcp</a></a> config -optionData                     $optionCodeList
<span class="comment-line">#      dhcp set $chid $c $p</span>
      <span class="comment-line"># dhcp options </span>
<span class="comment-line">#      puts &#34;DHCP OPTIONS : $optionCodeList&#34;  </span>
      <a name="::setDhcpOptions(1)"><a href="./ePTL3Tx.tcl.html#::setDhcpOptions_1564">::setDhcpOptions</a></a> optionCodeList
      <span class="comment-line">## set DHCP config</span>
<span class="comment-line">#      if [dhcp set $chid $c $p] {</span>
<span class="comment-line">#          result_debug &#34;Error setting dhcp configuration!&#34;</span>
<span class="comment-line">#      }</span>
      
      <span class="comment-line">## set up vlan</span>
      <a name="::protocol(4)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a> config -enable802dot1qTag                $wTag
      <a name="::vlan(1)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> config -cfi                                  $tagCfi
      <a name="::vlan(2)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> config -mode                                 $tagMode
      <a name="::vlan(3)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> config -repeat                               $tagRepeat
      <a name="::vlan(4)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> config -vlanID                               $tagNo
<span class="comment-line">#      vlan set                                          $chid $c $p</span>

<span class="comment-line">#      stream set				$chid $c $p 1</span>
<span class="comment-line">#     stream write                              $chid $c $p 1</span>
      <span class="comment-line"># Define filter &amp; capture</span>

      <a name="::filter(1)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterEnable		true
      <a name="::filter(2)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerEnable		true
      <a name="::filter(3)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -userDefinedStat1Enable		false
      <a name="::filter(4)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -userDefinedStat1DA			addr1
      <a name="::filter(5)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterPattern		anyPattern
      <a name="::filter(6)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerPattern		anyPattern
      <a name="::filter(7)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerDA			anyAddr
      <a name="::filter(8)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterDA			anyAddr
<span class="comment-line">#     filter set					$rxch $rxc $rxp</span>

      <a name="::filterPallette(1)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> config -DA1 			$destAddr
      <a name="::filterPallette(2)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> config -pattern1			$dataPattern
      <a name="::filterPallette(3)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> config -patternOffset1 		$patternOffset
<span class="comment-line">#     filterPallette set				$rxch $rxc $rxp</span>
<span class="comment-line">#   }</span>
   set portList &#34;$txChas:$txCard:$txPort&#34; 
   <a name="::writeConfigToHardware(1)"><a href="./mapping.tcl.html#::writeConfigToHardware_148">::writeConfigToHardware</a></a> $portList
   <a name="::zeroPortStats(1)"><a href="./mapping.tcl.html#::zeroPortStats_130">::zeroPortStats</a></a> $txChas $txCard $txPort
   <span class="comment-line">#for {set c $startCardNum} {$c&lt;=[expr $startCardNum + $numIxiaCd - 1]} {incr c 1} { ixiaConf_clearStat $c }</span>
   <span class="comment-line">#just in case some previous function stop capture on these ports</span>
   set pList &#34;&#34;
   lappend pList &#34;$txChas $txCard $txPort&#34;
   lappend pList &#34;$rxChas $rxCard $rxPort&#34;
   <a name="::ixStartCapture(1)"><a href="./mapping.tcl.html#::ixStartCapture_106">::ixStartCapture</a></a> $pList
   if {!$dontTx} {
<span class="comment-line">#      startTx one2oneArray</span>
      <a name="::startTx(1)"><a href="./mapping.tcl.html#::startTx_94">::startTx</a></a> $portList
      set time2 [clock seconds]
      <a name="::stream(13)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> get $txChas $txCard $txPort 1
      set streamSent [<a name="::stream(14)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> cget -packetView]
      <span class="comment-line">#result_debug &#34;*** Frame sent from ($txChas $txCard $txPort) = $streamSent&#34;</span>
<span class="comment-line">#      result_debug &#34;*** Time for Ixia TX setup = [expr $time2-$time1] secs&#34;</span>
      <span class="comment-line"># Make sure TX done</span>
      if { $streamType == &#34;stopStream&#34; } {
         if { ($saMode != &#34;contIncrement&#34;) &amp;&amp; ($saMode != &#34;contDecrement&#34;) &amp;&amp;   \
              ($daMode != &#34;contIncrement&#34;) &amp;&amp; ($daMode != &#34;contDecrement&#34;) } {
            <a name="::ixiaCheckTxDone(1)"><a href="./ePTMisc.tcl.html#::ixiaCheckTxDone_334">::ixiaCheckTxDone</a></a> $txChas $txCard $txPort $numFrames $txPort
            if { $direction == &#34;2Way&#34; } {
               <a name="::ixiaCheckTxDone(2)"><a href="./ePTMisc.tcl.html#::ixiaCheckTxDone_334">::ixiaCheckTxDone</a></a> $rxChas $rxCard $rxPort $numFrames $txPort
            }
         }
      }
     after 1000
      set time3 [clock seconds]
      <span class="comment-line">#result_debug &#34;*** Time for Ixia TX done = [expr $time3-$time2] secs\n&#34;</span>
      <a name="::result_debug(1)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;*** Ixia port config time [expr $time2-$time1] secs and TX time [expr $time3-$time2] secs\n&#34;
      if {$sMacAddr == &#34;default&#34;} {
         set sMacAddr $srcAddr
      }
      set txPortId [<a name="::MapIxiaCardnPort(1)"><a href="./ePTPortMapping.tcl.html#::MapIxiaCardnPort_331">::MapIxiaCardnPort</a></a> $txChas $txCard $txPort]
      set rxPortId [<a name="::MapIxiaCardnPort(2)"><a href="./ePTPortMapping.tcl.html#::MapIxiaCardnPort_331">::MapIxiaCardnPort</a></a> $rxChas $rxCard $rxPort]
      <a name="::displayDhcpPacketFormat(1)"><a href="./frameFormat.tcl.html#::displayDhcpPacketFormat_339">::displayDhcpPacketFormat</a></a> -txPortId $txPortId -rxPortId $rxPortId \
        -destMac $dMacAddr -srcMac $sMacAddr -srcIp $sIpAddr -destIp $dIpAddr \
        -saMode $saMode -daMode $daMode -clientHwAddr $clientHwAddr \
        -clientIpAddr $clientIpAddr -opCode $opCode -direction $direction \
        -optionCodeList $optionCodeList -wTag $wTag -tagNo $tagNo \
        -frameSent $streamSent
      return $streamSent
   } else {
      return &#34;&#34;
   }
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: ixiaConf_2Ports_arp   </span>
<span class="comment-line"># Description: </span>
<span class="comment-line">#	Set up an ixia port to send ARP packets (request or reply)		     </span>
<span class="comment-line"># Input args: args</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Typical usage: </span>
<span class="comment-line">#	set frameSent [ixiaConf_2Ports_arp -numIxiaCd $numIxiaCd \</span>
<span class="comment-line">#             -txChas $chasisId -txCard $card -txPort $port -startCardNum $startCardNum \</span>
<span class="comment-line">#             -rxChas $chasisId -rxCard $card -rxPort $rxPo \</span>
<span class="comment-line">#             -operation $type -sMacAddr $sourceMac -dMacAddr $destMac \</span>
<span class="comment-line">#             -sIpAddr $sourceIp -dIpAddr $destIp -numFrames $numFrames \</span>
<span class="comment-line">#	      -wTag $wTag -tagNo $tag -frameSize $frameSize -streamType $streamType \</span>
<span class="comment-line">#	      -arpSaMode $arpSaMode -arpDaMode $arpDaMode -percentage $percentage \</span>
<span class="comment-line">#	      -arpSaRepeat $arpSaRepeat -arpDaRepeat $arpDaRepeat]   </span>
<span class="comment-line"># Category: SendTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::ixiaConf_2Ports_arp_582">proc <a href="ePTL3Tx.tcl-annot.html#::::ixiaConf_2Ports_arp">::::ixiaConf_2Ports_arp</a></a></strong> {args} {
   <a name="::parse_args(2)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> ixiaConf_2Ports_arp $args {
      numIxiaCd &#34;1&#34;
      startCardNum &#34;1&#34;
      direction &#34;1Way&#34;
      txChas &#34;1&#34;
      txCard &#34;1&#34;
      txPort &#34;1&#34;
      rxChas &#34;1&#34;
      rxCard &#34;1&#34;
      rxPort &#34;2&#34;
      sMacAddr &#34;default&#34;
      dMacAddr &#34;FF FF FF FF FF FF&#34;
      sIpAddr &#34;127.0.0.1&#34;
      dIpAddr &#34;127.0.0.1&#34;
      arpSaMode &#34;arpIdle&#34;
      arpDaMode &#34;arpIdle&#34;
      operation &#34;arpRequest&#34;
      goodChecksum &#34;true&#34;
      numFrames &#34;1&#34;
      frameSize &#34;64&#34;
      frameRate &#34;default&#34;
      dataPattern &#34;0000&#34;
      streamType &#34;stopStream&#34;
      fcsError &#34;good&#34;
      wTag &#34;false&#34;
      tagNo &#34;002&#34;
      tagCfi &#34;resetCFI&#34;
      tagMode &#34;vIdle&#34;
      tagRepeat &#34;1&#34;
      percentage &#34;0.01&#34;
      saMode &#34;idle&#34;
      daMode &#34;idle&#34;
      chid &#34;1&#34;
      arpSaRepeat &#34;1&#34;
      arpDaRepeat &#34;1&#34;
      srcHwAddr &#34;default&#34;
      srcHwAddrMode &#34;arpIdle&#34;
      srcHwAddrRepeat &#34;1&#34;
      destHwAddr &#34;default&#34;
      destHwAddrMode &#34;arpIdle&#34;
      destHwAddrRepeat &#34;1&#34;   
      udfEnable &#34;false&#34;
      udfInitval &#34;00&#34;
      udfOffset &#34;0&#34;
      udfCountertype &#34;c8&#34;
      udfContinuousCount &#34;false&#34;
      dontTx &#34;0&#34;
   }
   global spawn_id
   global one2oneArray
   global macBroadcast
   global preambleSize
<span class="comment-line">#   globalSetDefault</span>
<span class="comment-line">#  protocolStackSetDefault</span>

   set date [clock format [clock seconds] -format &#34;%m-%d-%Y %I.%M.%S%p&#34;]
   <span class="comment-line">#result_debug &#34;\n*** date=$date&#34;</span>
   set time1 [clock seconds]
   set streamType					$streamType
   set patternOffset				32
   set macBroadcast					{FF FF FF FF FF FF}
   set preambleSize					8

   <span class="comment-line"># Create mapping</span>
<span class="comment-line">#   map new -type					one2one</span>
<span class="comment-line">#   map config -type 				one2one</span>
   if { $direction == &#34;2Way&#34; } {
<span class="comment-line">#puts &#34;--------------------- ll3 -----------------&#34;</span>
      <a name="::map(3)"><a href="./ePTClient.tcl.html#::map_366">::map</a></a> add $txChas $txCard $txPort $rxChas $rxCard $rxPort $rxChas $rxCard $rxPort $txChas $txCard $txPort
<span class="comment-line">#puts &#34;--------------------- ll4 -----------------&#34;</span>
   } else  {
      <a name="::map(4)"><a href="./ePTClient.tcl.html#::map_366">::map</a></a> add $txChas $txCard $txPort $rxChas $rxCard $rxPort
   }


   <span class="comment-line"># Config streams for validation traffic</span>
<span class="comment-line">#   foreach txMap [lsort -dictionary [array names one2oneArray]] {</span>
<span class="comment-line">#      scan $txMap					&#34;%d,%d,%d&#34; chid c p</span>
<span class="comment-line">#      port get						$chid $c $p</span>
<span class="comment-line">#      set txSpeed					[port cget -speed]</span>
       set txSpeed 100
      <a name="::stream(15)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -numFrames		$numFrames
<span class="comment-line">#      stream config -name 			S_${c}_${p}</span>
      <a name="::stream(16)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -framesize		$frameSize
      <a name="::decideLoopCount(2)"><a href="./ePTMisc.tcl.html#::decideLoopCount_499">::decideLoopCount</a></a> $numFrames $streamType

      if { $frameRate == &#34;default&#34; } {
         set frameRate [<a name="::decideFrameRate(1)"><a href="./ePTMisc.tcl.html#::decideFrameRate_423">::decideFrameRate</a></a> $txSpeed $frameSize $percentage]
      } else {
         set percentage [<a name="::decidePercentage(1)"><a href="./ePTMisc.tcl.html#::decidePercentage_471">::decidePercentage</a></a> $txSpeed $frameSize $frameRate]
      }
      <a name="::stream(17)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -rateMode usePercentRate
      <a name="::stream(18)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -percentPacketRate $percentage

<span class="comment-line">#      set ifg [calculateGap $frameRate $frameSize $preambleSize $txSpeed]</span>

      <span class="comment-line"># Now we configure the stream</span>
      <a name="::stream(19)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -fcs                       $fcsError
<span class="comment-line">#      stream config -ifg                       $ifg</span>
<span class="comment-line">#      stream config -isg                       $ifg</span>
<span class="comment-line">#      stream config -ibg                       $ifg</span>
      <a name="::stream(20)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -fir                       false           ;<span class="comment-line"># for timestamp</span>
      <a name="::stream(21)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -patternType nonRepeat  ;<span class="comment-line">#needed for version 3.1</span>
<span class="comment-line">#      stream config -dataPattern	userpattern -pattern $dataPattern</span>
      <a name="::stream(22)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -dataPattern $dataPattern
      <a name="::port(5)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> get						$txChas $txCard $txPort
    set srcAddr					[<a name="::port(6)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> cget -MacAddress]
       after 200   
<span class="comment-line">#    set rxMap						$one2oneArray($txMap)</span>
<span class="comment-line">#     scan [join $rxMap]			&#34;%d %d %d&#34; rxch rxc rxp</span>
     <a name="::port(7)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> get						$rxChas $rxCard $rxPort
     set destAddr					[<a name="::port(8)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> cget -MacAddress]
       after 200   

      <a name="::stream(23)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -saRepeatCounter $saMode 
      <a name="::stream(24)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -daRepeatCounter $daMode 
      if { $saMode != &#34;idle&#34; } { <a name="::stream(25)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -numSA $numFrames }
      if { $daMode != &#34;idle&#34; } { <a name="::stream(26)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -numDA $numFrames }

      if { $sMacAddr == &#34;default&#34; } { 
         set sTmpMacAddr $srcAddr
      } else {
         set sTmpMacAddr $sMacAddr
      }

      if { $dMacAddr == &#34;FF FF FF FF FF FF&#34; } {
         set dTmpMacAddr &#34;FF FF FF FF FF FF&#34;
      } else {
         set dTmpMacAddr $dMacAddr
      }


	  <a name="::stream(27)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -sa 					$sTmpMacAddr
          <a name="::stream(28)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -da 					$dTmpMacAddr

	  <a name="::protocol(5)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a> config -ethernetType 		ethernetII
	  <a name="::protocol(6)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a> config -name					ip
	  <a name="::protocol(7)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a> config -appName				Arp
	  <a name="::protocol(8)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a> config -enable802dot1qTag	$wTag

     <a name="::arp(1)"><a href="./ePTClient.tcl.html#::arp_1522">::arp</a></a> config -sourceProtocolAddr		 $sIpAddr
     <a name="::arp(2)"><a href="./ePTClient.tcl.html#::arp_1522">::arp</a></a> config -destProtocolAddr		 $dIpAddr
     <a name="::arp(3)"><a href="./ePTClient.tcl.html#::arp_1522">::arp</a></a> config -sourceProtocolAddrMode          $arpSaMode
     <a name="::arp(4)"><a href="./ePTClient.tcl.html#::arp_1522">::arp</a></a> config -destProtocolAddrMode            $arpDaMode
  
     if {$srcHwAddr==&#34;default&#34;} {
        <a name="::arp(5)"><a href="./ePTClient.tcl.html#::arp_1522">::arp</a></a> config -sourceHardwareAddr	         $sTmpMacAddr
     } else {
        <a name="::arp(6)"><a href="./ePTClient.tcl.html#::arp_1522">::arp</a></a> config -sourceHardwareAddr	         $srcHwAddr
     }

     if {$destHwAddr==&#34;default&#34;} {
        <a name="::arp(7)"><a href="./ePTClient.tcl.html#::arp_1522">::arp</a></a> config -destHardwareAddr             $dTmpMacAddr
     } else {
        <a name="::arp(8)"><a href="./ePTClient.tcl.html#::arp_1522">::arp</a></a> config -destHardwareAddr             $destHwAddr
     }

<span class="comment-line">#    arp config -destHardwareAddr	         &#34;00 00 00 00 00 00&#34;</span>
     <a name="::arp(9)"><a href="./ePTClient.tcl.html#::arp_1522">::arp</a></a> config -sourceProtocolAddrRepeatCount   $arpSaRepeat
     <a name="::arp(10)"><a href="./ePTClient.tcl.html#::arp_1522">::arp</a></a> config -destProtocolAddrRepeatCount     $arpDaRepeat
     <a name="::arp(11)"><a href="./ePTClient.tcl.html#::arp_1522">::arp</a></a> config -operation		         $operation
     <a name="::arp(12)"><a href="./ePTClient.tcl.html#::arp_1522">::arp</a></a> config -sourceHardwareAddrMode	         $srcHwAddrMode
     <a name="::arp(13)"><a href="./ePTClient.tcl.html#::arp_1522">::arp</a></a> config -sourceHardwareAddrRepeatCount   $srcHwAddrRepeat
     <a name="::arp(14)"><a href="./ePTClient.tcl.html#::arp_1522">::arp</a></a> config -destHardwareAddrMode            $destHwAddrMode
     <a name="::arp(15)"><a href="./ePTClient.tcl.html#::arp_1522">::arp</a></a> config -destHardwareAddrRepeatCount     $destHwAddrRepeat

<span class="comment-line">#     arp set								    $chid $c $p</span>
      
 <span class="comment-line"># Define UDF package</span>
      if {$udfEnable == &#34;true&#34;} {
          set inter 0
          foreach udfOffs $udfOffset {
          <a name="::udf(1)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -enable &#34;true&#34;
          <a name="::udf(2)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -continuousCount [lindex $udfContinuousCount $inter]
          <a name="::udf(3)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -initval [lindex $udfInitval $inter]
          <a name="::udf(4)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -offset [lindex $udfOffset $inter]
          <a name="::udf(5)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -countertype [lindex $udfCountertype $inter]
          incr inter
<span class="comment-line">#          udf set $inter</span>
          }
      }
          <a name="::udf(6)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -enable $udfEnable
      <a name="::vlan(5)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> config -cfi						$tagCfi
      <a name="::vlan(6)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> config -mode						$tagMode
      <a name="::vlan(7)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> config -repeat					$tagRepeat
         if {$wTag == &#34;true&#34;} {
	  <a name="::vlan(8)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> config -vlanID					$tagNo
          } else {
           <a name="::vlan(9)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> config -vlanID					none
          }
<span class="comment-line">#      vlan set								$chid $c $p</span>
      
<span class="comment-line">#      vlan set								$chid $c $p</span>
<span class="comment-line">#      stream set							$chid $c $p 1</span>

	  <span class="comment-line"># Define filter &amp; capture</span>
      <a name="::filter(9)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterEnable		true
      <a name="::filter(10)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerEnable		true
      <a name="::filter(11)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -userDefinedStat1Enable		false
      <a name="::filter(12)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -userDefinedStat1DA			addr1
      <a name="::filter(13)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterPattern		anyPattern
      <a name="::filter(14)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerPattern		anyPattern
      <a name="::filter(15)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerDA			anyAddr
      <a name="::filter(16)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterDA			anyAddr
<span class="comment-line">#      filter set								$rxch $rxc $rxp</span>

      <a name="::filterPallette(4)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> config -DA1 				$destAddr
      <a name="::filterPallette(5)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> config -pattern1			$dataPattern
      <a name="::filterPallette(6)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> config -patternOffset1 	$patternOffset
<span class="comment-line">#      filterPallette set						$rxch $rxc $rxp</span>
<span class="comment-line"># }</span>
   set portList &#34;$txChas:$txCard:$txPort&#34;
<span class="comment-line">#   writeConfigToHardware one2oneArray</span>
   <a name="::writeConfigToHardware(2)"><a href="./mapping.tcl.html#::writeConfigToHardware_148">::writeConfigToHardware</a></a> $portList
   <a name="::zeroPortStats(2)"><a href="./mapping.tcl.html#::zeroPortStats_130">::zeroPortStats</a></a> $txChas $txCard $txPort
   <span class="comment-line">#for {set c $startCardNum} {$c&lt;=[expr $startCardNum + $numIxiaCd - 1]} {incr c 1} { ixiaConf_clearStat $c }</span>
   <span class="comment-line">#just in case some previous function stop capture on these ports</span>
      <a name="::stream(29)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> get $txChas $txCard $txPort 1
      set streamSent [<a name="::stream(30)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> cget -packetView]
   set pList &#34;&#34;
   lappend pList &#34;$txChas $txCard $txPort&#34;
   lappend pList &#34;$rxChas $rxCard $rxPort&#34;
   <a name="::ixStartCapture(2)"><a href="./mapping.tcl.html#::ixStartCapture_106">::ixStartCapture</a></a> $pList
   if {!$dontTx} {
<span class="comment-line">#      startTx one2oneArray</span>
      <a name="::startTx(2)"><a href="./mapping.tcl.html#::startTx_94">::startTx</a></a> $portList
      set time2 [clock seconds]
      <span class="comment-line">#result_debug &#34;*** Frame sent from ($txChas $txCard $txPort) = $streamSent&#34;</span>
<span class="comment-line">#      result_debug &#34;*** Time for Ixia TX setup = [expr $time2-$time1] secs&#34;</span>

      <span class="comment-line"># Make sure TX done</span>
      if { $streamType == &#34;stopStream&#34; } {
         if { ($saMode != &#34;contIncrement&#34;) &amp;&amp; ($saMode != &#34;contDecrement&#34;) &amp;&amp;   \
              ($daMode != &#34;contIncrement&#34;) &amp;&amp; ($daMode != &#34;contDecrement&#34;) } {
            <a name="::ixiaCheckTxDone(3)"><a href="./ePTMisc.tcl.html#::ixiaCheckTxDone_334">::ixiaCheckTxDone</a></a> $txChas $txCard $txPort $numFrames $txPort
            if { $direction == &#34;2Way&#34; } {
               <a name="::ixiaCheckTxDone(4)"><a href="./ePTMisc.tcl.html#::ixiaCheckTxDone_334">::ixiaCheckTxDone</a></a> $rxChas $rxCard $rxPort $numFrames $txPort
            }
         }
      }
      after 500
      set time3 [clock seconds]
<span class="comment-line">#     result_debug &#34;*** Time for Ixia TX done = [expr $time3-$time2] secs\n&#34;</span>
      <a name="::result_debug(2)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;*** Ixia port config time [expr $time2-$time1] secs and TX time [expr $time3-$time2] secs\n&#34;
      if {$sMacAddr == &#34;default&#34;} {
         set sMacAddr $srcAddr
      }
      set txPortId [<a name="::MapIxiaCardnPort(3)"><a href="./ePTPortMapping.tcl.html#::MapIxiaCardnPort_331">::MapIxiaCardnPort</a></a> $txChas $txCard $txPort]
      set rxPortId [<a name="::MapIxiaCardnPort(4)"><a href="./ePTPortMapping.tcl.html#::MapIxiaCardnPort_331">::MapIxiaCardnPort</a></a> $rxChas $rxCard $rxPort]
      <a name="::displayArpPacketFormat(1)"><a href="./frameFormat.tcl.html#::displayArpPacketFormat_468">::displayArpPacketFormat</a></a> -txPortId $txPortId -rxPortId $rxPortId \
        -direction $direction -destMac $dMacAddr -srcMac $sMacAddr \
        -srcIp $sIpAddr -destIp $dIpAddr -operation $operation \
        -wTag $wTag -tagNo $tagNo -frameSent $streamSent
      return $streamSent
   } else {
      return &#34;&#34;
   }
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: ixiaConf_2Ports_ip   </span>
<span class="comment-line"># Description: </span>
<span class="comment-line">#	Set up an ixia port to send IP packets (tcp/udp/icmp/igmp)		     </span>
<span class="comment-line"># Input args: args</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Typical usage: </span>
<span class="comment-line">#	 set frameSent [ixiaConf_2Ports_ip -numIxiaCd $numIxiaCd \</span>
<span class="comment-line">#             -txChas $chasisId -txCard $card -txPort $port -startCardNum $startCardNum \</span>
<span class="comment-line">#             -rxChas $ch -rxCard $c -rxPort $rxPort \</span>
<span class="comment-line">#             -ipProtocol $protocol -sMacAddr $sourceMac -dMacAddr $destMac \</span>
<span class="comment-line">#             -sIpAddr $sourceIp -dIpAddr $destIp -dDutIpAddr $gatewayIp -ttl $ttl \</span>
<span class="comment-line">#             -pSrcPort $sourcePort -pDstPort $destPort \</span>
<span class="comment-line">#             -frameSizeType $frameSizeType -frameSizeMIN $frameSizeMIN  -frameSizeMAX $frameSizeMAX \</span>
<span class="comment-line">#	      -goodChecksum $goodChecksum -numFrames $numFrames -frameSize $frameSize \</span>
<span class="comment-line">#	      -frameRate $frameRate -dataPattern $dataPattern -streamType $streamType \</span>
<span class="comment-line">#	      -fcsError $fcsError -wTag $wTag -tagNo $tag -TOS $TOS -userPriority $userPriority \</span>
<span class="comment-line">#	      -percentage $percentage -priority $priority -ipOptions $ipOptions -direction $direction \</span>
<span class="comment-line">#             -saMode $saMode -daMode $daMode -ipSaMode $ipSaMode -ipDaMode $ipDaMode -dIpMask $dIpMask sIpMask $sIpMask \</span>
<span class="comment-line">#             -dontFrag $dontFrag -tcpSeqNum $tcpSeqNum -tcpSynFlag $tcpSynFlag -tcpFinFlag $tcpFinFlag \</span>
<span class="comment-line">#             -tcpRstFlag $tcpRstFlag -tcpAckFlag $tcpAckFlag -sequence $sequence -type $type -code $code \</span>
<span class="comment-line">#             -id $id -applyFilter $applyFilter -maxResponseTime $maxResponseTime -groupAddr $groupAddr \</span>
<span class="comment-line">#             -udfEnable $udfEnable -udfInitval $udfInitval -udfOffset $udfOffset -udfCountertype $udfCountertype ]   </span>
<span class="comment-line"># Category: SendTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::ixiaConf_2Ports_ip_867">proc <a href="ePTL3Tx.tcl-annot.html#::::ixiaConf_2Ports_ip">::::ixiaConf_2Ports_ip</a></a></strong> {args} {
   <a name="::parse_args(3)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> ixiaConf_2Ports_ip $args {
      numIxiaCd &#34;1&#34;
      startCardNum &#34;1&#34;
      direction &#34;1Way&#34;
      txChas &#34;1&#34;
      txCard &#34;1&#34;
      txPort &#34;1&#34;
      rxChas &#34;1&#34;
      rxCard &#34;1&#34;
      rxPort &#34;2&#34;
	   ipProtocol &#34;ip&#34;
      pSrcPort &#34;00&#34;
	   pDstPort &#34;00&#34;
	   sMacAddr &#34;default&#34;
	   dMacAddr &#34;00 e0 2b 00 00 01&#34;
	   sIpAddr &#34;127.0.0.1&#34;
	   dIpAddr &#34;127.0.0.1&#34;
      dDutIpAddr &#34;127.0.0.1&#34;
	   sIpMask &#34;255.255.255.0&#34;
	   dIpMask &#34;255.255.255.0&#34;
	   sClass &#34;classC&#34;
      dClass &#34;classC&#34;
	   ttl &#34;64&#34;
	   goodChecksum &#34;true&#34;
	   ipOptions &#34;&#34;
	   ipTotalLength &#34;20&#34;
	   TOS &#34;default&#34;
      numFrames &#34;1&#34;
      frameSize &#34;64&#34;
      frameSizeType &#34;sizeFixed&#34;
      frameSizeMAX &#34;1518&#34;
      frameSizeMIN &#34;64&#34;
      frameRate &#34;default&#34;
      dataPattern &#34;0000&#34;
      frameType &#34;08 00&#34;
      streamType &#34;stopStream&#34;
      fcsError &#34;good&#34;
      wTag &#34;false&#34;
	   tagNo &#34;002&#34;
	   tagCfi &#34;resetCFI&#34;
      	tagMode &#34;vIdle&#34;
	tagRepeat &#34;1&#34;
        protocolTagId &#34;null&#34;
	userPriority &#34;0&#34;
	applyFilter &#34;0&#34;
      	percentage &#34;100&#34;
      	priority &#34;0&#34;
      	sendArp &#34;false&#34;
      	numArpFrames &#34;2&#34;
      	saMode &#34;idle&#34;
      	daMode &#34;idle&#34;
        saCount &#34;&#34;
        daCount &#34;&#34;
      	ipSaMode &#34;ipIdle&#34;
      	ipDaMode &#34;ipIdle&#34;
        ipSaCount &#34;&#34;
        ipDaCount &#34;&#34;
      	dontFrag &#34;true&#34; 
      	tcpSynFlag &#34;false&#34;
      	tcpFinFlag &#34;false&#34;
      	tcpRstFlag &#34;false&#34;
      	tcpAckFlag &#34;false&#34;
        tcpPushFlag &#34;false&#34;
        tcpUrgFlag &#34;false&#34;
      	tcpSeqNum &#34;000000000&#34;
      	type &#34;8&#34;
	code &#34;0&#34;
	id &#34;0&#34;
	sequence &#34;0&#34;
	maxResponseTime &#34;100&#34;
        igmpMode &#34;Fixed&#34;
        igmpRepeatCount &#34;&#34;
	groupAddr &#34;224.0.0.1&#34;
      	chid &#34;1&#34;
      	ipApplication &#34;ip&#34;
     	ripCommand &#34;ripRequest&#34;
     	ripVersion &#34;2&#34;
     	ripAuthen &#34;&#34;
     	ripAuthenType &#34;2&#34;
     	ripNumRoute &#34;1&#34;
     	ripRouteFamilyId {2}
     	ripRouteIp {0.0.0.0}
     	ripRouteTag {00}
     	ripRouteMask {0.0.0.0} 
     	ripRouteNextHop {0.0.0.0}
     	ripRouteMetric {16}
     	udfEnable &#34;false&#34;
        udfInitval &#34;00&#34;
        udfOffset &#34;0&#34;
        udfCountertype &#34;c8&#34;
        udfContinuousCount &#34;false&#34;
        protoOffsetEnable &#34;false&#34;
        protoOffset &#34;14&#34;
        userDefTag &#34;&#34;
        clearStats &#34;yes&#34;
        dontTx &#34;0&#34;
        lengthOverride &#34;&#34;
    }
   
         
<span class="comment-line">#result_debug &#34;@@@ ixiaConf_2Ports_ip: numFrames=$numFrames, ipDaMode=$ipDaMode, sIpAddr=$sIpAddr&#34;</span>
<span class="comment-line">#      puts &#34;-dataPattern $dataPattern \</span>
<span class="comment-line">#        -streamType $streamType -percentage $percentage -TOS $TOS   \</span>
<span class="comment-line">#        -ipProtocol $ipProtocol -pDstPort $pDstPort -pSrcPort $pSrcPort \</span>
<span class="comment-line">#        -dMacAddr $dMacAddr  -sIpAddr $sIpAddr  -dIpAddr $dIpAddr&#34;</span>

<span class="comment-line">#puts &#34;frameSize$frameSize percentage$percentage&#34;</span>
        
   global spawn_id
   global one2oneArray
   global macBroadcast
   global preambleSize
<span class="comment-line">#  globalSetDefault</span>
<span class="comment-line">#  protocolStackSetDefault</span>

   set date [clock format [clock seconds] -format &#34;%m-%d-%Y %I.%M.%S%p&#34;]
   <span class="comment-line">#result_debug &#34;\n*** date=$date&#34;</span>
   set time1 [clock seconds]
   
   set enableUDF4DVMRP 0
   <span class="comment-line"># a hack to set dvmrp message</span>
   if {$ipProtocol == &#34;dvmrp&#34; } { 
      set ipProtocol &#34;ip&#34;
      set enableUDF4DVMRP 1
   }
   
   set enablepimdm 0
   if {$ipProtocol == &#34;pim-dm&#34; } { 
      set ipProtocol &#34;ip&#34;
      set enablepimdm 1
   }
   
   set patternOffset          30    ;<span class="comment-line"># offset1 for filterPallette pattern1</span>
   set macBroadcast           {FF FF FF FF FF FF}
   set preambleSize           8

   <span class="comment-line"># Create mapping</span>
<span class="comment-line">#   map new -type              one2one</span>
<span class="comment-line">#   map config -type           one2one</span>
   if { $direction == &#34;2Way&#34; } {
<span class="comment-line">#puts &#34;--------------------- ll3 -----------------&#34;</span>
      <a name="::map(5)"><a href="./ePTClient.tcl.html#::map_366">::map</a></a> add $txChas $txCard $txPort $rxChas $rxCard $rxPort $rxChas $rxCard $rxPort $txChas $txCard $txPort
<span class="comment-line">#puts &#34;--------------------- ll4 -----------------&#34;</span>
   } else  {
      <a name="::map(6)"><a href="./ePTClient.tcl.html#::map_366">::map</a></a> add $txChas $txCard $txPort $rxChas $rxCard $rxPort
   }
   if { $sendArp == &#34;true&#34; } {
      set numLearnFrames 2
<span class="comment-line">#     learn config -numframes $numLearnFrames</span>
<span class="comment-line">#     send_arp_frames one2oneArray</span>
   }


   <span class="comment-line"># Config streams for validation traffic</span>
   set counter 0
    set chid $txChas
    set c $txCard
    set p $txPort
<span class="comment-line">#   foreach txMap [lsort -dictionary [array names one2oneArray]] { </span>
<span class="comment-line">#      scan $txMap					   &#34;%d,%d,%d&#34; chid c p</span>
<span class="comment-line">#      set txSpeed					   [port cget -speed]</span>
      set txSpeed					   100
<span class="comment-line">#      stream setDefault</span>
      <a name="::stream(31)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -numFrames   $numFrames
<span class="comment-line">#      stream config -name        S_${c}_${p}</span>
      <a name="::stream(32)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -frameSizeType	  $frameSizeType
      <a name="::stream(33)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -framesize   $frameSize
      <span class="comment-line">#random size</span>
      if {$frameSizeType == &#34;sizeRandom&#34;} {
         <a name="::stream(34)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -frameSizeType	  $frameSizeType
         <a name="::stream(35)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -frameSizeMAX      $frameSizeMAX
         <a name="::stream(36)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -frameSizeMIN      $frameSizeMIN
      }
      <a name="::decideLoopCount(3)"><a href="./ePTMisc.tcl.html#::decideLoopCount_499">::decideLoopCount</a></a> $numFrames $streamType
      if { $frameRate == &#34;default&#34; } {
         set frameRate [<a name="::decideFrameRate(2)"><a href="./ePTMisc.tcl.html#::decideFrameRate_423">::decideFrameRate</a></a> $txSpeed $frameSize $percentage]
      } else {
         set percentage [<a name="::decidePercentage(2)"><a href="./ePTMisc.tcl.html#::decidePercentage_471">::decidePercentage</a></a> $txSpeed $frameSize $frameRate]
      }

      <a name="::stream(37)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -rateMode usePercentRate
      <a name="::stream(38)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -percentPacketRate $percentage

<span class="comment-line">#result_debug &#34;@@@ frameRate=$frameRate&#34;</span>
<span class="comment-line">#      set ifg [calculateGap $frameRate $frameSize $preambleSize $txSpeed]</span>
      <a name="::stream(39)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -fcs                       $fcsError
<span class="comment-line">#      stream config -ifg                       $ifg</span>
<span class="comment-line">#      stream config -isg                       $ifg</span>
<span class="comment-line">#      stream config -ibg                       $ifg</span>
      <a name="::stream(40)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -fir                       false           ;<span class="comment-line"># for timestamp</span>
      <a name="::stream(41)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -patternType nonRepeat  ;<span class="comment-line">#needed for version 3.1</span>
      <a name="::stream(42)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -dataPattern $dataPattern
<span class="comment-line">#      stream config -dataPattern	userpattern -pattern $dataPattern</span>
      <a name="::stream(43)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -frameType $frameType
<span class="comment-line">#     port get						   $chid $c $p</span>
      <a name="::port(9)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> get $txChas $txCard $txPort
      set srcAddr					   [<a name="::port(10)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> cget -MacAddress]
      after 200   
<span class="comment-line">#      set rxMap						$one2oneArray($txMap)</span>
<span class="comment-line">#     scan [join $rxMap]			&#34;%d %d %d&#34; rxch rxc rxp</span>
   
<span class="comment-line">#      port get						   $rxch $rxc $rxp</span>
      <a name="::port(11)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> get						   $rxChas $rxCard $rxPort
      set destAddr					[<a name="::port(12)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> cget -MacAddress]
       after 200  
      <a name="::stream(44)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -saRepeatCounter $saMode 
      <a name="::stream(45)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -daRepeatCounter $daMode 
      if {$saMode != &#34;idle&#34;} {
          if {$saCount == &#34;&#34;} {
              <a name="::stream(46)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -numSA $numFrames
          } else {
              <a name="::stream(47)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -numSA $saCount
          }
      }
      if {$daMode != &#34;idle&#34;} {
          if {$daCount == &#34;&#34;} {
              <a name="::stream(48)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -numDA $numFrames
          } else {
              <a name="::stream(49)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -numDA $daCount
          }
      }

      if { $sMacAddr == &#34;default&#34; } { <a name="::stream(50)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -sa $srcAddr
      } else {                        <a name="::stream(51)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -sa $sMacAddr }
      
      <span class="comment-line">#Kludge to get the first mac address      </span>
      if {[llength $dMacAddr]&gt;2} {
         set dMacAdd $dMacAddr
      } else {
         set dMacAdd [lindex $dMacAddr $counter]
      }
      if {$counter==0} {
         if {[llength $dMacAddr]&gt;2} {set dMacAddToFilter $dMacAddr} else {set dMacAddToFilter [lindex $dMacAddr 1]}
      } else {
         set dMacAddToFilter [lindex $dMacAddr 0]
      }

      <span class="comment-line"># if IP packet is to multicast fwded, set the DAMAC to be multicast and SA mac to be port mac</span>
      if {[regexp -nocase &#34;01 00 5e&#34; $dMacAddr]} {
         <span class="comment-line">#set dMacAddToFilter $srcAddr   ;# can not figure out for now as maybe L2 or L3 mcast fwding.</span>
         set destAddr $dMacAdd         
      }

      <a name="::stream(52)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> config -da 						   $dMacAdd
<span class="comment-line">#      protocol setDefault</span>
	   <a name="::protocol(9)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a> config -ethernetType  		ethernetII
	   <a name="::protocol(10)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a> config -name			ip
	   <a name="::protocol(11)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a> config -enable802dot1qTag		[lindex $wTag $counter]


      switch $ipApplication {
	&#34;rip&#34;  	{ <a name="::protocol(12)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a> config -appName Rip }
	&#34;ip&#34; -
	default { <a name="::protocol(13)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a> config -appName ip }
      }	   

<span class="comment-line">#     ip setDefault</span>
      set myDestIpAddr &#34;&#34;
      if { ($chid == $txChas) &amp;&amp; ($c == $txCard) &amp;&amp; ($p == $txPort) } {
	      <a name="::ip(6)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -sourceClass					$sClass
         <a name="::ip(7)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -sourceIpAddr				   $sIpAddr
	      <a name="::ip(8)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -sourceIpMask				   $sIpMask
         <a name="::ip(9)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -destClass					   $dClass
	      <a name="::ip(10)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -destIpAddr					$dIpAddr
	      <a name="::ip(11)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -destIpMask					$dIpMask
  	      set myDestIpAddr $dIpAddr
	  } else {
	      <a name="::ip(12)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -sourceClass					$dClass
         <a name="::ip(13)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -sourceIpAddr				   $dIpAddr
	      <a name="::ip(14)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -sourceIpMask				   $dIpMask
         <a name="::ip(15)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -destClass					   $sClass
	      <a name="::ip(16)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -destIpAddr					$sIpAddr
	      <a name="::ip(17)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -destIpMask					$sIpMask
  	      set myDestIpAddr $sIpAddr
	  }

     <a name="::ip(18)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -sourceIpAddrMode 				$ipSaMode 
     <a name="::ip(19)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -sourceIpAddrRepeatCount		1
     <a name="::ip(20)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -destIpAddrMode					$ipDaMode 
	  <a name="::ip(21)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -destIpAddrRepeatCount			1
	  <a name="::ip(22)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -destMacAddr					   $dMacAddr
     <a name="::ip(23)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -destDutIpAddr					   $dDutIpAddr
	
     if {$ipSaMode != &#34;ipIdle&#34;} {
         if {$ipSaCount == &#34;&#34;} {
             <a name="::ip(24)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -sourceIpAddrRepeatCount $numFrames
         } else {
             <a name="::ip(25)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -sourceIpAddrRepeatCount $ipSaCount
         }
     }
     if {$ipDaMode != &#34;ipIdle&#34;} {
         if {$ipDaCount == &#34;&#34;} {
             <a name="::ip(26)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -destIpAddrRepeatCount $numFrames
         } else {
             <a name="::ip(27)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -destIpAddrRepeatCount $ipDaCount
         }
     }

	  <a name="::ip(28)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -ipProtocol                   $ipProtocol
	  <a name="::ip(29)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -ttl                          $ttl
	  <a name="::ip(30)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -useValidChecksum             $goodChecksum
      
     if {$dontFrag == &#34;true&#34; } {
        <a name="::ip(31)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -fragment                     1
     } else {
        <a name="::ip(32)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -fragment                     0
     }

     if {[string length $ipOptions]} {
         <a name="::ip(33)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -options						$ipOptions
     }

	  if {$TOS != &#34;default&#34; } {
<span class="comment-line">#	  	   puts &#34;TOS |$TOS|&#34;</span>
	      set precedence [expr [expr $TOS&amp;0x80]==0x80][expr [expr $TOS&amp;0x40]==0x40][expr [expr $TOS&amp;0x20]==0x20]b
<span class="comment-line">#	      puts &#34;Precedence |$precedence|&#34;</span>
	      set key(000b) routine
	      set key(001b) priority
	      set key(010b) immediate
	      set key(011b) flash
	      set key(100b) flashOverride
	      set key(101b) criticEcp
	      set key(110b) internetControl
	      set key(111b) networkControl
   	  if {([expr $TOS &amp; 0x10] == 0x10)} {
   	      <a name="::ip(34)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -delay                 1
   	   } else { <a name="::ip(35)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -delay           0 }
   	  if {([expr $TOS &amp; 0x08] == 0x08)} {
            <a name="::ip(36)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -throughput            1
   	   } else { <a name="::ip(37)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -throughput      0 }
   	  if {([expr $TOS &amp; 0x04] == 0x04)} {
   	      <a name="::ip(38)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -reliability					   1
   	   } else { <a name="::ip(39)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -reliability				0 }
   	  <a name="::ip(40)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -precedence						$key($precedence)
   	  <a name="::ip(41)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -tos						$TOS
      } else { 
          set TOS &#34;00&#34;
   	  <a name="::ip(42)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -tos						$TOS
      }
<span class="comment-line">#      card get                                             $chid $c</span>
<span class="comment-line">#      set ixiaCardType                                     [card cget -typeName]</span>
<span class="comment-line">#      set flag [regexp -nocase &#34;XMS|XMV&#34; $ixiaCardType]</span>
       set flag 0
      if {$ipTotalLength != &#34;default&#34; } {

        if {$lengthOverride != &#34;&#34; } {
         <a name="::ip(43)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -lengthOverride $lengthOverride
        } else {

        <span class="comment-line"># For XMS or XMV ixia card type when ipTotalLength is not equal to default,lengthOverride must be false</span>
        <span class="comment-line"># If not it will be treated as bad packet Hence added the below code</span>
          if !{$flag} {
             <a name="::ip(44)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -lengthOverride &#34;true&#34;
          }
        }                  
         <a name="::ip(45)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -totalLength  $ipTotalLength
         <a name="::ip(46)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -identifier 6558 ;<span class="comment-line">#14700      </span>
      }
      if {$lengthOverride != &#34;&#34; } {
         <a name="::ip(47)"><a href="./ePTClient.tcl.html#::ip_974">::ip</a></a> config -lengthOverride $lengthOverride
      }
 <span class="comment-line">#     ip set                                  $chid $c $p</span>

      switch $ipProtocol {
	&#34;tcp&#34;  { <a name="::tcpConfig(1)"><a href="./ePTL3Tx.tcl.html#::tcpConfig_1477">::tcpConfig</a></a> $chid $c $p $pSrcPort $pDstPort $tcpSeqNum $tcpSynFlag $tcpFinFlag $tcpRstFlag $tcpAckFlag $tcpPushFlag $tcpUrgFlag}
	&#34;udp&#34;  { <a name="::udpConfig(1)"><a href="./ePTL3Tx.tcl.html#::udpConfig_1507">::udpConfig</a></a> $chid $c $p $pSrcPort $pDstPort }
	&#34;icmp&#34; { <a name="::icmpConfig(1)"><a href="./ePTL3Tx.tcl.html#::icmpConfig_1525">::icmpConfig</a></a> $chid $c $p $type $code $id $sequence}
	&#34;igmp&#34; { <a name="::igmpConfig(1)"><a href="./ePTL3Tx.tcl.html#::igmpConfig_1544">::igmpConfig</a></a> $chid $c $p $groupAddr $type $maxResponseTime $igmpMode $igmpRepeatCount
	         if {$type==18} {
               <a name="::igmp(1)"><a href="./ePTClient.tcl.html#::igmp_1323">::igmp</a></a> config -version 1
               <a name="::igmp(2)"><a href="./ePTClient.tcl.html#::igmp_1323">::igmp</a></a> config -maxResponseTime 00
<span class="comment-line">#               igmp set $chid $c $p</span>
	         }
	       }
      }
      if  { $ipApplication == &#34;rip&#34; } {
<span class="comment-line">#        rip setDefault</span>
        <a name="::rip(1)"><a href="./ePTClient.tcl.html#::rip_1158">::rip</a></a> config -command 	$ripCommand
        <a name="::rip(2)"><a href="./ePTClient.tcl.html#::rip_1158">::rip</a></a> config -version	$ripVersion 
        
<span class="comment-line">#        ripRoute setDefault</span>
<span class="comment-line">#        for {set index 0} {$index &lt; $ripNumRoute } {incr index} {</span>
<span class="comment-line">#          set routeID [expr $index + 1]</span>
<span class="comment-line">#    	  result_debug &#34;Setting route $routeID to [lindex $ripRouteIp $index]&#34;</span>
<span class="comment-line">#          ripRoute set $routeID</span>
<span class="comment-line">#        }  </span>
<span class="comment-line">#        rip set 	$chid $c $p</span>
<span class="comment-line">#    	  ripRoute config -familyId [lindex $ripRouteFamilyId $index ]</span>
<span class="comment-line">#    	  ripRoute config -routeTag [lindex $ripRouteTag $index ]</span>
<span class="comment-line">#          ripRoute config -ipAddress [lindex $ripRouteIp $index ]</span>
<span class="comment-line">#          ripRoute config -subnetMask [lindex $ripRouteMask $index ]</span>
<span class="comment-line">#          ripRoute config -nextHop [lindex $ripRouteNextHop $index ]</span>
<span class="comment-line">#          ripRoute config -metric [lindex $ripRouteMetric $index ]</span>
    	  <a name="::ripRoute(1)"><a href="./ePTClient.tcl.html#::ripRoute_1192">::ripRoute</a></a> config -familyId $ripRouteFamilyId
    	  <a name="::ripRoute(2)"><a href="./ePTClient.tcl.html#::ripRoute_1192">::ripRoute</a></a> config -routeTag $ripRouteTag
          <a name="::ripRoute(3)"><a href="./ePTClient.tcl.html#::ripRoute_1192">::ripRoute</a></a> config -ipAddress $ripRouteIp
          <a name="::ripRoute(4)"><a href="./ePTClient.tcl.html#::ripRoute_1192">::ripRoute</a></a> config -subnetMask $ripRouteMask
          <a name="::ripRoute(5)"><a href="./ePTClient.tcl.html#::ripRoute_1192">::ripRoute</a></a> config -nextHop $ripRouteNextHop
          <a name="::ripRoute(6)"><a href="./ePTClient.tcl.html#::ripRoute_1192">::ripRoute</a></a> config -metric $ripRouteMetric
      }
      if {$protocolTagId != &#34;null&#34;} {
          set decProtoTagId [expr $protocolTagId]
          <a name="::vlan(10)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> config -protocolTagId                            $decProtoTagId
      }
            
      <a name="::vlan(11)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> config -cfi							   $tagCfi
      <a name="::vlan(12)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> config -mode							   $tagMode
      <a name="::vlan(13)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> config -repeat						   $tagRepeat
      <a name="::vlan(14)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> config -userPriority			      $userPriority
      if {$protocolTagId != &#34;null&#34;} {
          set decProtoTagId [expr $protocolTagId]
          <a name="::vlan(15)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> config -protocolTagId                            $decProtoTagId
      }      
      if {[lindex $wTag $counter]==&#34;true&#34;} {
         <a name="::vlan(16)"><a href="./ePTClient.tcl.html#::vlan_772">::vlan</a></a> config -vlanID						[lindex $tagNo $counter]
<span class="comment-line">#         vlan set									   $chid $c $p</span>
      }
      incr counter

      <span class="comment-line">#overwrite the ip protocol into igmp protocol, so the datapattern can go right</span>
      <span class="comment-line">#after the ip header and not after igmp header is used igmp directly</span>
      if { $enableUDF4DVMRP } {
<span class="comment-line">#         udf setDefault</span>
         <a name="::udf(7)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -enable &#34;true&#34;
         <a name="::udf(8)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -initval &#34;02&#34;
         <a name="::udf(9)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -offset 23
         <a name="::udf(10)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -countertype &#34;c8&#34;
<span class="comment-line">#         udf set 1</span>
      }
      
      if {$enablepimdm} {
<span class="comment-line">#         udf setDefault</span>
       <a name="::udf(11)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -enable &#34;true&#34;
         <a name="::udf(12)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -initval &#34;67&#34;
         <a name="::udf(13)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -offset 23
         <a name="::udf(14)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -countertype &#34;c8&#34;
<span class="comment-line">#         udf set 1</span>
      }
<span class="comment-line">#      stream set                             $chid $c $p 1</span>

      <span class="comment-line">#set packet group to default, otherwise will cause ICMP bad CRC</span>
<span class="comment-line">##      packetGroup setDefault						</span>
<span class="comment-line">#      packetGroup setTx                      $chid $c $p 1</span>

      <span class="comment-line"># Define UDF package </span>
      if {$udfEnable == &#34;true&#34;} {
          set inter 0
          foreach udfOffs $udfOffset {
          <a name="::udf(15)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -enable &#34;true&#34;
          <a name="::udf(16)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -continuousCount [lindex $udfContinuousCount $inter]
          <a name="::udf(17)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -initval [lindex $udfInitval $inter]
          <a name="::udf(18)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -offset [lindex $udfOffset $inter]
          <a name="::udf(19)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -countertype [lindex $udfCountertype $inter]
          incr inter
<span class="comment-line">#          udf set $inter</span>
          }
      }
          <a name="::udf(20)"><a href="./ePTClient.tcl.html#::udf_2121">::udf</a></a> config -enable $udfEnable
      <span class="comment-line"># define protocolOffset</span>
      if {$protoOffsetEnable == &#34;true&#34;} {
<span class="comment-line">#         protocolOffset setDefault</span>
         <a name="::protocolOffset(1)"><a href="./ePTClient.tcl.html#::protocolOffset_816">::protocolOffset</a></a> config -enable true
         <a name="::protocolOffset(2)"><a href="./ePTClient.tcl.html#::protocolOffset_816">::protocolOffset</a></a> config -offset $protoOffset
         <a name="::protocolOffset(3)"><a href="./ePTClient.tcl.html#::protocolOffset_816">::protocolOffset</a></a> config -userDefinedTag $userDefTag
<span class="comment-line">#         if [protocolOffset set $txChas $txCard $txPort] {</span>
<span class="comment-line">#            result_debug &#34;Error in protocolOffset set for \</span>
<span class="comment-line">#                          $txChas $txCard $txPort&#34;</span>
<span class="comment-line">#         }</span>
      } else {
<span class="comment-line">#         protocolOffset setDefault</span>
         <a name="::protocolOffset(4)"><a href="./ePTClient.tcl.html#::protocolOffset_816">::protocolOffset</a></a> config -enable false
<span class="comment-line">#        protocolOffset set $txChas $txCard $txPort</span>
      }
<span class="comment-line">#      stream set                             $chid $c $p 1</span>
          
      <span class="comment-line"># Define filter &amp; capture</span>

      <a name="::filter(17)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterEnable		true
      <a name="::filter(18)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerEnable		true
      if {$applyFilter} {
         <a name="::filter(19)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -userDefinedStat1Enable  true
         <span class="comment-line"># In case of mcast fwding, dont care of SA1 value</span>
         if {[regexp -nocase &#34;01 00 5e&#34; $dMacAddr]} {
            <a name="::filter(20)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -userDefinedStat1SA      anyPattern
         } else {
            <a name="::filter(21)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -userDefinedStat1SA      addr1
         }
      } else {
         <a name="::filter(22)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -userDefinedStat1Enable  false
      }
      <a name="::filter(23)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -userDefinedStat1DA      addr1
      
      <a name="::filter(24)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterPattern		anyPattern
      <a name="::filter(25)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerPattern   anyPattern
      <a name="::filter(26)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerDA			anyAddr
      <a name="::filter(27)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterDA			anyAddr
      <a name="::filter(28)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -userDefinedStat1Pattern      pattern1
<span class="comment-line">#      filter set                             $rxch $rxc $rxp</span>

      <a name="::filterPallette(7)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> config -DA1 				$destAddr
      <a name="::filterPallette(8)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> config -matchType1   matchIpDAEthernetII
      set fir &#34;&#34;
      set sec &#34;&#34;
      set thi &#34;&#34;
      set fou &#34;&#34;
<span class="comment-line">#      scan $myDestIpAddr %d.%d.%d.%d fir sec thi fou</span>
      if {($fir!=&#34;&#34;)&amp;&amp;($sec!=&#34;&#34;)&amp;&amp;($thi!=&#34;&#34;)&amp;&amp;($fou!=&#34;&#34;)} {
         set pattern1 [string toupper [format &#34;%02x %02x %02x %02x&#34; $fir $sec $thi $fou]]
      } else {
         set pattern1 &#34;&#34;
      }
      <a name="::filterPallette(9)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> config -pattern1     $pattern1
      <a name="::filterPallette(10)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> config -SA1          $dMacAddToFilter

      <a name="::filterPallette(11)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> config -patternOffset1 	$patternOffset
<span class="comment-line">#     filterPallette set                     $rxch $rxc $rxp</span>
<span class="comment-line">#      puts &#34;the set is $rxch, $rxc, $rxp with DA1 $destAddr, Pattern1 $myDestIpAddr, SA1 $dMacAddToFilter&#34;</span>
<span class="comment-line">#   }</span>
<span class="comment-line">#   writeConfigToHardware one2oneArray</span>
   set portList &#34;$txChas:$txCard:$txPort&#34;
    if {[<a name="::ixWriteConfigToHardware(1)"><a href="./mapping.tcl.html#::ixWriteConfigToHardware_151">::ixWriteConfigToHardware</a></a> $portList -noProtocolServer]} {
	ixPuts &#34;failed to do ixWritePortsToHardware.\n$::ixErrorInfo&#34;
    }
<span class="comment-line">#   writeConfigToHardware $portList</span>
   if {$clearStats == &#34;yes&#34; } {
       <a name="::zeroPortStats(3)"><a href="./mapping.tcl.html#::zeroPortStats_130">::zeroPortStats</a></a> $txChas $txCard $txPort
   }
   <span class="comment-line">#for {set c $startCardNum} {$c&lt;=[expr $startCardNum + $numIxiaCd - 1]} {incr c 1} { ixiaConf_clearStat $c }</span>
   <span class="comment-line">#just in case some previous function stop capture on these ports</span>
      <a name="::stream(53)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> get $txChas $txCard $txPort 1
      set streamSent [<a name="::stream(54)"><a href="./ePTClient.tcl.html#::stream_565">::stream</a></a> cget -packetView]
   set pList &#34;&#34;
   lappend pList &#34;$txChas $txCard $txPort&#34;
   lappend pList &#34;$rxChas $rxCard $rxPort&#34;
   <a name="::ixStartCapture(3)"><a href="./mapping.tcl.html#::ixStartCapture_106">::ixStartCapture</a></a> $pList
   if {!$dontTx} {
<span class="comment-line">#      startTx one2oneArray</span>
      <a name="::startTx(3)"><a href="./mapping.tcl.html#::startTx_94">::startTx</a></a> $portList
      set time2 [clock seconds]
      <span class="comment-line">#result_debug &#34;*** Frame sent from ($txChas $txCard $txPort) = $streamSent&#34;</span>
<span class="comment-line">#      result_debug &#34;*** Time for Ixia TX setup = [expr $time2-$time1] secs&#34;</span>
      <span class="comment-line"># Make sure TX done</span>
      if { $streamType == &#34;stopStream&#34; } {
         if { ($saMode != &#34;contIncrement&#34;) &amp;&amp; ($saMode != &#34;contDecrement&#34;) &amp;&amp;  
              ($daMode != &#34;contIncrement&#34;) &amp;&amp; ($daMode != &#34;contDecrement&#34;) } {
            <a name="::ixiaCheckTxDone(5)"><a href="./ePTMisc.tcl.html#::ixiaCheckTxDone_334">::ixiaCheckTxDone</a></a> $txChas $txCard $txPort $numFrames $txPort
            <span class="comment-line">#Reset the filter</span>
            if { $direction == &#34;2Way&#34; } {
               <a name="::ixiaCheckTxDone(6)"><a href="./ePTMisc.tcl.html#::ixiaCheckTxDone_334">::ixiaCheckTxDone</a></a> $rxChas $rxCard $rxPort $numFrames $txPort
            }
         <span class="comment-line"># Reset the filters</span>
         if {$applyFilter} {
            <a name="::result_debug(3)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;resetting the UDS1 settings&#34;
<span class="comment-line">#            foreach txMap [lsort -dictionary [array names one2oneArray]] {</span>
<span class="comment-line">#              scan $txMap					   &#34;%d,%d,%d&#34; chid c p</span>
<span class="comment-line">#              set rxMap						$one2oneArray($txMap)</span>
<span class="comment-line">#              scan [join $rxMap]			&#34;%d %d %d&#34; rxch rxc rxp</span>
               <a name="::filter(29)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -userDefinedStat1Enable  false
               <a name="::filter(30)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -userDefinedStat2Enable  false
<span class="comment-line">#              filter set $rxch $rxc $rxp</span>
<span class="comment-line">#              filterPallette setDefault</span>
<span class="comment-line">#              filterPallette set $rxch $rxc $rxp</span>
<span class="comment-line">#            }</span>
<span class="comment-line">#           writeConfigToHardware one2oneArray</span>
           <a name="::writeConfigToHardware(3)"><a href="./mapping.tcl.html#::writeConfigToHardware_148">::writeConfigToHardware</a></a> $portList
         }
      }
      }
   after 1000
      set time3 [clock seconds]
<span class="comment-line">#      result_debug &#34;*** Time for Ixia TX done = [expr $time3-$time2] secs\n&#34;</span>
      <a name="::result_debug(4)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;*** Ixia port config time [expr $time2-$time1] secs and TX time [expr $time3-$time2] secs\n&#34;
      if {$sMacAddr == &#34;default&#34;} {
         set sMacAddr $srcAddr
      }
      set txPortId [<a name="::MapIxiaCardnPort(5)"><a href="./ePTPortMapping.tcl.html#::MapIxiaCardnPort_331">::MapIxiaCardnPort</a></a> $txChas $txCard $txPort]
      set rxPortId [<a name="::MapIxiaCardnPort(6)"><a href="./ePTPortMapping.tcl.html#::MapIxiaCardnPort_331">::MapIxiaCardnPort</a></a> $rxChas $rxCard $rxPort]
      <a name="::displayIpPacketFormat(1)"><a href="./frameFormat.tcl.html#::displayIpPacketFormat_24">::displayIpPacketFormat</a></a> -txPortId $txPortId  -rxPortId $rxPortId \
                    -direction $direction -frameSent $streamSent \
                    -streamType $streamType -destMac $dMacAddr \
                    -srcMac $sMacAddr -srcIp $sIpAddr -destIp $dIpAddr \
                    -numFrames $numFrames -protocol $ipProtocol \
                    -tcpSynFlag $tcpSynFlag -tcpFinFlag $tcpFinFlag \
                    -tcpRstFlag $tcpRstFlag -tcpAckFlag $tcpAckFlag \
                    -tcpPushFlag $tcpPushFlag -tcpUrgFlag $tcpUrgFlag \
                    -tcpSeqNum $tcpSeqNum -tcpPushFlag $tcpPushFlag \
                    -sourcePort $pSrcPort -destPort $pDstPort -tag $tagNo \
                    -userPriority $userPriority -saMode $saMode \
                    -saCount $saCount -daMode $daMode -daCount $daCount \
                    -ipSaMode $ipSaMode -ipSaCount $ipSaCount \
                    -ipDaMode $ipDaMode -ipDaCount $ipDaCount \
                    -percentage &#34;$percentage&#34;
      return $streamSent
   } else {
      return &#34;&#34;
   }
}

<span class="comment-line">##################################################################    </span>
<span class="comment-line"># Procedure Name: tcpConfig</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     	This proc is used to configure TCP header fields on an ixia port</span>
<span class="comment-line">#	before sending IP/TCP packets. </span>
<span class="comment-line"># Input args: chid c p pSrcPort pDstPort {seqNum} {synFlag} {finFlag} {rstFlag} {ackFlag}</span>
<span class="comment-line"># Output args: None</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#	tcpConfig $chid $c $p $pSrcPort $pDstPort $tcpSeqNum $tcpSynFlag $tcpFinFlag $tcpRstFlag $tcpAckFlag</span>
<span class="comment-line"># Category: SetupTestTool</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::tcpConfig_1477">proc <a href="ePTL3Tx.tcl-annot.html#::::tcpConfig">::::tcpConfig</a></a></strong> {chid c p pSrcPort pDstPort {seqNum &#34;0&#34;} {synFlag &#34;false&#34;} {finFlag &#34;flase&#34;} {rstFlag &#34;false&#34;} {ackFlag &#34;false&#34;} {pushFlag &#34;false&#34;} {urgFlag &#34;false&#34;}} {
   set len [string length $pSrcPort]
   if {$len == 4 &amp;&amp; [string index $pSrcPort 0] == &#34;0&#34;} {
   append pSrcPort1 [string index $pSrcPort 1] [string index $pSrcPort 2] [string index $pSrcPort 3]
   <a name="::tcp(1)"><a href="./ePTClient.tcl.html#::tcp_1369">::tcp</a></a> config -sourcePort	[format %04x $pSrcPort1]
   } else {
   <a name="::tcp(2)"><a href="./ePTClient.tcl.html#::tcp_1369">::tcp</a></a> config -sourcePort	[format %04x $pSrcPort]
   }
   <a name="::tcp(3)"><a href="./ePTClient.tcl.html#::tcp_1369">::tcp</a></a> config -destPort		[format %04x $pDstPort]
   <a name="::tcp(4)"><a href="./ePTClient.tcl.html#::tcp_1369">::tcp</a></a> config -sequenceNumber	[format %08x $seqNum]
   <a name="::tcp(5)"><a href="./ePTClient.tcl.html#::tcp_1369">::tcp</a></a> config -synchronize      $synFlag
   <a name="::tcp(6)"><a href="./ePTClient.tcl.html#::tcp_1369">::tcp</a></a> config -finished		$finFlag
   <a name="::tcp(7)"><a href="./ePTClient.tcl.html#::tcp_1369">::tcp</a></a> config -resetConnection	$rstFlag
   <a name="::tcp(8)"><a href="./ePTClient.tcl.html#::tcp_1369">::tcp</a></a> config -acknowledgeValid	$ackFlag
   <a name="::tcp(9)"><a href="./ePTClient.tcl.html#::tcp_1369">::tcp</a></a> config -pushFunctionValid $pushFlag
   <a name="::tcp(10)"><a href="./ePTClient.tcl.html#::tcp_1369">::tcp</a></a> config -urgentPointerValid $urgFlag
<span class="comment-line">#   tcp set $chid $c $p</span>
}

<span class="comment-line">##################################################################    </span>
<span class="comment-line"># Procedure Name: udpConfig</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     	This proc is used to configure UDP header fields on an ixia port</span>
<span class="comment-line">#	before sending IP/UDP packets. </span>
<span class="comment-line"># Input args: chid c p pSrcPort pDstPort</span>
<span class="comment-line"># Output args: None</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#	udpConfig $chid $c $p $pSrcPort $pDstPort</span>
<span class="comment-line"># Category: SetupTestTool</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::udpConfig_1507">proc <a href="ePTL3Tx.tcl-annot.html#::::udpConfig">::::udpConfig</a></a></strong> { chid c p pSrcPort pDstPort {ckSum 0} } {
   <a name="::udp(3)"><a href="./ePTClient.tcl.html#::udp_2089">::udp</a></a> config -sourcePort	[format %04x $pSrcPort]
   <a name="::udp(4)"><a href="./ePTClient.tcl.html#::udp_2089">::udp</a></a> config -destPort		[format %04x $pDstPort]
   <a name="::udp(5)"><a href="./ePTClient.tcl.html#::udp_2089">::udp</a></a> config -checksumMode $ckSum
<span class="comment-line">#  udp set $chid $c $p</span>
}

<span class="comment-line">##################################################################    </span>
<span class="comment-line"># Procedure Name: icmpConfig</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     	This proc is used to configure ICMP header fields on an ixia port</span>
<span class="comment-line">#	before sending IP/ICMP packets. </span>
<span class="comment-line"># Input args: chid c p type code id sequence</span>
<span class="comment-line"># Output args: None</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#	icmpConfig $chid $c $p $type $code $id $sequence</span>
<span class="comment-line"># Category: SetupTestTool</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::icmpConfig_1525">proc <a href="ePTL3Tx.tcl-annot.html#::::icmpConfig">::::icmpConfig</a></a></strong> { chid c p type code id sequence } {
   <a name="::icmp(1)"><a href="./ePTClient.tcl.html#::icmp_1450">::icmp</a></a> config -type		$type
   <a name="::icmp(2)"><a href="./ePTClient.tcl.html#::icmp_1450">::icmp</a></a> config -code		$code
   <a name="::icmp(3)"><a href="./ePTClient.tcl.html#::icmp_1450">::icmp</a></a> config -id			$id
   <a name="::icmp(4)"><a href="./ePTClient.tcl.html#::icmp_1450">::icmp</a></a> config -sequence	$sequence
<span class="comment-line">#   icmp set $chid $c $p</span>
}

<span class="comment-line">##################################################################    </span>
<span class="comment-line"># Procedure Name: igmpConfig</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     	This proc is used to configure IGMP header fields on an ixia port</span>
<span class="comment-line">#	before sending IP/IGMP packets. </span>
<span class="comment-line"># Input args: chid c p groupIp type maxResponseTime</span>
<span class="comment-line"># Output args: None</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#	igmpConfig $chid $c $p $groupAddr $type $maxResponseTime</span>
<span class="comment-line"># Category: SetupTestTool</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::igmpConfig_1544">proc <a href="ePTL3Tx.tcl-annot.html#::::igmpConfig">::::igmpConfig</a></a></strong> { chid c p groupIp type maxResponseTime igmpMode igmpCount} {
   <a name="::igmp(3)"><a href="./ePTClient.tcl.html#::igmp_1323">::igmp</a></a> config -type		$type
   <a name="::igmp(4)"><a href="./ePTClient.tcl.html#::igmp_1323">::igmp</a></a> config -groupIpAddress		$groupIp
   <a name="::igmp(5)"><a href="./ePTClient.tcl.html#::igmp_1323">::igmp</a></a> config -maxResponseTime     $maxResponseTime
   <a name="::igmp(6)"><a href="./ePTClient.tcl.html#::igmp_1323">::igmp</a></a> config -mode $igmpMode
   <a name="::igmp(7)"><a href="./ePTClient.tcl.html#::igmp_1323">::igmp</a></a> config -repeatCount $igmpCount
<span class="comment-line">#  igmp set $chid $c $p</span>
}

<span class="comment-line">##################################################################    </span>
<span class="comment-line"># Procedure Name: setDhcpOptions</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     	This proc is used to set the ixia DHCP options specified in the </span>
<span class="comment-line">#	optionCodeList. </span>
<span class="comment-line"># Input args: OptionCodeList</span>
<span class="comment-line"># Output args: None</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#	setDhcpOptions $optionCodeList</span>
<span class="comment-line"># Category: SetupTestTool</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::setDhcpOptions_1564">proc <a href="ePTL3Tx.tcl-annot.html#::::setDhcpOptions">::::setDhcpOptions</a></a></strong> {OptionCodeList} {

    upvar $OptionCodeList optionCodeList
    set retCode 0

    <span class="comment-line"># make sure there's an 'end' at the back end of each set of options</span>
    lappend optionCodeList dhcpEnd ff

    foreach {option data} $optionCodeList {
        <span class="comment-line">#ixPuts &#34;option: $option&#34;</span>
        <span class="comment-line">#ixPuts &#34;  data:   $data\n&#34;</span>
<span class="comment-line">#        dhcp config -optionData       $data</span>
<span class="comment-line">#        if [dhcp setOption $option] {</span>
<span class="comment-line">#            #ixPuts &#34;Error setting DHCP option &lt;$option&gt;&#34;</span>
<span class="comment-line">#            result_debug &#34;Error setting DHCP option &lt;$option&gt;&#34;</span>
<span class="comment-line">#            set retCode 1</span>
<span class="comment-line">#            continue</span>
<span class="comment-line">#        }</span>
    }
    return $retCode
}
</pre>
<hr>
<div class="index-selector">
	<a href="index_main.html#byfilename">file name</a> 
 | 
	<a href="index_main.html#byprocname">procedure name</a> 
 | 
	<a href="index_main.html#bycall">procedure call</a> 
 | 
	<a href="index_annot_full.html">annotation</a> 

<br>
<cite>File generated 2018-06-14 at 17:09.</cite>
</div>

</body>
</html>
