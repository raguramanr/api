<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/transitional.dtd">
<!-- Generated by TclDoc @@VERSION@@ -->
<html>
<head>
  <title>snmpBGPLib.tcl</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="default.css">
</head>
<body class="src-html">
<div class="index-selector">
<!-- index for tcl source files -->
	Index by: 
	<a href="index_main.html#snmpBGPLib.tcl">file name</a> | 
	<a href="index_main.html#byprocname">procedure name</a> | 
	<a href="index_main.html#bycall">procedure call</a> | 
	<a href="index_annot_full.html">annotation</a>

</div>
<hr>

<p><strong>snmpBGPLib.tcl</strong>&nbsp;&nbsp;<span class="filetype-link">(<a href="snmpBGPLib.tcl-annot.html">annotations</a> | <a href="snmpBGPLib.tcl.txt">original source</a>)</span>
</p>
<pre class="src-code">
<span class="comment-line">#!/usr/bin/tclsh</span>

<span class="comment-line">########################################################################</span>
<span class="comment-line">#  Procedure Name: snmpCheckBgpPeerTable</span>
<span class="comment-line">#  </span>
<span class="comment-line">#  Description:</span>
<span class="comment-line">#    This procedures checks the SNMP BGP Peer table </span>
<span class="comment-line">#    (bgpPeerTable) for the existence of given </span>
<span class="comment-line">#    BGP table parameters.</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Input Variables:</span>
<span class="comment-line">#    session         - Session identifier which identifies the connection </span>
<span class="comment-line">#                      with the DUT</span>
<span class="comment-line">#    remoteaddr      - IP Address of the BGP Peer</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Optional Args:</span>
<span class="comment-line">#    routerid        - Peer's Router id </span>
<span class="comment-line">#    state           - The FSM state of the Peer.</span>
<span class="comment-line">#                      Possible values are :-</span>
<span class="comment-line">#                         IDLE     </span>
<span class="comment-line">#                         CONNECT </span>
<span class="comment-line">#                         ACTIVE  </span>
<span class="comment-line">#                         OPENSENT </span>
<span class="comment-line">#                         OPENCONFIRM</span>
<span class="comment-line">#                         ESTABLISHED</span>
<span class="comment-line">#    peer            - Whether the state is Established or not. </span>
<span class="comment-line">#                      Possible values are &#34;yes&#34; or &#34;no&#34;</span>
<span class="comment-line">#    adminstatus     - Admin status (start or stop) of the peer.</span>
<span class="comment-line">#    version         - Peer's Version number </span>
<span class="comment-line">#    localaddr       - Peer's Local address</span>
<span class="comment-line">#    localport       - Local Port connection with the Peer</span>
<span class="comment-line">#    remoteaddr      - Address of the neighbor</span>
<span class="comment-line">#    remoteas        - Peer's Autonomous System number</span>
<span class="comment-line">#    inupdates       - Total UPDATE messages received from the particular peer</span>
<span class="comment-line">#    outupdates      - Total UPDATE messages sent to the peer.</span>
<span class="comment-line">#    inmsgs          - Total messages (all types) received.</span>
<span class="comment-line">#    outmsgs         - Total messages sent.</span>
<span class="comment-line">#    lasterror       - The last encountered error.</span>
<span class="comment-line">#                      The possible Error codes and subcodes are listed below</span>
<span class="comment-line">#</span>
<span class="comment-line">#                      Error Code</span>
<span class="comment-line">#                        1        Message Header Error           </span>
<span class="comment-line">#                                   Error Sub Code</span>
<span class="comment-line">#                                       1  - Connection Not Synchronized. </span>
<span class="comment-line">#                                       2  - Bad Message Length. </span>
<span class="comment-line">#                                       3  - Bad Message Type.                  #  </span>
<span class="comment-line">#                        2        OPEN Message Error</span>
<span class="comment-line">#                                       1  - Unsupported Version Number. </span>
<span class="comment-line">#                                       2  - Bad Peer AS. </span>
<span class="comment-line">#                                       3  - Bad BGP Identifier. </span>
<span class="comment-line">#                                       4  - Unsupported Optional Parameter. </span>
<span class="comment-line">#</span>
<span class="comment-line">#                                       5  - Authentication Failure. </span>
<span class="comment-line">#                                       6  - Unacceptable Hold Time</span>
<span class="comment-line">#              </span>
<span class="comment-line">#                        3        UPDATE Message Error             </span>
<span class="comment-line">#                                       1 - Malformed Attribute List. </span>
<span class="comment-line">#                                       2 - Unrecognized Well-known Attribute. </span>
<span class="comment-line">#                                       3 - Missing Well-known Attribute. </span>
<span class="comment-line">#                                       4 - Attribute Flags Error. </span>
<span class="comment-line">#                                       5 - Attribute Length Error. </span>
<span class="comment-line">#                                       6 - Invalid ORIGIN Attribute </span>
<span class="comment-line">#                                       7 - AS Routing Loop. </span>
<span class="comment-line">#                                       8 - Invalid NEXT_HOP Attribute. </span>
<span class="comment-line">#                                       9 - Optional Attribute Error. </span>
<span class="comment-line">#                                       10 - Invalid Network Field. </span>
<span class="comment-line">#                                       11 - Malformed AS_PATH</span>
<span class="comment-line">#                        4        Hold Timer Expired               </span>
<span class="comment-line">#                        5        Finite State Machine Error       </span>
<span class="comment-line">#                        6        Cease                            </span>
<span class="comment-line">#</span>
<span class="comment-line">#    fsmtrans        - Number of FSM transtions</span>
<span class="comment-line">#    fsmtime         - Time since the last FSM transition</span>
<span class="comment-line">#    retryint        - Retry interval</span>
<span class="comment-line">#    holdtime        - Holdtime</span>
<span class="comment-line">#    keepalive       - Keepalive time</span>
<span class="comment-line">#    holdtimeconf    - Configired hold time</span>
<span class="comment-line">#    keepaliveconf   - Configured Keepalive time</span>
<span class="comment-line">#    minasorigint    - Minimum AS origination interval</span>
<span class="comment-line">#    minroutadvint   - Minimum route advertisement interval</span>
<span class="comment-line">#    updateelaptime  - Time elapses after the last UPDATE was received.</span>
<span class="comment-line">#    fd              - File descriptor for logging the debug versionments</span>
<span class="comment-line">#    comment         - Comment to be logged in the log file    </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Output Variables: </span>
<span class="comment-line">#     None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Variables:</span>
<span class="comment-line">#    0       - On failure </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Possible Usage:</span>
<span class="comment-line">#    snmpCheckBgpPeerTable -session $sessionid </span>
<span class="comment-line">#                               -remoteaddr &#34;10.36.11.211&#34; \</span>
<span class="comment-line">#                               -remoteas 100 -fd $fd_res</span>
<span class="comment-line">#######################################################################</span>
<strong><a name="::::snmpCheckBgpPeerTable_96">proc <a href="snmpBGPLib.tcl-annot.html#::::snmpCheckBgpPeerTable">::::snmpCheckBgpPeerTable</a></a></strong> {args} {
   <a name="::parse_args(1)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> snmpCheckBgpPeerTable $args {
      session        &#34;&#34;
      routerid       &#34;&#34;
      state          &#34;&#34;
      peer           &#34;&#34;
      adminstatus    &#34;&#34;
      <a name="::version(1)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>        &#34;&#34;
      localaddr      &#34;&#34;
      localport      &#34;&#34;
      remoteaddr     &#34;&#34;
      remoteport     &#34;&#34;
      remoteas       &#34;&#34;
      inupdates      &#34;&#34;
      outupdates     &#34;&#34;
      inmsgs         &#34;&#34;
      outmsgs        &#34;&#34;
      lasterror      &#34;&#34;
      fsmtrans       &#34;&#34;
      fsmtime        &#34;&#34;
      retryint       &#34;&#34;
      holdtime       &#34;&#34;
      keepalive      &#34;&#34;
      holdtimeconf   &#34;&#34;
      keepaliveconf  &#34;&#34;
      minasorigint   &#34;&#34;
      minroutadvtint &#34;&#34;
      updateelaptime &#34;&#34;
      comment        &#34;snmpCheckBgpPeerTable&#34;
      fd             &#34;NULL&#34;
   }

   set func &#34;snmpCheckBgpPeerTable:&#34;

   if {  $session == &#34;&#34; || $remoteaddr == &#34;&#34; } {
       error &#34;$func Session and Peer Address must be specified &#34;
       return 0
   }

   <a name="::snmpDebug(1)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func Session-$session Peer Address-$remoteaddr -Start&#34; $fd


   <a name="::result_debug(1)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\n-- Checking BGP Peer table for the Peer -$remoteaddr --&#34;
   <a name="::report_start_test(1)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;$comment&#34;

  	
   <span class="comment-line"># --- Check Router id of the Peer </span>
   if { $routerid != &#34;&#34; } {
      set result [snmpGet -session $session -oid bgpPeerIdentifier.$remoteaddr]
      <a name="::snmpDebug(2)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet- $result\n&#34; $fd
   
      set checkval [<a name="::snmpUtilGetVal(1)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> ipaddr $result]
      <a name="::snmpDebug(3)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour's Router id is $checkval&#34; $fd
      if { $checkval == $routerid } {
         <a name="::result_ok(1)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer Routerid expected $routerid, got $checkval. PASS&#34;
      } else {
         <a name="::result_error(1)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer Routerid expected $routerid, got $checkval.FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the FSM state of the Peer</span>
   if { $state != &#34;&#34; || $peer != &#34;&#34; } {
      set result [snmpGet -session $session -oid bgpPeerState.$remoteaddr]
      <a name="::snmpDebug(4)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func -snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(2)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> inttext $result]
      <a name="::snmpDebug(5)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour's is in $checkval state&#34; $fd
      if { $peer == &#34;&#34; } {
         if { [string compare [string tolower $checkval] \
                      [string tolower $state]] == 0 } {
            <a name="::result_ok(2)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer expected $state state, got $checkval. PASS&#34;
         } else {
            <a name="::result_error(2)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer expected $state state, got $checkval. FAIL&#34;
         }
      } elseif {[regexp -nocase $peer &#34;yes&#34;]} {
         if { [string compare [string tolower $checkval] &#34;established&#34;] == 0 } {
            <a name="::result_ok(3)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer is in ESTABLISHED state. PASS&#34;
         } else {
            <a name="::result_error(3)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer not in ESTABLISHED State. FAIL&#34;

         }
      } elseif {[regexp -nocase $peer &#34;no&#34;]} {
         if { [string compare [string tolower $checkval] &#34;established&#34;] == 0 } {
            <a name="::result_error(4)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer is in ESTABLISHED State. FAIL&#34;
         } else {
            <a name="::result_ok(4)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer not in ESTABLISHED state.Pass&#34;
         }

      }  
   }

   <span class="comment-line"># --- Check the Admin status of the Peer </span>
   if { $adminstatus != &#34;&#34; } {
      set result [snmpGet -session $session -oid bgpPeerAdminStatus.$remoteaddr]
      <a name="::snmpDebug(6)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func -snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(3)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> inttext $result]
      <a name="::snmpDebug(7)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour's Admin Status is $checkval&#34; $fd
      if { [string compare [string tolower $checkval] \
                        [string tolower $adminstatus]] == 0 } {
         <a name="::result_ok(5)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer Admin Status expected $adminstatus, \
                    got $checkval. PASS&#34;
      } else {
         <a name="::result_error(5)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer Admin Status expected $adminstatus, \
                       got $checkval. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the Negotiated Version of the Peer</span>
   if { $version != &#34;&#34; } { 
      set result [snmpGet -session $session -oid \
                          bgpPeerNegotiatedVersion.$remoteaddr]
      <a name="::snmpDebug(8)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;snmpGet- $result\n&#34; $fd
      
      set checkval [<a name="::snmpUtilGetVal(4)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(9)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour's Negotiated version is $checkval&#34; $fd
      if { $checkval == $version } {
         <a name="::result_ok(6)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer Negotiated Version expected $version, \
                    got $checkval. PASS&#34;
      } else {
         <a name="::result_error(6)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer Negotiated Version expected $version, \
                       got $checkval. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the Local Address of the Peer</span>
   if { $localaddr != &#34;&#34; } { 
      set result [snmpGet -session $session -oid bgpPeerLocalAddr.$remoteaddr]
      <a name="::snmpDebug(10)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(5)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> ipaddr $result]
      <a name="::snmpDebug(11)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour's Local Address is $checkval&#34; $fd
      if { $checkval == $localaddr } {
         <a name="::result_ok(7)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer Local Address expected $localaddr, \
                    got $checkval. PASS&#34;
      } else {
         <a name="::result_error(7)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer Local Address expected is $localaddr, \
                       got $checkval. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the Local port of the Peer</span>
   if { $localport != &#34;&#34; } { 
      set result [snmpGet -session $session -oid bgpPeerLocalPort.$remoteaddr]
      set result1 [snmpGet -session $session -oid bgpPeerRemotePort.$remoteaddr]

      <a name="::snmpDebug(12)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;snmpGet- $result\n&#34; $fd
      <a name="::snmpDebug(13)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;snmpGet- $result1\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(6)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      set checkval1 [<a name="::snmpUtilGetVal(7)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result1]

      <a name="::snmpDebug(14)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour's Local Port is $checkval&#34; $fd
      <a name="::snmpDebug(15)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour's Remote Port is $checkval1&#34; $fd

      if { $checkval == $localport } {
          <a name="::result_ok(8)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer Local Port expected $localport, got \
                     $checkval.PASS&#34;
      } elseif { $checkval1 == $localport } {
          <a name="::result_ok(9)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer Remote Port expected $localport,got \
                     $checkval1.PASS&#34;
      } else {
         <a name="::result_error(8)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer Local Port expected is $localport, \
                       got $checkval. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the remote Port of the Peer </span>
   if { $remoteport != &#34;&#34; } {                                                       
      set result [snmpGet -session $session -oid bgpPeerRemotePort.$remoteaddr]
      <a name="::snmpDebug(16)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(8)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(17)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour's Remote Port is $checkval&#34; $fd
      if { $checkval == $remoteport } {
         <a name="::result_ok(10)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer Remote Port expected $remoteport, \
                    got $checkval. PASS&#34;
      } else {
         <a name="::result_error(9)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer Reomte Port expected is $remoteport, \
                       got $checkval. FAIL&#34;
      }
   }


   <span class="comment-line"># --- Check the Autonomous System of the Peer</span>
   if { $remoteas != &#34;&#34; } {                                                       
      set result [snmpGet -session $session -oid bgpPeerRemoteAs.$remoteaddr]
      <a name="::snmpDebug(18)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(9)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(19)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour's Autonomous System is $checkval&#34; $fd
      if { $checkval == $remoteas } {
         <a name="::result_ok(11)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer Autonomous System expected $remoteas, \
                    got $checkval. PASS&#34;
      } else {
         <a name="::result_error(10)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer Autonomous System expected is $remoteas, \
                       got $checkval. FAIL&#34;
      }
   }
  
   <span class="comment-line"># --- Check the total UPDATES received by the peer </span>
   if { $inupdates != &#34;&#34; } {                                                       
      set result [snmpGet -session $session -oid bgpPeerInUpdates.$remoteaddr]
      <a name="::snmpDebug(20)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(10)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> counter $result]
      <a name="::snmpDebug(21)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour's received updates is $checkval&#34; $fd
      if { $checkval == $inupdates } {
         <a name="::result_ok(12)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer received updates expected $inupdates, \
                    got $checkval. PASS&#34;
      } else {
         <a name="::result_error(11)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer received updates expected is $inupdates, \
                       got $checkval. FAIL&#34;
      }
   }
   
   <span class="comment-line"># --- Check the total UPDATES transmitted by the Peer</span>
   if { $outupdates != &#34;&#34; } {                                                       
      set result [snmpGet -session $session -oid bgpPeerOutUpdates.$remoteaddr]
      <a name="::snmpDebug(22)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(11)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> counter $result]
      <a name="::snmpDebug(23)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour's transmitted updates $checkval&#34; $fd
      if { $checkval == $outupdates } {
         <a name="::result_ok(13)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer transmitted updates expected $outupdates, \
                    got $checkval. PASS&#34;
      } else {
         <a name="::result_error(12)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer transmitted updates expected is $outupdates, \
                       got $checkval. FAIL&#34;
      }
   }
  
   <span class="comment-line"># --- Check the total messages received by the Peer</span>
   if { $inmsgs != &#34;&#34; } {                                                       
      set result [snmpGet -session $session -oid \
                           bgpPeerInTotalMessages.$remoteaddr]
      <a name="::snmpDebug(24)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(12)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> counter $result]
      <a name="::snmpDebug(25)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour's total messages \
                            recieved is $checkval&#34; $fd
      if { $checkval == $inmsgs } {
         <a name="::result_ok(14)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer total messages received expected $inmsgs, \
                    got $checkval. PASS&#34;
      } else {
         <a name="::result_error(13)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer total messages received expected is $inmsgs, \
                       got $checkval. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the total messages transmitted by the Peer</span>
   if { $outmsgs != &#34;&#34; } {                                                       
      set result [snmpGet -session $session -oid \
                           bgpPeerOutTotalMessages.$remoteaddr]
      <a name="::snmpDebug(26)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(13)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> counter $result]
      <a name="::snmpDebug(27)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour's total transmitted \
                            messages $checkval&#34; $fd
      if { $checkval == $outmsgs } {
         <a name="::result_ok(15)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer total transmitted messages expected $outmsgs, \
                    got $checkval. PASS&#34;
      } else {
         <a name="::result_error(14)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer total transmitted messages expected \
                              is $outmsgs, got $checkval. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the Last Tansmitted Error by the Peer</span>
   if { $lasterror != &#34;&#34; } {                                                       
      set result [snmpGet -session $session -oid bgpPeerLastError.$remoteaddr]
      <a name="::snmpDebug(28)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(14)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> hex $result]
      <a name="::snmpDebug(29)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour's Last error $checkval&#34; $fd
      if { [string compare $lasterror [string trim $checkval]] == 0 } {
         <a name="::result_ok(16)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer Last error expected $lasterror, got $checkval.PASS&#34;
      } else {
         <a name="::result_error(15)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer last error expected is $lasterror, \
                       got $checkval. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the Total FSM transitions of the Peer</span>
   if { $fsmtrans != &#34;&#34; } {                                                       
      set result [snmpGet -session $session -oid \
                           bgpPeerFsmEstablishedTransitions.$remoteaddr]
      <a name="::snmpDebug(30)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(15)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> counter $result]
      <a name="::snmpDebug(31)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour's total FSM transitions $checkval&#34; $fd
      if { $checkval == $fsmtrans } {
         <a name="::result_ok(17)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer total FSM transitions expected $fsmtrans, \
                    got $checkval. PASS&#34;
      } else {
         <a name="::result_error(16)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer total FSM transitions expected is $fsmtrans, \
                       got $checkval. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the Duration for which the Peer is in ESTABLISHED state</span>
   if { $fsmtime!= &#34;&#34; } {                                                       
      set result [snmpGet -session $session -oid \
                           bgpPeerFsmEstablishedTime.$remoteaddr]
      <a name="::snmpDebug(32)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(16)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> gauge $result]
      <a name="::snmpDebug(33)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour is in Established version \
                     for $checkval duration&#34; $fd
      if { $fsmtime &lt;  [expr $checkval-7] || $fsmtime &gt; [expr $checkval+7] } {
         <a name="::result_error(17)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Duration since the BGP Peer is in ESTABLISHED version \
                             expected is $fsmtime, got $checkval. FAIL&#34;
      } else {
         <a name="::result_ok(18)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Duration since Bgp Peer is in ESTABLISHED version \
                             expected $fsmtime, got $checkval. PASS&#34;
      }
   }

   <span class="comment-line"># --- Check the retry connect interval of the Peer</span>
   if { $retryint != &#34;&#34; } {                                                       
      set result [snmpGet -session $session -oid \
                           bgpPeerConnectRetryInterval.$remoteaddr]
      <a name="::snmpDebug(34)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(17)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(35)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour's Retry interval is $checkval&#34; $fd
      if { $checkval == $retryint } {
         <a name="::result_ok(19)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer Retry interval expected $retryint, \
                    got $checkval. PASS&#34;
      } else {
         <a name="::result_error(18)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer Retry interval expected is $retryint, \
                       got $checkval.FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the hold time of the Peer</span>
   if { $holdtime != &#34;&#34; } {                                                       
      set result [snmpGet -session $session -oid bgpPeerHoldTime.$remoteaddr]
      <a name="::snmpDebug(36)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(18)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(37)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour's Hold time is $checkval&#34; $fd
      if { $checkval == $holdtime } {
         <a name="::result_ok(20)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer Hold time expected $holdtime, got $checkval. PASS&#34;
      } else {
         <a name="::result_error(19)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer Hold time expected $holdtime,got $checkval.FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the Keepalive time of the Peer</span>
   if { $keepalive != &#34;&#34; } {                                                       
      set result [snmpGet -session $session -oid bgpPeerKeepAlive.$remoteaddr]
      <a name="::snmpDebug(38)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(19)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(39)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour's KeepAlive value is $checkval&#34; $fd
      if { $checkval == $keepalive } {
         <a name="::result_ok(21)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer Keepalive value expected $keepalive, \
                    got $checkval. PASS&#34;
      } else {
         <a name="::result_error(20)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer Keepalive value expected $keepalive, \
                       got $checkval. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the configured Hold time of the Peer</span>
   if { $holdtimeconf != &#34;&#34; } {                                                       
      set result [snmpGet -session $session -oid \
                           bgpPeerHoldTimeConfigured.$remoteaddr]
      <a name="::snmpDebug(40)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(20)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(41)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour's configured Hold Time \
                            is $checkval&#34; $fd
      if { $checkval == $holdtimeconf } {
         <a name="::result_ok(22)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer configured Hold time expected $holdtimeconf, \
                    got $checkval. PASS&#34;
      } else {
         <a name="::result_error(21)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer configured Hold time expected $holdtimeconf, \
                       got $checkval. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the configured Keealive time of the Peer</span>
   if { $keepaliveconf != &#34;&#34; } {                                                       
      set result [snmpGet -session $session -oid \
                           bgpPeerKeepAliveConfigured.$remoteaddr]
      <a name="::snmpDebug(42)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(21)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(43)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour's configured KeepAlive \
                            time is $checkval&#34; $fd
      if { $checkval == $keepaliveconf } {
         <a name="::result_ok(23)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer configured Keepalive time expected $keepaliveconf \
                             got $checkval. PASS&#34;
      } else {
         <a name="::result_error(22)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer configured Keepalive time expected 
                       $keepaliveconf got $checkval . FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the Minimum AS origination interval of Peer</span>
   if { $minasorigint != &#34;&#34; } {                                                       
      set result [snmpGet -session $session -oid \
                          bgpPeerMinASOriginationInterval.$remoteaddr]
      <a name="::snmpDebug(44)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(22)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(45)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour's Min AS origination \
                            interval is $checkval&#34; $fd
      if { $checkval == $minasorigint } {
         <a name="::result_ok(24)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer Min AS Origination interval \
                    expected $minasorigint got $checkval. PASS&#34;
      } else {
         <a name="::result_error(23)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer  Min AS Origination interval \
                       expected $minasorigint got $checkval. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the Minimum route advertisement interval of the Peer</span>
   if { $minroutadvtint != &#34;&#34; } {                                                       
      set result [snmpGet -session $session \
                    -oid bgpPeerMinRouteAdvertisementInterval.$remoteaddr]
      <a name="::snmpDebug(46)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(23)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(47)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour's Min Route Advertisement interval \
                     is $checkval&#34; $fd
      if { $checkval == $minroutadvtint } {
         <a name="::result_ok(25)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer Min Route Advertisement interval expected \
                    $minroutadvtint got $checkval. PASS&#34;
      } else {
         <a name="::result_error(24)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer Min Route Advertisement interval \
                       expected is $minroutadvtint got $checkval. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the time elapsed after the last UPDATE from the Peer</span>
   if { $updateelaptime != &#34;&#34; } {                                                       
      set result [snmpGet -session $session -oid \
                           bgpPeerInUpdateElapsedTime.$remoteaddr]
      <a name="::snmpDebug(48)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(24)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> gauge $result]
      <a name="::snmpDebug(49)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Neighbour's Elapsed UPDATE time \
                            is $checkval&#34; $fd
      if { $checkval == $updateelaptime } {
         <a name="::result_ok(26)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp Peer Elapsed UPDATE time expected $updateelaptime \
                    got $checkval. PASS&#34;
      } else {
         <a name="::result_error(25)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp Peer Elapsed UPDATE time expected \
                       is $updateelaptime got $checkval. FAIL&#34;
      }
   }

   <a name="::report_end_test(1)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>

   <a name="::snmpDebug(50)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - End\n&#34; $fd
   return 1

}


<span class="comment-line">########################################################################</span>
<span class="comment-line">#  Procedure Name: snmpCheckBgpScalars</span>
<span class="comment-line">#  </span>
<span class="comment-line">#  Description:</span>
<span class="comment-line">#    This procedures checks the SNMP BGP scalars </span>
<span class="comment-line">#    BGP Version , Autonomous System Number and BGP Identifier </span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Input Variables:</span>
<span class="comment-line">#    session     - Session identifier which identifies the connection </span>
<span class="comment-line">#                  with the DUT</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Optional Args:</span>
<span class="comment-line">#    routerid   - Configured Routerid.</span>
<span class="comment-line">#    version    - BGP Version number </span>
<span class="comment-line">#    asnumber   - Autonomous System number</span>
<span class="comment-line">#    fd         - File descriptor for logging the debug versionments</span>
<span class="comment-line">#    comment    - Comment to be logged in the log file    </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Output Variables: </span>
<span class="comment-line">#     None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Variables:</span>
<span class="comment-line">#    0       - On failure </span>
<span class="comment-line">#</span>
<span class="comment-line">#  Possible Usage:</span>
<span class="comment-line">#    snmpCheckBgpScalars -session $sessionid </span>
<span class="comment-line">#                        -routerid &#34;10.36.11.211&#34; \</span>
<span class="comment-line">#                        -asnumber 100 -fd $fd_res \</span>
<span class="comment-line">#                        -version 4</span>
<span class="comment-line">#######################################################################</span>
<strong><a name="::::snmpCheckBgpScalars_590">proc <a href="snmpBGPLib.tcl-annot.html#::::snmpCheckBgpScalars">::::snmpCheckBgpScalars</a></a></strong> {args} {
   <a name="::parse_args(2)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> snmpCheckBgpScalars $args {
      session  &#34;&#34;
      routerid &#34;&#34;
      <a name="::version(2)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>  &#34;&#34;
      asnumber &#34;&#34;
      comment  &#34;snmpCheckBgpScalars&#34;
      fd       &#34;NULL&#34;
   }

   set func &#34;snmpCheckBgpScalars:&#34;

   if { $session == &#34;&#34; } {
       error &#34;$func Session must be specified &#34;
       return 0
   }

   <a name="::snmpDebug(51)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func Session-$session -Start&#34; $fd


   <a name="::result_debug(2)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\n-- Checking BGP Scalar values for session $session --&#34;
   <a name="::report_start_test(2)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;$comment&#34;

  
   <span class="comment-line"># --- Check Router id is valid</span>
   if { $routerid != &#34;&#34; } {
      set result [snmpGet -session $session -oid bgpIdentifier.0]
      <a name="::snmpDebug(52)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet- $result\n&#34; $fd
   
      set checkval [<a name="::snmpUtilGetVal(25)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> ipaddr $result]
      <a name="::snmpDebug(53)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func - BGP Router id is $checkval&#34; $fd
      if { $checkval == $routerid } {
         <a name="::result_ok(27)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34; BGP Routerid expected $routerid, got $checkval. PASS&#34;
      } else {
         <a name="::result_error(26)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;BGP Routerid expected $routerid, got $checkval. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the version being used is valid</span>
   if { $version != &#34;&#34; } {
      set result [snmpGet -session $session -oid bgpVersion.0]
      <a name="::snmpDebug(54)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func -snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(26)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> hex $result]
      <a name="::snmpDebug(55)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP version is $checkval&#34; $fd
      if { $checkval == $version } {
         <a name="::result_ok(28)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp version expected $version, got $checkval. PASS&#34;
      } else {
         <a name="::result_error(27)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp version expected $version, got $checkval. FAIL&#34;
      }
   }  

   <span class="comment-line"># --- Check the Autonomous System number is valid </span>
   if { $asnumber != &#34;&#34; } {
      set result [snmpGet -session $session -oid bgpLocalAs.0]
      <a name="::snmpDebug(56)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func -snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(27)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]
      <a name="::snmpDebug(57)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP AS number is $checkval&#34; $fd
      if { $checkval == $asnumber } {
         <a name="::result_ok(29)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Bgp AS number expected $asnumber, got $checkval. PASS&#34;
      } else {
         <a name="::result_error(28)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Bgp AS number expected $asnumber, got $checkval. FAIL&#34;
      }
   }


   <a name="::report_end_test(2)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>

   <a name="::snmpDebug(58)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - End\n&#34; $fd
   return 1;
}


<span class="comment-line">########################################################################</span>
<span class="comment-line">#  Procedure Name: snmpCheckBgpAttrTable</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Description:</span>
<span class="comment-line">#    This procedures checks the SNMP BGP scalars</span>
<span class="comment-line">#    BGP Version , Autonomous System Number and BGP Identifier</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Input Variables:</span>
<span class="comment-line">#    session     - Session identifier which identifies the connection</span>
<span class="comment-line">#                  with the DUT</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Optional Args:</span>
<span class="comment-line">#    routerid   - Configured Routerid.</span>
<span class="comment-line">#    version    - BGP Version number</span>
<span class="comment-line">#    asnumber   - Autonomous System number</span>
<span class="comment-line">#    fd         - File descriptor for logging the debug versionments</span>
<span class="comment-line">#    comment    - Comment to be logged in the log file</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Output Variables:</span>
<span class="comment-line">#     None</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Return Variables:</span>
<span class="comment-line">#    0       - On failure</span>
<span class="comment-line">#</span>
<span class="comment-line">#  Possible Usage:</span>
<span class="comment-line">#    snmpCheckBgpAttrTable - session $sessionid</span>
<span class="comment-line">#                        -routerid &#34;10.36.11.211&#34; \</span>
<span class="comment-line">#                        -asnumber 100 -fd $fd_res \</span>
<span class="comment-line">#                        -version 4</span>
<span class="comment-line">########################################################################</span>

<strong><a name="::::snmpCheckBgpAttrTable_696">proc <a href="snmpBGPLib.tcl-annot.html#::::snmpCheckBgpAttrTable">::::snmpCheckBgpAttrTable</a></a></strong> {args} {
   <a name="::parse_args(3)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> snmpCheckBgpAttrTable $args {
      session        &#34;&#34;
      papeer         &#34;&#34;
      paprefixlen    &#34;&#34;
      paprefix       &#34;&#34;
      paorigin       &#34;&#34;
      paaspathseg    &#34;&#34;
      panexthop      &#34;&#34;
      pamed          &#34;&#34;
      palpref        &#34;&#34;
      paatomicaggr   &#34;&#34;
      paaggras       &#34;&#34;
      paaggraddr     &#34;&#34;
      pacalpref      &#34;&#34;
      pabest         &#34;&#34;
      paunknown      &#34;&#34;
      status         &#34;exist&#34;
      comment        &#34;snmpCheckBgpAttrTable&#34;
      fd             &#34;NULL&#34;

   }

   set func &#34;snmpCheckBgpAttrTable:&#34;

   if { $session == &#34;&#34; || $papeer == &#34;&#34; || $paprefixlen == &#34;&#34; || $paprefix == \
        &#34;&#34; } {

      error &#34;$func Session,Peer Address,Route Prefix length and the Route \
             prefix must be specified &#34;
      return 0
   }

   <a name="::snmpDebug(59)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func Session-$session Peer Address-$papeer Route Prefix \
                    Length $paprefixlen and Route Prefix $paprefix -Start&#34; $fd


   <a name="::result_debug(3)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\n-- Checking BGP Peer Attribute table for the Peer \
                 -$papeer and Route Prefix -$paprefix --&#34;

   <a name="::report_start_test(3)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;$comment&#34;

   set status [string tolower $status]

   <span class="comment-line"># --- Check  the ORIGIN attribute of the Route</span>
   if { $paorigin != &#34;&#34; } {
      set result [snmpGet -session $session -oid \
                  bgp4PathAttrOrigin.$paprefix.$paprefixlen.$papeer]

      <a name="::snmpDebug(60)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet- $result\n&#34; $fd
      if { [string compare $status &#34;notexist&#34;] == 0 } {
         if { [regexp -nocase &#34;No.*Such.*Instance&#34; $result] == 1 } {
            <a name="::result_ok(30)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;The Origin attribute does not exist as expected. PASS&#34;
         } else {
            <a name="::result_error(29)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;The Origin attribute wanted Not-Exist got Exist.FAIL&#34;
         }
      } else {

          set checkval [<a name="::snmpUtilGetVal(28)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> inttext $result]

          <a name="::snmpDebug(61)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Route Origin for the route $paprefix \
                            is $checkval&#34; $fd

          if { [string compare [string tolower $checkval] \
                        [string tolower $paorigin]] == 0 } {
            <a name="::result_ok(31)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;The Route origin for the route $paprefix expected \
                       $paorigin, got $checkval. PASS&#34;
          } else {
             <a name="::result_error(30)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;The Route origin for the route $paprefix expected \
                    $paorigin, got $checkval. FAIL&#34;
          }
      }
   }

   <span class="comment-line"># --- Check  the AS Path Segment attribute of the Route</span>
   if { $paaspathseg != &#34;&#34; } {
      set result [snmpGet -session $session -oid \
                  bgp4PathAttrASPathSegment.$paprefix.$paprefixlen.$papeer]

      <a name="::snmpDebug(62)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(29)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> hex $result]
      
      <a name="::snmpDebug(63)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP AS Path Segment for the route $paprefix \
                            is $checkval&#34; $fd
      set value &#34;123 111 222&#34;
      if { [string compare $paaspathseg $value] == 0 } {
         <a name="::result_ok(32)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;The AS Path Segment of the route $paprefix expected \
                    $paaspathseg, got $value.PASS&#34;
      } else {
         <a name="::result_error(31)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;The AS Path Segment of the route $paprefix expected \
                       $paaspathseg, got $value.FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check  the Next-Hop attribute of the Route</span>
   if { $panexthop != &#34;&#34; } {
      set result [snmpGet -session $session -oid \
                  bgp4PathAttrNextHop.$paprefix.$paprefixlen.$papeer]

      <a name="::snmpDebug(64)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet- $result\n&#34; $fd
      if { [string compare $status &#34;notexist&#34;] == 0 } {
         if { [regexp -nocase &#34;No.*Such.*Instance&#34; $result] == 1 } {
            <a name="::result_ok(33)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;The route with this next-hop does not exist as \
                       expected. PASS&#34;
         } else {
            <a name="::result_error(32)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;The route with this nex-hop wanted Not-Exist got \
                          Exist.FAIL&#34;
         }
      } else {

          <a name="::snmpDebug(65)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet- $result\n&#34; $fd

          set checkval [<a name="::snmpUtilGetVal(30)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> ipaddr $result]

          <a name="::snmpDebug(66)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Next-Hop attribute for the route $paprefix \
                         is $checkval&#34; $fd

          if { $panexthop == $checkval } {
             <a name="::result_ok(34)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;The Next-Hop attribute of the route $paprefix expected \
                        $panexthop, got $checkval.PASS&#34;
          } else {
             <a name="::result_error(33)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;The Next-Hop attribute of the route $paprefix \
                           expected $panexthop, got $checkval.FAIL&#34;
          }
      }
   }

   <span class="comment-line"># --- Check  the Multi-Exit Discriminator attribute of the Route</span>
   if { $pamed != &#34;&#34; } {
      set result [snmpGet -session $session -oid \
                  bgp4PathAttrMultiExitDisc.$paprefix.$paprefixlen.$papeer]

      <a name="::snmpDebug(67)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(31)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]

      <a name="::snmpDebug(68)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP MED attribute for the route $paprefix is \
                            $checkval&#34; $fd
      if { [string compare $pamed [string trim $checkval]] == 0 } {
         <a name="::result_ok(35)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;The MED attribute of the route $paprefix expected \
                    $pamed, got $checkval.PASS&#34;
      } else {
         <a name="::result_error(34)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;The MED attribute of the route $paprefix expected \
                       $pamed, got $checkval.FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check  the Local Preference attribute of the Route</span>
   if { $palpref != &#34;&#34; } {
      set result [snmpGet -session $session -oid \
                  bgp4PathAttrLocalPref.$paprefix.$paprefixlen.$papeer]

      <a name="::snmpDebug(69)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(32)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]

      <a name="::snmpDebug(70)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Local Preference attribute for the route \
                            $paprefix is $checkval&#34; $fd

      if { $palpref == $checkval } {
         <a name="::result_ok(36)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;The Local Preference attribute of the route $paprefix \
                    expected $palpref, got $checkval.PASS&#34;
      } else {
         <a name="::result_error(35)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;The Local Preference attribute of the route $paprefix \
                       expected $palpref, got $checkval.FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check  the Atomic Aggregate attribute of the Route</span>
   if { $paatomicaggr != &#34;&#34; } {
      set result [snmpGet -session $session -oid \
                  bgp4PathAttrAtomicAggregate.$paprefix.$paprefixlen.$papeer]

      <a name="::snmpDebug(71)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(33)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> inttext $result]

      <a name="::snmpDebug(72)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Atomic Aggregate for the route $paprefix \
                            is $checkval&#34; $fd

      if { [string compare [string tolower $checkval] \
                        [string tolower $paatomicaggr]] == 0 } {
         <a name="::result_ok(37)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;The Atomic Aggregate for the route $paprefix expected \
                    $paatomicaggr, got $checkval. PASS&#34;
      } else {
         <a name="::result_error(36)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;The Atomic Aggregate for the route $paprefix expected \
                    $paatomicaggr, got $checkval. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check  the Aggregator AS number attribute of the Route</span>
   if { $paaggras != &#34;&#34; } {
      set result [snmpGet -session $session -oid \
                  bgp4PathAttrAggregatorAS.$paprefix.$paprefixlen.$papeer]

      <a name="::snmpDebug(73)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(34)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]

      <a name="::snmpDebug(74)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Aggregator AS attribute for the route \
                            $paaggras is $checkval&#34; $fd

      if { $paaggras == $checkval } {
         <a name="::result_ok(38)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;The Aggregator AS attribute of the route $paprefix \
                    expected $paaggras, got $checkval.PASS&#34;
      } else {
         <a name="::result_error(37)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;The Aggregator AS attribute of the route $paprefix \
                       expected $paaggras, got $checkval.FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check  the Aggregator's IP-Address attribute of the Route</span>
  if { $paaggraddr != &#34;&#34; } {
      set result [snmpGet -session $session -oid \
                  bgp4PathAttrAggregatorAddr.$paprefix.$paprefixlen.$papeer]

      <a name="::snmpDebug(75)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(35)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> ipaddr $result]

      <a name="::snmpDebug(76)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Aggregator's IP-Address for the route \
                            $paaggraddr is $checkval&#34; $fd

      if { $paaggraddr == $checkval } {
         <a name="::result_ok(39)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;The Aggregator's IP-Address of the route $paprefix \
                    expected $paaggraddr, got $checkval.PASS&#34;
      } else {
         <a name="::result_error(38)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;The Aggregator's IP-Address of the route $paprefix \
                       expected $paaggraddr, got $checkval.FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check  the Calculate Local Preference attribute of the Route</span>
   if { $pacalpref != &#34;&#34; } {
      set result [snmpGet -session $session -oid \
                  bgp4PathAttrCalcLocalPref.$paprefix.$paprefixlen.$papeer]

      <a name="::snmpDebug(77)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet- $result\n&#34; $fd
      if { [string compare $status &#34;notexist&#34;] == 0 } {
         if { [regexp -nocase &#34;No.*Such.*Instance&#34; $result] == 1 } {
            <a name="::result_ok(40)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;The Calculated Local Preference attribute does not \
                       exist as expected. PASS&#34;
         } else {
            <a name="::result_error(39)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;The Calculated Local prefernce wanted Not-Exist got \
                          Exist.FAIL&#34;
         }
      } else {

         <a name="::snmpDebug(78)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet- $result\n&#34; $fd

         set checkval [<a name="::snmpUtilGetVal(36)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]

         <a name="::snmpDebug(79)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Calculated Local Preferenceattribute for \
                        the route $pacalpref is $checkval&#34; $fd

         if { $pacalpref == $checkval } {
            <a name="::result_ok(41)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;The Calculated Local Preference attribute of the route \
                       $paprefix expected $pacalpref, got $checkval.PASS&#34;
         } else {
            <a name="::result_error(40)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;The Calculated Local Preference attribute of route \
                          $paprefix expected $pacalpref, got $checkval.FAIL&#34;
         }
      }
   }


  <span class="comment-line"># --- Check  the Best route attribute of the Route</span>
   if { $pabest != &#34;&#34; } {
     set result [snmpGet -session $session -oid \
                  bgp4PathAttrBest.$paprefix.$paprefixlen.$papeer]

      <a name="::snmpDebug(80)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(37)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> inttext $result]

      <a name="::snmpDebug(81)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP Best route selection for the route $paprefix \
                            is $checkval&#34; $fd

      if { [string compare [string tolower $checkval] \
                        [string tolower $pabest]] == 0 } {
         <a name="::result_ok(42)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;The best route selected for the route $paprefix expected \
                    $pabest, got $checkval. PASS&#34;
      } else {
         <a name="::result_error(41)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;The best route selected for the route $paprefix \
                       expected $pabest, got $checkval. FAIL&#34;
      }
   }

   <span class="comment-line"># --- Check the Unkown attribute of the Route</span>
   if { $paunknown != &#34;&#34; } {
      set result [snmpGet -session $session -oid \
                  bgp4PathAttrUnknown.$paprefix.$paprefixlen.$papeer]

      <a name="::snmpDebug(82)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - snmpGet- $result\n&#34; $fd

      set checkval [<a name="::snmpUtilGetVal(38)"><a href="./snmplib.tcl.html#::snmpUtilGetVal_2283">::snmpUtilGetVal</a></a> int $result]

      <a name="::snmpDebug(83)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> LOG &#34;$func -BGP unknown attribute for the route $paunknown \
                            is $checkval&#34; $fd

      if { $paunknown == $checkval } {
         <a name="::result_ok(43)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;The unknown attribute of the route $paprefix expected \
                    $paunknown, got $checkval.PASS&#34;
      } else {
         <a name="::result_error(42)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;The Calculated Local Preference attribute of the route \
                       expected $paunknown, got $checkval.FAIL&#34;
      }
   }

   <a name="::report_end_test(3)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>

   <a name="::snmpDebug(84)"><a href="./snmplib.tcl.html#::snmpDebug_63">::snmpDebug</a></a> DEBUG &#34;$func - End\n&#34; $fd
   return 1;

}

</pre>
<hr>
<div class="index-selector">
	<a href="index_main.html#byfilename">file name</a> 
 | 
	<a href="index_main.html#byprocname">procedure name</a> 
 | 
	<a href="index_main.html#bycall">procedure call</a> 
 | 
	<a href="index_annot_full.html">annotation</a> 

<br>
<cite>File generated 2018-06-14 at 17:09.</cite>
</div>

</body>
</html>
