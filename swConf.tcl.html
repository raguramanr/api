<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/transitional.dtd">
<!-- Generated by TclDoc @@VERSION@@ -->
<html>
<head>
  <title>swConf.tcl</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="default.css">
</head>
<body class="src-html">
<div class="index-selector">
<!-- index for tcl source files -->
	Index by: 
	<a href="index_main.html#swConf.tcl">file name</a> | 
	<a href="index_main.html#byprocname">procedure name</a> | 
	<a href="index_main.html#bycall">procedure call</a> | 
	<a href="index_annot_full.html">annotation</a>

</div>
<hr>

<p><strong>swConf.tcl</strong>&nbsp;&nbsp;<span class="filetype-link">(<a href="swConf.tcl-annot.html">annotations</a> | <a href="swConf.tcl.txt">original source</a>)</span>
</p>
<pre class="src-code">
<span class="comment-line">#load {expect52.dll}</span>
<span class="comment-line">#set auto_path [linsert $auto_path 0 . ]</span>

<span class="comment-line"># ---------------------------------------------------------------------------</span>
<span class="comment-line"># proc _initDUTs_infoArray</span>
<span class="comment-line">#</span>
<span class="comment-line">#  !!!  All variables that will be used in DUTs_info should be added here !!!</span>
<span class="comment-line">#       The IKEYS list will be used for printing output and writing</span>
<span class="comment-line">#       to the initFile for dev and autodev modes</span>
<span class="comment-line"># ---------------------------------------------------------------------------</span>
<strong><a name="::::_initDUTs_infoArray_11">proc <a href="swConf.tcl-annot.html#::::_initDUTs_infoArray">::::_initDUTs_infoArray</a></a></strong><a name="::::_initDUTs_infoArray"></a> {} {
    global DUTs_info IKEYS MAIN CFG_PLATFORM IKEYTEXT
    puts &#34;\n\n\n-- Init DUTs_info Variables --\n\n&#34;

    _getTestBedNumNodes;<span class="comment-line"># Make sure MAIN(NODECOUNT) is set.</span>
    _getTestBedStandbyNodes;<span class="comment-line"># Set MAIN(STDBYCOUNT) and MAIN(STDBYLIST)</span>
    <span class="comment-line"># When adding keys, keep in mind that this is the order that the debug</span>
    <span class="comment-line">#   print displays.  Group variables logically so you don't have to look</span>
    <span class="comment-line">#   around too much</span>
    if [info exists IKEYS] {unset IKEYS}
    if [info exists idef] {unset idef}
    lappend IKEYS &#34;sysName&#34;;<span class="comment-line"># System Name - changes with snmp so not good for ID'ing system</span>
        set IKEYTEXT(sysName) &#34;System Name&#34;  
    lappend IKEYS &#34;sysType&#34;;<span class="comment-line"># good for ID'ing System, but Type + Stack for a stack - (Stack) is stripped</span>
        set IKEYTEXT(sysType) &#34;System Type&#34;
    lappend IKEYS &#34;platform&#34;;<span class="comment-line"># The Sys Type OR Stack</span>
        set IKEYTEXT(platform) &#34;Platform&#34;
    lappend IKEYS &#34;sysMAC&#34;;<span class="comment-line"># Mac</span>
        set IKEYTEXT(sysMAC) &#34;System MAC&#34;
    lappend IKEYS &#34;version&#34;;<span class="comment-line"># Version from show switch on the booted partition</span>
        set IKEYTEXT(version) &#34;Image Version&#34;
    lappend IKEYS &#34;sVVersion&#34;;<span class="comment-line"># Version from show version.  Most accurate</span>
        set IKEYTEXT(sVVersion) &#34;Version from Show Verison&#34;
    lappend IKEYS &#34;verTime&#34;;<span class="comment-line">#</span>
        set IKEYTEXT(verTime) &#34;Running image built on&#34;
    lappend IKEYS &#34;relMaster&#34;;<span class="comment-line">#</span>
        set idef(relMaster) &#34;release-manager&#34;;<span class="comment-line"># Example of setting a default value</span>
        set IKEYTEXT(relMaster) &#34;Release Master&#34;
    lappend IKEYS &#34;partitionCli&#34;;<span class="comment-line"># full port partitioning cli list for this DUT</span>
        set idef(partitionCli) &#34;&#34;;
        set IKEYTEXT(partitionCli) &#34;DUT Port partioning info&#34;
    lappend IKEYS &#34;firstConnTimeOut&#34;;<span class="comment-line"># On first login attempts use a shorter time than connectionTimeout</span>
        set idef(firstConnTimeOut) &#34;15&#34;;
        set IKEYTEXT(firstConnTimeOut) &#34;Initial DUT connect expect timeout&#34;
    lappend IKEYS &#34;UncSwAdditionalTime&#34;;<span class="comment-line"># If default.xsf reboots or takes a while.. more time may be needed.</span>
        set idef(UncSwAdditionalTime) &#34;0&#34;;
        set IKEYTEXT(UncSwAdditionalTime) &#34;Additional delay after unconfigure switch&#34;
    lappend IKEYS &#34;coreFileTarget&#34;;<span class="comment-line"># The location to store corefiles</span>
        set idef(coreFileTarget) &#34;internal-memory&#34;;
        set IKEYTEXT(coreFileTarget) &#34;Core file target&#34;
    lappend IKEYS &#34;InbandNetConnected&#34;;<span class="comment-line"># Track if inband network test was run and passed for this DUT</span>
        set idef(InbandNetConnected) &#34;0&#34;;
        set IKEYTEXT(InbandNetConnected) &#34;Status of front panel network at Setup&#34;
    lappend IKEYS &#34;MgmtNetConnected&#34;;<span class="comment-line"># Track if mgmt network test was run and passed for this DUT</span>
        set idef(MgmtNetConnected) &#34;0&#34;;
        set IKEYTEXT(MgmtNetConnected) &#34;Status of mgmt port at System Setup&#34;
    lappend IKEYS &#34;serial&#34;;<span class="comment-line"># Serial number</span>
        set IKEYTEXT(serial) &#34;System Serial Number&#34;
    lappend IKEYS &#34;productNum&#34;;
        set IKEYTEXT(productNum) &#34;System Product Number&#34;
    lappend IKEYS &#34;currState&#34;;<span class="comment-line"># Operation Master or Backup</span>
        set IKEYTEXT(currState) &#34;Switch State&#34;
    lappend IKEYS &#34;imageSel&#34;;<span class="comment-line"># Select image for the console I am on</span>
        set IKEYTEXT(imageSel) &#34;Image Selected&#34;
    lappend IKEYS &#34;imageSelA&#34;;<span class="comment-line"># Select image for the console I am on</span>
        set IKEYTEXT(imageSelA) &#34;Image Selected Primary&#34;
    lappend IKEYS &#34;imageSelB&#34;;<span class="comment-line"># Selected image for the OR master capable.</span>
        set IKEYTEXT(imageSelB) &#34;Image Selected Backup&#34;
    lappend IKEYS &#34;imageBooted&#34;;<span class="comment-line"># Booted image</span>
        set IKEYTEXT(imageBooted) &#34;Image Booted&#34;
    lappend IKEYS &#34;imageBootedA&#34;;<span class="comment-line"># Booted image for console I am connected to</span>
        set IKEYTEXT(imageBootedA) &#34;Image Booted Primary&#34;
    lappend IKEYS &#34;imageBootedB&#34;;<span class="comment-line"># Booted image for other Master capable</span>
        set IKEYTEXT(imageBootedB) &#34;Image Booted Primary&#34;
    lappend IKEYS &#34;priImage&#34;;<span class="comment-line"># Primary bank version of console I am on</span>
        set IKEYTEXT(priImage) &#34;Primary Image&#34;
    lappend IKEYS &#34;priImageA&#34;;<span class="comment-line"># Primary bank version of console I am on</span>
        set IKEYTEXT(priImageA) &#34;Primary Image on Primary&#34;
    lappend IKEYS &#34;priImageB&#34;;<span class="comment-line"># Primary bank version of other console</span>
        set IKEYTEXT(priImageB) &#34;Primary Image on Backup&#34;
    lappend IKEYS &#34;secImage&#34;;<span class="comment-line">#</span>
        set IKEYTEXT(secImage) &#34;Secondary Image&#34;
    lappend IKEYS &#34;secImageA&#34;;<span class="comment-line">#</span>
        set IKEYTEXT(secImageA) &#34;Secondary Image on Primary&#34;
    lappend IKEYS &#34;secImageB&#34;;<span class="comment-line">#</span>
        set IKEYTEXT(secImageB) &#34;Secondary Image on Backup&#34;
    lappend IKEYS &#34;bootROM&#34;;<span class="comment-line">#</span>
        set IKEYTEXT(bootROM) &#34;BootROM&#34;
    lappend IKEYS &#34;numSlots&#34;;<span class="comment-line">#</span>
        set IKEYTEXT(numSlots) &#34;Number of Slots&#34;
    lappend IKEYS &#34;numSlotsFM&#34;;<span class="comment-line">#</span>
        set IKEYTEXT(numSlotsFM) &#34;Number of FM Slots&#34;
    lappend IKEYS &#34;hwList&#34;;<span class="comment-line"># a list of systypes for chassis or stack switches</span>
        set IKEYTEXT(hwList) &#34;Slot Card List&#34;
    lappend IKEYS &#34;slotNums&#34;;<span class="comment-line"># vpex may be &#34;1 33 44 58&#34;</span>
        set IKEYTEXT(slotNums) &#34;Slot Numbers List&#34;
    lappend IKEYS &#34;numExtSlots&#34;;<span class="comment-line">#</span>
        set IKEYTEXT(numExtSlots) &#34;Number of VPEX Slots&#34;
    lappend IKEYS &#34;hwListFM&#34;;<span class="comment-line">#</span>
        set IKEYTEXT(hwListFM) &#34;FM Slot Card List&#34;
    lappend IKEYS &#34;dlReqD&#34;;<span class="comment-line">#</span>
        set IKEYTEXT(dlReqD) &#34;Download Flag Init&#34;
    lappend IKEYS &#34;debugFlag&#34;;<span class="comment-line">#</span>
        set IKEYTEXT(debugFlag) &#34;Debug-Mode state&#34;
    lappend IKEYS &#34;snmpVersion&#34;;<span class="comment-line">#</span>
        set IKEYTEXT(snmpVersion) &#34;SNMP version&#34;
    lappend IKEYS &#34;license&#34;;<span class="comment-line">#  </span>
        set IKEYTEXT(license) &#34;License&#34;
    lappend IKEYS &#34;feature_licenses&#34;;<span class="comment-line">#</span>
        set IKEYTEXT(feature_licenses) &#34;Feature Licenses&#34;
    lappend IKEYS &#34;memoryCard&#34;;<span class="comment-line"># memory card present in msm</span>
        set IKEYTEXT(memoryCard) &#34;memoryCard status&#34;

    for {set i 1} {$i&lt;=$MAIN(NODECOUNT)} {incr i} {
        if {![info exists CFG_PLATFORM($i)]} {
            set CFG_PLATFORM($i) &#34;null&#34;
        }
        global DUT${i}_MASK DUT${i}_SETUP DUT${i}_DefaultBlade
        if {![info exists DUT${i}_MASK]} {
            set DUT${i}_MASK 24
        }
        if {![info exists DUT${i}_SETUP]} {
            set DUT${i}_SETUP &#34;&#34;
            puts &#34;DUT${i}_SETUP initialized to null.  Missing from configuration file&#34;
        }
        if {![info exists DUT${i}_DefaultBlade]} {
            set DUT${i}_DefaultBlade 0
        }
        global DUT${i}_CONNECT DUT${i}_CONNECTB
        foreach infoKey $IKEYS {
            if {[info exists idef($infoKey)]} {
                set val $idef($infoKey)
            } else {
                set val &#34;INVALID&#34;
            }
            set DUTs_info(DUT$i,$infoKey) $val
        }
        <span class="comment-line">#</span>
        <span class="comment-line"># DUT cfg file variables</span>
        <span class="comment-line">#</span>
        if {[info exists DUT${i}_CONNECT]} {
            set DUTs_info(DUT$i,connect) [set DUT${i}_CONNECT]
            if {[lsearch $IKEYS &#34;connect&#34;] &lt; 0} {
                lappend IKEYS &#34;connect&#34;
                set IKEYTEXT(connect) &#34;DUT Terminal Server Connection&#34;
            }
        }
        if {[info exists DUT${i}_CONNECTB]} {
            set DUTs_info(DUT$i,connectB) [set DUT${i}_CONNECTB]
            if {[lsearch $IKEYS &#34;connectB&#34;] &lt; 0} {
                lappend IKEYS &#34;connectB&#34;
                set IKEYTEXT(connectB) &#34;DUT Backup Terminal Server Connection&#34;
            }
        }
    }
    puts &#34;dut1 pre source $DUTs_info(DUT1,sysType)&#34;
    set iFile [<a name="::::GetInitFileName(1)"><a href="./SystemSetup.tcl.html#::::GetInitFileName_2846">::::GetInitFileName</a></a> $MAIN(autoRoot) $MAIN(cfg) Tmp2]
    if {[file exists $iFile] &amp;&amp; [info exists MAIN(feature_directory)] &amp;&amp; \
               $MAIN(feature_directory) == &#34;QLoadImage&#34;} {
        if {[catch {source $iFile} oops]} {
            puts &#34;Sourcing the initFile failed: $oops&#34;
        } else {
            puts &#34;Sourced $iFile&#34;
        }
    } else {
        puts &#34;Couldn't find $iFile $MAIN(feature_directory)&#34;
    }
    puts &#34;dut1 post source $DUTs_info(DUT1,sysType)&#34;
}
<span class="comment-line"># ---------------------------------------------------------------------------</span>
<span class="comment-line"># proc _initDUTs_Slot_infoArray</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># ---------------------------------------------------------------------------</span>
<strong><a name="::::_initDUTs_Slot_infoArray_176">proc <a href="swConf.tcl-annot.html#::::_initDUTs_Slot_infoArray">::::_initDUTs_Slot_infoArray</a></a></strong><a name="::::_initDUTs_Slot_infoArray"></a> {} {

    global DUTs_Slot_info IKEYS ISLOTKEYS MAIN

    set slist &#34;1 2 3 4 5 6 7 8 A B&#34;

    if [info exists ISLOTKEYS] {unset ISLOTKEYS}
    if [info exists islotdef] {unset islotdef}
    lappend ISLOTKEYS &#34;serial&#34;;<span class="comment-line">#</span>
    lappend ISLOTKEYS &#34;productNum&#34;;<span class="comment-line">#</span>
    lappend ISLOTKEYS &#34;hwModType&#34;
    lappend ISLOTKEYS &#34;sysType&#34;
    lappend ISLOTKEYS &#34;confType&#34;
    lappend ISLOTKEYS &#34;state&#34;
    lappend ISLOTKEYS &#34;numPorts&#34;
    lappend ISLOTKEYS &#34;npRev&#34;
        set islotdef(npRev) &#34;1.0&#34;;<span class="comment-line"># Example of setting a default value</span>
    lappend ISLOTKEYS &#34;npProc1&#34;
    lappend ISLOTKEYS &#34;npProc2&#34;
    lappend ISLOTKEYS &#34;imageSel&#34;
    lappend ISLOTKEYS &#34;priImage&#34;
    lappend ISLOTKEYS &#34;secImage&#34;
    lappend ISLOTKEYS &#34;version&#34;
    lappend ISLOTKEYS &#34;verTime&#34;
    lappend ISLOTKEYS &#34;dlReqD&#34;
    lappend ISLOTKEYS &#34;category&#34;


    for {set i 1} {$i&lt;=$MAIN(NODECOUNT)} {incr i} {
        foreach infoKey $ISLOTKEYS {
            if {[info exists islotdef($infoKey)]} {
                set val $islotdef($infoKey)
            } else {
                set val &#34;INVALID&#34;
            }
            foreach s $slist {
                set DUTs_Slot_info(DUT$i,slot$s,$infoKey) $val
            }
        }
    }

}
<span class="comment-line"># -------------------------------------------------------------------------------</span>
<span class="comment-line"># proc ReunSetupScript</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># -------------------------------------------------------------------------------</span>
<strong><a name="::::RunSetupScript_225">proc <a href="swConf.tcl-annot.html#::::RunSetupScript">::::RunSetupScript</a></a></strong><a name="::::RunSetupScript"></a> {{connectList &#34;0.0.0.0&#34;} {setupScriptList &#34;&#34;} {args} } {

    <a name="::parse_args(1)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> RunSetupScript $args {
	at &#34;main&#34;  ;<span class="comment-line"># location of script run &#34;download&#34; for download file section </span>
	dut 1     ;<span class="comment-line"># dut supplied when called from download</span>
    }

    global spawn_id
    global in
    global POWERCYCLE_DUT
    global forceSerialReboot
    global numDUT
    for {set i 1} {$i&lt;=$numDUT} {incr i} {
       global DUT($i)_CONNECT
    }
    global switchPort2DefaultRouter
    global defaultRouter
    global regRouterIPAddr
    global MGMT_REG

    set MGMT_REG(forceConsole) 1; <span class="comment-line">#This proc should always run over the console</span>
    <a name="::UpdateTrackDBTxt(1)"><a href="./resource_track.tcl.html#::UpdateTrackDBTxt_133">::UpdateTrackDBTxt</a></a> &#34;executing: RunSetupScript&#34;;<span class="comment-line"># tracking db location</span>
    set in $at
    for {set i 1} {$i&lt;= $numDUT} {incr i} {
       lappend dutList $i
    }

    if { [info exists forceSerialReboot] &amp;&amp; $forceSerialReboot == 1} {
        <a name="::result_debug(1)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Force serial set in cfg file; Do Serial Setup Script&#34;
        set runSetupRetVal [<a name="::::DoSerialRunSetup(1)"><a href="./swConf.tcl.html#::::DoSerialRunSetup_604">::::DoSerialRunSetup</a></a> $dutList $connectList $setupScriptList $at $dut]
        return $runSetupRetVal
    }

    if { ([regexp -nocase &#34;mgmt&#34; $switchPort2DefaultRouter]) } {
	<a name="::result_debug(2)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;network port is mgmt; run setup script parallely&#34;
	set runSetupRetVal [<a name="::::DoParallelRunSetup(1)"><a href="./swConf.tcl.html#::::DoParallelRunSetup_555">::::DoParallelRunSetup</a></a> $dutList $connectList $setupScriptList $at $dut]
	return $runSetupRetVal
    }

    if { ![info exists regRouterIPAddr] } {
	<a name="::result_debug(3)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;regRouterIPAddr not defined; Do Serial Setup Script&#34;
	set runSetupRetVal [<a name="::::DoSerialRunSetup(2)"><a href="./swConf.tcl.html#::::DoSerialRunSetup_604">::::DoSerialRunSetup</a></a> $dutList $connectList $setupScriptList $at $dut]
        set MGMT_REG(forceConsole) 0;
	return $runSetupRetVal
    } else {

	<span class="comment-line"># First try to login to each DUT to make sure that its even possible</span>
	<span class="comment-line"># If not possible, no need to proceed further</span>
	<span class="comment-line"># Only &#34;need&#34; this here because this is where we do the disable port on regrouter...</span>
	<span class="comment-line"># We dont want situation where regrouter ports are disabled and scripts abort on login,</span>
	<span class="comment-line"># leaving the ports in disabled state...</span>
	if { [info exists regRouterIPAddr] } {
	    foreach dutnumber $dutList {
		set DUTName [format %s%d DUT $dutnumber]
		global ${DUTName}_CONNECT
		
		if { [<a name="::Login(1)"><a href="./login.tcl.html#::Login_24">::Login</a></a> [set ${DUTName}_CONNECT] -CheckOperational 0 -masterCheck 0] != 1 } {
		    <a name="::result_error(1)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Could not login to DUT$dutnumber [set ${DUTName}_CONNECT]&#34;
                    set MGMT_REG(forceConsole) 0;
		    return &#34;Error&#34;
		}
	    }
	}

	<a name="::result_debug(4)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;network port is on I/O blade; try to disable switchPort2DefaultRouter links&#34;

	if { $regRouterIPAddr == $defaultRouter } {
	    <a name="::result_error(2)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;FATAL ERROR: regRouterIPAddr cannot be same as defaultRouter IP ($defaultRouter). Check cfg file.&#34;
            set MGMT_REG(forceConsole) 0;
	    return &#34;REGROUTER_FAILED&#34;
	}

	set unconfigSwAllFound 0
	if { [string tolower $at] != &#34;download&#34; } {
	    <span class="comment-line"># Not called from LoadImage</span>
	    <span class="comment-line"># (if it was, there is no need to disable mgmt links, because that does not do unconfig sw all anyway)</span>
	    foreach setupScript $setupScriptList {
		foreach command $setupScript {
		    if  { [string match &#34;unc* sw*&#34; $command] == 1 } {
			<span class="comment-line"># Do the disable/enable port and parallel SetupScript</span>
			set unconfigSwAllFound 1
			break
		    }
		}
		if { $unconfigSwAllFound } {
		    <span class="comment-line"># No need to check any further... disable/enable regRouter ports required.</span>
		    break
		}
	    }
	}
	if { $unconfigSwAllFound } {
	    set portList [<a name="::::DisableRegRouterMgmtLinks(1)"><a href="./swConf.tcl.html#::::DisableRegRouterMgmtLinks_357">::::DisableRegRouterMgmtLinks</a></a>]
	} else {
	    set portList &#34;NotNeeded&#34;
	}

	if { $portList == &#34;Error&#34; } {
	    <a name="::result_debug(5)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Could not disable ports on regRouter; run SetupScript serially&#34;
	    set runSetupRetVal [<a name="::::DoSerialRunSetup(3)"><a href="./swConf.tcl.html#::::DoSerialRunSetup_604">::::DoSerialRunSetup</a></a> $dutList $connectList $setupScriptList $at $dut]
	} elseif { $portList == &#34;NotNeeded&#34; } {
	    <a name="::result_debug(6)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Disabling regRouter ports not required; run SetupScript parallely&#34;
	    set runSetupRetVal [<a name="::::DoParallelRunSetup(2)"><a href="./swConf.tcl.html#::::DoParallelRunSetup_555">::::DoParallelRunSetup</a></a> $dutList $connectList $setupScriptList $at $dut]
	} else {
	    <a name="::result_debug(7)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;regRouter ports disabled successfully; run SetupScript parallely&#34;
	    set runSetupRetVal [<a name="::::DoParallelRunSetup(3)"><a href="./swConf.tcl.html#::::DoParallelRunSetup_555">::::DoParallelRunSetup</a></a> $dutList $connectList $setupScriptList $at $dut]
	}

	if {0} {
	    if { $unconfigSwAllFound } {
		set retVal [<a name="::::EnableRegRouterMgmtLinks(1)"><a href="./swConf.tcl.html#::::EnableRegRouterMgmtLinks_396">::::EnableRegRouterMgmtLinks</a></a> $portList]
	    } else {
		set retVal &#34;NotNeeded&#34;
	    }
	}
	if { $portList == &#34;NotNeeded&#34; } {
	    global regRouterMGMTPorts
	    set portList [join $regRouterMGMTPorts &#34;,&#34;]
	}
	set retVal [<a name="::::EnableRegRouterMgmtLinks(2)"><a href="./swConf.tcl.html#::::EnableRegRouterMgmtLinks_396">::::EnableRegRouterMgmtLinks</a></a> $portList]

	if { ($portList != &#34;Error&#34;) &amp;&amp; ($portList != &#34;NotNeeded&#34;) &amp;&amp; ($retVal == &#34;Error&#34;) } {
	    <span class="comment-line"># If disable port was successful and enable port was not successful</span>
	    
	    <a name="::result_error(3)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;FATAL ERROR: Could not re-enable the ports on the RegRouter.&#34;
            set MGMT_REG(forceConsole) 0;
	    return &#34;REGROUTER_FAILED&#34;
	}
    }
    set MGMT_REG(forceConsole) 0;
    return $runSetupRetVal
}

<strong><a name="::::DisableRegRouterMgmtLinks_357">proc <a href="swConf.tcl-annot.html#::::DisableRegRouterMgmtLinks">::::DisableRegRouterMgmtLinks</a></a></strong><a name="::::DisableRegRouterMgmtLinks"></a> { } {
    global regRouterIPAddr
    global regRouterMGMTPorts
    global regRouterLogin
    global regRouterPassword

    <a name="::report_start_test(1)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;Disable links on Reg Router before unconfig all DUT's&#34;

    if { [<a name="::Login(2)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $regRouterIPAddr -userid $regRouterLogin -passwd $regRouterPassword -CheckOperational 0] != 1 } {
	<a name="::result_error(4)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Could not login to regrouter $regRouterIPAddr&#34;
	<a name="::report_end_test(1)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>
	return &#34;Error&#34;
    }

    <span class="comment-line">#In case of any extra whitespace between the portnumbers....</span>
    set portList [split $regRouterMGMTPorts]
    foreach portnum $portList {
	if { $portnum == &#34;&#34; } {
	    continue
	}
	lappend pList $portnum
    }
    set portList [join $pList &#34;,&#34;]

    if { [regexp -nocase &#34;illegal&#34; [<a name="::CheckCmdLegal(1)"><a href="./checkCmdLegality.tcl.html#::CheckCmdLegal_58">::CheckCmdLegal</a></a> &#34;disable port $portList&#34;]] } {
	<a name="::logout(1)"><a href="./logout.tcl.html#::logout_21">::logout</a></a>
	<span class="comment-line"># --- use it for delay without using sleep</span>
	puts &#34;Logged out of regrouter $regRouterIPAddr&#34;
	<a name="::report_end_test(2)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>
	return &#34;Error&#34;
    } else {
	<a name="::logout(2)"><a href="./logout.tcl.html#::logout_21">::logout</a></a>
	<span class="comment-line"># --- use it for delay without using sleep</span>
	puts &#34;Logged out of regrouter $regRouterIPAddr&#34;
	<a name="::report_end_test(3)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>
	return $portList
    }
}

<strong><a name="::::EnableRegRouterMgmtLinks_396">proc <a href="swConf.tcl-annot.html#::::EnableRegRouterMgmtLinks">::::EnableRegRouterMgmtLinks</a></a></strong><a name="::::EnableRegRouterMgmtLinks"></a> { portList } {
    global regRouterIPAddr
    global regRouterLogin
    global regRouterPassword

    <a name="::report_start_test(2)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;Re-enable links on Reg Router after unconfig all DUT's&#34;

    if { [<a name="::Login(3)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $regRouterIPAddr -userid $regRouterLogin -passwd $regRouterPassword -CheckOperational 0] != 1 } {
	<a name="::result_error(5)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Could not login to regrouter $regRouterIPAddr&#34;
	<a name="::report_end_test(4)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>
	return &#34;Error&#34;
    }

    if { [regexp -nocase &#34;illegal&#34; [<a name="::CheckCmdLegal(2)"><a href="./checkCmdLegality.tcl.html#::CheckCmdLegal_58">::CheckCmdLegal</a></a> &#34;enable port $portList&#34;]] } {
	<a name="::logout(3)"><a href="./logout.tcl.html#::logout_21">::logout</a></a>
	<span class="comment-line"># --- use it for delay without using sleep</span>
	puts &#34;Logged out of regrouter $regRouterIPAddr&#34;
	<a name="::report_end_test(5)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>
	return &#34;Error&#34;
    } else {
	<span class="comment-line"># Verify ports are now in enabled state</span>
	foreach portNum [split $portList &#34;,&#34;] {
	    lappend parameterList &#34;{^ *$portNum .*E } exist&#34;
	}
	if { [<a name="::CheckKeyValue(1)"><a href="./OptionCheck.tcl.html#::CheckKeyValue_47">::CheckKeyValue</a></a> &#34;show port $portList info&#34; $parameterList \
		-comment &#34;Verifying all ports re-enabled on regRouter $regRouterIPAddr&#34;] == &#34;error&#34; } {

	    <span class="comment-line"># Disable port was successful and enable port was not successful</span>
	    
	    <a name="::logout(4)"><a href="./logout.tcl.html#::logout_21">::logout</a></a>
	    <span class="comment-line"># --- use it for delay without using sleep</span>
	    puts &#34;Logged out of regrouter $regRouterIPAddr&#34;
	    <a name="::report_end_test(6)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>
	    <a name="::result_error(6)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;FATAL ERROR: Could not re-enable the ports on the RegRouter.&#34;
	    return &#34;Error&#34;
	}
	<a name="::logout(5)"><a href="./logout.tcl.html#::logout_21">::logout</a></a>
	<span class="comment-line"># --- use it for delay without using sleep</span>
	puts &#34;Logged out of regrouter $regRouterIPAddr&#34;
	<a name="::report_end_test(7)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>
	return $portList
    }
}
<span class="comment-line">#</span>
<span class="comment-line"># _multiRunSetupScript</span>
<span class="comment-line">#</span>
<strong><a name="::::_multiRunSetupScript_442">proc <a href="swConf.tcl-annot.html#::::_multiRunSetupScript">::::_multiRunSetupScript</a></a></strong><a name="::::_multiRunSetupScript"></a> {args} {
    global MAIN DUTs_info at wayToBootPart forceSerialReboot

    <a name="::parse_args(2)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> _multiRunSetupScript $args {
        dutListIn  &#34;null&#34;
    }

    if {![info exists MAIN(NODECOUNT)]} {_getTestBedNumNodes;}
    if {![info exists at]} {set at &#34;main&#34;;}

    if {$dutListIn != &#34;null&#34;} {
        set DUTLIST $dutListIn
    } else {
        set DUTLIST $MAIN(DUTLIST)
    }

    if {[info exists forceSerialReboot] &amp;&amp; $forceSerialReboot} {
        puts &#34;\n\n -----   Setup in SERIAL MODE&#34;
        foreach stdby $MAIN(STDBYLIST) {
            global STDBY${stdby}_CONNECT
            set me [expr 100 + $stdby]
            set DUTs_info(DUT$me,SHOWPROCESSES) 0
            <a name="::Login(4)"><a href="./login.tcl.html#::Login_24">::Login</a></a> [set STDBY${stdby}_CONNECT] -masterCheck 0 -CheckOperational 0
            puts &#34;STANDBYs 1st!  Start _unconfigSwToPartition  -dut none -bootPart primary -standby $stdby&#34;
            set res [<a name="::::_unconfigSwToPartition(1)"><a href="./swConf.tcl.html#::::_unconfigSwToPartition_524">::::_unconfigSwToPartition</a></a>  -dut none -bootPart primary -standby $stdby]
        }
        foreach dut $DUTLIST {
            global DUT${dut}_SETUP DUT${dut}_CONNECT
            if {$wayToBootPart($dut) == &#34;null&#34;} {continue;}
            set DUTs_info(DUT$dut,SHOWPROCESSES) 0
            <a name="::Login(5)"><a href="./login.tcl.html#::Login_24">::Login</a></a> [set DUT${dut}_CONNECT] -masterCheck 0 -CheckOperational 0
            if {$wayToBootPart($dut) == &#34;setupScript&#34;} {
                puts &#34;Start RunSetupScript_Single \&#34;[set DUT${dut}_CONNECT]\&#34; \&#34;[set DUT${dut}_SETUP]\&#34; \
                          -at $at -dut $dut&#34;
                set res [<a name="::::RunSetupScript_Single(1)"><a href="./swConf.tcl.html#::::RunSetupScript_Single_620">::::RunSetupScript_Single</a></a> [set DUT${dut}_CONNECT] [set DUT${dut}_SETUP] -at $at -dut $dut]
            } elseif {$wayToBootPart($dut) == &#34;unconfigSw&#34;} {
                set res [<a name="::::_unconfigSwToPartition(2)"><a href="./swConf.tcl.html#::::_unconfigSwToPartition_524">::::_unconfigSwToPartition</a></a>  -dut $dut -bootPart $MAIN(bootPart)]
            }
        }
    } else {
        puts &#34;\n\n -----   Setup in FORKED MODE&#34;
        set setupList &#34;&#34;
        foreach dut $DUTLIST {
            global DUT${dut}_SETUP DUT${dut}_CONNECT
            if {$wayToBootPart($dut) == &#34;null&#34;} {continue;}
            set DUTs_info(DUT$dut,SHOWPROCESSES) 0
            if {$wayToBootPart($dut) == &#34;setupScript&#34;} {
                lappend setupList &#34;RunSetupScript_Single \&#34;[set DUT${dut}_CONNECT]\&#34; \&#34;[set DUT${dut}_SETUP]\&#34; -at $at -dut $dut&#34;
            } elseif {$wayToBootPart($dut) == &#34;unconfigSw&#34;} {
                lappend setupList &#34;_unconfigSwToPartition  -dut $dut -bootPart $MAIN(bootPart)&#34;
            }
        }
        foreach stdby $MAIN(STDBYLIST) {
            set me [expr 100 + $stdby]
            set DUTs_info(DUT$me,SHOWPROCESSES) 0
            lappend setupList &#34;_unconfigSwToPartition  -dut none -bootPart primary -standby $stdby&#34;
        }

        if {[llength $setupList] == 0} {
            <a name="::result_debug(8)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;All DUTs are on the correct bank for download to start.&#34;
        } else {
            <a name="::result_debug(9)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\nRunning Configuration File Setup Script with minimal print out\n$setupList\n\n&#34;
            <a name="::_setShowOutput(1)"><a href="./SendSwCmd.tcl.html#::_setShowOutput_3101">::_setShowOutput</a></a> -screen on -log on -res_fmt on
                <a name="::MultiTask(1)"><a href="./multiTask.tcl.html#::MultiTask_39">::MultiTask</a></a> $setupList
            <a name="::_setShowOutput(2)"><a href="./SendSwCmd.tcl.html#::_setShowOutput_3101">::_setShowOutput</a></a> -screen on -log on -res_fmt on
            <a name="::result_debug(10)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Setup scripts completed&#34;
        }
    }
    <span class="comment-line"># -- Turn show process back on in CheckOperational</span>
    foreach dut $DUTLIST {
        if {$wayToBootPart($dut) == &#34;null&#34;} {continue;}
        set DUTs_info(DUT$dut,SHOWPROCESSES) 1
    }
    foreach stdby $MAIN(STDBYLIST) {
        set me [expr 100 + $stdby]
        set DUTs_info(DUT$me,SHOWPROCESSES) 1
    }
    return
}
<span class="comment-line">#</span>
<span class="comment-line"># Unc switch to the target partition.</span>
<span class="comment-line">#</span>
<strong><a name="::::_unconfigSwToPartition_524">proc <a href="swConf.tcl-annot.html#::::_unconfigSwToPartition">::::_unconfigSwToPartition</a></a></strong><a name="::::_unconfigSwToPartition"></a> {args} {
    global MAIN DUTs_info

    <a name="::parse_args(3)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> _unconfigSwToPartition $args {
        bootPart    &#34;primary&#34;
        dut         &#34;1&#34;
        standby     &#34;null&#34;
    }

    if {$standby != &#34;null&#34; &amp;&amp; [regexp &#34;\[0-9]&#34; $standby]} {
        global STDBY${standby}_CONNECT
        if {![info exists STDBY${standby}_CONNECT]} {
            <a name="::result_error(7)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;STDBY${standby}_CONNECT variable is called but is not in cfg&#34;
            return;
        }
        <a name="::Login(6)"><a href="./login.tcl.html#::Login_24">::Login</a></a> [set STDBY${standby}_CONNECT] -masterCheck 0 -CheckOperational 0
    } else {
        global DUT${dut}_CONNECT
        <a name="::Login(7)"><a href="./login.tcl.html#::Login_24">::Login</a></a> [set DUT${dut}_CONNECT] -masterCheck 0 -CheckOperational 0
    }
    <a name="::SendACmd(1)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;use image $bootPart&#34;

    if {[<a name="::UnconfigSwAll(1)"><a href="./SendSwCmd.tcl.html#::UnconfigSwAll_1628">::UnconfigSwAll</a></a> -initial_unconfig yes -at &#34;download&#34;] == 0 } {
        <a name="::result_error(8)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Unconfig sw all failed&#34;
        return 0
    } else {
        puts &#34;!!\n!!\nDUT $dut completed unconfig to parition\n!!\n!!&#34;;
        return 1
    }
}

<strong><a name="::::DoParallelRunSetup_555">proc <a href="swConf.tcl-annot.html#::::DoParallelRunSetup">::::DoParallelRunSetup</a></a></strong><a name="::::DoParallelRunSetup"></a> { dutList connectList setupScriptList at dut } {

    set pid [pid]


    package require Tclx

    foreach dutnumber $dutList {
	
	<span class="comment-line"># Need to login once before the child processes are forked, </span>
	<span class="comment-line"># because spawn_id from parent is used later in get_DUTs_info</span>
	set DUTName [format %s%d DUT $dutnumber]
	global ${DUTName}_CONNECT
	if {![regexp -nocase &#34;download&#34; $at] } {
	   <a name="::Login(8)"><a href="./login.tcl.html#::Login_24">::Login</a></a> [set ${DUTName}_CONNECT] -CheckOperational 0
        }
	set sec [clock seconds]
	lappend childPids [fork]
	after 1000 ;<span class="comment-line"># required to avoid children getting the same tmp file sometimes being too fast</span>
	if {[lindex $childPids [expr $dutnumber-1]]} {
	    if {$dutnumber==[llength $dutList]} {
		set co 1
		foreach childPid $childPids {
		    <a name="::result_debug(11)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Parent now waiting for child # $co with pid $childPid&#34;
                    set childRetCode  [wait $childPid]
		    if {![regexp -nocase &#34;EXIT 0&#34; $childRetCode]} {    ;<span class="comment-line"># parent waits here for child to complete</span>
                       <a name="::result_debug(12)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Now child returned with pid $childPid with $childRetCode status&#34;
                       return -1
                    } else {
                       <a name="::result_debug(13)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Now child returned with pid $childPid&#34;
                       incr co
                    }
		}
	    }
	} else {
	    <a name="::result_debug(14)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;child # $dutnumber enters with pid [pid]&#34;
	    set connect [lindex $connectList [expr $dutnumber-1]]
	    set setupScript [lindex $setupScriptList [expr $dutnumber-1]]
	    
	    if {[<a name="::::RunSetupScript_Single(2)"><a href="./swConf.tcl.html#::::RunSetupScript_Single_620">::::RunSetupScript_Single</a></a> $connect $setupScript -at $at -dut $dutnumber]==-1} {
		return -1
	    }
	    exit   ;<span class="comment-line"># Child exits here, returns back to the waiting parent</span>
	    <span class="comment-line"># end of fork construct</span>
	}
    }
            <a name="::exSleep(1)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 2 ;<span class="comment-line"># needed to avoid race condition in consoles</span>
}

<strong><a name="::::DoSerialRunSetup_604">proc <a href="swConf.tcl-annot.html#::::DoSerialRunSetup">::::DoSerialRunSetup</a></a></strong><a name="::::DoSerialRunSetup"></a>  { dutList connectList setupScriptList at dut } {
    <a name="::result_debug(15)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Could not disable ports on regRouter; run unconfig sequentially&#34;
    foreach dutnumber $dutList {
	set connect [lindex $connectList [expr $dutnumber-1]]
	set setupScript [lindex $setupScriptList [expr $dutnumber-1]]	
	if {[<a name="::::RunSetupScript_Single(3)"><a href="./swConf.tcl.html#::::RunSetupScript_Single_620">::::RunSetupScript_Single</a></a> $connect $setupScript -at $at -dut $dutnumber]==-1} {
	    if { [regexp -nocase &#34;download&#34; $at] } {
		<span class="comment-line"># called from LoadImage; return dutnum</span>
		return &#34;$dutnumber-1&#34;
	    } else {
		return -1
	    }
	}
    }
}

<strong><a name="::::RunSetupScript_Single_620">proc <a href="swConf.tcl-annot.html#::::RunSetupScript_Single">::::RunSetupScript_Single</a></a></strong><a name="::::RunSetupScript_Single"></a> {{connect &#34;0.0.0.0&#34;} {setupScript &#34;&#34;} {args} } {
    global spawn_id

    <a name="::parse_args(4)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> RunSetupScript $args {
        at &#34;main&#34;  ;<span class="comment-line"># location of script run &#34;download&#34; for download file section </span>
        dut 1     ;<span class="comment-line"># dut supplied when called from download</span>
    }
    global in
    global POWERCYCLE_DUT
    global whichDutNow
    global SWDEVSERVER MAIN
    global DUT${dut}_TYPE DUT${dut}_CONNECT SKIPPCTOBOOTROM SKIPPCTOBOOTROMFLAG

    set in $at
    if {$in==&#34;download&#34; &amp;&amp; [info exists SWDEVSERVER] &amp;&amp; $SWDEVSERVER} {
        if {[info exists POWERCYCLE_DUT($dut)]} {
            set platform [<a name="::GetPlatform(1)"><a href="./misc.tcl.html#::GetPlatform_478">::GetPlatform</a></a> DUT$dut]
            if {[regexp -nocase &#34;$SKIPPCTOBOOTROM&#34; $platform] || $SKIPPCTOBOOTROMFLAG} {
                <span class="comment-line"># Some platforms are not able to power cycle to boot rom</span>
                puts &#34;Skip power cycle for this platform $platform&#34;
            } else {
                <span class="comment-line"># Power cycle to the bootrom and select the primary partition</span>
                if {[<a name="::pcToBootRom(1)"><a href="./bootRomLib.tcl.html#::pcToBootRom_763">::pcToBootRom</a></a> $dut]==&#34;ok&#34;} {
                    <a name="::result_debug(16)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Wait for 120 secs for rebooted DUT $dut to come up...&#34;
                    <a name="::exSleep(2)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 100
                    <a name="::Login(9)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connect -masterCheck 0 -CheckOperational 0
                    set output [<a name="::CheckOperational(1)"><a href="./login.tcl.html#::CheckOperational_653">::CheckOperational</a></a>]
                    if { $output == 0 } {
                        <a name="::result_error(9)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Some slots not operational&#34;
                        error &#34;Some slots not operational&#34;
                    }
                } else {
                    set MAIN(loginQuick) 5
                    if {[<a name="::Login(10)"><a href="./login.tcl.html#::Login_24">::Login</a></a> [set DUT${dut}_CONNECT] -masterCheck 0 -CheckOperational 0] == 0} {
                        <a name="::result_debug(17)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Quick login with power cycle on no interaction failed&#34;
                    }
                    set MAIN(loginQuick) 0
                }
            }
        }
    }

    <span class="comment-line"># Do not checkOperational as unc first</span>
    if {[<a name="::Login(11)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connect -CheckOperational 0] != 1} {
        if {$in==&#34;download&#34;} { 
            <a name="::result_debug(18)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Login failed, but in Download.  It may not matter.&#34; 
            return -1   ;<span class="comment-line"># Error during login</span>
        } else {
            <a name="::result_error(10)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Login Failed.  CheckOperational Return a failure! &#34;
            return -1   ;<span class="comment-line"># Error during login</span>
        }
    }

    if {($in == &#34;download&#34;)} {
        <span class="comment-line"># - Disable pacman</span>
        global DUTs_info MAIN
        if {[info exists MAIN(bootPart)]} {
            <a name="::SendACmd(2)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;use image $MAIN(bootPart)&#34;
        }
        if {![info exists DUTs_info(DUT${whichDutNow},version)] || \
                                  $DUTs_info(DUT${whichDutNow},version) == &#34;INVALID&#34;} {
            set DUTs_info(DUT${whichDutNow},version) 24.1.1.1 ;<span class="comment-line"># Set to any value so jerry cmd will work</span>
        }
        set buf [<a name="::SendACmd(3)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;&#34;]
        if {[regexp -nocase &#34;pacman&#34; $buf]} {
            <a name="::EnableDebugMode(1)"><a href="./misc.tcl.html#::EnableDebugMode_2430">::EnableDebugMode</a></a>
            <a name="::result_debug(19)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Disable pacman&#34;
            <a name="::SendACmd(4)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;jerry disable pacman&#34;
            <a name="::exSleep(3)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 2
        }
        <span class="comment-line"># Swidswap chassis I/O module if necessary, and only if RunSetupScript is called from Qloadimage</span>
        <span class="comment-line">#     # Currently only supported for BDX 100G/100G XL (EXOS 15.6 &amp; later)</span>
        if {&#34;DUT$whichDutNow&#34; == &#34;DUT1&#34;} {
            global swidSwapList
            if {[info exists swidSwapList]} {
                <a name="::EnableDebugMode(2)"><a href="./misc.tcl.html#::EnableDebugMode_2430">::EnableDebugMode</a></a>
                foreach swidSwap $swidSwapList {
                    set swidSlot [lindex $swidSwap 0]
                    set swid [lindex $swidSwap 1]
                    lappend parameterList &#34;{Status:.*changing.*from.*to} $swid&#34;
                    lappend parameterList &#34;{SUCCESS:.*SwidSwap.*completed}&#34;
                    if {![regexp -nocase &#34;ok&#34; [<a name="::CheckKeyValue(2)"><a href="./OptionCheck.tcl.html#::CheckKeyValue_47">::CheckKeyValue</a></a> &#34;jerry hal swidswap slot $swidSlot&#34; $parameterList]]} {
                        if {![regexp -nocase &#34;ok&#34; [<a name="::CheckKeyValue(3)"><a href="./OptionCheck.tcl.html#::CheckKeyValue_47">::CheckKeyValue</a></a> &#34;jerry hal swidswap slot $swidSlot&#34; $parameterList]]} {
                            <a name="::result_error(11)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Could not complete SwidSwap on slot $swidSlot for swid $swid&#34;
                            return -1
                        }
                    }
                }
            }
        }

        <span class="comment-line"># VPEX DUT may need default.xsf applied before image download to pass CheckOperational with BPE slots</span>
        if {[regexp -nocase &#34;vpex&#34; [<a name="::GetPlatform(2)"><a href="./misc.tcl.html#::GetPlatform_478">::GetPlatform</a></a> DUT$whichDutNow]]} {
            puts &#34;\n!!\nIn vpex createdefault xsf pre download&#34;
            CreateDefaultXsf -dut $whichDutNow
            <a name="::Login(12)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connect -CheckOperational 0
            puts &#34;\n!!\n!!Completed vpex createdefault xsf pre download&#34;
        }
    }

    foreach command $setupScript {
        if { ([string match &#34;unc* sw*&#34; $command] == 1) \
            &amp;&amp; ([string tolower $at] != &#34;download&#34;) } {
            if {[<a name="::UnconfigSwAll(2)"><a href="./SendSwCmd.tcl.html#::UnconfigSwAll_1628">::UnconfigSwAll</a></a> -initial_unconfig yes] == 0 } {
                <a name="::result_error(12)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Unconfig sw all failed&#34; 
                return -1
            }
        } elseif { ([string match &#34;unc* sw*&#34; $command] == 1) } {
            puts &#34;Skipping Unconfig Switch for Download&#34; 
        } else {
            set buf [<a name="::SendACmd(5)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> $command]
            set backupStr &#34;Error: This command can only be executed on Master&#34;
            if {[regexp -nocase $backupStr $buf]} {
                if {[string tolower $at] == &#34;download&#34;} {
                    <a name="::result_debug(20)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Backup encountered&#34;
                } else {
                    <a name="::result_error(13)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Backup encountered, aborting&#34;
                    return -1
                }
            }
            if { ([string match &#34;reboo*&#34; $command] == 1) } {
                <a name="::result_debug(21)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Adding Extra Time for Reboot&#34;
                <a name="::exSleep(4)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 150
            }
        }
    }
    if {[info exists whichDutNow]} {
        <a name="::result_debug(22)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\n\n\n@@@@ Completed running DUT $whichDutNow Setup @@@@\n\n&#34;
    }
}


<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: SaveAndReboot</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: Performs save/reboot to the current DUT</span>
<span class="comment-line">#</span>
<span class="comment-line">#              </span>
<span class="comment-line">#     </span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args:      -waitLogin &#34;true|false&#34; after reboot wait for auth and login.</span>
<span class="comment-line">#                             default is &#34;false&#34;</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#              SaveAndReboot</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::SaveAndReboot_770">proc <a href="swConf.tcl-annot.html#::::SaveAndReboot">::::SaveAndReboot</a></a></strong><a name="::::SaveAndReboot"></a> {args} {
    global whichDutNow timeout

    <a name="::parse_args(5)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> SaveAndReboot $args {
        waitLogin   &#34;false&#34;
    }

    if {[info exists whichDutNow]} {
        set dut $whichDutNow
    } else {
        set dut 1
    }
    global DUT${dut}_CONNECT

    <a name="::result_debug(23)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;****Save and reboot.****&#34;
    send &#34;save\r&#34;
    expect {
        &#34;database?&#34; {
            send &#34;y\r&#34;
        }
        -nocase &#34;(y*n*)&#34; {
            send &#34;y\r&#34;
        }
        timeout {
            puts &#34;Did not get an expected prompt from the Save CLI&#34;
            send &#34;\r&#34;
        }
    }
    expect &#34;#&#34;
    send &#34;reboot\n&#34;
    expect -nocase &#34;(y*n*)&#34;
    send &#34;y\r&#34;
    expect {
        -re &#34;Requesting system reboot|Copyright|DRAM|Default BootLoader|Using Default image|Self Test|Press|xtreme&#34; {
            if {[regexp -nocase &#34;true|y&#34; $waitLogin]} {
                exp_continue
            } else {
                <a name="::result_debug(24)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\nDUT $dut has started reboot process. Continue test&#34;
                return
            }
        }
        -re &#34;login|password|Authentication Service&#34; {
            <a name="::result_debug(25)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\nSave and Reboot reached Authentication.  Login to DUT $dut&#34;
            <a name="::Login(13)"><a href="./login.tcl.html#::Login_24">::Login</a></a> [set DUT${dut}_CONNECT] -CheckOperational 0 -masterCheck 0
            return
        }
        timeout {
            puts &#34;\nDUT did not hit authentication prompts in $timeout seconds&#34;
        }
    }
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: clearFdb</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: Performs clear fdb on the current DUT, retained for historical reasons</span>
<span class="comment-line">#</span>
<span class="comment-line">#              </span>
<span class="comment-line">#     </span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: none</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#              clearFdb</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::clearFdb_839">proc <a href="swConf.tcl-annot.html#::::clearFdb">::::clearFdb</a></a></strong><a name="::::clearFdb"></a> {fd} {
   global DUTs_info;
   global whichDutNow;

   <a name="::result_debug(26)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;--- clear fdb&#34;;
   send &#34;clear fdb\r&#34;;

   <span class="comment-line"># For Aspen and Cougar platform delay 5 seconds to sync FDB cache on MSM with HW deleted FDBs on IO module.</span>
   global bcmPlatform
   if {[regexp -nocase $bcmPlatform $DUTs_info(DUT$whichDutNow,platform)]} {
      <a name="::result_debug(27)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Sleeping 5s awaiting clear fdb completion&#34;;
      <a name="::exSleep(5)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 5;
   }

   expect &#34;#&#34;;

   global pioneerPlatform
   if {[regexp -nocase $pioneerPlatform $DUTs_info(DUT$whichDutNow,platform)]} {
       <a name="::result_print(1)"><a href="./loadConsoles.tcl.html#::result_print_12">::result_print</a></a> &#34;Sleeping 15s awaiting PIONEER clear fdb completion....&#34;;
       <a name="::exSleep(6)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 15
   } 
}


<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: get_DUTs_info</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: creates a DUTs_info array after discovering all DUTs information in the testbed.</span>
<span class="comment-line">#              fills in all elements of DUTs_info array with relevant information.</span>
<span class="comment-line">#</span>
<span class="comment-line">#              </span>
<span class="comment-line">#     </span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: none</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#              get_DUTs_info</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::get_DUTs_info_881">proc <a href="swConf.tcl-annot.html#::::get_DUTs_info">::::get_DUTs_info</a></a></strong><a name="::::get_DUTs_info"></a> {{infoFilename &#34;info&#34;} {tmpdir &#34;Tmp&#34;}} {
global spawn_id
global numDUT
global MAIN
global DUT
global exos
global in
<span class="comment-line">#variable to store all the DUTs interested information</span>
global DUTs_info
global DUTs_Slot_info
global harness chassis stacking
global CFG_PLATFORM stackable i386Stackable

set pid [pid]

set fd_res [<a name="::open_result_file(1)"><a href="./result.tcl.html#::open_result_file_276">::open_result_file</a></a> &#34;$infoFilename&#34;]
set slotDump 0   
for {set i 1} {$i &lt;= $numDUT} {incr i 1} { 
    global eware_dut
    if {([info exists eware_dut]) &amp;&amp; ([lsearch $eware_dut $i] &gt; -1 )} {
        global DUT[set i]_CONNECT
        <a name="::Login(14)"><a href="./login.tcl.html#::Login_24">::Login</a></a> [set DUT[set i]_CONNECT]
        <a name="::::get_DUTs_info_eware(1)"><a href="./swConf.tcl.html#::::get_DUTs_info_eware_2409">::::get_DUTs_info_eware</a></a>
    } else {
        global DUT[set i]_CONNECT
        if {![info exists CFG_PLATFORM($i)]} {
            set CFG_PLATFORM($i) &#34;null&#34;
        }

        if {[info exists in] &amp;&amp; ([string tolower $in] == &#34;download&#34;)} {
            <a name="::result_debug(28)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Skipping CheckOperational in download&#34;
            <a name="::Login(15)"><a href="./login.tcl.html#::Login_24">::Login</a></a> &#34;[set DUT[set i]_CONNECT]&#34; -CheckOperational 0
        } else {
            <a name="::result_debug(29)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;CheckOperational not in download&#34;
            <a name="::Login(16)"><a href="./login.tcl.html#::Login_24">::Login</a></a> [set DUT[set i]_CONNECT]
            <a name="::result_debug(30)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Autotest is entering here&#34;
        }

        set platform [<a name="::GetPlatform(3)"><a href="./misc.tcl.html#::GetPlatform_478">::GetPlatform</a></a> DUT[set i]]
        <a name="::CheckOperational(2)"><a href="./login.tcl.html#::CheckOperational_653">::CheckOperational</a></a>    
        <a name="::Login(17)"><a href="./login.tcl.html#::Login_24">::Login</a></a> [set DUT[set i]_CONNECT]
        if {[regexp -nocase &#34;stack&#34; $platform] } {
            set showSwitchOutput &#34;&#34;
            lappend showSwitchOutput &#34;{Current.*State} {MASTER.*BACKUP.*In.*Sync} inLine exists&#34;
            <a name="::CheckKeyValue(4)"><a href="./OptionCheck.tcl.html#::CheckKeyValue_47">::CheckKeyValue</a></a> &#34;show switch&#34; $showSwitchOutput -testNo $infoFilename -time {s: 1 i: 20 d: 120 f: 240 r} \

        }

        <span class="comment-line">################################################################</span>
       <span class="comment-line">##  Get Slot info dump if Platform Type is BD or BT or Godzilla etc</span>
       <span class="comment-line">################################################################</span>
       set fd_in [open &#34;$tmpdir/tmp_info_DUT$i$pid&#34; &#34;w&#34;]

       <a name="::SendACmd(6)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable clipaging&#34;
       <a name="::SendACmd(7)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable auto-provision&#34;
       <a name="::SendACmd(8)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;show version detail&#34;
       <a name="::SendACmd(9)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;show version images&#34;
       <a name="::SendACmd(10)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;show fans detail&#34;
       <a name="::SendACmd(11)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;show switch&#34; $fd_res $fd_in
       <a name="::SendACmd(12)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;show version&#34; $fd_res $fd_in
       close $fd_in

       <span class="comment-line">################################################################</span>
       <span class="comment-line">##  Initiallize variables to be gathered.</span>
       <span class="comment-line">################################################################</span>
       set imageSel &#34;NONE&#34;
       set imageBooted &#34;NONE&#34;
       set priImage &#34;INVALID&#34;
       set secImage &#34;INVALID&#34;
       set version &#34;INVALID&#34;
       set platform &#34;INVALID&#34;
       set sysMAC &#34;INVALID&#34;
       set bootROM &#34;INVALID&#34;
       set relMaster &#34;INVALID&#34;
       set hwList 0
       set hwListFM 0
       set numSlots  &#34;0&#34; 
       set numSlotsFM &#34;0&#34;  
       set verTime   &#34;INVALID&#34;
       set memoryCard &#34;INVALID&#34;
       set coreTarget &#34;internal-memory&#34;
       set dlReqD    &#34;0&#34;
       set showVerVersion &#34;&#34;
       set snmpVersion &#34;2&#34;
       set sysN &#34;INVALID&#34;
       set sysT &#34;INVALID&#34;
       set license &#34;INVALID&#34;
       set slotNums &#34;&#34;
       set numExtSlots 0
       set slotSers &#34;&#34;

       set DUTs_info(DUT$i,imageSel) $imageSel
       set DUTs_info(DUT$i,imageBooted) $imageBooted
       set DUTs_info(DUT$i,priImage) $priImage
       set DUTs_info(DUT$i,secImage) $secImage
       set DUTs_info(DUT$i,version) $version
       set DUTs_info(DUT$i,verTime)   $verTime   
       set DUTs_info(DUT$i,platform) $platform
       set DUTs_info(DUT$i,sysMAC) $sysMAC
       set DUTs_info(DUT$i,bootROM) $bootROM
       set DUTs_info(DUT$i,numSlots)  $numSlots
       set DUTs_info(DUT$i,numSlotsFM)  $numSlotsFM      
       set DUTs_info(DUT$i,relMaster) $relMaster
       set DUTs_info(DUT$i,hwList) $hwList
       set DUTs_info(DUT$i,hwListFM) $hwListFM
       set DUTs_info(DUT$i,dlReqD)   $dlReqD
       set DUTs_info(DUT$i,sysName) $sysN
       set DUTs_info(DUT$i,sysType) $sysT
       set DUTs_info(DUT$i,debugFlag) 1
       set DUTs_info(DUT$i,sVVersion) $showVerVersion
       set DUTs_info(DUT$i,snmpVersion) $snmpVersion
       set DUTs_info(DUT$i,license) $license
       set DUTs_info(DUT$i,memoryCard) NULL
       set DUTs_info(DUT$i,slotNums)  $slotNums
       set DUTs_info(DUT$i,numExtSlots) $numExtSlots
       set DUTs_info(DUT$i,slotSerials) $slotSers 

       set bList &#34;NULL&#34;
       set location &#34;NULL&#34;
       <span class="comment-line"># Check the cfg file for DEFAULTXSF partition settings</span>
       _SetPartitionVars -dut $i

       set fd_in [open &#34;$tmpdir/tmp_info_DUT$i$pid&#34; &#34;r&#34;]
       set devSerialNum &#34;null&#34;
       while {[gets $fd_in line] != -1} {
          regexp -nocase -all &#34;(Switch|Chassis).*(\[a-zA-Z0-9]{5,5}\-\[a-zA-Z0-9]{5,5})&#34; $line dummy d2 devSerialNum;
          <span class="comment-line">#grant</span>
          if {[regexp -nocase &#34;vpex&#34; $platform]} {
              if {[regexp -nocase -all &#34;Slot-(\[0-9]+).*(\[a-zA-Z0-9]{5,5}\-\[a-zA-Z0-9]{5,5})&#34; \
                      $line dummy d2 devSerialNum]} {
                  lappend slotSers $devSerialNum
                  if {$d2==1 &amp;&amp; [regexp -nocase &#34;vpex&#34; $platform]} {
                      set mainSerial $devSerialNum
                  }
              }
          }
          set cookedLine [<a name="::cookString(1)"><a href="./misc.tcl.html#::cookString_22">::cookString</a></a> $line]


          <span class="comment-line">#result_debug &#34;----- cookedLine=$cookedLine&#34;</span>
          set aList [split $cookedLine]

          if {$bList != &#34;NULL&#34;} {

          <span class="comment-line"># Determine location in file search &#34;show switch, slot or version&#34;</span>
          if { ([lindex $bList 0] == &#34;sysName:&#34;) || ([lindex $bList 0] == &#34;SysName:&#34;) } {
              set location &#34;switch&#34;
          }

          if { ([lindex $bList 0] == &#34;Chassis:&#34;)  || \
               ([lindex $bList 0] == &#34;Chassis&#34;)   || \
               ([lindex $bList 0] == &#34;Slot-1&#34;)   || \
               ([lindex $bList 0] == &#34;Switch&#34;)   || \
               ([lindex $bList 0] == &#34;CPU&#34;)   || \
               ([lindex $bList 0] == &#34;Daughtercard:&#34;) || \
               ([lindex $bList 0] == &#34;Baseboard:&#34;)  } {
             set location &#34;version&#34;
          }

    <span class="comment-line">###########   Find image version selected to boot###########################</span>

          if { ([lindex $bList 0] == &#34;Image&#34;) &amp;&amp;     \
               ([lindex $bList 1] == &#34;Selected:&#34;) &amp;&amp;      \
               ( $location == &#34;switch&#34;        )  &amp;&amp; [lindex $aList 2]!=&#34;&#34;} {
             set imageSel [lindex $aList 2]
             set imageSel [string tolower $imageSel]
          }
          <span class="comment-line">#for 6.2.1</span>
          if { ([lindex $aList 0] == &#34;Image&#34;) &amp;&amp;     \
               ([lindex $aList 1] == &#34;Booted:&#34;) &amp;&amp; [lindex $aList 2]!=&#34;&#34; } {
             set imageBooted [lindex $aList 2]
             set imageBooted [string tolower $imageBooted]
          }


    <span class="comment-line">############ Find the names of the images load in the 2 MSM spaces.. ###</span>


          <span class="comment-line">#find primary image</span>
          if { ( $location == &#34;switch&#34; ) &amp;&amp;     \
               ([string tolower [lindex $bList 0]] == &#34;primary&#34;) &amp;&amp;     \
               ([string tolower [lindex $bList 1]] == &#34;ver:&#34;) } {
             set priImage [lindex $bList 2]
          }
          <span class="comment-line">#find second image</span>
          if { ( $location == &#34;switch&#34; ) &amp;&amp;     \
               ([string tolower [lindex $bList 0]] == &#34;secondary&#34;) &amp;&amp;   \
               ([string tolower [lindex $bList 1]] == &#34;ver:&#34;) } {
             set secImage [lindex $bList 2]
          }
          <span class="comment-line">#find System Name</span>
          if { ([string tolower [lindex $bList 0]] == &#34;sysname:&#34;) } {
             <span class="comment-line">#set platform [computeSysName [lindex $bList 1]]</span>
             set sysN [lindex $bList 1]
          }
          <span class="comment-line">#find System Type</span>
          if { ( $location == &#34;switch&#34; ) &amp;&amp;     \
               ([string tolower [lindex $bList 0]] == &#34;system&#34;) &amp;&amp;   \
               ([string tolower [lindex $bList 1]] == &#34;type:&#34;) } {
                   set sysT [lindex $bList 2]
                   if {$sysT == &#34;VPEX&#34;} {
                       set sysT &#34;[lindex $bList 2] [lindex $bList 3]&#34;
                   }
                   if {[regexp -nocase stack $bList match]} {
                       set platform $match
                   }  else {
                       set platform $sysT
                   }
                   if {[info exists CFG_PLATFORM($i)] &amp;&amp; $CFG_PLATFORM($i) != &#34;null&#34;} {
                       set platform $CFG_PLATFORM($i)
                   }
             }

                          
          
          <span class="comment-line">#find system MAC</span>
          if { ([lindex $bList 0] == &#34;System&#34;) &amp;&amp;     \
               ([lindex $bList 1] == &#34;MAC:&#34;) } {
             set sysMAC [lindex $bList 2]

          }
          <span class="comment-line">#find release master, time of the build, and the release master</span>
          <span class="comment-line"># EY-06-15-2006: Added elseif clause to handle new &#34;ExtremeXOS&#34;</span>
          <span class="comment-line"># software name.</span>
          if { ( $location == &#34;version&#34; )     &amp;&amp; \
               ([lindex $bList 0] == &#34;Image&#34;) &amp;&amp; \
               ([lindex $bList 3] == &#34;XOS&#34;)   &amp;&amp; \
               ([lindex $bList 4] == &#34;version&#34;)} {

             set version [lindex $bList 5];
             set showVerVersion [lindex $bList 6];
             <span class="comment-line"># Compute the version for patch builds in EXOS</span>
             if {[regexp -nocase &#34;\\-&#34; $showVerVersion]} {
                set patchList [split $showVerVersion &#34;-&#34;];
                foreach str [lrange $patchList 1 end] {
                   set version [format %s-%s $version $str];
                }
             }
             set relMaster [lindex $bList 8];
          } elseif { ( $location == &#34;version&#34; )          &amp;&amp; \
                     ([lindex $bList 0] == &#34;Image&#34;)      &amp;&amp; \
                    (([lindex $bList 2] == &#34;ExtremeXOS&#34;) || \
                     ([lindex $bList 2] == &#34;NETGEAR&#34;)   || \
                    ([lindex $bList 2] == &#34;AviatOS&#34;))   &amp;&amp; \
                     ([lindex $bList 3] == &#34;version&#34;)} {

              set version [lindex $bList 4];
              set showVerVersion [lindex $bList 5];
              <span class="comment-line"># Compute the version for patch builds in EXOS</span>
              if {[regexp -nocase &#34;\\-&#34; $showVerVersion]} {
                 set patchList [split $showVerVersion &#34;-&#34;];
                 foreach str [lrange $patchList 0 end] {
                    set version [format %s-%s $version $str];
                 }
              }
              <span class="comment-line"># Add support for change in Image : formatting 16.1.0.27 and higher</span>
              set versionDigits [split $version &#34;.&#34;]
              if {[lindex $versionDigits 0] &gt;= 16} {
                  set relMaster [lindex $bList 6];
              } else {
                  set relMaster [lindex $bList 7];
              }
          } elseif { ( $location == &#34;version&#34; )          &amp;&amp; \
                     ([lindex $bList 0] == &#34;Image&#34;)      &amp;&amp; \
                     (([lindex $bList 2] == &#34;NETGEAR&#34;) || \
                     ([lindex $bList 2] == &#34;AviatOS&#34;)) &amp;&amp;  \
                     ([lindex $bList 3] == &#34;version&#34;)} {

              set version [lindex $bList 4];
              set showVerVersion [lindex $bList 5];
              <span class="comment-line"># Compute the version for patch builds in EXOS</span>
              if {[regexp -nocase &#34;\\-&#34; $showVerVersion]} {
                 set patchList [split $showVerVersion &#34;-&#34;];
                 foreach str [lrange $patchList 0 end] {
                    set version [format %s-%s $version $str];
                 }
              }
              set relMaster [lindex $bList 7];
          } elseif { ( $location == &#34;version&#34; )          &amp;&amp; \
                     ([lindex $bList 0] == &#34;Image&#34;)      &amp;&amp; \
                     ([lindex $bList 2] == &#34;SwitchOS&#34;) &amp;&amp; \
                     ([lindex $bList 3] == &#34;version&#34;)} {

              set version [lindex $bList 4];
              set showVerVersion [lindex $bList 5];
              <span class="comment-line"># Compute the version for patch builds in EXOS</span>
              if {[regexp -nocase &#34;\\-&#34; $showVerVersion]} {
                 set patchList [split $showVerVersion &#34;-&#34;];
                 foreach str [lrange $patchList 0 end] {
                    set version [format %s-%s $version $str];
                 }
              }
              set relMaster [lindex $bList 7];
          }

          if { ( $location == &#34;version&#34; ) &amp;&amp;     \
               ([lindex $bList 0] == &#34;on&#34;)} {
             set verTime [lrange $bList 1 6]
          }



          <span class="comment-line">#find BootROM</span>
          if { ([lindex $bList 0] == &#34;BootROM&#34;) } {
             set bootROM [lindex $bList 2]

          }      

       }
          set bList $aList;<span class="comment-line"># This sets bList equal to the PREVIOUS line aList</span>
       }  ;<span class="comment-line"># end of file while</span>

       set parameterList &#34;&#34;
       if {[regexp -nocase &#34;by&#34; $relMaster] || [regexp -nocase &#34;by&#34; $showVerVersion]} {
           lappend parameterList &#34;{by} 1&#34;
           lappend parameterList &#34;{by} -1&#34;
           lappend parameterList &#34;{by} -2&#34;
           set getVerInfo [<a name="::GetKeyValue(1)"><a href="./OptionCheck.tcl.html#::GetKeyValue_438">::GetKeyValue</a></a> &#34;show version&#34; $parameterList]
           set getVerInfo [split [lindex $getVerInfo 0] &#34; &#34;] 
           set relMaster [lindex $getVerInfo 0]
           set showVerVersion [lindex $getVerInfo 1]
           if {[lindex $getVerInfo 2] == &#34;version&#34;} {
               set version [lindex $getVerInfo 1]
           } else {
               set version [lindex $getVerInfo 2]
           }
       }
       if {$version == &#34;INVALID&#34;} {
           lappend parameterList &#34;{ExtremeXOS version} 1&#34;
           lappend parameterList &#34;{by} 1&#34;
           lappend parameterList &#34;{by} -1&#34;
           set getVerInfo [<a name="::GetKeyValue(2)"><a href="./OptionCheck.tcl.html#::GetKeyValue_438">::GetKeyValue</a></a> &#34;show version&#34; $parameterList]
           set getVerInfo [list $getVerInfo]
           set version [lindex $getVerInfo 0]
           set relMaster [lindex $getVerInfo 1]
           set showVerVersion [lindex $getVerInfo 2]
       }
       unset parameterList
       <span class="comment-line">#get slot info to figure out hardware type</span>
       set hardwareType &#34;NEW_GEN&#34;
       set bladeType &#34;NONE&#34;
       global chassis everestChassis
       global i386Chassis
        if {[regexp -nocase &#34;$chassis|$i386Chassis|vpex&#34; $platform]} {
            lappend parameterList &#34;{^Slot-\[0-9\]+} 1&#34;
            set HardwareList [<a name="::GetKeyValue(3)"><a href="./OptionCheck.tcl.html#::GetKeyValue_438">::GetKeyValue</a></a> &#34;show slot&#34; $parameterList]
            unset parameterList
            set hwList &#34;&#34;
            set k 0;
            <span class="comment-line"># Stacks have Slot-# prompt. This may match the paralist above</span>
            foreach sVal $HardwareList {
                if {[regexp -nocase &#34;stack&#34; $sVal]} {
                    continue;
                }
                lappend hwList $sVal
                incr k 1;
            }
            <a name="::result_debug(31)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;HardwareList: $HardwareList&#34;
            <a name="::result_debug(32)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;hwList: $hwList&#34;
            foreach hardware $HardwareList {
                if {[lsearch -regexp $bladeType $hardware]==-1} {
                    if {$bladeType==&#34;NONE&#34;} {set bladeType &#34;&#34;}
                    if {![regexp -nocase &#34;none|Empty|stack&#34; $hardware]} {
                        set bladeType &#34;$bladeType$hardware&#34;
                    }
                }
            }
            <span class="comment-line"># Use foreach loop count to set numSlots</span>
            set numSlots $k;
            <a name="::result_debug(33)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;The number of I/O slots is $k&#34;
            <span class="comment-line">#VPEX slot numbers</span>
            if {[regexp -nocase &#34;vpex&#34; $platform]} {
                lappend parameterList &#34;{^Slot-\[0-9\]+} 0&#34;
                set slotNumList [<a name="::GetKeyValue(4)"><a href="./OptionCheck.tcl.html#::GetKeyValue_438">::GetKeyValue</a></a> &#34;show slot&#34; $parameterList]
                unset parameterList
                set newSlotCount 0
                foreach aSlot $slotNumList {
                    if {[regexp -nocase {slot-([0-9]+)|msm-([ab])|mm-([ab])} $aSlot allmatch myNum]} {
                        incr newSlotCount
                        lappend slotNums $myNum
                        if {$myNum &gt; 32} {
                            incr numExtSlots
                        }
                    }
                }
                set devSerialNum $mainSerial
                set numSlots $newSlotCount
                puts &#34;hwSlotNumbers $slotNums&#34;
            }

            <span class="comment-line">#get FM slot info for Everest chassis</span>
            if {[regexp -nocase &#34;$everestChassis&#34; $platform]} {
                lappend parameterList &#34;{^FM-\[0-5\]+} 1&#34;
                set HardwareListFM [<a name="::GetKeyValue(5)"><a href="./OptionCheck.tcl.html#::GetKeyValue_438">::GetKeyValue</a></a> &#34;show slot&#34; $parameterList]
                unset parameterList
                <a name="::result_debug(34)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;HardwareListFM: $HardwareListFM&#34;
                set hwListFM $HardwareListFM;

                set m 0;
                foreach hardwareFM $HardwareListFM {
                    if {[lsearch -regexp $bladeType $hardwareFM]==-1} {
                        if {$bladeType==&#34;NONE&#34;} {set bladeType &#34;&#34;}
                        if {![regexp -nocase &#34;none|Empty&#34; $hardwareFM]} {
                        set bladeType &#34;$bladeType$hardwareFM&#34;
                        }
                    }
                    incr m 1;
                }
                <span class="comment-line"># Use foreach loop count to set numSlotsFM</span>
                set numSlotsFM $m;
                <a name="::result_debug(35)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;The number of FM slots is $m&#34;

            }

        } else {
            if { [regexp -nocase &#34;$stackable|$i386Stackable&#34; $platform]} {
                set hardwareType &#34;NEW_GEN&#34;
            }
        }

       
       <span class="comment-line">################################################################</span>
       <span class="comment-line">##  Determine whether memorycard present, fill in memoryCard in DUTs_info</span>
       <span class="comment-line">################################################################</span>
       set memBuf [<a name="::SendACmd(13)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;show memorycard&#34;]
       if {![regexp -nocase &#34;Memorycard is not present|No such file or directory&#34; $memBuf]} {
           set memoryCard &#34;present&#34;
       }
       <span class="comment-line">################################################################</span>
       <span class="comment-line">##  Set the location that core files will be written to</span>
       <span class="comment-line">##  Chassis with memorycards - target = memory card</span>
       <span class="comment-line">##  For now stackables with USB/memorycard will still use int-memory</span>
       <span class="comment-line">################################################################</span>
       if {$memoryCard == &#34;present&#34; &amp;&amp; [regexp -nocase &#34;$chassis&#34; $platform] &amp;&amp; \
          ![regexp -nocase &#34;$stacking&#34; $platform]} {
           set coreTarget &#34;memorycard&#34;
       }
       if {$memoryCard == &#34;present&#34; &amp;&amp; [info exists MAIN(CORESTOSTACKABLEMEMORYCARD)] &amp;&amp; $MAIN(CORESTOSTACKABLEMEMORYCARD)} {
           set coreTarget &#34;memorycard&#34;
       }

       set parameterList &#34;&#34;
       lappend parameterList &#34;{Enabled License Level:} 0 1&#34;
       lappend parameterList &#34;{Enabled License Level:} 1 1&#34;
       set getLicense [<a name="::GetKeyValue(6)"><a href="./OptionCheck.tcl.html#::GetKeyValue_438">::GetKeyValue</a></a> &#34;show license&#34; $parameterList];
       <span class="comment-line"># EY-05-15-2008: Cleared out parameterList before end of loop.</span>
       <span class="comment-line"># This fixes a problem when retrieving slot info on a test bed with</span>
       <span class="comment-line"># more than one chassis or stack DUT.</span>
       unset parameterList;
       if {[lindex [lindex $getLicense 0] 1] != &#34;&#34;} {
          set temp [split [lindex $getLicense 0] &#34; &#34;]
          set currentLicense [concat [lindex $temp 0][lindex $temp 1]]
       } else {
          set temp [split [lindex $getLicense 0] &#34; &#34;]
          set currentLicense [lindex $temp 0]
       }
       set license $currentLicense



       <span class="comment-line">################################################################</span>

       global _VERSION
       global VERSION
       set _VERSION $version
       set VERSION [string range $_VERSION 0 0]
       set DUTs_info(DUT$i,VERSION) $VERSION
       <span class="comment-line">################################################################</span>

       puts &#34;####### version $version  ###########################&#34;
       set DUTs_info(DUT$i,imageSel) $imageSel
       set DUTs_info(DUT$i,imageBooted) $imageBooted
       set DUTs_info(DUT$i,priImage) $priImage
       set DUTs_info(DUT$i,secImage) $secImage
       set DUTs_info(DUT$i,version) $version
       set DUTs_info(DUT$i,verTime) $verTime   
       set DUTs_info(DUT$i,platform) $platform
       set DUTs_info(DUT$i,sysName) $sysN
       set DUTs_info(DUT$i,sysType) $sysT
       set DUTs_info(DUT$i,serial) $devSerialNum
       set DUTs_info(DUT$i,sysMAC) [string toupper $sysMAC]
       set DUTs_info(DUT$i,relMaster) $relMaster
       set DUTs_info(DUT$i,bootROM) $bootROM
       set DUTs_info(DUT$i,numSlots) $numSlots
       set DUTs_info(DUT$i,numSlotsFM) $numSlotsFM
       set DUTs_info(DUT$i,hwList) $hwList
       set DUTs_info(DUT$i,hwListFM) $hwListFM
       set DUTs_info(DUT$i,slotNums) $slotNums
       set DUTs_info(DUT$i,numExtSlots) $numExtSlots
       set DUTs_info(DUT$i,HardwareType) $hardwareType
       set DUTs_info(DUT$i,bladeType) $bladeType
       set DUTs_info(DUT$i,dlReqD)   $dlReqD
       set DUTs_info(DUT$i,sVVersion) $showVerVersion
       set DUTs_info(DUT$i,memoryCard) $memoryCard
       set DUTs_info(DUT$i,coreFileTarget) $coreTarget
       set DUTs_info(DUT$i,snmpVersion) $snmpVersion
       set DUTs_info(DUT$i,license) [string tolower $license]
       set DUTs_info(DUT$i,connect) [set DUT[set i]_CONNECT]
       if {[info exists DUT${i}_CONNECTB]} {
           set DUTs_info(DUT$i,connectB) [set DUT[set i]_CONNECTB]
       }

       <a name="::result_debug(36)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;****** START DEVICE INFORMATION DUT$i ********&#34;
       <a name="::result_debug(37)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i Image Selected = $DUTs_info(DUT$i,imageSel)&#34;
       <a name="::result_debug(38)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i Image Booted = $DUTs_info(DUT$i,imageBooted)&#34;
       <a name="::result_debug(39)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i Image Version = $DUTs_info(DUT$i,version)&#34;
       <a name="::result_debug(40)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i Connect type= $DUTs_info(DUT$i,connectType)&#34;
       <a name="::result_debug(41)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i Running Image Built on $DUTs_info(DUT$i,verTime)&#34;   
       <a name="::result_debug(42)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i Primary Image = $DUTs_info(DUT$i,priImage)&#34;
       <a name="::result_debug(43)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i Secondary Image = $DUTs_info(DUT$i,secImage)&#34;
       <a name="::result_debug(44)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i Platform = $DUTs_info(DUT$i,platform)&#34;
       <a name="::result_debug(45)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i System MAC = $DUTs_info(DUT$i,sysMAC)&#34;
       <a name="::result_debug(46)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i System Type = $DUTs_info(DUT$i,sysType)&#34;
       <a name="::result_debug(47)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i System Serial Number = $DUTs_info(DUT$i,serial)&#34;
       <a name="::result_debug(48)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i BootROM = $DUTs_info(DUT$i,bootROM)&#34;
       <a name="::result_debug(49)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i Release Master = $DUTs_info(DUT$i,relMaster)&#34;
       <a name="::result_debug(50)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i Slot Card List = $DUTs_info(DUT$i,hwList)&#34;
       <a name="::result_debug(51)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i FM Slot Card List = $DUTs_info(DUT$i,hwListFM)&#34;
       <a name="::result_debug(52)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i Slot Numbers List = $DUTs_info(DUT$i,slotNums)&#34;
       <a name="::result_debug(53)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i Number of VPEX Slots = $DUTs_info(DUT$i,numExtSlots)&#34;
       <a name="::result_debug(54)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i Number of Slots = $DUTs_info(DUT$i,numSlots)&#34;
       <a name="::result_debug(55)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i Number of FM Slots = $DUTs_info(DUT$i,numSlotsFM)&#34;      
       <a name="::result_debug(56)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i Hardware Type = $DUTs_info(DUT$i,HardwareType)&#34;
       <a name="::result_debug(57)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i Blade Type = $DUTs_info(DUT$i,bladeType)&#34;
       <a name="::result_debug(58)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i Download Flag Init    = $DUTs_info(DUT$i,dlReqD)&#34;
       <a name="::result_debug(59)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i Version from Show Version = $DUTs_info(DUT$i,sVVersion)&#34;
       <a name="::result_debug(60)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i memoryCard status = $DUTs_info(DUT$i,memoryCard)&#34;
       <a name="::result_debug(61)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i core file target = $DUTs_info(DUT$i,coreFileTarget)&#34;
       <a name="::result_debug(62)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i SNMP version = $DUTs_info(DUT$i,snmpVersion)&#34;
       <a name="::result_debug(63)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i License = $DUTs_info(DUT$i,license)&#34;
       <a name="::result_debug(64)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i Console = $DUTs_info(DUT$i,connect)&#34;
       if {[info exists DUT${i}_CONNECTB]} {
           <a name="::result_debug(65)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i Backup Console = $DUTs_info(DUT$i,connectB)&#34;
       }   
       <a name="::result_debug(66)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;****** END DEVICE INFORMATION DUT$i ********&#34;

       close $fd_in
       catch {file delete &#34;$tmpdir/tmp_info_DUT$i$pid&#34;}

       if {[info exist MAIN(ifPipe)] &amp;&amp; $MAIN(ifPipe) != &#34;NULL&#34;} {
           <span class="comment-line"># Later after DUTs_info array is fixed by removing 1Dim entries</span>
           <span class="comment-line">#foreach dKeyName [lsort [array_dimnames DUTs_info 1]] {</span>
           <span class="comment-line">#    if {[info exists DUTs_info(DUT$i,$dKeyName)]} {</span>
           <span class="comment-line">#        puts &#34;---- set DUTs_info(DUT$i,$dKeyName) \&#34;$DUTs_info(DUT$i,$dKeyName)\&#34;&#34;</span>
           <span class="comment-line">#    }</span>
           <span class="comment-line">#}</span>
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,imageSel) \&#34;$DUTs_info(DUT$i,imageSel)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,imageBooted) \&#34;$DUTs_info(DUT$i,imageBooted)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,version) \&#34;$DUTs_info(DUT$i,version)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,connectType) \&#34;$DUTs_info(DUT$i,connectType)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,VERSION) \&#34;$DUTs_info(DUT$i,VERSION)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,priImage) \&#34;$DUTs_info(DUT$i,priImage)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,secImage) \&#34;$DUTs_info(DUT$i,secImage)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,platform) \&#34;$DUTs_info(DUT$i,platform)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,sysMAC) \&#34;$DUTs_info(DUT$i,sysMAC)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,bootROM) \&#34;$DUTs_info(DUT$i,bootROM)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,relMaster) \&#34;$DUTs_info(DUT$i,relMaster)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,verTime) \&#34;$DUTs_info(DUT$i,verTime)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,serial) \&#34;$DUTs_info(DUT$i,serial)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,hwList) \&#34;$DUTs_info(DUT$i,hwList)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,hwListFM) \&#34;$DUTs_info(DUT$i,hwListFM)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,slotNums) \&#34;$DUTs_info(DUT$i,slotNums)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,numExtSlots) \&#34;$DUTs_info(DUT$i,numExtSlots)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,numSlots) \&#34;$DUTs_info(DUT$i,numSlots)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,numSlotsFM) \&#34;$DUTs_info(DUT$i,numSlotsFM)\&#34;&#34;              
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,HardwareType) \&#34;$DUTs_info(DUT$i,HardwareType)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,bladeType) \&#34;$DUTs_info(DUT$i,bladeType)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,dlReqD) \&#34;$DUTs_info(DUT$i,dlReqD)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,sysName) \&#34;$DUTs_info(DUT$i,sysName)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,sysType) \&#34;$DUTs_info(DUT$i,sysType)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,sVVersion) \&#34;$DUTs_info(DUT$i,sVVersion)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,snmpVersion) \&#34;$DUTs_info(DUT$i,snmpVersion)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,license) \&#34;$DUTs_info(DUT$i,license)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,memoryCard) \&#34;$DUTs_info(DUT$i,memoryCard)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,coreFileTarget) \&#34;$DUTs_info(DUT$i,coreFileTarget)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,UncSwAdditionalTime) \&#34;$DUTs_info(DUT$i,UncSwAdditionalTime)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,partitionCli) \&#34;$DUTs_info(DUT$i,partitionCli)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,debugFlag) \&#34;$DUTs_info(DUT$i,debugFlag)\&#34;&#34;
           puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,connect) \&#34;$DUTs_info(DUT$i,connect)\&#34;&#34;
           if {[info exists DUT${i}_CONNECTB]} {
               puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,connectB) \&#34;$DUTs_info(DUT$i,connectB)\&#34;&#34;
           }
           puts &#34;Just wrote DUTs_info to $MAIN(initFile)&#34;
       } elseif {[info exists MAIN(runMode)] &amp;&amp; $MAIN(runMode) == 0} {
            <a name="::result_error(14)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;There is an issue with the initFile to be written to.\
                   \npipe= $MAIN(ifPipe) file= $MAIN(initFile)&#34;
            
       }
    }
}
if {[info exists MAIN(ifPipe)] &amp;&amp; $MAIN(ifPipe) != &#34;NULL&#34;} {
    flush $MAIN(ifPipe)
}
<a name="::close_result_file(1)"><a href="./result.tcl.html#::close_result_file_363">::close_result_file</a></a>  
<span class="comment-line"># Now get the info from the individual slots if platform matches</span>
     if {$slotDump} {
         <a name="::::get_DUTs_Slot_info(1)"><a href="./swConf.tcl.html#::::get_DUTs_Slot_info_2096">::::get_DUTs_Slot_info</a></a> $tmpdir
     }
     global ixiaCh1
     if {($ixiaCh1 != &#34;NO_IXIA&#34;)} {
         if {![info exists DUT(LoadImage)]} { ;<span class="comment-line"># Need to turn of when run LoadImage</span>
             <span class="comment-line">#</span>
             <span class="comment-line"># EY-04-04-2013: Check return value of getTECardSpeed.</span>
             if {[set rc [<a name="::::getTECardSpeed(1)"><a href="./swConf.tcl.html#::::getTECardSpeed_1662">::::getTECardSpeed</a></a>]] != 0} {
                 puts &#34;Error $rc while calling getTECardSpeed.&#34;;
                 return -1;
             }
         }
     }
    return 0;
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: DutSlotType</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: Return the slot name of a specified DUT and Slot</span>
<span class="comment-line">#     </span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: DUT number, Slot Number</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: Return the slot name of a specified DUT and Slot</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#              DutSlotType 1 1</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: GetSwitchInfo</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::DutSlotType_1509">proc <a href="swConf.tcl-annot.html#::::DutSlotType">::::DutSlotType</a></a></strong><a name="::::DutSlotType"></a> {{dut &#34;&#34;} {slot &#34;&#34;}} {
   global DUTs_info
   if {$DUTs_info(DUT$dut,bladeType) != &#34;NONE&#34;} {
       set cardType [lindex $DUTs_info(DUT${dut},hwList) [expr $slot -1]]
   } else {
       set cardType &#34;NONE&#34;
   }

   return $cardType
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: DutSlotNumPorts</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: Return the number of ports on a slot</span>
<span class="comment-line">#     </span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: DUT number, Slot Number</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: Return the number of slots on a port</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#              DutSlotNumPorts 1 1</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: GetSwitchInfo</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::DutSlotNumPorts_1536">proc <a href="swConf.tcl-annot.html#::::DutSlotNumPorts">::::DutSlotNumPorts</a></a></strong><a name="::::DutSlotNumPorts"></a> {{dut &#34;&#34;} {slot &#34;&#34;}} {
   global DUTs_info

   if {$DUTs_info(DUT$dut,bladeType) != &#34;NONE&#34;} {
       set cardType [lindex $DUTs_info(DUT${dut},hwList) [expr $slot -1]]
   } else {
       set cardType &#34;0&#34;
   }

   if {0} {
      if {[regexp -nocase &#34;(\[0-9\]+)&#34; $cardType str]} {
         set numPort $str
      } else {
         set numPort &#34;0&#34;
      }
   } else {
      if {[regexp -nocase &#34;(\[0-9\]+)&#34; $cardType str]} {
          <a name="::Login(18)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $DUTs_info(DUT${dut},connect)
          lappend parameterList &#34;available: 1&#34;
          set numPort [<a name="::GetKeyValue(7)"><a href="./OptionCheck.tcl.html#::GetKeyValue_438">::GetKeyValue</a></a> &#34;show slot $slot&#34; $parameterList]
          unset parameterList
      } else {
         set numPort &#34;0&#34;
      }
   }

   return $numPort
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: DutSlotStateRT</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: Return the state of a slot from a real time show slot x</span>
<span class="comment-line">#     </span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: DUT number, Slot Number</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: Return the state of the card</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#              DutSlotStateRT 1 1</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: GetSwitchInfo</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::DutSlotStateRT_1581">proc <a href="swConf.tcl-annot.html#::::DutSlotStateRT">::::DutSlotStateRT</a></a></strong><a name="::::DutSlotStateRT"></a> {{dut &#34;&#34;} {slot &#34;&#34;}} {
    global DUTs_info

    <a name="::Login(19)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $DUTs_info(DUT${dut},connect)

    if {$DUTs_info(DUT$dut,bladeType) != &#34;NONE&#34;} {
        lappend parameterList &#34;State: 1&#34;
        set slotState [<a name="::GetKeyValue(8)"><a href="./OptionCheck.tcl.html#::GetKeyValue_438">::GetKeyValue</a></a> &#34;show slot $slot&#34; $parameterList]
        unset parameterList
    } else {
        set slotState NONE
    }
    return $slotState
}


<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: computeSysName</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: determines the platform system name. Run a sh ver and determines platform based on</span>
<span class="comment-line">#              number of slots i.e. whether 16,8 or 4 for GZ, BD or BT respectively.</span>
<span class="comment-line">#</span>
<span class="comment-line">#              </span>
<span class="comment-line">#     </span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: none</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: Returns the system name either BD, BT, GODZILLA or Sysname</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#              computeSysName</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::computeSysName_1616">proc <a href="swConf.tcl-annot.html#::::computeSysName">::::computeSysName</a></a></strong><a name="::::computeSysName"></a> {{<a name="::sysName(1)"><a href="./LLDPLib.tcl.html#::sysName_863">::sysName</a></a> &#34;&#34;}} {

   if {[regexp -nocase &#34;MSM&#34; $sysName]} {
      lappend parameterList &#34;{SLOT *16 :} 1&#34;
      set slot16Value [<a name="::GetKeyValue(9)"><a href="./OptionCheck.tcl.html#::GetKeyValue_438">::GetKeyValue</a></a> &#34;show ver&#34; $parameterList]
      unset parameterList
      <a name="::result_debug(67)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;slot16Value: $slot16Value&#34;
      if {[regexp -nocase &#34;KEY_NOT_FOUND&#34; $slot16Value]} {   ;<span class="comment-line"># BD or BT</span>
         lappend parameterList &#34;{SLOT *5 :} 1&#34;
         set slot5Value [<a name="::GetKeyValue(10)"><a href="./OptionCheck.tcl.html#::GetKeyValue_438">::GetKeyValue</a></a> &#34;show ver&#34; $parameterList]
         unset parameterList
         <a name="::result_debug(68)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;slot5Value: $slot5Value&#34;
         if {[regexp -nocase &#34;KEY_NOT_FOUND&#34; $slot5Value]} {   ;<span class="comment-line"># BT</span>
            set platform BT
         } else {
             <span class="comment-line"># no more set BD to MSM64 after ridding of EXTREME_PLATFORM</span>
             <span class="comment-line">#set platform $sysName ;# BD</span>
             set platform BD
         }
      } else {    ;<span class="comment-line"># Godzilla</span>
         set platform GODZILLA
      }
   } else {
      set platform $sysName
   }
   return $platform
}


<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: getTECardSpeed</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: determines the test equipment card's speed i.e. 10/100 or 1G</span>
<span class="comment-line">#</span>
<span class="comment-line">#              </span>
<span class="comment-line">#     </span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: none</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#              getTECardSpeed</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: VerifyTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::getTECardSpeed_1662">proc <a href="swConf.tcl-annot.html#::::getTECardSpeed">::::getTECardSpeed</a></a></strong><a name="::::getTECardSpeed"></a> {} {
   global ixiaCh1
   global startCardNum
   global MAIN
   <span class="comment-line">#</span>
   <span class="comment-line"># EY-04-04-2013: New global ixiaTclSrvr variable in case TCL server to</span>
   <span class="comment-line"># connect to is not the same as the chassis.</span>
   global ixiaTclSrvr;

   global cardSpeed
   set cardSpeed 0
  if {[info exists ixiaCh1]} {   
     global env
     global auto_path
     global ixiaPath

     set MAIN(skipIxInit) 0; set MAIN(IxiaReady) 1;
     <span class="comment-line">#set env(IXIA_HOME) $ixiaPath($ixiaCh1)</span>
     <a name="::SetIxiaEnv(1)"><a href="./ePTMisc.tcl.html#::SetIxiaEnv_517">::SetIxiaEnv</a></a> $ixiaPath($ixiaCh1)
     <span class="comment-line">#source $ixiaPath($ixiaCh1)</span>
     set auto_path_temp &#34;&#34;
     foreach var $auto_path {
         set var1 [split $var &#34;/&#34;]
         if {![regexp -nocase &#34;ixia&#34; $var1] &amp;&amp; $var1 != &#34;.&#34;} {
             lappend auto_path_temp $var
         }
     }
     unset auto_path
     lappend auto_path &#34;$ixiaPath($ixiaCh1)/lib&#34;
     lappend auto_path &#34;$ixiaPath($ixiaCh1)/lib/ixTcl1.0&#34;
     foreach adir $auto_path_temp {
         lappend auto_path $adir
     }
<span class="comment-line">#     puts &#34;DEBUG [set auto_path]\n\nIXIA_HOME env var = $env(IXIA_HOME)&#34;    </span>
     puts &#34;\n--- DEBUG TCL Variables and Ixia $ixiaCh1 ---\n [set auto_path]&#34;    
     puts &#34;Autotest the IXIA_HOME var is $env(IXIA_HOME)&#34;
     if {[set fd_out [<a name="::FileOpen(1)"><a href="./queueLib.tcl.html#::FileOpen_58">::FileOpen</a></a> [file join $env(IXIA_HOME) &#34;lib/ixTcl1.0/ixTclHal.tcl&#34;] r+]]==-1} {
         return $fd_out 
      }
      package require IxTclHal
      funlock $fd_out 
      package require Tclx
      package require Mpexpr
      <span class="comment-line">#clean up any previous mess</span>
   <span class="comment-line">#   cleanUp</span>
      <span class="comment-line">#</span>
      <span class="comment-line"># EY-04-04-2013: ixInitialize was deprecated back in IxOS v3.80.</span>
      <span class="comment-line"># Replace it with calls to ixConnectToTclServer and ixConnectToChassis.</span>
      <span class="comment-line">#ixInitialize $ixiaCh1</span>
      if {[isUNIX]} {
         <span class="comment-line">#</span>
         <span class="comment-line"># The expression to test needs to be in curly-braces to keep the</span>
         <span class="comment-line"># TCL interpreter from trying to substitute ixiaTclSrvr too soon.</span>
         set tclSrvrIp [expr {[info exists ixiaTclSrvr] ? $ixiaTclSrvr : $ixiaCh1}];
         if {[<a name="::ixConnectToTclServer(1)"><a href="./mapping.tcl.html#::ixConnectToTclServer_58">::ixConnectToTclServer</a></a> $tclSrvrIp]} {
            puts &#34;@@@@ Error connecting to Ixia TCL server @@@@&#34;;
            puts &#34;Error connecting to Ixia TCL server $tclSrvrIp.&#34;;
            return -1;
         }
      }
      if {[set rc [<a name="::ixConnectToChassis(1)"><a href="./mapping.tcl.html#::ixConnectToChassis_82">::ixConnectToChassis</a></a> $ixiaCh1]] != 0} {
         switch $rc {
            1       {puts &#34;Error connecting to Ixia chassis $ixiaCh1.&#34;;}
            2       {puts &#34;Version mismatch when connecting to Ixia chassis $ixiaCh1.&#34;;}
            3       {puts &#34;Timeout while trying to connect to Ixia chassis $ixiaCh1.&#34;;}
            default {puts &#34;Unknown error while attempting to connect to Ixia chassis $ixiaCh1.&#34;;}
         }
         return -2;
      }
      if {[chassis get $ixiaCh1]} {
         puts &#34;Error reading chassis configuration from Ixia chassis $ixiaCh1.&#34;;
         return -3;
      }
      set chId [chassis cget -id];
      <span class="comment-line">#</span>
      <span class="comment-line"># EY-04-04-2013: Add code to handle new case of startCardNum containing</span>
      <span class="comment-line"># a colon-separated port ID.</span>
      if {[info exists startCardNum]} {
         set tmp [split $startCardNum &#34;:&#34;];
         if {[llength $tmp] &gt; 1} {
            set startCard [lindex $tmp 0];
            set startPort [lindex $tmp 1];
         } else {
            set startCard $startCardNum;
            set startPort 1;
         }
         if {[<a name="::port(1)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> get $chId $startCard $startPort]} {
            puts &#34;Error reading port configuration from port $startCard:$startPort on Ixia chassis $ixiaCh1.&#34;;
            return -4;
         }
         set cardSpeed [<a name="::port(2)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> cget -speed]
         if {[info exist MAIN(ifPipe)] &amp;&amp; ($MAIN(ifPipe) != &#34;NULL&#34;)} {
            puts $MAIN(ifPipe) &#34;set cardSpeed $cardSpeed&#34;
         }
      }
   }
   return 0;
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: smallIxiaInit</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: This performs a faster ixia init in case of dev mode run.</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">#     </span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: none</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#              smallIxiaInit</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: VerifyTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::smallIxiaInit_1778">proc <a href="swConf.tcl-annot.html#::::smallIxiaInit">::::smallIxiaInit</a></a></strong><a name="::::smallIxiaInit"></a> {} {
      <span class="comment-line"># ----- Ixia initialization</span>
  global ixiaCh1
  global ixiaNoReset
  global MAIN

  if {[info exists ixiaCh1]} {
      global env
      global auto_path
      global ixiaPath
      
      set MAIN(skipIxInit) 0; set MAIN(IxiaReady) 1;
      <a name="::SetIxiaEnv(2)"><a href="./ePTMisc.tcl.html#::SetIxiaEnv_517">::SetIxiaEnv</a></a> $ixiaPath($ixiaCh1)
      set auto_path_temp &#34;&#34;
      foreach var $auto_path {
          set var1 [split $var &#34;/&#34;]
          if {![regexp -nocase &#34;ixia&#34; $var1] &amp;&amp; $var1 != &#34;.&#34;} {
              lappend auto_path_temp $var
          }
      }
      unset auto_path
      lappend auto_path &#34;$ixiaPath($ixiaCh1)/lib&#34;
      lappend auto_path &#34;$ixiaPath($ixiaCh1)/lib/ixTcl1.0&#34;
      foreach adir $auto_path_temp {
          lappend auto_path $adir
      }
      puts &#34;DEBUG [set auto_path]&#34;
      puts &#34;Autotest the IXIA_HOME var is $env(IXIA_HOME)&#34;
      if {[set fd_out [<a name="::FileOpen(2)"><a href="./queueLib.tcl.html#::FileOpen_58">::FileOpen</a></a> [file join $env(IXIA_HOME) &#34;lib/ixTcl1.0/ixTclHal.tcl&#34;] r+]]==-1} {
          return $fd_out
      }
      package require IxTclHal
      funlock $fd_out
      package require Tclx
      package require Mpexpr

      <a name="::ixInitialize(1)"><a href="./mapping.tcl.html#::ixInitialize_55">::ixInitialize</a></a> $ixiaCh1
      if {![info exists ixiaNoReset]} {
          <a name="::IxiaPortsInit(1)"><a href="./ePTTx.tcl.html#::IxiaPortsInit_331">::IxiaPortsInit</a></a>
      }
  }
    
}
<span class="comment-line">##################################################################</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::smallStcInit_1829">proc <a href="swConf.tcl-annot.html#::::smallStcInit">::::smallStcInit</a></a></strong><a name="::::smallStcInit"></a> {} {
    global MAIN stcPath LABSERVER SPIRENTCH1

    set ::LABSERVER 10.69.5.245
    lappend auto_path &#34;/auto/ixia_5_70/lib/mpexpr-1.1/&#34;
    <a name="::::overWriteProcs(1)"><a href="./stc.tcl.html#::::overWriteProcs_95">::::overWriteProcs</a></a> $MAIN(LIB_PATH) [file join $MAIN(LIB_PATH) spirent]
    source [file join $MAIN(LIB_PATH) ePTLib ePTUtils.tcl]
    <a name="::logcmd(1)"><a href="./spirent.tcl.html#::logcmd_26">::logcmd</a></a> lappend auto_path $stcPath($SPIRENTCH1)
    <a name="::stcInit(1)"><a href="./spirent.tcl.html#::stcInit_11">::stcInit</a></a> $LABSERVER
    package require Mpexpr
    puts &#34;\n\nPackage Require SpirentTestCenter&#34;
    <a name="::logcmd(2)"><a href="./spirent.tcl.html#::logcmd_26">::logcmd</a></a> package require SpirentTestCenter
    <a name="::GenerateDUTPortMapping(1)"><a href="./ePTPortMapping.tcl.html#::GenerateDUTPortMapping_217">::GenerateDUTPortMapping</a></a>; <span class="comment-line"># Add here temporarily b/c called in SystemSetup</span>
    set returnFlag &#34;connectionOkay&#34;
    <a name="::ReservePorts(1)"><a href="./spirent.tcl.html#::ReservePorts_67">::ReservePorts</a></a>
    set MAIN(IxInitialized) 1

}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: RunUnCon</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: This performs a uncon sw a at a slower speed making sure evey char typed is </span>
<span class="comment-line">#              is accepted by DUT</span>
<span class="comment-line">#</span>
<span class="comment-line">#     </span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: none</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#              RunUnCon</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::RunUnCon_1865">proc <a href="swConf.tcl-annot.html#::::RunUnCon">::::RunUnCon</a></a></strong><a name="::::RunUnCon"></a> {{connect &#34;0.0.0.0&#34;}      
               {setupScript &#34;&#34;}
               {fd &#34;NULL&#34;}} {
   global spawn_id
   <a name="::Login(20)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $connect
   set timeout 120

   foreach command $setupScript {
      if { [string match &#34;unc* sw*&#34; $command] == 1 } {
         <a name="::result_debug(69)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Make sure that this is not a direct telnet connection&#34;
         <a name="::result_debug(70)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Reseting to factory defaults...&#34;
         foreach letter {u n c o n &#34; &#34; s w &#34; &#34; a} {
            send $letter
             expect {
                &#34;$letter&#34; {
                    after 10
                }
                timeout {
                   for {set c 0} {$c&lt;10} {incr c} {
                      send $letter
                      expect {
                         &#34;$letter&#34; {
                            break
                         }
                         timeout {
                            after 10
                         }
                      }
                   }
                }
             }
         }
         send &#34;\r&#34;
         expect -nocase &#34;(y*n*)&#34;
         send &#34;y\r&#34;
         log_user 1
      }     
   }        
<span class="comment-line">#   logout  </span>
}           
<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name: GetBcomPortInfoStd</span>
<span class="comment-line"># Description: Init Globals for PortId_Info and Trunk_Info </span>
<span class="comment-line"># portId and Trunk port on a standard regression bed.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Sets globals: </span>
<span class="comment-line">#</span>
<span class="comment-line">#       PortID_Info($i,portSpeed) $portSpeed</span>
<span class="comment-line">#       PortID_Info($i,showSpeed) 100Mbps|1Gbps|10Gbps|40Gbps - how it is display on show port info det</span>
<span class="comment-line">#       PortID_Info($i,normTxPerc) (lowest portId speed / portSpeed) * 100</span>
<span class="comment-line">#       PortID_Info($j,normTxPercBy100) (lowest portId speed / portSpeed)</span>
<span class="comment-line">#</span>
<span class="comment-line">#       -- These variables are used in test cases where sw forwarding may or may not be used</span>
<span class="comment-line">#          depending on the platform or the port ID</span>
<span class="comment-line">#       PortID_Info($i,txSwHwPercHigh) sw or hw tx perc - applicatin specific;</span>
<span class="comment-line">#       PortID_Info($i,txSwHwPercLow) sw or hw tx perc - applicatin specific;</span>
<span class="comment-line">#       PortID_Info($i,txSwHwPerc) sw or hw tx perc - applicatin specific;</span>
<span class="comment-line">#       PortID_Info($i,txSwHwRateHigh) sw or hw tx frame rate - applicatin specific;</span>
<span class="comment-line">#       PortID_Info($i,txSwHwRateLow) sw or hw tx frame rate - applicatin specific;</span>
<span class="comment-line">#       PortID_Info($i,txSwHwRate) sw or hw tx frame rate - applicatin specific;</span>
<span class="comment-line">#       PortID_Info($i,txSwHwNumFrames) 64k for sw 3M for hw</span>
<span class="comment-line">#       PortID_Info($i,txPath) sw|hw;</span>
<span class="comment-line">#</span>
<span class="comment-line">#       Main_Info(stdIdCount) 8|12</span>
<span class="comment-line">#       Main_Info(portSpeedList) list of all 8|12 speeds &#34;100 100 1000 100 10000 40000 ....&#34;</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: none</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: none</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#       GetPortIdInfoStd;</span>
<span class="comment-line"># Category: Utility</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetPortIdInfoStd_1938">proc <a href="swConf.tcl-annot.html#::::GetPortIdInfoStd">::::GetPortIdInfoStd</a></a></strong><a name="::::GetPortIdInfoStd"></a> {{saveMode 0}} {
    global Trunk_Info;
    global DUTs_info;
    global PortID_Info;
    global Main_Info;
    global chassis;
    global DUT1_CONNECT;
    global DUT2_CONNECT;
    global chassis;
    global whichDutNow;
    global bcmPlatform;
    global bcmJaguar;
    global napaBlade;
    global bcmChassis;
    global stacking;
    global MAIN;
    global portIDsUsed;

    set saveGlobals 0;
    if {[info exist MAIN(ifPipe)] &amp;&amp; ($MAIN(ifPipe) != &#34;NULL&#34;) &amp;&amp; ($saveMode != &#34;0&#34;)} {
        <a name="::_getPortIdTypeInfo(1)"><a href="./broadcom.tcl.html#::_getPortIdTypeInfo_985">::_getPortIdTypeInfo</a></a> 1;
    } else {
        <a name="::_getPortIdTypeInfo(2)"><a href="./broadcom.tcl.html#::_getPortIdTypeInfo_985">::_getPortIdTypeInfo</a></a>;
        set saveMode 0;
    }

    set portSpeedList &#34;&#34;;
    <span class="comment-line"># EY-12-16-2009: Fixed typo and cleaned up indentation.</span>
    if {[info exists portIDsUsed]} {
        foreach portId $portIDsUsed {
            set portSpeed [<a name="::GetPortIdSpeed(1)"><a href="./ePTMisc.tcl.html#::GetPortIdSpeed_451">::GetPortIdSpeed</a></a> $portId];
            lappend portSpeedList $portSpeed;
            set portSpeedArray(portID${portId},speed) $portSpeed;
            set PortID_Info($portId,portSpeed) $portSpeed;
            if {$saveMode} {puts $MAIN(ifPipe) &#34;set PortID_Info($portId,portSpeed) $portSpeed&#34;;}
            switch $portSpeed {
                &#34;100&#34;   {set PortID_Info($portId,showSpeed) 100Mbps;}
                &#34;1000&#34;  {set PortID_Info($portId,showSpeed) 1Gbps;}
                &#34;2500&#34;  {set PortID_Info($portId,showSpeed) &#34;2.5Gbps&#34;;}
                &#34;5000&#34;  {set PortID_Info($portId,showSpeed) 5Gbps;}
                &#34;10000&#34; {set PortID_Info($portId,showSpeed) 10Gbps;}
                &#34;40000&#34; {set PortID_Info($portId,showSpeed) 40Gbps;}
            }
        }
        set Main_Info(portSpeedList) $portSpeedList;
        if {$saveMode} {puts $MAIN(ifPipe) &#34;set Main_Info(portSpeedList) \&#34;$portSpeedList\&#34;&#34;;}

        <span class="comment-line"># Sort the port speeds from lowest to highest</span>
        set portSpeedList [lsort -integer $portSpeedList];
        set Main_Info(sortPortSpeedList) $portSpeedList;
        if {$saveMode} {puts $MAIN(ifPipe) &#34;set Main_Info(sortPortSpeedList) \&#34;$portSpeedList\&#34;&#34;;}
        set lowestPortSpeed [lindex $portSpeedList 0];
        foreach portUsed $portIDsUsed {
            set PortID_Info($portUsed,normTxPerc) [mpexpr int(double($lowestPortSpeed) / double($PortID_Info($portUsed,portSpeed)) * 100)];
            if {$saveMode} {
                puts $MAIN(ifPipe) &#34;set PortID_Info($portUsed,normTxPerc) [mpexpr int(double($lowestPortSpeed) / double($PortID_Info($portUsed,portSpeed)) * 100)]&#34;;
            }      
            set PortID_Info($portUsed,normTxPercBy100) [mpexpr double($lowestPortSpeed) / double($PortID_Info($portUsed,portSpeed))];
            if {$saveMode} {
                puts $MAIN(ifPipe) &#34;set PortID_Info($portUsed,normTxPercBy100) [mpexpr double($lowestPortSpeed) / double($PortID_Info($portUsed,portSpeed))]&#34;;
            }

            set i $portUsed;
            if {$PortID_Info($i,BcomGen) == &#34;NewGen&#34; || $PortID_Info($i,BcomGen) == &#34;Default&#34;} {
                switch [<a name="::GetPortIdSpeed(2)"><a href="./ePTMisc.tcl.html#::GetPortIdSpeed_451">::GetPortIdSpeed</a></a> $i] {
                    &#34;40000&#34; {set PortID_Info($i,txSwHwPercHigh) 100;
                             set PortID_Info($i,txSwHwPercLow) 10;
                             set PortID_Info($i,txSwHwPerc) 100;
                             set PortID_Info($i,txSwHwRateHigh) 59200000;
                             set PortID_Info($i,txSwHwRateLow) 592000;
                             set PortID_Info($i,txSwHwRate) 592000}
                    &#34;10000&#34; {set PortID_Info($i,txSwHwPercHigh) 100;
                             set PortID_Info($i,txSwHwPercLow) 10;
                             set PortID_Info($i,txSwHwPerc) 100;
                             set PortID_Info($i,txSwHwRateHigh) 14800000;
                             set PortID_Info($i,txSwHwRateLow) 148000;
                             set PortID_Info($i,txSwHwRate) 148000}
                    &#34;1000&#34;  {set PortID_Info($i,txSwHwPercHigh) 100;
                             set PortID_Info($i,txSwHwPercLow) 10;
                             set PortID_Info($i,txSwHwPerc) 100;
                             set PortID_Info($i,txSwHwRateHigh) 1480000;
                             set PortID_Info($i,txSwHwRateLow) 14800;
                             set PortID_Info($i,txSwHwRate) 148000}
                    &#34;100&#34;   {set PortID_Info($i,txSwHwPercHigh) 100;
                             set PortID_Info($i,txSwHwPercLow) 10;
                             set PortID_Info($i,txSwHwPerc) 100;
                             set PortID_Info($i,txSwHwRateHigh) 148000;
                             set PortID_Info($i,txSwHwRateLow) 1480;
                             set PortID_Info($i,txSwHwRate) 14800;}
                    default {set PortID_Info($i,txSwHwPercHigh) 100;
                             set PortID_Info($i,txSwHwPercLow) 10;
                             set PortID_Info($i,txSwHwPerc) 100;
                             set PortID_Info($i,txSwHwRateHigh) 148000;
                             set PortID_Info($i,txSwHwRateLow) 1480;
                             set PortID_Info($i,txSwHwRate) 14800}
                }; <span class="comment-line"># switch [GetPortIdSpeed $i]</span>
                <span class="comment-line">#result_debug &#34;PortID $i is on a NewGen Broadcom OR Genesis Chassis Blade&#34;</span>
                set PortID_Info($i,txSwHwNumFrames) 3000000;
                set PortID_Info($i,txPath) hw;
            } else {
                switch [<a name="::GetPortIdSpeed(3)"><a href="./ePTMisc.tcl.html#::GetPortIdSpeed_451">::GetPortIdSpeed</a></a> $i] {
                    &#34;40000&#34; {set PortID_Info($i,txSwHwPercHigh) .003; <span class="comment-line">#copy 10000 settings until the correct value is determined DH 29-Apr-2011</span>
                             set PortID_Info($i,txSwHwPercLow) .001;
                             set PortID_Info($i,txSwHwPerc) .003;
                             set PortID_Info($i,txSwHwRateHigh) 200;
                             set PortID_Info($i,txSwHwRateLow) 100;
                             set PortID_Info($i,txSwHwRate) 200}
                    &#34;10000&#34; {set PortID_Info($i,txSwHwPercHigh) .003;
                             set PortID_Info($i,txSwHwPercLow) .001;
                             set PortID_Info($i,txSwHwPerc) .003;
                             set PortID_Info($i,txSwHwRateHigh) 200;
                             set PortID_Info($i,txSwHwRateLow) 100;
                             set PortID_Info($i,txSwHwRate) 200}
                    &#34;1000&#34;  {set PortID_Info($i,txSwHwPercHigh) .02;
                             set PortID_Info($i,txSwHwPercLow) .01;
                             set PortID_Info($i,txSwHwPerc) .02;
                             set PortID_Info($i,txSwHwRateHigh) 200;
                             set PortID_Info($i,txSwHwRateLow) 100;
                             set PortID_Info($i,txSwHwRate) 200}
                    &#34;100&#34;   {set PortID_Info($i,txSwHwPercHigh) .25;
                             set PortID_Info($i,txSwHwPercLow) .10;
                             set PortID_Info($i,txSwHwPerc) .25;
                             set PortID_Info($i,txSwHwRateHigh) 200;
                             set PortID_Info($i,txSwHwRateLow) 100;
                             set PortID_Info($i,txSwHwRate) 200}
                    default {set PortID_Info($i,txSwHwPercHigh) .25;
                             set PortID_Info($i,txSwHwPercLow) .10;
                             set PortID_Info($i,txSwHwPerc) .25;
                             set PortID_Info($i,txSwHwRateHigh) 200;
                             set PortID_Info($i,txSwHwRateLow) 100;
                             set PortID_Info($i,txSwHwRate) 200}
                }; <span class="comment-line"># switch [GetPortIdSpeed $i]</span>
                <span class="comment-line">#result_debug &#34;PortID $i is OldGen Broadcom Stackable&#34;</span>
                set PortID_Info($i,txSwHwNumFrames) 64000;
                set PortID_Info($i,txPath) sw;
            }; <span class="comment-line"># else</span>
        }; <span class="comment-line"># foreach portUsed $portIDsUsed</span>
    }; <span class="comment-line"># if {[info exists portIDsUsed]}</span>
}; <span class="comment-line"># proc GetPortIdInfoStd</span>

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: get_DUTs_Slot_info</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: This creates and fills in the array  DUTs_Slot_info with the help of DUTs_info</span>
<span class="comment-line">#              All slot specific necessary information may be obtained from this array. This array</span>
<span class="comment-line">#              may be referred with known information of DUT and slot number</span>
<span class="comment-line">#</span>
<span class="comment-line">#     </span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: tmpdir</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#              get_DUTs_Slot_info</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::get_DUTs_Slot_info_2096">proc <a href="swConf.tcl-annot.html#::::get_DUTs_Slot_info">::::get_DUTs_Slot_info</a></a></strong><a name="::::get_DUTs_Slot_info"></a> {{tmpdir &#34;Tmp&#34;}} {
global spawn_id
global numDUT
global MAIN

set numSlots 8

<span class="comment-line">#variable to store all the DUTs interested information</span>
global DUTs_info
global DUTs_Slot_info

set fd_res [<a name="::open_result_file(2)"><a href="./result.tcl.html#::open_result_file_276">::open_result_file</a></a> &#34;slotinfo&#34;]

for {set i 1} {$i &lt;= $numDUT} {incr i 1} {

   global DUT${i}_CONNECT
   global DUT${i}_CONNECTB
   set numSlots $DUTs_info(DUT$i,numSlots)
   set hwModType &#34;NULL&#34;
   set confType  &#34;NULL&#34;
   set state     &#34;NULL&#34;
   set npRev     &#34;NULL&#34;
   set npProc1   &#34;NULL&#34;
   set npProc2   &#34;NULL&#34;
   set imageSel  &#34;NULL&#34;
   set priImage  &#34;NULL&#34;
   set secImage  &#34;NULL&#34;
   set version   &#34;NULL&#34;
   set verTime   &#34;NULL&#34;
   set dlReqD    &#34;0&#34;
   set category  &#34;NULL&#34;

   for {set j 1} {$j &lt;= $numSlots} {incr j} {
   <span class="comment-line"># Hardware module type</span>
   set DUTs_Slot_info(DUT$i,slot$j,hwModType) $hwModType
   <span class="comment-line"># Module type set in the configuration</span>
   set DUTs_Slot_info(DUT$i,slot$j,confType)  $confType
   <span class="comment-line"># State of the card (Operational or not)</span>
   set DUTs_Slot_info(DUT$i,slot$j,state)     $state
   <span class="comment-line"># Revision of the C5 Network Processor</span>
   set DUTs_Slot_info(DUT$i,slot$j,npRev)     $npRev
   <span class="comment-line"># Status of each NP on the slot</span>
   set DUTs_Slot_info(DUT$i,slot$j,npProc1)   $npProc1
   <span class="comment-line"># Status of each NP on the slot</span>
   set DUTs_Slot_info(DUT$i,slot$j,npProc2)   $npProc2
   <span class="comment-line"># Image selected to boot from</span>
   set DUTs_Slot_info(DUT$i,slot$j,imageSel)  $imageSel
   <span class="comment-line"># Image in the primary slot</span>
   set DUTs_Slot_info(DUT$i,slot$j,priImage)  $priImage
   <span class="comment-line"># Image in the secondary slot</span>
   set DUTs_Slot_info(DUT$i,slot$j,secImage)  $secImage
   <span class="comment-line"># Image in the slot that is chosen to boot from ASSUMED RUNNING IMAGE</span>
   set DUTs_Slot_info(DUT$i,slot$j,version)   $version
   <span class="comment-line"># Date and Time that the running image was made</span>
   set DUTs_Slot_info(DUT$i,slot$j,verTime)   $verTime
   <span class="comment-line"># For use to determine downloads</span>
   set DUTs_Slot_info(DUT$i,slot$j,dlReqD)    $dlReqD
   <span class="comment-line"># Set category OldGen NewGen NP</span>
   set DUTs_Slot_info(DUT$i,slot$j,category)  $category

   }


   <span class="comment-line">#For the NP Cards we need more than 1 line captured</span>

   set bList &#34;NULL&#34;
   set location &#34;NULL&#34;

   set fd_in [open &#34;$tmpdir/tmp_info_DUT$i&#34; &#34;r&#34;]
   while {[gets $fd_in line] != -1} {
      set cookedLine [<a name="::cookString(2)"><a href="./misc.tcl.html#::cookString_22">::cookString</a></a> $line]


<span class="comment-line">#result_debug &#34;----- cookedLine=$cookedLine&#34;</span>
      set aList [split $cookedLine]

      if {$bList != &#34;NULL&#34;} {

<span class="comment-line"># Determine location in file search &#34;show switch, slot or version&#34;</span>
      if { ([lindex $bList 0] == &#34;sysName:&#34;)} {
         set location &#34;switch&#34;
         }
      if { ([lindex $bList 0] == &#34;Chassis:&#34;)} {
         set location &#34;version&#34;
         }

<span class="comment-line">######## Loop through slots #########################################</span>
  for {set j 1} {$j &lt;= $numSlots} {incr j} {

        if { ([lindex $bList 0] == &#34;Slot&#34;) &amp;&amp;    \
           ([lindex $bList 1] == &#34;$j&#34;) &amp;&amp;       \
           ([lindex $bList 2] == &#34;information:&#34;) } {
            set location &#34;slot$j&#34;
        }


<span class="comment-line">###########   Find image version selected to boot###########################</span>

      <span class="comment-line">#find image version selected on an NP Card</span>


        if {    ([lindex $bList 0] == &#34;Software&#34;) &amp;&amp;     \
                ([lindex $bList 1] == &#34;image&#34;) &amp;&amp;        \
                ([lindex $bList 2] == &#34;booted:&#34;) &amp;&amp;      \
                ( $location == &#34;slot$j&#34;        )  } {
            set DUTs_Slot_info(DUT$i,slot$j,imageSel) [lindex $bList 3]
            set npImageSel $DUTs_Slot_info(DUT$i,slot$j,imageSel)
            set DUTs_Slot_info(DUT$i,slot$j,imageSel) \
                   [string tolower $DUTs_Slot_info(DUT$i,slot$j,imageSel)]

        }


<span class="comment-line">###########  Find name of image version booted #############################</span>
      <span class="comment-line">#find image version booted name on an NP Card</span>
      set tmp [lindex $bList 0]
      set tmp [string tolower $tmp]

        if {   ($tmp == $DUTs_Slot_info(DUT$i,slot$j,imageSel)) &amp;&amp; \
               ([string tolower [lindex $bList 1]] == &#34;software&#34;) &amp;&amp;        \
               ([string tolower [lindex $bList 2]] == &#34;version:&#34;) &amp;&amp;    \
               ($location == &#34;slot$j&#34;) } {
            set DUTs_Slot_info(DUT$i,slot$j,version) &#34;[lindex $aList 1] [string trimleft \
                              [lindex $aList 2] &#34;(&#34;] [string trimright [lindex $aList 3] &#34;)&#34;] \
                              [lindex $aList 6]&#34;
            if {[lindex $aList 4] == &#34;Prj&#34;} {
                set DUTs_Slot_info(DUT$i,slot$j,verTime) &#34;[lindex $aList 12] [lindex $aList 13] \
                                 [lindex $aList 14] [lindex $aList 15] [lindex $aList 16]&#34;
            }
            if {[lindex $aList 4] == &#34;(Type:&#34;} {
                set DUTs_Slot_info(DUT$i,slot$j,verTime) &#34;[lindex $aList 9] [lindex $aList 10] \
                                 [lindex $aList 11] [lindex $aList 12] [lindex $aList 13]&#34;
            }
            if { ([lindex $aList 0] == &#34;6.2.1&#34;)  &amp;&amp; \
                 ([lindex $aList 4] == &#34;by&#34;)   } {
                set DUTs_Slot_info(DUT$i,slot$j,verTime) &#34;[lindex $aList 7] [lindex $aList 8] \
                                 [lindex $aList 9]&#34;
                set DUTs_Slot_info(DUT$i,slot$j,version) &#34;[lindex $aList 0] [string trimleft \
                              [lindex $aList 1] &#34;(&#34;] [string trimright [lindex $aList 2] &#34;)&#34;]&#34;
            }                  
            if { ([lindex $aList 0] &gt;= &#34;7.0.0&#34;)  &amp;&amp; \
                 ([lindex $aList 5] == &#34;by&#34;)   } {
                set DUTs_Slot_info(DUT$i,slot$j,verTime) &#34;[lindex $aList 8] [lindex $aList 9] \
                                 [lindex $aList 10]&#34;
                set DUTs_Slot_info(DUT$i,slot$j,version) &#34;[lindex $aList 0] [lindex $aList 3]&#34;
            }
            if { ([lindex $aList 0] &gt;= &#34;7.0.0&#34;)  &amp;&amp; \
                 ([lindex $aList 4] == &#34;by&#34;)   } {
                set DUTs_Slot_info(DUT$i,slot$j,verTime) &#34;[lindex $aList 7] [lindex $aList 8] \
                                 [lindex $aList 9]&#34;
                set DUTs_Slot_info(DUT$i,slot$j,version) &#34;[lindex $aList 0] b[string trimright \
                                 [lindex $aList 2] &#34;)&#34;]&#34;
            }
        }



<span class="comment-line">############ Find the names of the images load in the 2 spaces.. NP cards###</span>
      <span class="comment-line">#find primary image</span>
      if { ( $location == &#34;slot$j&#34; ) &amp;&amp;     \
           ([string tolower [lindex $bList 0]] == &#34;primary&#34;) &amp;&amp;     \
           ([string tolower [lindex $bList 1]] == &#34;software&#34;) &amp;&amp;    \
           ([string tolower [lindex $bList 2]] == &#34;version:&#34;) } {
         set DUTs_Slot_info(DUT$i,slot$j,priImage) &#34;[lindex $aList 1] [string trimleft \
                            [lindex $aList 2] &#34;(&#34;] [string trimright [lindex $aList 3] &#34;)&#34;] \
                            [lindex $aList 6]&#34;
         if {[lindex $aList 0] == &#34;6.2.1&#34;} {
             set DUTs_Slot_info(DUT$i,slot$j,priImage) &#34;[lindex $aList 0] [string trimleft \
                           [lindex $aList 1] &#34;(&#34;] [string trimright [lindex $aList 2] &#34;)&#34;]&#34;
         }
      }
      <span class="comment-line">#find second image</span>
      if { ( $location == &#34;slot$j&#34; ) &amp;&amp;     \
           ([string tolower [lindex $bList 0]] == &#34;secondary&#34;) &amp;&amp;   \
           ([string tolower [lindex $bList 1]] == &#34;software&#34;) &amp;&amp;    \
           ([string tolower [lindex $bList 2]] == &#34;version:&#34;) } {
         set DUTs_Slot_info(DUT$i,slot$j,secImage) &#34;[lindex $aList 1] [string trimleft \
                            [lindex $aList 2] &#34;(&#34;] [string trimright [lindex $aList 3] &#34;)&#34;] \
                            [lindex $aList 6]&#34;
         if {[lindex $aList 0] == &#34;6.2.1&#34;} {
             set DUTs_Slot_info(DUT$i,slot$j,secImage) &#34;[lindex $aList 0] [string trimleft \
                           [lindex $aList 1] &#34;(&#34;] [string trimright [lindex $aList 2] &#34;)&#34;]&#34;
         }
      }
      <span class="comment-line">#find Hardware module type</span>
      if { ([lindex $bList 0] == &#34;HW&#34;) &amp;&amp;     \
           ([lindex $bList 2] == &#34;Type:&#34;) &amp;&amp; \
            ( $location == &#34;slot$j&#34; )   } {
         set DUTs_Slot_info(DUT$i,slot$j,hwModType) [lindex $bList 3]

      }

      <span class="comment-line">#find Slot s/w Configured setting</span>
      if { ([lindex $bList 0] == &#34;Configured&#34;) &amp;&amp;     \
           ([lindex $bList 1] == &#34;Type:&#34;) &amp;&amp; \
            ( $location == &#34;slot$j&#34; )   } {
         set DUTs_Slot_info(DUT$i,slot$j,confType) [lindex $bList 2]

      }
      <span class="comment-line">#find find operational state</span>
      if { ([lindex $bList 0] == &#34;State:&#34;) &amp;&amp;  \
            ( $location == &#34;slot$j&#34; ) } {
         set DUTs_Slot_info(DUT$i,slot$j,state) [lindex $bList 1]

      }
      <span class="comment-line">#find NP Revision</span>
      if { ([lindex $bList 0] == &#34;NP&#34;) &amp;&amp;     \
           ([lindex $bList 1] == &#34;1:&#34;) &amp;&amp; \
           ([lindex $bList 2] == &#34;Rev&#34;) &amp;&amp; \
            ( $location == &#34;slot$j&#34; )   } {
         set DUTs_Slot_info(DUT$i,slot$j,npRev) [lindex $bList 3]
      }
      <span class="comment-line">#find NP 1 Proc State</span>
      if { ([lindex $bList 0] == &#34;Network&#34;) &amp;&amp;     \
           ([lindex $bList 1] == &#34;Processor&#34;) &amp;&amp; \
           ([lindex $bList 2] == &#34;1&#34;) &amp;&amp; \
            ( $location == &#34;slot$j&#34; )   } {
         set DUTs_Slot_info(DUT$i,slot$j,npProc1) [lindex $bList 4]
      }
      <span class="comment-line">#find NP 2 Proc State</span>
      if { ([lindex $bList 0] == &#34;Network&#34;) &amp;&amp;     \
           ([lindex $bList 1] == &#34;Processor&#34;) &amp;&amp; \
           ([lindex $bList 2] == &#34;2&#34;) &amp;&amp; \
            ( $location == &#34;slot$j&#34; )   } {
         set DUTs_Slot_info(DUT$i,slot$j,npProc2) [lindex $bList 4]
      }

   }
   }
   set bList $aList

}



for {set j 1} {$j &lt;= $numSlots} {incr j} {

    switch $DUTs_Slot_info(DUT$i,slot$j,hwModType) {
        &#34;A3ci&#34;    {set DUTs_Slot_info(DUT$i,slot$j,category) NP}
        &#34;P3ci&#34;    {set DUTs_Slot_info(DUT$i,slot$j,category) NP}
        &#34;P12ci&#34;   {set DUTs_Slot_info(DUT$i,slot$j,category) NP}
        &#34;ARM&#34;     {set DUTs_Slot_info(DUT$i,slot$j,category) NP}
        &#34;ASMGM2X&#34; {set DUTs_Slot_info(DUT$i,slot$j,category) NP}
        &#34;MPLS&#34;    {set DUTs_Slot_info(DUT$i,slot$j,category) NP}
        &#34;SMA&#34;     {set DUTs_Slot_info(DUT$i,slot$j,category) NP}
        &#34;G8Xi&#34;    {set DUTs_Slot_info(DUT$i,slot$j,category) NEW_GEN}
        &#34;F48Ti&#34;   {set DUTs_Slot_info(DUT$i,slot$j,category) NEW_GEN}
        &#34;G12Xi&#34;   {set DUTs_Slot_info(DUT$i,slot$j,category) NEW_GEN}
        &#34;F32T&#34;    {set DUTs_Slot_info(DUT$i,slot$j,category) OLD_GEN}
        &#34;F24T&#34;    {set DUTs_Slot_info(DUT$i,slot$j,category) OLD_GEN}
    }

   <a name="::result_debug(71)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;*** DUT$i *** Slot$j Info ********&#34;
   <a name="::result_debug(72)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Hardware Module Type = $DUTs_Slot_info(DUT$i,slot$j,hwModType)&#34;
   <a name="::result_debug(73)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Module Configured = $DUTs_Slot_info(DUT$i,slot$j,confType)&#34;
   <a name="::result_debug(74)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Slot State = $DUTs_Slot_info(DUT$i,slot$j,state)&#34;
   <a name="::result_debug(75)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Network Processor Rev = $DUTs_Slot_info(DUT$i,slot$j,npRev)&#34;
   <a name="::result_debug(76)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Network Processor 1 Status = $DUTs_Slot_info(DUT$i,slot$j,npProc1)&#34;
   <a name="::result_debug(77)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Network Processor 2 Status = $DUTs_Slot_info(DUT$i,slot$j,npProc2)&#34;
   <a name="::result_debug(78)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Image Selected = $DUTs_Slot_info(DUT$i,slot$j,imageSel)&#34;
   <a name="::result_debug(79)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Booted Version Name = $DUTs_Slot_info(DUT$i,slot$j,version)&#34;
   <a name="::result_debug(80)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Build Date = $DUTs_Slot_info(DUT$i,slot$j,verTime)&#34;
   <a name="::result_debug(81)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Primary Image = $DUTs_Slot_info(DUT$i,slot$j,priImage)&#34;
   <a name="::result_debug(82)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Secondary Image = $DUTs_Slot_info(DUT$i,slot$j,secImage)&#34;
   <a name="::result_debug(83)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Card Category = $DUTs_Slot_info(DUT$i,slot$j,category)&#34;


      if {[info exist MAIN(ifPipe)] &amp;&amp; ($MAIN(ifPipe) != &#34;NULL&#34;)} {
       puts $MAIN(ifPipe) &#34;set DUTs_Slot_info(DUT$i,slot$j,hwModType) \&#34;$DUTs_Slot_info(DUT$i,slot$j,hwModType)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_Slot_info(DUT$i,slot$j,confType) \&#34;$DUTs_Slot_info(DUT$i,slot$j,confType)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_Slot_info(DUT$i,slot$j,state) \&#34;$DUTs_Slot_info(DUT$i,slot$j,state)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_Slot_info(DUT$i,slot$j,npRev) \&#34;$DUTs_Slot_info(DUT$i,slot$j,npRev)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_Slot_info(DUT$i,slot$j,npProc1) \&#34;$DUTs_Slot_info(DUT$i,slot$j,npProc1)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_Slot_info(DUT$i,slot$j,npProc2) \&#34;$DUTs_Slot_info(DUT$i,slot$j,npProc2)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_Slot_info(DUT$i,slot$j,imageSel) \&#34;$DUTs_Slot_info(DUT$i,slot$j,imageSel)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_Slot_info(DUT$i,slot$j,version) \&#34;$DUTs_Slot_info(DUT$i,slot$j,version)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_Slot_info(DUT$i,slot$j,verTime) \&#34;$DUTs_Slot_info(DUT$i,slot$j,verTime)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_Slot_info(DUT$i,slot$j,priImage) \&#34;$DUTs_Slot_info(DUT$i,slot$j,priImage)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_Slot_info(DUT$i,slot$j,secImage) \&#34;$DUTs_Slot_info(DUT$i,slot$j,secImage)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_Slot_info(DUT$i,slot$j,category) \&#34;$DUTs_Slot_info(DUT$i,slot$j,category)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_Slot_info(DUT$i,slot$j,dlReqD)   \&#34;$DUTs_Slot_info(DUT$i,slot$j,dlReqD)\&#34;&#34;       
      }

}

   close $fd_in                          


}
<a name="::close_result_file(2)"><a href="./result.tcl.html#::close_result_file_363">::close_result_file</a></a>

}



<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: get_DUTs_info_eware</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: creates a DUTs_info array after discovering all DUTs information in the testbed.</span>
<span class="comment-line">#              fills in all elements of DUTs_info array with relevant information.</span>
<span class="comment-line">#</span>
<span class="comment-line">#              </span>
<span class="comment-line">#     </span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: none</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#              get_DUTs_info</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::get_DUTs_info_eware_2409">proc <a href="swConf.tcl-annot.html#::::get_DUTs_info_eware">::::get_DUTs_info_eware</a></a></strong><a name="::::get_DUTs_info_eware"></a> {{infoFilename &#34;info&#34;} {tmpdir &#34;Tmp&#34;}} {
global spawn_id
global numDUT
global MAIN
global DUT
global DUTs_info
global DUTs_Slot_info
global branch
global pioneerPlatform
global everestChassis
global DUTs_info
global whichDutNow

global tmpPath
if [info exists tmpPath] {
    set tmpdir $tmpPath
}

set fd_res [<a name="::open_result_file(3)"><a href="./result.tcl.html#::open_result_file_276">::open_result_file</a></a> &#34;$infoFilename&#34;]
set slotDump 0   
<span class="comment-line">#for {set i 1} {$i &lt;= $numDUT} {incr i 1} {</span>

<span class="comment-line">#   global eware_dut</span>
<span class="comment-line">#   if {[info exists eware_dut]} {</span>
<span class="comment-line">#      if {[lsearch $eware_dut $i] &gt; -1 } {</span>
<span class="comment-line">#         set loopVar 1</span>
 <span class="comment-line">#     } else {</span>
 <span class="comment-line">#        set loopVar 0</span>
 <span class="comment-line">#     }</span>
 <span class="comment-line">#  } else {</span>
 <span class="comment-line">#     set loopVar 0</span>
 <span class="comment-line">#  }</span>

  <span class="comment-line"># if {$loopVar} {</span>
   global whichDutNow
   set i $whichDutNow
   global DUT[set i]_CONNECT
   <a name="::Login(21)"><a href="./login.tcl.html#::Login_24">::Login</a></a> [set DUT[set i]_CONNECT]

   lappend parameterList &#34;{SysName:}   1&#34;
   set sysN [<a name="::GetKeyValue(11)"><a href="./OptionCheck.tcl.html#::GetKeyValue_438">::GetKeyValue</a></a> &#34;show switch&#34; $parameterList]
   unset parameterList

   <span class="comment-line">################################################################</span>
   <span class="comment-line">##  Determine Platform Type as BD or BT or Godzilla etc</span>
   <span class="comment-line">################################################################</span>
   set platFType [<a name="::::computeSysName(1)"><a href="./swConf.tcl.html#::::computeSysName_1616">::::computeSysName</a></a> $sysN]
   set platFType [string tolower $platFType]
   <span class="comment-line">################################################################</span>
   <span class="comment-line">##  Get Slot info dump if Platform Type is BD or BT or Godzilla etc</span>
   <span class="comment-line">################################################################</span>
   set fd_in [open &#34;$tmpdir/tmp_info_DUT$i-[pid]&#34; &#34;w&#34;]
   <a name="::SendACmd(14)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;sh sw&#34; $fd_res $fd_in
   <a name="::SendACmd(15)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;sh ver&#34; $fd_res $fd_in
   <a name="::SendACmd(16)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;sh vlan default&#34; $fd_res $fd_in
   if {([regexp -nocase &#34;bd|bt&#34; $platFType])      || \
       ([regexp -nocase &#34;Alpine*&#34; $platFType])    || \
       ([regexp -nocase &#34;godzilla&#34; $platFType])  } {
      <a name="::SendACmd(17)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;sh slot&#34; $fd_res $fd_in
      set slotDump 1
   }      
   close $fd_in
   <span class="comment-line">################################################################</span>
   <span class="comment-line">##  Initiallize variables to be gathered.</span>
   <span class="comment-line">################################################################</span>
   set imageSel &#34;NONE&#34;
   set priImage &#34;INVALID&#34;
   set secImage &#34;INVALID&#34;
   set version &#34;INVALID&#34;
   set platform &#34;INVALID&#34;
   set techRel   &#34;INVALID&#34;   
   set sysMAC &#34;INVALID&#34;
   set bootROM &#34;INVALID&#34;
   set relMaster &#34;INVALID&#34;
   set numPorts 0
   set merge     &#34;INVALID&#34;
   set numSlots  &#34;0&#34;   
   set version2  &#34;INVALID&#34;
   set verTime   &#34;INVALID&#34;
   set dlReqD    &#34;0&#34;
   set priVer    &#34;&#34;
   set secVer    &#34;&#34;
   set showVerVersion &#34;&#34;
   set snmpVersion &#34;2&#34;

   set DUTs_info(DUT$i,imageSel) $imageSel
   set DUTs_info(DUT$i,priImage) $priImage
   set DUTs_info(DUT$i,secImage) $secImage
   set DUTs_info(DUT$i,version) $version
   set DUTs_info(DUT$i,verTime)   $verTime   
   set DUTs_info(DUT$i,platform) $platform
   set DUTs_info(DUT$i,sysMAC) $sysMAC
   set DUTs_info(DUT$i,bootROM) $bootROM
   set DUTs_info(DUT$i,numSlots)  $numSlots   
   set DUTs_info(DUT$i,relMaster) $relMaster
   set DUTs_info(DUT$i,numPorts) $numPorts
   set DUTs_info(DUT$i,techRel)   $techRel
   set DUTs_info(DUT$i,merge)    $merge
   set DUTs_info(DUT$i,dlReqD)   $dlReqD
   set DUTs_info(DUT$i,sysName) $sysN
   set DUTs_info(DUT$i,debugFlag) 1
   set DUTs_info(DUT$i,sVVersion) $showVerVersion
   set DUTs_info(DUT$i,snmpVersion) $showVerVersion

   set masterOfsset &#34;17&#34;
   set masterEnd &#34;28&#34;
   set isMSM &#34;FALSE&#34;
   set bList &#34;NULL&#34;
   set location &#34;NULL&#34;
   set msmLocation &#34;NULL&#34;
   set msmMaster   &#34;MSM-B&#34;

   set fd_in [open &#34;$tmpdir/tmp_info_DUT$i-[pid]&#34; &#34;r&#34;]
   while {[gets $fd_in line] != -1} {
      set cookedLine [<a name="::cookString(3)"><a href="./misc.tcl.html#::cookString_22">::cookString</a></a> $line]


<span class="comment-line">#result_debug &#34;----- cookedLine=$cookedLine&#34;</span>
      set aList [split $cookedLine]

      if {$bList != &#34;NULL&#34;} {

<span class="comment-line"># Determine location in file search &#34;show switch, slot or version&#34;</span>
      if { ([lindex $bList 0] == &#34;sysName:&#34;) || ([lindex $bList 0] == &#34;SysName:&#34;) } {
         set location &#34;switch&#34;
         }
    <span class="comment-line">#Determine if you are in an msm image section</span>
      set msmType [string toupper  [lindex $bList 0]]
      switch -exact -- $msmType {
        &#34;MSM-A&#34; { set msmLocation &#34;MSM-A&#34; }    
        &#34;MSM-B&#34; { set msmLocation &#34;MSM-B&#34; }    
        &#34;MSM-C&#34; { set msmLocation &#34;MSM-C&#34; }    
        &#34;MSM-D&#34; { set msmLocation &#34;MSM-D&#34; }   
      }  
      if { ([lindex $bList 0] == &#34;Chassis:&#34;)  || \
           ([lindex $bList 0] == &#34;Chassis&#34;)   || \
           ([lindex $bList 0] == &#34;CPU&#34;)   || \
           ([lindex $bList 0] == &#34;Daughtercard:&#34;) || \
           ([lindex $bList 0] == &#34;Baseboard:&#34;)  } {
         set location &#34;version&#34;
      }

      if { ([lindex $bList 0] == &#34;Slot&#34;) &amp;&amp;    \
           ([lindex $bList 1] == &#34;1&#34;) &amp;&amp;       \
           ([lindex $bList 2] == &#34;information:&#34;) } {
         set location &#34;slot&#34;
      }
      <span class="comment-line">#6.2.1b10</span>
      if { ([lindex $aList 0] == &#34;Current&#34;) &amp;&amp;     \
           ([lindex $aList 1] == &#34;State:&#34;) } {

         set masterOffset &#34;29&#34;
         set masterEnd &#34;40&#34;
         set isMSM &#34;TRUE&#34;
         if {[regexp -nocase $pioneerPlatform $DUTs_info(DUT$whichDutNow,platform)] || \
             [regexp -nocase $everestChassis $DUTs_info(DUT$whichDutNow,platform)]} {
             set msmMaster MM-B
         } else {
             set msmMaster MSM-B
         }
         if {[string tolower [lindex $aList 2]] == &#34;master&#34; } {
             set masterOfsset &#34;17&#34;
             set masterEnd &#34;28&#34;
             set msmMaster MSM-A
             if {[regexp -nocase $pioneerPlatform $DUTs_info(DUT$whichDutNow,platform)]} {
                 set msmMaster MM-A
             } else {
                 set msmMaster MSM-A
             }
         }
      }

  <span class="comment-line">###########   Find both image versions Fix for 700b37 new Show switch #########</span>
      if { ([string tolower [lindex $aList 0]] == &#34;primary&#34;) &amp;&amp;     \
           ([string tolower [lindex $aList 1]] == &#34;ew&#34;) &amp;&amp;        \
           ([string tolower [lindex $aList 2]] == &#34;ver:&#34;) } {
      set priVer [string tolower [lindex $aList 3]]
      }
          if { ([string tolower [lindex $aList 0]] == &#34;secondary&#34;) &amp;&amp;     \
               ([string tolower [lindex $aList 1]] == &#34;ew&#34;) &amp;&amp;        \
               ([string tolower [lindex $aList 2]] == &#34;ver:&#34;) } {
          set secVer [string tolower [lindex $aList 3]]
          }

  <span class="comment-line">################   Find image version selected to boot IMAGE RUNNING NOW  #####</span>

      <span class="comment-line">#find image version selected on switch</span>

      if { ([lindex $bList 0] == &#34;Software&#34;) &amp;&amp;     \
           ([lindex $bList 1] == &#34;image&#34;) &amp;&amp;        \
           ([lindex $bList 2] == &#34;booted:&#34;) &amp;&amp;      \
           ( $location == &#34;switch&#34;        )  } {
         set imageSel [lindex $bList 3]
         set imageSel [string tolower $imageSel]
           puts &#34;**$imageSel***from the wrong place 618 code########&#34;
      }
      <span class="comment-line">###### Fix for ABU new Show Switch 700b44##################################</span>
      if { ([lindex $bList 0] == &#34;Module&#34;) &amp;&amp;     \
           ([lindex $bList 1] == &#34;Image&#34;) &amp;&amp;        \
           ([lindex $bList 4] == &#34;Booted&#34;) &amp;&amp;      \
           ( $location == &#34;switch&#34;        )  } {
         set imageSel [lindex $aList 2]
         set imageSel [string tolower $imageSel]
         if {$imageSel == &#34;primary&#34;} {
             set version $priVer
         } elseif {$imageSel == &#34;secondary&#34;} {
             set version $secVer
         }
      }
      <span class="comment-line">###### Fix for ABU new Show Switch 700b45 and above##################################</span>
      if { ([lindex $bList 0] == &#34;------&#34;) &amp;&amp;     \
           ( $location == &#34;switch&#34;        )  } {
         set imageSel [lindex $aList 2]
         set imageSel [string tolower $imageSel]
         if {$imageSel == &#34;primary&#34;} {
             set version $priVer
         } elseif {$imageSel == &#34;secondary&#34;} {
             set version $secVer
         }
      }
      if { ([lindex $bList 0] == &#34;Image&#34;) &amp;&amp;     \
           ([lindex $bList 1] == &#34;Selected:&#34;) &amp;&amp;      \
           ( $location == &#34;switch&#34;        )  } {
         set imageSel [lindex $aList 2]
         set imageSel [string tolower $imageSel]
         if {$imageSel == &#34;primary&#34;} {
             set version $priVer
         } elseif {$imageSel == &#34;secondary&#34;} {
             set version $secVer
         }
      puts &#34;** 700 changes for Alpine  ########&#34;
      }
      <span class="comment-line">#for 6.2.1</span>
      if { ([lindex $aList 0] == &#34;Image&#34;) &amp;&amp;     \
           ([lindex $aList 1] == &#34;Booted:&#34;) } {
         set imageSel [lindex [string range $line $masterOfsset $masterEnd] 0]
         set imageSel [string tolower $imageSel]
 puts &#34;**$imageSel***from 621 code########&#34;
      }


      <span class="comment-line"># Find image version booted name on MSM</span>
      <span class="comment-line">#</span>

      set tmp [lindex $bList 0]
      set tmp [string tolower $tmp]
      if { ($tmp == $imageSel) &amp;&amp; ($location == &#34;switch&#34;) &amp;&amp;    \
           ([string tolower [lindex $bList 1]] == &#34;software&#34;) &amp;&amp;        \
           ([string tolower [lindex $bList 2]] == &#34;version:&#34;) } {
         set version [lindex $bList 3]
         set slot [lindex $bList 5]
         if { $slot == &#34;MSM-A&#34; || $slot == &#34;MM-A&#34;} {
            if {$version == &#34;empty&#34;} {
               set version [string tolower &#34;[lindex $bList 6]&#34;]
            } else {
               set version [string tolower &#34;[lindex $bList 3]&#34;]
            }
         }
      }

      <span class="comment-line">#6.2.1b10</span>
      set tmp [lindex $aList 0]
      set tmp [string tolower $tmp]      
      if { ($tmp == $imageSel) &amp;&amp;     \
           ([string tolower [lindex $aList 1]] == &#34;ew&#34;) &amp;&amp;        \
           ([string tolower [lindex $aList 2]] == &#34;ver:&#34;) &amp;&amp;  \
           ($msmLocation == &#34;NULL&#34;)     } {
      set version [string tolower [lindex $aList 3]]
         if { $isMSM == &#34;TRUE&#34; } {
            if {$masterOfsset == &#34;17&#34;} {
               set version [string tolower &#34;[lindex [string range $line $masterOfsset $masterEnd] 0]&#34;]
            } else {
               set version [string tolower &#34;[lindex [string range $line $masterOfsset $masterEnd] 0]&#34;]
            }
         }
      }
      <span class="comment-line">#7.0.0b39 RTPFixes5</span>
      <span class="comment-line"># Primary   EW Ver:   7.3.0.22 branch-4digit_v730b22 [non-ssh] [base] </span>
      <span class="comment-line"># Secondary EW Ver:   7.1.1b11 branch.PA-0311-01-r2 [non-ssh]      </span>
      set tmp [lindex $bList 0]
      set tmp [string tolower $tmp]      
      if { ($tmp == $imageSel) &amp;&amp;     \
           ([string tolower [lindex $bList 1]] == &#34;ew&#34;) &amp;&amp;        \
           ([string tolower [lindex $bList 2]] == &#34;ver:&#34;) &amp;&amp;      \
           ($msmMaster == $msmLocation)    } {
         set version [string tolower [lindex $bList 3]]
      }
      set version1 $version

<span class="comment-line">#############################################################################</span>
<span class="comment-line">###               Find the names of the images load in the 2 MSM spaces.. ###</span>
<span class="comment-line">###              SHOW SWITCH                                              ###</span>
<span class="comment-line">#############################################################################</span>

      <span class="comment-line">#find primary image</span>
      if { ( $location == &#34;switch&#34; ) &amp;&amp;     \
           ([string tolower [lindex $bList 0]] == &#34;primary&#34;) &amp;&amp;     \
           ([string tolower [lindex $bList 1]] == &#34;software&#34;) &amp;&amp;    \
           ([string tolower [lindex $bList 2]] == &#34;version:&#34;) } {
         set priImage [lindex $bList 3]
      }
      <span class="comment-line">#for 6.2.1</span>
      if { ([string tolower [lindex $aList 0]] == &#34;primary&#34;) &amp;&amp;     \
           ([string tolower [lindex $aList 1]] == &#34;ew&#34;) &amp;&amp;    \
           ([string tolower [lindex $aList 2]] == &#34;ver:&#34;) &amp;&amp; \
           ($msmLocation == &#34;NULL&#34;)    } {
         set priImage [lindex [string range $line $masterOfsset $masterEnd] 0]
      }
      <span class="comment-line">#for 700b39 rtpfixes on</span>
      if { ([string tolower [lindex $bList 0]] == &#34;primary&#34;) &amp;&amp;     \
           ([string tolower [lindex $bList 1]] == &#34;ew&#34;) &amp;&amp;    \
           ([string tolower [lindex $bList 2]] == &#34;ver:&#34;) &amp;&amp; \
           ($msmMaster == $msmLocation)    } {
           <span class="comment-line">#fix for 701b4</span>
           if {[regexp -nocase &#34;ssh&#34; [lindex $bList 4]]} {
               set priImage &#34;[lindex $bList 3]&#34;
           } else {
               set priImage &#34;[lindex $bList 3] [lindex $bList 4]&#34;
           }

      }
      <span class="comment-line">#find second image</span>
      if { ( $location == &#34;switch&#34; ) &amp;&amp;     \
           ([string tolower [lindex $bList 0]] == &#34;secondary&#34;) &amp;&amp;   \
           ([string tolower [lindex $bList 1]] == &#34;software&#34;) &amp;&amp;    \
           ([string tolower [lindex $bList 2]] == &#34;version:&#34;) } {
         set secImage [lindex $bList 3]
      }
        <span class="comment-line">#for 6.2.1</span>
        if { ([string tolower [lindex $aList 0]] == &#34;secondary&#34;) &amp;&amp;   \
             ([string tolower [lindex $aList 1]] == &#34;ew&#34;) &amp;&amp;    \
             ([string tolower [lindex $aList 2]] == &#34;ver:&#34;) &amp;&amp;  \
             ($msmLocation == &#34;NULL&#34;)    } {
           set secImage [lindex [string range $line $masterOfsset $masterEnd] 0]
        }
        <span class="comment-line">#for 700b39 rtpfixes5 and on</span>
        if { ([string tolower [lindex $bList 0]] == &#34;secondary&#34;) &amp;&amp;   \
             ([string tolower [lindex $bList 1]] == &#34;ew&#34;) &amp;&amp;    \
             ([string tolower [lindex $bList 2]] == &#34;ver:&#34;) &amp;&amp;  \
             ($msmMaster == $msmLocation)    } {

           <span class="comment-line">#fix for 701b4</span>
           if {[regexp -nocase &#34;ssh&#34; [lindex $bList 4]]} {
               set secImage &#34;[lindex $bList 3]&#34;
           } else {
               set secImage &#34;[lindex $bList 3] [lindex $bList 4]&#34;
           }
        }
      <span class="comment-line">#find System Name</span>
      if { ([string tolower [lindex $bList 0]] == &#34;sysname:&#34;) } {
         set platform [<a name="::::computeSysName(2)"><a href="./swConf.tcl.html#::::computeSysName_1616">::::computeSysName</a></a> [lindex $bList 1]]
      }
      <span class="comment-line">#find system MAC</span>
      if { ([lindex $bList 0] == &#34;System&#34;) &amp;&amp;     \
           ([lindex $bList 1] == &#34;MAC:&#34;) } {
         set sysMAC [lindex $bList 2]

      }
<span class="comment-line">######################################################################################</span>
<span class="comment-line">#    Show version portion of the file </span>
<span class="comment-line">#</span>
<span class="comment-line">######## find release master, time of the build ######################################</span>
      if { ( $location == &#34;version&#34; ) &amp;&amp;     \
           ([lindex $bList 0] == &#34;Image&#34;) &amp;&amp;     \
           ([lindex $bList 2] == &#34;Extremeware&#34;) &amp;&amp;  \
           ([lindex $bList 3] == &#34;Version&#34;)} {

         <span class="comment-line">#should be able to handle 4 and 3 digit version like:</span>
         <span class="comment-line">#Image : Extremeware  Version 7.3.0.30 [non-ssh] [wlan] by </span>
         <span class="comment-line">#Build_Master on 05/17/04 17:23:30                 </span>
         <span class="comment-line">#</span>
         <span class="comment-line">#Image  :  Extremeware Version 6.2.2 (Build 156)  by </span>
         <span class="comment-line">#Release_Master 02/13/04 18:33:39 </span>
         <span class="comment-line">#</span>
         <span class="comment-line">#extract the version </span>
         regexp -nocase {Version +([^ ]+)} $bList dummy showVerVersion
         <span class="comment-line">#extract the build number if exist</span>
         if [regexp -nocase {Build +([0-9]+)} $bList dummy matchb] {
            set showVerVersion &#34;${showVerVersion}b$matchb&#34;
         }

         <span class="comment-line"># Santa Clara base, Tech Release Code, or branch build??????</span>
         <span class="comment-line"># First Case is for IPSERV code. Adjust build # and BuildMaster</span>
         if {[lindex $bList 8] == &#34;IP_SERV_TECH_REL&#34;} {
            set version2 [lindex $bList 9]
            set relMaster [lindex $bList 11]
            <span class="comment-line">### Set the build time for this Version of Code </span>
            <span class="comment-line">### (for download comparison##</span>
            set verTime \
               &#34;[lindex $bList 12] [lindex $bList 13] [lindex $bList 14]&#34;
         }


         <span class="comment-line"># Second Case is for Santa Clara built  </span>
         if {[lindex $bList 8] != &#34;IP_SERV_TECH_REL&#34;} {
             set relMaster [lindex $bList 8]
             set verTime \
                &#34;[lindex $bList 9] [lindex $bList 10] [lindex $bList 11]&#34;
         }


         <span class="comment-line">### fix for 6.2.1 build 17 (sandbox)</span>
         if {([lindex $bList 4] == &#34;6.2.1&#34;) 
            &amp;&amp; ([lindex $bList 10] == &#34;on&#34;)} {
             set verTime &#34;[lindex $bList 11] [lindex $bList 12]&#34;
             set relMaster [lindex $bList 9]
             set merge [lindex $bList 7]
             regsub -all {\.} $merge &#34;_&#34; merge
         }

         <span class="comment-line">### fix for 6.2.1 build 10 (new linux buildmaster)</span>
         if {([lindex $bList 4] == &#34;6.2.1&#34;) 
            &amp;&amp; ([lindex $bList 10] != &#34;on&#34;)} {
             set verTime &#34;[lindex $bList 10] [lindex $bList 11]&#34;
         }



         <span class="comment-line">###### fix for 7.0.0 on ncbuild1 FINAL BUILD MASTER?</span>
         <span class="comment-line">#should handle the following syntax for various builds:</span>
         <span class="comment-line">#</span>
         <span class="comment-line">#Image : Extremeware  Version 7.3.0.25 [non-ssh] [base] by </span>
         <span class="comment-line">#Build_Master on 04/01/04 14:06:55                       </span>
         <span class="comment-line">#</span>
         <span class="comment-line">#Image : Extremeware  Version 7.3.0.30 [non-ssh] [wlan] by </span>
         <span class="comment-line">#Build_Master on 05/17/04 17:23:30                 </span>
         <span class="comment-line">#</span>
         <span class="comment-line">#Image : Extremeware  Version 7.2.0 (Build 25) </span>
         <span class="comment-line">#branch.PA-720-0404-01-r1 [non-ssh] by Patch_Master on 05/06/04 </span>
         <span class="comment-line">#22:07:46       </span>
         <span class="comment-line">#</span>
         <span class="comment-line">#Image : Extremeware  Version 7.2.0 (Build 24) [non-ssh] by </span>
         <span class="comment-line">#Release_Master on 03/18/04 00:55:14            </span>
         <span class="comment-line">#</span>
         <span class="comment-line">#Image : Extremeware  Version 7.1.1 (Build 15) </span>
         <span class="comment-line">#branch.PA-711-0405-1-r1 [non-ssh] by Patch_Master on 05/05/04 </span>
         <span class="comment-line">#18:51:38   </span>
         <span class="comment-line"># </span>
         <span class="comment-line">#Image : Extremeware  Version 7.1.1 (Build 13) [non-ssh] by </span>
         <span class="comment-line">#Release_Master on 01/16/04 18:21:29 </span>
         <span class="comment-line">#</span>
         <span class="comment-line">#Image : Extremeware  Version 7.3.0.22 br-4dig_v730b22 [non-ssh] </span>
         <span class="comment-line">#[wlan] by Build_Master on 03/19/04 19:54:59</span>
         <span class="comment-line">#</span>
         if {[lindex $bList 4] &gt;= &#34;7.0.0&#34;} {
            <span class="comment-line">#extract relMaster and verTime</span>
            regexp -nocase {by +([^ ]+) +.+ +([0-9]+:[0-9]+:[0-9]+)} \
               $bList dummy relMaster verTime
            <span class="comment-line">#extract merge string</span>
            <span class="comment-line">#for 4 digit version the merge string is any non space char </span>
            <span class="comment-line">#in between version number and a open square bracket, but </span>
            <span class="comment-line">#don't match anything in bracket like &#34;[non-ssh]&#34;</span>
            <span class="comment-line">#note that in bList any square bracket is preceded by a brace </span>
            if ![regexp -nocase \
               {\.[0-9a-z]+ +([^ \[]+) +\{?\[} $bList dummy merge] {
               <span class="comment-line">#if not 4 digit version, the merge string is in between</span>
               <span class="comment-line"># &#34;)&#34; and &#34;[&#34;. if this doesn't match there is no</span>
               <span class="comment-line">#branch information to extract</span>
               regexp {\) +([^ \[]+) +\{?\[} $bList dummy merge
            }
            regsub -all {\.} $merge &#34;_&#34; merge
         }
      }

<span class="comment-line">#    End Show Version</span>
<span class="comment-line">######################################################################################</span>

      <span class="comment-line">#find BootROM</span>
      if { ([lindex $bList 0] == &#34;BootROM&#34;) } {
         set bootROM [lindex $bList 2]

      }      
      if { ([lindex $bList 0] == &#34;snmpVersion&#34;) } {
         set snmpVersion [lindex $bList 2]

      }       
      <span class="comment-line">#find total ports</span>
      if { ([lindex $bList 0] == &#34;Ports:&#34;) } {
         set numPorts [lindex $bList 1]

      } 
   }
   set bList $aList
   }  ;<span class="comment-line"># end while</span>

   <span class="comment-line"># Add the Technology Release or Merge info to the version</span>
   if {$version2 == &#34;INVALID&#34;} {
       set version &#34;$version1&#34;
   } else {
       set version &#34;$version1 $version2&#34;
   }

   <span class="comment-line">#get slot info to figure out hardware type</span>
   set hardwareType &#34;NEW_GEN&#34;
   set bladeType &#34;NONE&#34;
   if {[regexp -nocase &#34;bd|bt|godzilla|alpine*&#34; $platform]} {
      lappend parameterList &#34;{HW Module Type:} 1&#34;
      set HardwareList [<a name="::GetKeyValue(12)"><a href="./OptionCheck.tcl.html#::GetKeyValue_438">::GetKeyValue</a></a> &#34;show slot&#34; $parameterList]
      unset parameterList
      <a name="::result_debug(84)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;HardwareList: $HardwareList&#34;
      foreach hardware $HardwareList {
         if {[lsearch -regexp $bladeType $hardware]==-1} {
            if {$bladeType==&#34;NONE&#34;} {set bladeType &#34;&#34;}
            if {![regexp -nocase &#34;none|Empty&#34; $hardware]} {
               set bladeType &#34;$bladeType$hardware&#34;
            }
         }
         switch $hardware {
      	   F32T -
      	   F24T {
               	   set hardwareType &#34;OLD_GEN&#34;     		   
      		} 
         }
      }
   } else {
       if {([regexp -nocase {[0-9|s]i} $platform] == 0) &amp;&amp; 
             ([regexp -nocase summit\[2-4\]00 $platform] == 0)} {
           set hardwareType &#34;OLD_GEN&#34;
       }
   }
   <span class="comment-line">################################################################</span>
   <span class="comment-line">##  Determine number of slots in the chassis</span>
   <span class="comment-line">################################################################</span>
   switch $platFType {
       bd         {set numSlots 8}
       bt         {set numSlots 4}
       godzilla   {set numSlots 16}
       alpine3808 {set numSlots 8}
       alpine3804 {set numSlots 4}
       alpine3802 {set numSlots 2}
       default    {set numSlots 0}
   }
   puts &#34;####### version $version  ###########################&#34;
   set DUTs_info(DUT$i,imageSel) $imageSel
   set DUTs_info(DUT$i,priImage) $priImage
   set DUTs_info(DUT$i,secImage) $secImage
   set DUTs_info(DUT$i,version) $version
   set DUTs_info(DUT$i,verTime) $verTime   
   set DUTs_info(DUT$i,platform) $platform
   set DUTs_info(DUT$i,sysMAC) [string toupper $sysMAC]
   set DUTs_info(DUT$i,relMaster) $relMaster
   set DUTs_info(DUT$i,bootROM) $bootROM
   set DUTs_info(DUT$i,numSlots)     $numSlots
   set DUTs_info(DUT$i,numPorts) $numPorts
   set DUTs_info(DUT$i,HardwareType) $hardwareType
   set DUTs_info(DUT$i,bladeType) $bladeType
   set DUTs_info(DUT$i,techRel) $version2
   set DUTs_info(DUT$i,merge)   [string tolower $merge]
   set DUTs_info(DUT$i,dlReqD)   $dlReqD
   set DUTs_info(DUT$i,sVVersion) $showVerVersion
   set DUTs_info(DUT$i,snmpVersion) $snmpVersion
 <span class="comment-line">#  global SNMPv3</span>
 <span class="comment-line">#  global SNMPv2</span>

<span class="comment-line">#   #Determine the SNMP version depending upon the version</span>
<span class="comment-line">#   if { [CompareVersion_eware &#34;6.2.2.&#34; DUT$i] &lt;= 0 } {</span>
<span class="comment-line">#      set DUTs_info(DUT$i,snmpVersion) $SNMPv3</span>
<span class="comment-line">#   } else {</span>
<span class="comment-line">#      set DUTs_info(DUT$i,snmpVersion) $SNMPv2</span>
<span class="comment-line">#   }</span>

   if { $version2 != &#34;INVALID&#34; } {
       set buildList [split $version2 &#34;.&#34;]
       set bNum [lindex $buildList 0]
       set branch &#34;$version1 ipserv[string trimleft $bNum &#34;v&#34;]&#34;
   }  else {
       set branch &#34;$version1&#34;
   }

   global _VERSION
   global VERSION
   set _VERSION $version
   set VERSION [string range $_VERSION 0 0]
   set DUTs_info(DUT$i,VERSION) $VERSION

   <a name="::result_debug(85)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;****** DUT$i Info ********&#34;
   <a name="::result_debug(86)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Image Selected = $DUTs_info(DUT$i,imageSel)&#34;
   <a name="::result_debug(87)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Image Version = $DUTs_info(DUT$i,version)&#34;
   <a name="::result_debug(88)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Running Image Built on $DUTs_info(DUT$i,verTime)&#34;   
   <a name="::result_debug(89)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Primary Image = $DUTs_info(DUT$i,priImage)&#34;
   <a name="::result_debug(90)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Secondary Image = $DUTs_info(DUT$i,secImage)&#34;
   <a name="::result_debug(91)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Platform = $DUTs_info(DUT$i,platform)&#34;
   <a name="::result_debug(92)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;System MAC = $DUTs_info(DUT$i,sysMAC)&#34;
   <a name="::result_debug(93)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;BootROM = $DUTs_info(DUT$i,bootROM)&#34;
   <a name="::result_debug(94)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Release Master = $DUTs_info(DUT$i,relMaster)&#34;
   <a name="::result_debug(95)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Total Ports = $DUTs_info(DUT$i,numPorts)&#34;
   <a name="::result_debug(96)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Number of Slots = $DUTs_info(DUT$i,numSlots)&#34;   
   <a name="::result_debug(97)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Hardware Type = $DUTs_info(DUT$i,HardwareType)&#34;
   <a name="::result_debug(98)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Blade Type = $DUTs_info(DUT$i,bladeType)&#34;
   <a name="::result_debug(99)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Tech Release version = $DUTs_info(DUT$i,techRel)&#34;
   <a name="::result_debug(100)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Merge Release version = $DUTs_info(DUT$i,merge)&#34;
   <a name="::result_debug(101)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Download Flag Init    = $DUTs_info(DUT$i,dlReqD)&#34;
   <a name="::result_debug(102)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Version from Show Version = $DUTs_info(DUT$i,sVVersion)&#34;
 <span class="comment-line">#  result_debug &#34;SNMP version = $DUTs_info(DUT$i,snmpVersion)&#34;</span>
   close $fd_in

   if {[info exist MAIN(ifPipe)] &amp;&amp; ($MAIN(ifPipe) != &#34;NULL&#34;)} {
       puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,imageSel) \&#34;$DUTs_info(DUT$i,imageSel)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,version) \&#34;$DUTs_info(DUT$i,version)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,VERSION) \&#34;$DUTs_info(DUT$i,VERSION)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,priImage) \&#34;$DUTs_info(DUT$i,priImage)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,secImage) \&#34;$DUTs_info(DUT$i,secImage)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,platform) \&#34;$DUTs_info(DUT$i,platform)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,sysMAC) \&#34;$DUTs_info(DUT$i,sysMAC)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,bootROM) \&#34;$DUTs_info(DUT$i,bootROM)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,relMaster) \&#34;$DUTs_info(DUT$i,relMaster)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,numPorts) \&#34;$DUTs_info(DUT$i,numPorts)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,numSlots) \&#34;$DUTs_info(DUT$i,numSlots)\&#34;&#34;       
       puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,HardwareType) \&#34;$DUTs_info(DUT$i,HardwareType)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,bladeType) \&#34;$DUTs_info(DUT$i,bladeType)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,techRel) \&#34;$DUTs_info(DUT$i,techRel)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,merge) \&#34;$DUTs_info(DUT$i,merge)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,dlReqD) \&#34;$DUTs_info(DUT$i,dlReqD)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,sysName) \&#34;$DUTs_info(DUT$i,sysName)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,sVVersion) \&#34;$DUTs_info(DUT$i,sVVersion)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,snmpVersion) \&#34;$DUTs_info(DUT$i,snmpVersion)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,debugFlag) \&#34;$DUTs_info(DUT$i,debugFlag)\&#34;&#34;
       puts $MAIN(ifPipe) &#34;set branch \&#34;$branch\&#34;&#34;
   }
<span class="comment-line">#}</span>
<span class="comment-line">#}</span>

<a name="::close_result_file(3)"><a href="./result.tcl.html#::close_result_file_363">::close_result_file</a></a>  
<span class="comment-line"># Now get the info from the individual slots if platform matches</span>
<span class="comment-line">#     if {$slotDump} {</span>
<span class="comment-line">#         get_DUTs_Slot_info $tmpdir</span>
<span class="comment-line">#     }</span>
<span class="comment-line">#     if {![info exists DUT(LoadImage)]} { ;# Need to turn of when run LoadImage</span>
<span class="comment-line">#         getTECardSpeed</span>
<span class="comment-line">#     }</span>

<span class="comment-line">#     for {set i 1} {$i &lt;= $numDUT} {incr i 1} {</span>
<span class="comment-line">#	 file delete &#34;$tmpdir/tmp_info_DUT$i-[pid]&#34;</span>
<span class="comment-line">#     }</span>
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: _get_HW_DUTs_info</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: Stores a Single Switch information to</span>
<span class="comment-line">#              the DUTs_info array</span>
<span class="comment-line">#</span>
<span class="comment-line">#    NOTE: use /tmp for all temporary files b/c NAS would</span>
<span class="comment-line">#          slow the performance if we use relative dirs.          </span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: none</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#</span>
<span class="comment-line">#   for single DUT</span>
<span class="comment-line">#      _get_HW_DUTs_info -dut $dut</span>
<span class="comment-line">#              </span>
<span class="comment-line">#   More common from multiTask</span>
<span class="comment-line">#</span>
<span class="comment-line">#    set getInfoList &#34;&#34;</span>
<span class="comment-line">#    set numDUT 1</span>
<span class="comment-line">#    while { [info exists DUT${numDUT}_CONNECT] } {</span>
<span class="comment-line">#        puts &#34;***** DUT${numDUT}_CONNECT=$connect ***** &#34;</span>
<span class="comment-line">#        puts &#34;***** numDUT=$numDUT ***** &#34;</span>
<span class="comment-line">#        lappend getInfoList &#34;_get_HW_DUTs_info -dut $numDUT&#34;</span>
<span class="comment-line">#        incr numDUT 1</span>
<span class="comment-line">#    }</span>
<span class="comment-line">#    incr numDUT -1</span>
<span class="comment-line">#    MultiTask $getInfoList</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::_get_HW_DUTs_info_3079">proc <a href="swConf.tcl-annot.html#::::_get_HW_DUTs_info">::::_get_HW_DUTs_info</a></a></strong><a name="::::_get_HW_DUTs_info"></a> {args} {
    global spawn_id fd_res
    global DUT MAIN
    global exos
    global in
    global DUTs_info
    global DUTs_Slot_info
    global chassis
    global harness
    global eware_dut
    global CFG_PLATFORM

    <a name="::parse_args(6)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> _get_HW_DUTs_info $args {
        dut   &#34;1&#34;
        checkOperational &#34;0&#34;
    }

    <span class="comment-line"># --- Turn off printing SendACmd output to stdout</span>
    <a name="::_setShowOutput(3)"><a href="./SendSwCmd.tcl.html#::_setShowOutput_3101">::_setShowOutput</a></a> -screen off -log off -res_fmt on

    <span class="comment-line"># --------------------------------------------------------------</span>
    <span class="comment-line">#  If Multitask calls this we need to save variables to a tmp</span>
    <span class="comment-line">#     file b/c the caller is in a different scope</span>
    <span class="comment-line">#</span>
    <span class="comment-line">#    passUp is only turned on when multiTask calls this proc</span>
    <span class="comment-line">#</span>
    <span class="comment-line"># --------------------------------------------------------------    </span>
    set passUp 0
    if {[info exists MAIN(MULTITASKON)] &amp;&amp; $MAIN(MULTITASKON)} {
        set passUp 1
        set fd_g [open &#34;/tmp/[pid]_setvars&#34; &#34;w&#34;]
    }

    set pid [pid]
    set DUTs_info(DUT$dut,show_output) &#34;empty&#34;

    <span class="comment-line"># This is a TMP file to support SendACmd fd_res. We don't care</span>
    <span class="comment-line">#   about the data</span>
    if ![info exists fd_res] {
        set fd_res [open &#34;/tmp/HwInfo_DUT${dut}_$pid&#34; &#34;w&#34;]
    } else {
        flush $fd_res
    }
    set slotDump 0

    if {[info exists eware_dut] &amp;&amp; $eware_dut != &#34;&#34;} {
        <a name="::result_debug(103)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;_get_HW_DUTs_info does not support ExtremeWare&#34;
        return 0
    }

    global DUT[set dut]_CONNECT
    global DUT[set dut]_CONNECTB
    global DUT[set dut]_CONNECTC
    global DUT[set dut]_CONNECTD
    global DUT[set dut]_CONNECTE
    global DUT[set dut]_CONNECTF
    global DUT[set dut]_CONNECTG
    global DUT[set dut]_CONNECTH

    <a name="::Login(22)"><a href="./login.tcl.html#::Login_24">::Login</a></a> &#34;[set DUT[set dut]_CONNECT]&#34; -CheckOperational 0
    
    set DUTs_info(DUT$dut,sysType) [<a name="::GetSystemType(1)"><a href="./misc.tcl.html#::GetSystemType_513">::GetSystemType</a></a> $dut]
    if {[info exists CFG_PLATFORM($dut)] &amp;&amp; $CFG_PLATFORM($dut) != &#34;null&#34;} {
        set DUTs_info(DUT$dut,platform) $CFG_PLATFORM($dut)
    } else {
        set DUTs_info(DUT$dut,platform) $DUTs_info(DUT$dut,sysType)
    }
    if {$passUp} {
        puts $fd_g &#34;set DUTs_info(DUT$dut,sysType) [<a name="::GetSystemType(2)"><a href="./misc.tcl.html#::GetSystemType_513">::GetSystemType</a></a> $dut]&#34;
        puts $fd_g &#34;set DUTs_info(DUT$dut,platform) $DUTs_info(DUT$dut,sysType)&#34;
    }

    if {$checkOperational} {
        <a name="::result_debug(104)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Login with - CheckOperational&#34;
        <a name="::Login(23)"><a href="./login.tcl.html#::Login_24">::Login</a></a> [set DUT[set dut]_CONNECT]

        if {[regexp -nocase &#34;stack&#34; [<a name="::GetSystemType(3)"><a href="./misc.tcl.html#::GetSystemType_513">::GetSystemType</a></a> $dut]] } {
            set showSwitchOutput &#34;&#34;
            lappend showSwitchOutput &#34;{Current.*State} {MASTER.*BACKUP.*In.*Sync} inLine exists&#34;
            <a name="::CheckKeyValue(5)"><a href="./OptionCheck.tcl.html#::CheckKeyValue_47">::CheckKeyValue</a></a> &#34;show switch&#34; $showSwitchOutput -testNo none \
                                         -time {s: 5 i: 30 d: 120 f: 240 r}
        }
    }
    <span class="comment-line">################################################################</span>
    <span class="comment-line">##  Get switch info dump</span>
    <span class="comment-line">#     - open capture file</span>
    <span class="comment-line">#     - get outputs</span>
    <span class="comment-line">#     - pull output for parsing</span>
    <span class="comment-line">#     - delete tmp capture files</span>
    <span class="comment-line">################################################################</span>
    <span class="comment-line"># -- open files to hold the temp data</span>
    set fd_in [open &#34;/tmp/tmp_hwinfo_DUT${dut}$pid&#34; &#34;w&#34;]

    <a name="::SendACmd(18)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable clipaging&#34;
    <a name="::SendACmd(19)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;show switch&#34; $fd_res $fd_in
    <a name="::SendACmd(20)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;show version&#34; $fd_res $fd_in
    <a name="::SendACmd(21)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;show license&#34; $fd_res $fd_in
    if {[regexp -nocase &#34;$chassis&#34; $DUTs_info(DUT$dut,platform)] || \
        [regexp -nocase &#34;stack&#34; $DUTs_info(DUT$dut,platform)] || \
        [regexp -nocase &#34;vpex&#34; $DUTs_info(DUT$dut,platform)]} {
        <a name="::SendACmd(22)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;show slot&#34; $fd_res $fd_in
    }
    close $fd_in;<span class="comment-line"># Close file that hold data we are parsing</span>
    <a name="::close_result_file(4)"><a href="./result.tcl.html#::close_result_file_363">::close_result_file</a></a>;<span class="comment-line"># Close gen harness file for fd_res / SendACmd</span>

    <span class="comment-line"># -- Read in data for parsing</span>
    set fp [open &#34;/tmp/tmp_hwinfo_DUT${dut}$pid&#34; r]
    set show_data [read $fp]
    close $fp
    <span class="comment-line"># -- Delete the supporting files</span>
    catch {file delete -force /tmp/tmp_hwinfo_DUT${dut}$pid} oops;<span class="comment-line"># fd_in</span>
    if {[file exists /tmp/HwInfo_DUT${dut}_$pid]} {
        catch {file delete -force /tmp/HwInfo_DUT${dut}_$pid} oops;<span class="comment-line"># fd_res</span>
    }
    <span class="comment-line">#</span>
    <span class="comment-line"># End Gathering data section</span>
    <span class="comment-line">#</span>

    <span class="comment-line"># --------- Save switch output for printing later -----------</span>
    set DUTs_info(DUT$dut,show_output) &#34;$show_data&#34;
    if {$passUp} {
        set fd_so [open &#34;/tmp/${pid}_showout&#34; &#34;w&#34;]
        puts $fd_so &#34;set DUTs_info(DUT$dut,show_output) \{$show_data\}&#34;
        close $fd_so
    }
    <span class="comment-line"># ------- A boat load of regexp to grab switch info ---------</span>

    <span class="comment-line"># Information from show switch</span>
    <span class="comment-line"># SysName:</span>
    if {![regexp -nocase {SysName\: *([a-zA-Z0-9\-]+)} \
               $show_data ignore val]} {
        puts &#34;SysName not set&#34;
    } else {
        set DUTs_info(DUT$dut,sysName) $val
        if {$passUp} {
            puts $fd_g &#34;set DUTs_info(DUT$dut,sysName) $val&#34;
        }
    }
    <span class="comment-line"># System MAC:</span>
    if {![regexp -nocase {System MAC\: *([a-fA-F0-9\:]{17,17})} \
               $show_data ignore val]} {
        puts &#34;System MAC not set&#34;
    } else {
        set DUTs_info(DUT$dut,sysMAC) [string toupper $val]
        if {$passUp} {
            puts $fd_g &#34;set DUTs_info(DUT$dut,sysMAC) [string toupper $val]&#34;
        }
    }
    <span class="comment-line"># System Type:</span>
    if {![regexp -nocase {System Type\: *([a-zA-Z0-9\-]+).*} \
               $show_data mline val]} {
        puts &#34;System Type not set&#34;
    } else {
        if {[info exists CFG_PLATFORM($dut)] &amp;&amp; $CFG_PLATFORM($dut) != &#34;null&#34;} {
            set DUTs_info(DUT$dut,platform) $CFG_PLATFORM($dut)
            set DUTs_info(DUT$dut,sysType) $val
            if {$passUp} {
                puts $fd_g &#34;set DUTs_info(DUT$dut,platform) $CFG_PLATFORM($dut)&#34;
                puts $fd_g &#34;set DUTs_info(DUT$dut,sysType) $val&#34;
            }
        } elseif {[regexp -nocase &#34;stack&#34; $mline]} {
            set DUTs_info(DUT$dut,platform) &#34;Stack&#34;
            set DUTs_info(DUT$dut,sysType) &#34;Stack&#34;
            if {$passUp} {
                puts $fd_g &#34;set DUTs_info(DUT$dut,platform) \&#34;Stack\&#34;&#34;
                puts $fd_g &#34;set DUTs_info(DUT$dut,sysType) \&#34;Stack\&#34;&#34;
            }
        } else {
            set DUTs_info(DUT$dut,platform) $val
            set DUTs_info(DUT$dut,sysType) $val
            if {$passUp} {
                puts $fd_g &#34;set DUTs_info(DUT$dut,platform) $val&#34;
                puts $fd_g &#34;set DUTs_info(DUT$dut,sysType) $val&#34;
            }
        }
    }
    <span class="comment-line"># Current State:</span>
    set master &#34;INVALID&#34;; set backup &#34;INVALID&#34;; set stat &#34;INVALID&#34;;
    if ![regexp -nocase \
          {Current State\:[ ]+([a-zA-Z\-]+)[ ]+([a-zA-Z\-]+)?[ ]+(\([a-zA-Z]+\)?|\([a-zA-Z]+ [a-zA-Z]+\))?} \
          $show_data csLine master backup stat] {
        puts &#34;Switch State not set&#34;
    } else {
        set DUTs_info(DUT$dut,currState) $master
        if {$passUp} {
            puts $fd_g &#34;set DUTs_info(DUT$dut,currState) $master&#34;
        }
    }
    <span class="comment-line"># Image Selected:</span>
    set master1 &#34;INVALID&#34;; set backup1 &#34;INVALID&#34;;
    if ![regexp -nocase {Image Selected\:[ ]+([a-zA-Z]+)[ ]+([a-zA-Z]+)?} $show_data iselectLine  master1 backup1] {
        puts &#34;Image selected could not be determined&#34;
    } else {
        set DUTs_info(DUT$dut,imageSel) $master1
        set DUTs_info(DUT$dut,imageSelA) $master1
        set DUTs_info(DUT$dut,imageSelB) $backup1
        if {$passUp} {
            puts $fd_g &#34;set DUTs_info(DUT$dut,imageSel) $master1&#34;
            puts $fd_g &#34;set DUTs_info(DUT$dut,imageSelA) $master1&#34;
            puts $fd_g &#34;set DUTs_info(DUT$dut,imageSelB) $backup1&#34;
        }
    }
    <span class="comment-line"># Image Booted:</span>
    set master2 &#34;INVALID&#34;; set backup2 &#34;INVALID&#34;;
    if {![regexp -nocase {Image Booted\:[ ]+([a-zA-Z]+)[ ]+([a-zA-Z]+)?} \
               $show_data ibootLine  master2 backup2]} {
        puts &#34;Image Booted not set&#34;
    } else {
        set DUTs_info(DUT$dut,imageBooted) $master2
        set DUTs_info(DUT$dut,imageBootedA) $master2
        set DUTs_info(DUT$dut,imageBootedB) $backup2
        if {$passUp} {
            puts $fd_g &#34;set DUTs_info(DUT$dut,imageBooted) $master2&#34;
            puts $fd_g &#34;set DUTs_info(DUT$dut,imageBootedA) $master2&#34;
            puts $fd_g &#34;set DUTs_info(DUT$dut,imageBootedB) $backup2&#34;
        }
    }
    <span class="comment-line"># Primary Ver:</span>
    set mBuild &#34;INVALID&#34;; set bBuild &#34;INVALID&#34;;
    if {![regexp -nocase {Primary ver:[ ]+([0-9]{2,2}\.[0-9]{1,2}\.[0-9]{1,2}\.[0-9]{1,2})\
                         [ ]+([0-9]{2,2}\.[0-9]{1,2}\.[0-9]{1,2}\.[0-9]{1,2})?} \
               $show_data priILine  mBuild bBuild]} {
        puts &#34;Primary Image not set&#34;
    } else {
        set DUTs_info(DUT$dut,priImage) $mBuild
        set DUTs_info(DUT$dut,priImageA) $mBuild
        set DUTs_info(DUT$dut,priImageB) $bBuild
        if {$passUp} {
            puts $fd_g &#34;set DUTs_info(DUT$dut,priImage) $mBuild&#34;
            puts $fd_g &#34;set DUTs_info(DUT$dut,priImageA) $mBuild&#34;
            puts $fd_g &#34;set DUTs_info(DUT$dut,priImageB) $bBuild&#34;
        }
    }
    <span class="comment-line"># Secondary Ver:</span>
    set mBuild &#34;INVALID&#34;; set bBuild &#34;INVALID&#34;;
    if {![regexp -nocase {Secondary ver:[ ]+([0-9]{2,2}\.[0-9]{1,2}\.[0-9]{1,2}\.[0-9]{1,2})\
                         [ ]+([0-9]{2,2}\.[0-9]{1,2}\.[0-9]{1,2}\.[0-9]{1,2})?} \
               $show_data secILine mBuild bBuild]} {
        puts &#34;Secondary Image not set&#34;
    } else {
        set DUTs_info(DUT$dut,secImage) $mBuild
        set DUTs_info(DUT$dut,secImageA) $mBuild
        set DUTs_info(DUT$dut,secImageB) $bBuild
        if {$passUp} {
            puts $fd_g &#34;set DUTs_info(DUT$dut,secImage) $mBuild&#34;
            puts $fd_g &#34;set DUTs_info(DUT$dut,secImageA) $mBuild&#34;
            puts $fd_g &#34;set DUTs_info(DUT$dut,secImageB) $bBuild&#34;
        }
    }
    <span class="comment-line"># ------------------ Logic to set the version based on booted --------------------</span>
    <span class="comment-line"># Check for mismatch</span>
    set AOk 0
    set BOk 0
    if {[string trim $DUTs_info(DUT$dut,priImageA)] != &#34;&#34; &amp;&amp; \
        [string trim $DUTs_info(DUT$dut,priImageA)] != &#34;INVALID&#34;} {
        set AOk 1
    }
    if {[string trim $DUTs_info(DUT$dut,priImageB)] != &#34;&#34; &amp;&amp; \
        [string trim $DUTs_info(DUT$dut,priImageB)] != &#34;INVALID&#34;} {
        set BOk 1
    }
    if {$AOk &amp;&amp; $BOk} {
        if {$DUTs_info(DUT$dut,priImageA) != $DUTs_info(DUT$dut,priImageB)} {
            set MAIN(MISMATCH_pri) 1
        } else {
            set MAIN(MISMATCH_pri) 0
        }
        if {$DUTs_info(DUT$dut,secImageA) != $DUTs_info(DUT$dut,secImageB)} {
            set MAIN(MISMATCH_sec) 1
        } else {
            set MAIN(MISMATCH_sec) 0
        }
    } else {
        <span class="comment-line"># -- standalone</span>
        set MAIN(MISMATCH_pri) 0; set MAIN(MISMATCH_sec) 0
    }
    if {[regexp -nocase &#34;pri&#34; $DUTs_info(DUT$dut,imageBooted)]} {
        set DUTs_info(DUT$dut,version) $DUTs_info(DUT$dut,priImage);
    } else {
        set DUTs_info(DUT$dut,version) $DUTs_info(DUT$dut,secImage);
    }
    if {$passUp} {
        puts $fd_g &#34;set MAIN(MISMATCH_pri) $MAIN(MISMATCH_pri)&#34;
        puts $fd_g &#34;set MAIN(MISMATCH_sec) $MAIN(MISMATCH_sec)&#34;
        puts $fd_g &#34;set DUTs_info(DUT$dut,version) $DUTs_info(DUT$dut,version)&#34;
    }
    <span class="comment-line"># get serial for chassis and switch</span>
    set ischassis 0
    set prodnum &#34;INVALID&#34;; set ser &#34;INVALID&#34;;
    if {![regexp -nocase {Chassis[ ]+:[ ]+([0-9]+\-[0-9]+\-[0-9]+)[ ]+([0-9A-Z]{5,5}\-[0-9A-Z]{5,5})} \
               $show_data swChSerLine prodnum ser]} {
    } else {
        set ischassis 1
        set DUTs_info(DUT$dut,serial) $ser
        set DUTs_info(DUT$dut,productNum) $prodnum
        if {$passUp} {
            puts $fd_g &#34;set DUTs_info(DUT$dut,serial) $ser&#34;
            puts $fd_g &#34;set DUTs_info(DUT$dut,productNum) $prodnum&#34;
        }
    }
    set isVM 0
    set prodnum &#34;INVALID&#34;; set ser &#34;INVALID&#34;;
    if {![regexp -nocase {Switch[ ]+:[ ]+(PN\:[a-z0-9]{6,6})[ ]+(SN\:[0-9]{6,6})[ ]+Rev} \
               $show_data swChSerLine prodnum ser]} {
    } else {
        set isVM 1
        set DUTs_info(DUT$dut,serial) $ser
        set DUTs_info(DUT$dut,productNum) $prodnum
        if {$passUp} {
            puts $fd_g &#34;set DUTs_info(DUT$dut,serial) $ser&#34;
            puts $fd_g &#34;set DUTs_info(DUT$dut,productNum) $prodnum&#34;
        }
    }
    if {!$isVM &amp;&amp; !$ischassis &amp;&amp; [set DUTs_info(DUT$dut,platform)] != &#34;Stack&#34;} {
        set prodnum &#34;INVALID&#34;; set ser &#34;INVALID&#34;;
        if {![regexp -nocase {Switch[ ]+:[ ]+([0-9]+\-[0-9]+\-[0-9]+)[ ]+([0-9A-Z]{5,5}\-[0-9A-Z]{5,5})} \
                   $show_data swChSerLine prodnum ser]} {
            puts &#34;Standalone Switch serial number not hit&#34;
            if {$passUp} {
                puts $fd_g &#34;set DUTs_info(DUT$dut,serial) \&#34;INVALID\&#34;&#34;
                puts $fd_g &#34;set DUTs_info(DUT$dut,productNum) \&#34;INVALID\&#34;&#34;
            }
        } else {
            set DUTs_info(DUT$dut,serial) $ser
            set DUTs_info(DUT$dut,productNum) $prodnum
            if {$passUp} {
                puts $fd_g &#34;set DUTs_info(DUT$dut,serial) $ser&#34;
                puts $fd_g &#34;set DUTs_info(DUT$dut,productNum) $prodnum&#34;
            }
        }
    }
    if {[regexp -nocase &#34;stack&#34; $DUTs_info(DUT$dut,platform)] || $ischassis || \
        [regexp -nocase &#34;vpex&#34; $DUTs_info(DUT$dut,platform)]} {
        <span class="comment-line"># get slots serial for stack</span>
        <span class="comment-line">#</span>
        <span class="comment-line"># vpex slots start at 33</span>
        if {[regexp -nocase &#34;vpex&#34; $DUTs_info(DUT$dut,platform)]} {
            set slotVals 1
            for {set sv 33} {$sv &lt;= 64 } {incr sv} {
                lappend slotVals $sv
            }
        } else {
            set slotVals {1 2 3 4 5 6 7 8 A B}
        }
        set nslot 0
        foreach i $slotVals {
            set prodnum &#34;INVALID&#34;; set ser &#34;INVALID&#34;; set sl &#34;INVALID&#34;
            if {![regexp -nocase &#34;(Slot\-${i}|MSM\-${i}|MM\-${i})\[ ]+:\[ ]+(\[0-9]+\-\[0-9]+\-\[0-9]+)\[ ]+(\[0-9A-Z]{5,5}\-\[0-9A-Z]{5,5})&#34; \
                       $show_data swChSerLine sl prodnum ser]} {
                if {$passUp} {
                    puts $fd_g &#34;set DUTs_Slot_info(DUT$dut,slot$i,serial) \&#34;INVALID\&#34;&#34;
                    puts $fd_g &#34;set DUTs_Slot_info(DUT$dut,slot$i,productNum) \&#34;INVALID\&#34;&#34;
                }
            } else {
                if {[regexp -nocase &#34;slot&#34; $sl]} {incr nslot}
                set DUTs_Slot_info(DUT$dut,slot$i,serial) $ser
                set DUTs_Slot_info(DUT$dut,slot$i,productNum) $prodnum
                if {$passUp} {
                    puts $fd_g &#34;set DUTs_Slot_info(DUT$dut,slot$i,serial) $ser&#34;
                    puts $fd_g &#34;set DUTs_Slot_info(DUT$dut,slot$i,productNum) $prodnum&#34;
                }
            }
            set tp &#34;INVALID&#34;; set cf &#34;INVALID&#34;; set stt &#34;INVALID&#34;; set pts &#34;INVALID&#34;;
            if {![regexp -nocase &#34;(Slot\-${i})\[ ]+(\[a-z0-9]+\-\[a-z0-9\(\)]+)\[ ]+(\[a-z0-9]+\-\[a-z0-9\(\)]+)?\[ ]+(\[ a-z]+)\[ ]+(\[0-9]+)&#34; \
                       $show_data sltLine slt tp cf stt pts]} {
            } else {
                set DUTs_Slot_info(DUT$dut,slot$i,sysType) $tp
                set DUTs_Slot_info(DUT$dut,slot$i,hwModType) $tp
                set DUTs_Slot_info(DUT$dut,slot$i,state) $stt
                set DUTs_Slot_info(DUT$dut,slot$i,confType) $cf
                set DUTs_Slot_info(DUT$dut,slot$i,numPorts) &#34;$pts&#34;
                if {$passUp} {
                    puts $fd_g &#34;set DUTs_Slot_info(DUT$dut,slot$i,sysType) $tp&#34;
                    puts $fd_g &#34;set DUTs_Slot_info(DUT$dut,slot$i,hwModType) $tp&#34;
                    puts $fd_g &#34;set DUTs_Slot_info(DUT$dut,slot$i,state) $stt&#34;
                    puts $fd_g &#34;set DUTs_Slot_info(DUT$dut,slot$i,confType) $cf&#34;
                    puts $fd_g &#34;set DUTs_Slot_info(DUT$dut,slot$i,numPorts) $DUTs_Slot_info(DUT$dut,slot$i,numPorts)&#34;
                }
            }
        }
        set DUTs_info(DUT$dut,numSlots) $nslot
        if {$passUp} {
            puts $fd_g &#34;set DUTs_info(DUT$dut,numSlots) $nslot&#34;
        }
    }
    <span class="comment-line"># Get version showVerVersion version builder date</span>
    set os &#34;INVALID&#34;; set bld &#34;INVALID&#34;; set svv &#34;INVALID&#34;; set builder &#34;INVALID&#34;; set bdate &#34;INVALID&#34;;
    if {![regexp -nocase {Image[ ]+:[ ]+(ExtremeXOS|NETGEAR|AviatOS)[ ]+version([ ]+[0-9]{2,2}\.[0-9]\.[0-9]\.[0-9]{1,2})[ ]+([a-zA-Z0-9_\-\.]+)?[by ]+([]a-zA-Z\-]+).*on[ ]+([a-zA-Z0-9\ :]+).*BootROM|Diagnostics} \
              $show_data versLine os bld svv builder bdate]} {
        puts &#34;Show version info not foud&#34;
        set DUTs_info(DUT$dut,version) &#34;INVALID&#34;
        set DUTs_info(DUT$dut,verTime) &#34;INVALID&#34;
        set DUTs_info(DUT$dut,relMaster) &#34;INVALID&#34;
        set DUTs_info(DUT$dut,sVVersion) &#34;INVALID&#34;
        if {$passUp} {
            puts $fd_g &#34;set DUTs_info(DUT$dut,version) \&#34;INVALID\&#34;&#34;
            puts $fd_g &#34;set DUTs_info(DUT$dut,verTime) \&#34;INVALID\&#34;&#34;
            puts $fd_g &#34;set DUTs_info(DUT$dut,relMaster) \&#34;INVALID\&#34;&#34;
            puts $fd_g &#34;set DUTs_info(DUT$dut,sVVersion) \&#34;INVALID\&#34;&#34;
        }
    } else {
        set svvList [split $svv &#34;.&#34;]
        if {[llength $svvList] == 2 &amp;&amp; ![regexp -nocase {[a-z]} $svv]} {
            set svv [string trim $bld]
        }
        if {[llength $svvList] == 1 &amp;&amp; [string trim $svv] == &#34;by&#34;} {
            set svv [string trim $bld]
        }
        set DUTs_info(DUT$dut,version) &#34;$bld&#34;
        set DUTs_info(DUT$dut,verTime) &#34;$bdate&#34;
        set DUTs_info(DUT$dut,relMaster) &#34;$builder&#34;
        set DUTs_info(DUT$dut,sVVersion) &#34;$svv&#34;
        if {$passUp} {
            puts $fd_g &#34;set DUTs_info(DUT$dut,verTime) \&#34;$bdate\&#34;&#34;
            puts $fd_g &#34;set DUTs_info(DUT$dut,verTime) \&#34;$bdate\&#34;&#34;
            puts $fd_g &#34;set DUTs_info(DUT$dut,relMaster) \&#34;$builder\&#34;&#34;
            puts $fd_g &#34;set DUTs_info(DUT$dut,sVVersion) \&#34;$svv\&#34;&#34;
        }
    }
    <span class="comment-line"># Bootrom</span>
    set br &#34;INVALID&#34;;
    if {![regexp -nocase {[ ]+on.*BootROM[ ]+:[ ]+([0-9]{1,2}\.[0-9]\.[0-9]\.[0-9]{1,2}|[0-9]{1,2}\.[0-9])} \
               $show_data bpLine br]} {
        puts &#34;bootrom not found&#34;
        set DUTs_info(DUT$dut,bootROM) &#34;INVALID&#34;
        if {$passUp} {
            puts $fd_g &#34;set DUTs_info(DUT$dut,bootROM) \&#34;INVALID\&#34;&#34;
        }
    } else {
        set DUTs_info(DUT$dut,bootROM) $br
        if {$passUp} {
            puts $fd_g &#34;set DUTs_info(DUT$dut,bootROM) $br&#34;
        }
    }
    <span class="comment-line"># License info</span>
    set lic &#34;INVALID&#34;
    set fpack &#34;INVALID&#34;
    if {![regexp -nocase {Enabled License Level:.*\n[ ]+([ a-zA-Z]+).*Packs:.*\n[ ]+([ a-zA-Z0-9]+)} \
               $show_data bpLine lic fpack]} {
    } else {
        set DUTs_info(DUT$dut,license) [string trim $lic]
        set DUTs_info(DUT$dut,feature_licenses) &#34;\&#34;[string trim $fpack]\&#34;&#34;
        if {$passUp} {
            puts $fd_g &#34;set DUTs_info(DUT$dut,license) [string trim $lic]&#34;
            puts $fd_g &#34;set DUTs_info(DUT$dut,feature_licenses) $DUTs_info(DUT$dut,feature_licenses)&#34;
        }
    }

    <span class="comment-line">#</span>
    <span class="comment-line"># Show slot stuff</span>
    <span class="comment-line">#</span>


    if {$passUp} {
        close $fd_g
    }
    <a name="::logout(6)"><a href="./logout.tcl.html#::logout_21">::logout</a></a>;<span class="comment-line"># For some reason to be discovered later, the spawnid tracking is not working</span>
    <a name="::_setShowOutput(4)"><a href="./SendSwCmd.tcl.html#::_setShowOutput_3101">::_setShowOutput</a></a> -screen on -log on -res_fmt on
}
<span class="comment-line"># -------------------------------------------------------------------------------------</span>
<span class="comment-line"># proc _printDutsInfoVars</span>
<span class="comment-line">#</span>
<span class="comment-line">#   Dump the values set for DUTs_info for all DUTs</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#  _printDutsInfoVars</span>
<span class="comment-line"># -------------------------------------------------------------------------------------  </span>
<strong><a name="::::_printDutsInfoVars_3547">proc <a href="swConf.tcl-annot.html#::::_printDutsInfoVars">::::_printDutsInfoVars</a></a></strong><a name="::::_printDutsInfoVars"></a> {{type normal}} {
    global DUTs_info IKEYS MAIN IKEYTEXT

    if ![array exists DUTs_info] {
        <a name="::result_debug(105)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUTs_info has not be set&#34;
        return;
    }
    if {$type==&#34;info&#34;} {
        for {set i 1} {$i&lt;=$MAIN(NODECOUNT)} {incr i} {
            foreach infoKey $IKEYS {
                if [info exists DUTs_info(DUT$i,$infoKey)] {
                    puts &#34;[format &#34;%-45s = %-45s&#34; &#34;DUTs_info(DUT$i,$infoKey)&#34; &#34;$DUTs_info(DUT$i,$infoKey)&#34;]&#34;
                }
            }
        }
    } elseif {$type==&#34;normal&#34;} {
        for {set i 1} {$i&lt;=$MAIN(NODECOUNT)} {incr i} {
            puts &#34;\n&#34;
            <a name="::result_debug(106)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;****** START DEVICE INFORMATION DUT$i ********&#34;
            foreach infoKey $IKEYS {
                if [info exists DUTs_info(DUT$i,$infoKey)] {
                    <a name="::result_debug(107)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUT$i $IKEYTEXT($infoKey) = $DUTs_info(DUT$i,$infoKey)&#34;
                }
            }
        }
    } else {
        <span class="comment-line">#    set rList [list &#34;mod_current_test&#34; &#34;$cTest&#34; &#34;mod_name&#34; &#34;$modName&#34; &#34;queue_id&#34; &#34;$qId&#34; \</span>
        <span class="comment-line">#         &#34;mod_results&#34; &#34;complete&#34;]</span>
        <span class="comment-line">#    handleOutput $s &#34;[listToJson -mlist $rList -elem &#34;TCLResult&#34;]&#34;</span>
        for {set i 1} {$i&lt;=$MAIN(NODECOUNT)} {incr i} {
            set jout($i) &#34;&#34;
            foreach infoKey $IKEYS {
                if [info exists DUTs_info(DUT$i,$infoKey)] {
                    lappend jout($i) &#34;$infoKey&#34;
                    lappend jout($i) &#34;$DUTs_info(DUT$i,$infoKey)&#34;
                    <span class="comment-line">#result_debug &#34;DUT$i $IKEYTEXT($infoKey) = $DUTs_info(DUT$i,$infoKey)&#34;</span>
                }
            }
            puts &#34;[<a name="::listToJson(1)"><a href="./semaphore.tcl.html#::listToJson_5">::listToJson</a></a> -mlist $jout($i) -elem &#34;DUT$i&#34;]&#34;
        }
    }

}
<span class="comment-line"># -------------------------------------------------------------------------------------</span>
<span class="comment-line"># proc _printDUTSlotInfoVars</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># -------------------------------------------------------------------------------------</span>
<strong><a name="::::_printDUTSlotInfoVars_3597">proc <a href="swConf.tcl-annot.html#::::_printDUTSlotInfoVars">::::_printDUTSlotInfoVars</a></a></strong><a name="::::_printDUTSlotInfoVars"></a> {} {
    global DUTs_Slot_info IKEYS ISLOTKEYS MAIN

    set slist &#34;1 2 3 4 5 6 7 8 A B&#34;

    if ![array exists DUTs_Slot_info] {
        <a name="::result_debug(108)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUTs_Slot_info has not been set&#34;
        return;
    }

    for {set i 1} {$i&lt;=$MAIN(NODECOUNT)} {incr i} {
        foreach infoKey $ISLOTKEYS {
            foreach s $slist {
                if [info exists DUTs_Slot_info(DUT$i,slot$s,$infoKey)] {
                    puts &#34;[format &#34;      %-45s = %-45s&#34; &#34;DUTs_Slot_info(DUT$i,slot$s,$infoKey)&#34; &#34;$DUTs_Slot_info(DUT$i,slot$s,$infoKey)&#34;]&#34;
                }
            }
        }
    }
}
<span class="comment-line"># -------------------------------------------------------------------------------------</span>
<span class="comment-line"># proc WriteDutsInfoVarsToInit</span>
<span class="comment-line">#</span>
<span class="comment-line">#   After gathering test bed variables write them to the init file</span>
<span class="comment-line">#</span>
<span class="comment-line"># -------------------------------------------------------------------------------------</span>
<strong><a name="::::WriteDutsInfoVarsToInit_3623">proc <a href="swConf.tcl-annot.html#::::WriteDutsInfoVarsToInit">::::WriteDutsInfoVarsToInit</a></a></strong><a name="::::WriteDutsInfoVarsToInit"></a> {} {
    global DUTs_info IKEYS MAIN

    if ![array exists DUTs_info] {
        <a name="::result_debug(109)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;DUTs_info has not be set&#34;
        return;
    }
    if {![info exists MAIN(ifPipe)] || $MAIN(ifPipe) == &#34;NULL&#34;} {
        <span class="comment-line">#open the init</span>
    }
    for {set i 1} {$i&lt;=$MAIN(NODECOUNT)} {incr i} {
        foreach infoKey $IKEYS {
            if [info exists DUTs_info(DUT$i,$infoKey)] {
                puts $MAIN(ifPipe) &#34;set DUTs_info(DUT$i,$infoKey) $DUTs_info(DUT$i,$infoKey)&#34;
            }
        }
    }

}
<span class="comment-line"># -------------------------------------------------------------------------------------</span>
<span class="comment-line"># proc _printMultiTaskOutput</span>
<span class="comment-line">#</span>
<span class="comment-line">#     set the variable internally in the multitask as</span>
<span class="comment-line">#    </span>
<span class="comment-line">#     DUTs_info(DUT$dut,show_output) $show_data</span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage: _printMultiTaskOutput    </span>
<span class="comment-line"># -------------------------------------------------------------------------------------</span>
<strong><a name="::::_printMultiTaskOutput_3651">proc <a href="swConf.tcl-annot.html#::::_printMultiTaskOutput">::::_printMultiTaskOutput</a></a></strong><a name="::::_printMultiTaskOutput"></a> {{dutList &#34;null&#34;}} {
    global MAIN DUTs_info

    if {$dutList != &#34;null&#34;} {
        set DUTLIST $dutList
    } else {
        set DUTLIST $MAIN(DUTLIST)
    }

    foreach i $DUTLIST {
        set h1 &#34;----------------------------------------------------------------&#34;
        set ho &#34;\n&#34;
        append ho &#34;$h1\n&#34;
        append ho &#34;                          DUT $i \n&#34;
        append ho $h1
        <a name="::result_debug(110)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> $ho
        if {[info exists DUTs_info(DUT$i,show_output)]} {
            puts &#34;[string trim $DUTs_info(DUT$i,show_output)]&#34;
            <a name="::result_pre(1)"><a href="./loadConsoles.tcl.html#::result_pre_15">::result_pre</a></a> &#34;[string trim $DUTs_info(DUT$i,show_output)]&#34;
        }
    }

}
<span class="comment-line"># -------------------------------------------------------------------------------------</span>
<span class="comment-line"># Procedure: _get_duts_info</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># -------------------------------------------------------------------------------------</span>
<strong><a name="::::_get_duts_info_3680">proc <a href="swConf.tcl-annot.html#::::_get_duts_info">::::_get_duts_info</a></a></strong><a name="::::_get_duts_info"></a> {s   p} {
    global MAIN DUTs_info
    set getInfoList &#34;&#34;
    for {set i 1} {$i&lt;=$MAIN(NODECOUNT)} {incr i} {
        lappend getInfoList  &#34;_get_HW_DUTs_info -dut $i -checkOperational 0&#34;
    }
    <a name="::MultiTask(2)"><a href="./multiTask.tcl.html#::MultiTask_39">::MultiTask</a></a> $getInfoList
    if {$s==&#34;show&#34;} {
        <a name="::::_printMultiTaskOutput(1)"><a href="./swConf.tcl.html#::::_printMultiTaskOutput_3651">::::_printMultiTaskOutput</a></a>;
    }
    if {$p==&#34;print&#34;} {
        <a name="::::_printDutsInfoVars(1)"><a href="./swConf.tcl.html#::::_printDutsInfoVars_3547">::::_printDutsInfoVars</a></a>
    }
}
</pre>
<hr>
<div class="index-selector">
	<a href="index_main.html#byfilename">file name</a> 
 | 
	<a href="index_main.html#byprocname">procedure name</a> 
 | 
	<a href="index_main.html#bycall">procedure call</a> 
 | 
	<a href="index_annot_full.html">annotation</a> 

<br>
<cite>File generated 2018-06-14 at 17:09.</cite>
</div>

</body>
</html>
