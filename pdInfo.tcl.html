<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/transitional.dtd">
<!-- Generated by TclDoc @@VERSION@@ -->
<html>
<head>
  <title>pdInfo.tcl</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="default.css">
</head>
<body class="src-html">
<div class="index-selector">
<!-- index for tcl source files -->
	Index by: 
	<a href="index_main.html#pdInfo.tcl">file name</a> | 
	<a href="index_main.html#byprocname">procedure name</a> | 
	<a href="index_main.html#bycall">procedure call</a> | 
	<a href="index_annot_full.html">annotation</a>

</div>
<hr>

<p><strong>pdInfo.tcl</strong>&nbsp;&nbsp;<span class="filetype-link">(<a href="pdInfo.tcl-annot.html">annotations</a> | <a href="pdInfo.tcl.txt">original source</a>)</span>
</p>
<pre class="src-code">
<span class="comment-line">#!/usr/bin/expect --</span>

load [lindex [glob &#34;/usr/lib/libexpect*so*&#34;] 0]
source SiebelAccess.tcl


<strong><a name="::::printUsage_7">proc <a href="pdInfo.tcl-annot.html#::::printUsage">::::printUsage</a></a></strong> { } {
     puts &#34;\r&#34;
     puts &#34;Usage:./pdInfo.tcl &lt;pd name&gt;&#34;
     puts &#34;Ex: ./pdInfo.tcl PD2-178884043&#34;
}

<strong><a name="::::printInfo_13">proc <a href="pdInfo.tcl-annot.html#::::printInfo">::::printInfo</a></a></strong> { } {
    puts &#34;\n*********************************************************************&#34;
    puts &#34;***  Please read the PD informations in the following sequence -  ***&#34;
    puts &#34;***  Owner, Creation Date, Created By, Status, Severity, Priority ***&#34;
    puts &#34;***  PD Headline, PD Description                                  ***&#34;
    puts &#34;*********************************************************************\n&#34;
}

<strong><a name="::::getSql_21">proc <a href="pdInfo.tcl-annot.html#::::getSql">::::getSql</a></a></strong> { pd } {
     set SQL &#34;select owner.login PD_Owner, pd.created, created.login PD_Created_by, \
             pd.status_cd, pd.SEVERITY_CD, pd.OTH_PRIORITY_CD, pd.ABSTRACT, pd.DESC_TEXT \
             from siebel.s_employee owner, siebel.s_employee created, siebel.s_prod_defect \
             pd where owner.row_id = pd.OWNER_EMP_ID and created.row_id = pd.created_by and \
             pd.defect_num ='$pd'&#34; 
    return $SQL;
}

<strong><a name="::::getPdInput_30">proc <a href="pdInfo.tcl-annot.html#::::getPdInput">::::getPdInput</a></a></strong> { } {
   puts -nonewline &#34;\n Enter the PD number (Q to quit): &#34;
   flush stdout
   set pd [gets stdin]
   while { $pd == &#34;&#34; } {
       puts -nonewline &#34;\n Enter the PD number (Q to quit): &#34;
       flush stdout
       set pd [gets stdin]
   }
  return $pd
}

<strong><a name="::::isValidPdName_42">proc <a href="pdInfo.tcl-annot.html#::::isValidPdName">::::isValidPdName</a></a></strong> { pd } {
     set ret [regexp {(PD)[0-9](-)([0-9]+)} $pd]
     if { $ret == 0 } {
          puts &#34;ERROR: Invalid PD name&#34;
     }
     return $ret
}

<span class="comment-line">#************************************************************************</span>
<span class="comment-line">#                  MAIN CODE </span>
<span class="comment-line">#************************************************************************</span>

set pd &#34;&#34;


if { [lsearch $argv &#34;-help&#34;] &gt; -1} {
      <a name="::printUsage(1)"><a href="./pdInfo.tcl.html#::printUsage_7">::printUsage</a></a>
      exit
}

if { [lsearch $argv &#34;?&#34;] &gt; -1} {
      <a name="::printUsage(2)"><a href="./pdInfo.tcl.html#::printUsage_7">::printUsage</a></a>
      exit
}

if { $argc&lt;1 } {
     <a name="::printInfo(1)"><a href="./pdInfo.tcl.html#::printInfo_13">::printInfo</a></a> 
     set pd [<a name="::getPdInput(1)"><a href="./pdInfo.tcl.html#::getPdInput_30">::getPdInput</a></a>] 
     if { $pd == &#34;q&#34; || $pd == &#34;Q&#34; || [<a name="::isValidPdName(1)"><a href="./pdInfo.tcl.html#::isValidPdName_42">::isValidPdName</a></a> $pd] == 0 } {
        exit
     }
} else {
     <a name="::printInfo(2)"><a href="./pdInfo.tcl.html#::printInfo_13">::printInfo</a></a> 
     sleep 3
     set pd [lindex $argv 0]
     if { [<a name="::isValidPdName(2)"><a href="./pdInfo.tcl.html#::isValidPdName_42">::isValidPdName</a></a> $pd] == 0 } {
         exit
     }
}

set lda [<a name="::OpenSiebelSession(1)"><a href="./SiebelAccess.tcl.html#::OpenSiebelSession_61">::OpenSiebelSession</a></a>]
set hdl [<a name="::LoginSiebel(1)"><a href="./SiebelAccess.tcl.html#::LoginSiebel_106">::LoginSiebel</a></a> $lda]

set SQL [<a name="::getSql(1)"><a href="./pdInfo.tcl.html#::getSql_21">::getSql</a></a> $pd] 
set rowData [<a name="::ExecuteSQL(1)"><a href="./SiebelAccess.tcl.html#::ExecuteSQL_143">::ExecuteSQL</a></a> $hdl $SQL]
puts &#34;\n $pd : $rowData&#34;
set ans &#34;&#34;
while { 1 } {
   while { $ans == &#34;&#34; } {
       puts -nonewline &#34;\n Any more PD ?? (y/n) :&#34;
       flush stdout
       set ans [gets stdin]
   }
   if { $ans == &#34;n&#34; || $ans == &#34;N&#34; } {
        break
   } else {
       set pd [<a name="::getPdInput(2)"><a href="./pdInfo.tcl.html#::getPdInput_30">::getPdInput</a></a>] 
       if { $pd == &#34;q&#34; || $pd == &#34;Q&#34; || [<a name="::isValidPdName(3)"><a href="./pdInfo.tcl.html#::isValidPdName_42">::isValidPdName</a></a> $pd] == 0 } {
          break
       }
      set SQL [<a name="::getSql(2)"><a href="./pdInfo.tcl.html#::getSql_21">::getSql</a></a> $pd]
      set rowData [<a name="::ExecuteSQL(2)"><a href="./SiebelAccess.tcl.html#::ExecuteSQL_143">::ExecuteSQL</a></a> $hdl $SQL]
      puts &#34;\n $pd : $rowData&#34;
   }

 set ans &#34;&#34;
 set pd &#34;&#34;
}

<a name="::LogoutSiebel(1)"><a href="./SiebelAccess.tcl.html#::LogoutSiebel_125">::LogoutSiebel</a></a> $hdl
<a name="::CloseSiebelSession(1)"><a href="./SiebelAccess.tcl.html#::CloseSiebelSession_88">::CloseSiebelSession</a></a> $lda

</pre>
<hr>
<div class="index-selector">
	<a href="index_main.html#byfilename">file name</a> 
 | 
	<a href="index_main.html#byprocname">procedure name</a> 
 | 
	<a href="index_main.html#bycall">procedure call</a> 
 | 
	<a href="index_annot_full.html">annotation</a> 

<br>
<cite>File generated 2018-06-14 at 17:09.</cite>
</div>

</body>
</html>
