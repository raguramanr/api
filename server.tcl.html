<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/transitional.dtd">
<!-- Generated by TclDoc @@VERSION@@ -->
<html>
<head>
  <title>server.tcl</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="default.css">
</head>
<body class="src-html">
<div class="index-selector">
<!-- index for tcl source files -->
	Index by: 
	<a href="index_main.html#server.tcl">file name</a> | 
	<a href="index_main.html#byprocname">procedure name</a> | 
	<a href="index_main.html#bycall">procedure call</a> | 
	<a href="index_annot_full.html">annotation</a>

</div>
<hr>

<p><strong>server.tcl</strong>&nbsp;&nbsp;<span class="filetype-link">(<a href="server.tcl-annot.html">annotations</a> | <a href="server.tcl.txt">original source</a>)</span>
</p>
<pre class="src-code">
<span class="comment-line"># Function to write data to a file</span>
<strong><a name="::::WriteToFile_2">proc <a href="server.tcl-annot.html#::::WriteToFile">::::WriteToFile</a></a></strong> {filename data} {
        set fileId [open $filename &#34;w&#34;]
        puts -nonewline $fileId $data
        close $fileId
}

<span class="comment-line"># Function for server to receive connection and set resume flag</span>
<strong><a name="::::Server_9">proc <a href="server.tcl-annot.html#::::Server">::::Server</a></a></strong> {channel clientaddr clientport} {
        global canresume
        puts &#34;Connection from $clientaddr registered&#34;
        puts $channel [clock format [clock seconds]]
        close $channel
        set canresume 1
}

<strong><a name="::::EzPause_17">proc <a href="server.tcl-annot.html#::::EzPause">::::EzPause</a></a></strong> { argc argv } {
        set canresume 0
        set portno [expr int([expr floor( rand() * 55000) + 10000])]
        set sock 0

        if { $argc != 1 } {
                puts &#34;This script requires a command line argument&#34;
                puts &#34;The command line argument is the file name&#34;
                exit
        }

        puts &#34;Trying $portno...&#34;

        while (1) {
                if {[catch {set sock [socket -server Server $portno]} errmsg]} {
                        puts $errmsg
                        set portno [expr int([expr floor( rand() * 55000) + 10000])]
                        puts &#34;Error while trying to pause&#34;
                } else {
                        break
                }
        }

        <a name="::WriteToFile(1)"><a href="./server.tcl.html#::WriteToFile_2">::WriteToFile</a></a> [lindex $argv 0] $portno
        puts &#34;Execution Paused&#34;
        vwait canresume
        close $sock
}

<span class="comment-line">#unit testing</span>
<span class="comment-line">#EzPause $argc $argv</span>
<span class="comment-line"># --------------------------------------------------------------------</span>
<span class="comment-line"># Procedure: _getRegServerHostname</span>
<span class="comment-line">#</span>
<span class="comment-line">#  return the hostname of the server the script is running on</span>
<span class="comment-line"># --------------------------------------------------------------------</span>
<strong><a name="::::_getRegServerHostname_53">proc <a href="server.tcl-annot.html#::::_getRegServerHostname">::::_getRegServerHostname</a></a></strong> {} {
    set hn [info hostname]
    set hnList [split $hn &#34;.&#34;]
    return [lindex $hnList 0]
}
</pre>
<hr>
<div class="index-selector">
	<a href="index_main.html#byfilename">file name</a> 
 | 
	<a href="index_main.html#byprocname">procedure name</a> 
 | 
	<a href="index_main.html#bycall">procedure call</a> 
 | 
	<a href="index_annot_full.html">annotation</a> 

<br>
<cite>File generated 2018-06-14 at 17:09.</cite>
</div>

</body>
</html>
