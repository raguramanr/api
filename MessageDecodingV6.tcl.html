<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/transitional.dtd">
<!-- Generated by TclDoc @@VERSION@@ -->
<html>
<head>
  <title>MessageDecodingV6.tcl</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="default.css">
</head>
<body class="src-html">
<div class="index-selector">
<!-- index for tcl source files -->
	Index by: 
	<a href="index_main.html#MessageDecodingV6.tcl">file name</a> | 
	<a href="index_main.html#byprocname">procedure name</a> | 
	<a href="index_main.html#bycall">procedure call</a> | 
	<a href="index_annot_full.html">annotation</a>

</div>
<hr>

<p><strong>MessageDecodingV6.tcl</strong>&nbsp;&nbsp;<span class="filetype-link">(<a href="MessageDecodingV6.tcl-annot.html">annotations</a> | <a href="MessageDecodingV6.tcl.txt">original source</a>)</span>
</p>
<pre class="src-code">

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetICMPV6Type</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the hex icmpv6 type value from an icmp packet header</span>
<span class="comment-line">#     Supports tagged frames too.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Integer or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetICMPTypeV6 frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetICMPTypeV6_19">proc <a href="MessageDecodingV6.tcl-annot.html#::::GetICMPTypeV6">::::GetICMPTypeV6</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]

   <span class="comment-line"># Remove E-tag if 802.1br frame</span>
   if {$type == &#34;89 3F&#34;} {
      set chunk1 [string range $rawFrame 0 35]
      set chunk2 [string range $rawFrame 60 [string length $rawFrame]]
      set rawFrame $chunk1$chunk2
      set type [string range $rawFrame 36 40]
   }

   switch -- $type \
      &#34;86 DD&#34; {
      return [string range $rawFrame 102 103]        
   }  &#34;81 00&#34; {
      return [string range $rawFrame 174 176]      ;<span class="comment-line">#tagged frame   </span>
   } default {
      <a name="::result_debug(1)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown IP Type: $type&#34;
      return -1
   }
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetICMPCodeV6</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the hex icmp code value from an icmp packet header</span>
<span class="comment-line">#     Supports tagged frames too.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Integer or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetICMPCode frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetICMPCodeV6_58">proc <a href="MessageDecodingV6.tcl-annot.html#::::GetICMPCodeV6">::::GetICMPCodeV6</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]

   <span class="comment-line"># Remove E-tag if 802.1br frame</span>
   if {$type == &#34;89 3F&#34;} {
      set chunk1 [string range $rawFrame 0 35]
      set chunk2 [string range $rawFrame 60 [string length $rawFrame]]
      set rawFrame $chunk1$chunk2
      set type [string range $rawFrame 36 40]
   }

   switch -- $type \
      &#34;86 DD&#34; {
      return  [string range $rawFrame 105 106]         
   }  &#34;81 00&#34; {
      return  [string range $rawFrame 176 178]      ;<span class="comment-line">#tagged frame   </span>
   } default {
      <a name="::result_debug(2)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown IP Type: $type&#34;
      <span class="comment-line">#just return the type</span>
      return -1
   }
}


<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetTRAFFIClass</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the hex value of TOS field from an ip packet header</span>
<span class="comment-line">#     Supports tagged frames too.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: 2 byte hex value or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetTOSHex frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetTRAFFIClass_99">proc <a href="MessageDecodingV6.tcl-annot.html#::::GetTRAFFIClass">::::GetTRAFFIClass</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;08 00&#34; {
      return [string range $rawFrame 45 46]       
   }  &#34;81 00&#34; {
      return [string replace [string range $rawFrame 55 57] 1 1 &#34;&#34;]     ;<span class="comment-line">#tagged frame   </span>
   } default {
      <a name="::result_debug(3)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: $type&#34;
      <span class="comment-line">#just return the type</span>
      return -1
   }
}
<span class="comment-line">#################################################################</span>
<span class="comment-line"># Procedure Name: GetICMPv6Message</span>
<span class="comment-line">#</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is designed to get the next header type.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Automation supported message type or &#34;FAIL&#34; in error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetICMPv6Message frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>

<strong><a name="::::GetICMPv6Message_129">proc <a href="MessageDecodingV6.tcl-annot.html#::::GetICMPv6Message">::::GetICMPv6Message</a></a></strong> { rawFrame } {

   set type [string range $rawFrame 36 40]

   <span class="comment-line"># Remove E-tag if 802.1br frame</span>
   if {$type == &#34;89 3F&#34;} {
      set chunk1 [string range $rawFrame 0 35]
      set chunk2 [string range $rawFrame 60 [string length $rawFrame]]
      set rawFrame $chunk1$chunk2
      set type [string range $rawFrame 36 40]
   }

   switch -- $type \
      &#34;81 00&#34; {
         set IpType [<a name="::hextodec(1)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 72 74]]
         switch -- $IpType \
            &#34;58&#34;  {
               return &#34;IP_ICMPV6&#34;
         }
   }    
}


<span class="comment-line">#################################################################</span>
<span class="comment-line"># Procedure Name: GetMessageTypeV6</span>
<span class="comment-line">#</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the type of protocol and specific type in</span>
<span class="comment-line">#     that protocol. Currently, this proc supports, ICMPV6.</span>
<span class="comment-line">#     Supports tagged frames too.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Automation supported message type or &#34;FAIL&#34; in error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetMessageType frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>

<strong><a name="::::GetMessageTypeV6_171">proc <a href="MessageDecodingV6.tcl-annot.html#::::GetMessageTypeV6">::::GetMessageTypeV6</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;81 00&#34; {
         set IpType [<a name="::hextodec(2)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 172 174]]
         switch -- $IpType \
            &#34;58&#34;  {
               return &#34;IP_ICMPV6&#34;
         }  &#34;133&#34;  {
               return &#34;Router_Solicitation&#34;     ;<span class="comment-line">#RFC2461</span>
         }  &#34;134&#34;  {
               return &#34;Router_Advertisement&#34;    ;<span class="comment-line">#RFC2461</span>
         }  &#34;135&#34;  {
               return &#34;Neighbor_Solicitation&#34;   ;<span class="comment-line">#RFC2461</span>
         }  &#34;136&#34;  {
               return &#34;Neighbor_Advertisement&#34;  ;<span class="comment-line">#RFC2461</span>
         }  &#34;137&#34;  {
               return &#34;Redirect_Message&#34;        ;<span class="comment-line">#RFC2461</span>
         }  default {
               return &#34;Invalid ICMP Type: $IpType&#34;
         }
   }  &#34;86 DD&#34; {
         set IpType [<a name="::hextodec(3)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 162 164]]
         switch -- $IpType \
            &#34;58&#34;  {
               return &#34;IP_ICMPV6&#34;
         }  &#34;133&#34;  {
               return &#34;Router_Solicitation&#34;     ;<span class="comment-line">#RFC2461</span>
         }  &#34;134&#34;  {
               return &#34;Router_Advertisement&#34;    ;<span class="comment-line">#RFC2461</span>
         }  &#34;135&#34;  {
               return &#34;Neighbor_Solicitation&#34;   ;<span class="comment-line">#RFC2461</span>
         }  &#34;136&#34;  {
               return &#34;Neighbor_Advertisement&#34;  ;<span class="comment-line">#RFC2461</span>
         }  &#34;137&#34;  {
               return &#34;Redirect_Message&#34;        ;<span class="comment-line">#RFC2461</span>
         }  default {
               return &#34;Invalid ICMP Type: $IpType&#34;
         }
   }
}

<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name: GetDestIPAddressV6</span>
<span class="comment-line">#</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the destination IP address  from an IPv6 packet header</span>
<span class="comment-line">#     Supports tagged frames too.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: IP Address or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetDestIPAddressV6 frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetDestIPAddressV6_230">proc <a href="MessageDecodingV6.tcl-annot.html#::::GetDestIPAddressV6">::::GetDestIPAddressV6</a></a></strong> { rawFrame } {

   set type [string range $rawFrame 36 40]

   <span class="comment-line"># Remove E-tag if 802.1br frame</span>
   if {$type == &#34;89 3F&#34;} {
      set chunk1 [string range $rawFrame 0 35]
      set chunk2 [string range $rawFrame 60 [string length $rawFrame]]
      set rawFrame $chunk1$chunk2
      set type [string range $rawFrame 36 40]
   }

   switch -- $type \
      &#34;81 00&#34; {
      <span class="comment-line">#result_debug &#34;126 to 172 [string range $rawFrame 126 172 ]&#34;</span>
      <span class="comment-line">#result_debug &#34;type 174 to 176 [string range $rawFrame 174 176 ]&#34;</span>
      <span class="comment-line">#result_debug &#34;code 177 to 179 [string range $rawFrame 177 179 ]&#34;</span>
      return [string range $rawFrame 126 172 ]
   }  &#34;86 DD&#34; {
      <span class="comment-line">#result_debug &#34;114 to 160 [string range $rawFrame 114 160 ]&#34;</span>
      <span class="comment-line">#result_debug &#34;type 162 to 164 [string range $rawFrame 162 164 ]&#34;</span>
      <span class="comment-line">#result_debug &#34;code 165 to 167 [string range $rawFrame 165 167 ]&#34;</span>
      return [string range $rawFrame 114 160 ]
   }  default {
      <a name="::result_debug(4)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: $type&#34;
      return -1
   }

}
<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name: GetSourceIPAddressV6</span>
<span class="comment-line">#</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the source IP address  from an IPv6 packet header</span>
<span class="comment-line">#     Supports tagged frames too.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: IP Address or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetDestIPAddressV6 frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetSourceIPAddressV6_276">proc <a href="MessageDecodingV6.tcl-annot.html#::::GetSourceIPAddressV6">::::GetSourceIPAddressV6</a></a></strong> { rawFrame } {

   set type [string range $rawFrame 36 40]
   switch $type {
      &#34;81 00&#34; {return [string range $rawFrame 78 124 ]}
      &#34;86 DD&#34; {return [string range $rawFrame 66 112 ]}
      default {
         <a name="::result_debug(5)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: $type&#34;
         return -1
      }
   }
}
<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name: GetMACEuiIPv6</span>
<span class="comment-line">#</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc pulls the MAC address from an EUI Space De-limited</span>
<span class="comment-line">#         IPv6 Address</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: Dot de-limited MAC</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Colon Seperated MAC - 00:04:96:A1:02:03</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetMACEuiIPv6 $euiIPv6Addr</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetMACEuiIPv6_305">proc <a href="MessageDecodingV6.tcl-annot.html#::::GetMACEuiIPv6">::::GetMACEuiIPv6</a></a></strong> { euiIPv6Addr } {
   set Mac1 [string range $euiIPv6Addr 27 31]
   set Mac2 [string range $euiIPv6Addr 39 46 ]
   set MAC &#34;00 $Mac1 $Mac2&#34;
   return [string tolower [<a name="::nl_delimitMac(1)"><a href="./NetloginLib.tcl.html#::nl_delimitMac_4567">::nl_delimitMac</a></a> &#34;$MAC&#34;]];
}

<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name: GetControlTypeIPv6</span>
<span class="comment-line">#</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc pulls the last 6 bytes from a Space De-limited</span>
<span class="comment-line">#         IPv6 Address.  Initially used to pull the control message</span>
<span class="comment-line">#         Type from a multicast packet</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: Space delimited 6 bytes</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: 00 01 ff 00 00 00</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetControlTypeIPv6 $MulticastAddr</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetControlTypeIPv6_330">proc <a href="MessageDecodingV6.tcl-annot.html#::::GetControlTypeIPv6">::::GetControlTypeIPv6</a></a></strong> { iPv6Addr } {
   return [string tolower [string range $iPv6Addr 30 46]];
}

<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name: GetIPv6ReportDAAddrFromMac</span>
<span class="comment-line">#</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc creates a report based EUI IPv6 Address  </span>
<span class="comment-line">#        from a dot-de-limited MAC address</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: MAC delimit scale</span>
<span class="comment-line">#             MAC = colon delimited MAC</span>
<span class="comment-line">#             delimit = type of delimiter for output v6 address</span>
<span class="comment-line">#             scale: full all 16 words or 32 bytes</span>
<span class="comment-line">#</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Colon Seperated Partial Ipv6 Address - </span>
<span class="comment-line">#               Example: MAC = 00:04:96:1D:57:A0</span>
<span class="comment-line">#                        Return Full = fe80::0204:96ff:fe1d:57a0</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetIPv6ReportDAAddrFromMac $Mac colon partial</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetIPv6ReportDAAddrFromMac_357">proc <a href="MessageDecodingV6.tcl-annot.html#::::GetIPv6ReportDAAddrFromMac">::::GetIPv6ReportDAAddrFromMac</a></a></strong> { Mac {delimit colon} {scale partial}} {
   set hexMacList [split $Mac :]
   set hex1 [string tolower [lindex $hexMacList 1]];
   set hex2 [string tolower [lindex $hexMacList 2]];
   set hex3 [string tolower [lindex $hexMacList 3]];
   set hex4 [string tolower [lindex $hexMacList 4]];
   set hex5 [string tolower [lindex $hexMacList 5]];
   switch -- $delimit \
      &#34;colon&#34; {
         if {$scale == &#34;full&#34;} {
            return &#34;ff02:0000:0000:0000:0000:0000:0000:0000:0000:0000:0000:0000:0000:0001:ff${hex3}:${hex4}${hex5}&#34;;
         } elseif {$scale == &#34;partial&#34;} {
            return &#34;ff02::01:ff${hex3}:${hex4}${hex5}&#34;;
         } else {
            return &#34;ff02::01:ff${hex3}:${hex4}${hex5}&#34;;
         }         
   }  &#34;space&#34; {
        if {$scale == &#34;full&#34;} {
           return &#34;ff 02 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 ff ${hex3} ${hex4} ${hex5}&#34;;
        } else {
           return &#34;ff 02 00 00 00 00 00 00 00 00 00 01 ff ${hex3} ${hex4} ${hex5}&#34;
        }
   } default {
      return &#34;ff02::01:ff${hex3}:${hex4}${hex5}&#34;;
   }

}
<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name: GetIPv6ReportDAMac</span>
<span class="comment-line">#</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc creates a DA Mac for a report  </span>
<span class="comment-line">#        based on the SA Mac</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: MAC delimit scale</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Colon Seperated MAC - </span>
<span class="comment-line">#               Example: MAC = 33:33:96:1D:57:A0</span>
<span class="comment-line">#                        </span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetIPv6ReportDAMac $Mac</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetIPv6ReportDAMac_403">proc <a href="MessageDecodingV6.tcl-annot.html#::::GetIPv6ReportDAMac">::::GetIPv6ReportDAMac</a></a></strong> { Mac } {
   set hexMacList [split $Mac :]
   set hex1 [string tolower [lindex $hexMacList 1]];
   set hex2 [string tolower [lindex $hexMacList 2]];
   set hex3 [string tolower [lindex $hexMacList 3]];
   set hex4 [string tolower [lindex $hexMacList 4]];
   set hex5 [string tolower [lindex $hexMacList 5]];
   return &#34;33:33:FF:${hex3}:${hex4}:${hex5}&#34;;
}
<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name: GetRightIPv6EuiFromMac</span>
<span class="comment-line">#</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc creates the right 6 hex EUI digits of an  </span>
<span class="comment-line">#        IPv6 address from a MAC address</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: IPv6 Address - GetRightIPv6EuiFromMac</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Colon Seperated Partial Ipv6 Address - </span>
<span class="comment-line">#               Example: MAC = 00:04:96:1D:57:A0</span>
<span class="comment-line">#                        Full = fe80::204:96ff:fe1d:57a0 </span>
<span class="comment-line">#                        only return 1d:57a0</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetRightIPv6EuiFromMac $Mac</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetRightIPv6EuiFromMac_432">proc <a href="MessageDecodingV6.tcl-annot.html#::::GetRightIPv6EuiFromMac">::::GetRightIPv6EuiFromMac</a></a></strong> { Mac } {
   set hexMacList [split $Mac :]
   set hex1 [lindex $hexMacList 3];
   set hex2 [lindex $hexMacList 4];
   set hex3 [lindex $hexMacList 5];
   set rValue ${hex1}:${hex2}${hex3}
   return [string tolower $rValue];
}
<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name: GetIPv6EuiFromMac</span>
<span class="comment-line">#</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc creates the Full MAC Portion of an EUI IPv6 Address  </span>
<span class="comment-line">#        from a dot-de-limited MAC address</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: MAC Address</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Colon Seperated Partial Ipv6 Address - </span>
<span class="comment-line">#               Example: MAC = 00:04:96:1D:57:A0</span>
<span class="comment-line">#                        Full = fe80::0204:96ff:fe1d:57a0 </span>
<span class="comment-line">#                        Return = 204:96ff:fe1d:57a0</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetIPv6EuiAllFromMac $Mac</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetIPv6EuiFromMac_460">proc <a href="MessageDecodingV6.tcl-annot.html#::::GetIPv6EuiFromMac">::::GetIPv6EuiFromMac</a></a></strong> { Mac } {
   set hexMacList [split $Mac :]
   set hex1 [lindex $hexMacList 1];
   set hex2 [lindex $hexMacList 2];
   set hex3 [lindex $hexMacList 3];
   set hex4 [lindex $hexMacList 4];
   set hex5 [lindex $hexMacList 5];
   set val45 [string trimleft &#34;${hex4}${hex5}&#34; &#34;0&#34;];
   set val2 [string trimleft &#34;${hex2}&#34; &#34;0&#34;]; 
   return [string tolower &#34;2${hex1}:${val2}ff:fe${hex3}:${val45}&#34;];
}
<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name: GetIPv6LinkLocalFromMac</span>
<span class="comment-line">#</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc creates a full EUI IPv6 Address  </span>
<span class="comment-line">#        from a dot-de-limited MAC address</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: MAC delimit scale</span>
<span class="comment-line">#             MAC = colon delimited MAC</span>
<span class="comment-line">#             delimit = type of delimiter for output v6 address</span>
<span class="comment-line">#             scale: full all 16 words or 32 bytes</span>
<span class="comment-line">#</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Colon Seperated Partial Ipv6 Address - </span>
<span class="comment-line">#               Example: MAC = 00:04:96:1D:57:A0</span>
<span class="comment-line">#                        Return Full = fe80::0204:96ff:fe1d:57a0</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetIPv6LinkLocalFromMac $Mac colon partial</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetIPv6LinkLocalFromMac_494">proc <a href="MessageDecodingV6.tcl-annot.html#::::GetIPv6LinkLocalFromMac">::::GetIPv6LinkLocalFromMac</a></a></strong> { Mac {delimit colon} {scale partial} {trim 0}} {
   set hexMacList [split $Mac :]
   set hex0 [string tolower [lindex $hexMacList 0]];
   set hex1 [string tolower [lindex $hexMacList 1]];
   set hex2 [string tolower [lindex $hexMacList 2]];
   set hex3 [string tolower [lindex $hexMacList 3]];
   set hex4 [string tolower [lindex $hexMacList 4]];
   set hex5 [string tolower [lindex $hexMacList 5]];

   if {$hex0 == &#34;02&#34;} {
      set ULBit &#34;00&#34;
      set ULBitShort &#34;&#34; 
        if {$trim} {
            set hex1 [string trimleft $hex1 0]
        }
   } else {
      set ULBit &#34;02&#34;
      set ULBitShort &#34;2&#34;
   }
   switch -- $delimit \
      &#34;colon&#34; {
         if {$scale == &#34;full&#34;} {
            return [string toupper &#34;FE80:0000:0000:0000:0000:0000:0000:0000:0000:0000:0000:0000:${ULBit}${hex1}:${hex2}FF:FE${hex3}:${hex4}${hex5}&#34;];
         } elseif {$scale == &#34;partial&#34;} {
set hex4 [string trimleft $hex4 0]

            return [string toupper &#34;FE80::${ULBitShort}${hex1}:${hex2}FF:FE${hex3}:${hex4}${hex5}&#34;];
         } else {
            set hex2 [string trimleft $hex2 0]
            set hex4 [string trimleft $hex4 0]
            if {$hex4 == &#34;&#34;} {
               set hex5 [string trimleft $hex5 0]
            }
            return &#34;fe80::${ULBitShort}${hex1}:${hex2}ff:fe${hex3}:${hex4}${hex5}&#34;
         }         
   }  &#34;space&#34; {
         return [string toupper &#34;FE 80 00 00 00 00 00 00 ${ULBit} ${hex1} ${hex2} FF FE ${hex3} ${hex4} ${hex5}&#34;];
   } default {
      return [string toupper &#34;FE80::${ULBitShort}${hex1}:${hex2}FF:FE${hex3}:${hex4}${hex5}&#34;];
   }

}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetIPV6HopLimit</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the decimal hop limit of v6 traffic</span>
<span class="comment-line">#     Supports tagged frames too.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Integer or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetIPV6HopLimit frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetIPV6HopLimit_554">proc <a href="MessageDecodingV6.tcl-annot.html#::::GetIPV6HopLimit">::::GetIPV6HopLimit</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;86 DD&#34; {
      return [string range $rawFrame 63 64]        
   }  &#34;81 00&#34; {
      return [string range $rawFrame 75 76]      ;<span class="comment-line">#tagged frame   </span>
   } default {
      <a name="::result_debug(6)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown IP Type: $type&#34;
      return -1
   }
}
<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetICMPv6Header2Value</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the 2nd icmp header and icmpv6 frame</span>
<span class="comment-line">#     Supports tagged frames too. (hex 82 83 84 = query report done)</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Return decimal icmpv6 packet type</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetICMPv6Header2Value $frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetICMPv6Header2Value_583">proc <a href="MessageDecodingV6.tcl-annot.html#::::GetICMPv6Header2Value">::::GetICMPv6Header2Value</a></a></strong> { rawFrame {withRA &#34;yes&#34;}} {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;86 DD&#34; {
         if {$withRA == &#34;yes&#34;} {
            return [<a name="::hextodec(4)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 186 187]]
         } else {
            return [<a name="::hextodec(5)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 162 163]]
         }
   }  &#34;81 00&#34; {
         if {$withRA == &#34;yes&#34;} {
            return [<a name="::hextodec(6)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 198 199]]      ;<span class="comment-line">#tagged frame</span>
         } else {
            return [<a name="::hextodec(7)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 174 175]]      ;<span class="comment-line">#tagged frame</span>
         }
   } default {
      <a name="::result_debug(7)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown EtherType: $type&#34;
      return -1
   }
}
<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: CheckMLDRouterAlert</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to check if a v6 packet is an MLD router alert.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Integer or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># CheckRouterAlert frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CheckRouterAlert</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::CheckMLDRouterAlert_619">proc <a href="MessageDecodingV6.tcl-annot.html#::::CheckMLDRouterAlert">::::CheckMLDRouterAlert</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;86 DD&#34; {
         <a name="::result_debug(8)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Checking: [string range $rawFrame 162 185]&#34;
      if {[string range $rawFrame 162 185] == &#34;3A 00 05 02 00 00 01 00&#34;} {        
         return 1;
      } else {
         return 0;
      }
   }  &#34;81 00&#34; {
         <a name="::result_debug(9)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Checking: [string range $rawFrame 174 197]&#34;
      if {[string range $rawFrame 174 197] == &#34;3A 00 05 02 00 00 01 00&#34;} {
         return 1;
      } else {
         return 0;
      }
   } default {
      <a name="::result_debug(10)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown EtherType: $type&#34;
      return 0
   }
}
<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetMLDResponseDelay</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the response delay of an mld</span>
<span class="comment-line">#     ipv6 packet.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Integer or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetRouterAlertType frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetMLDResponseDelay_658">proc <a href="MessageDecodingV6.tcl-annot.html#::::GetMLDResponseDelay">::::GetMLDResponseDelay</a></a></strong> { rawFrame {withRA &#34;yes&#34;} } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;86 DD&#34; {
         if {$withRA == &#34;yes&#34;} {
            set mldType [<a name="::hextodec(8)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 186 187]]
         } else {
            set mldType [<a name="::hextodec(9)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 162 163]]
         }
         if {$mldType == 130} {
            if {$withRA == &#34;yes&#34;} {
               set numVar [join [string range $rawFrame 198 203] &#34;&#34;]
               <a name="::result_debug(11)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Hex Response Delay $numVar&#34;
               return [<a name="::hextodec(10)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> $numVar]
            } else {
               set numVar [join [string range $rawFrame 174 179] &#34;&#34;]
               <a name="::result_debug(12)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Hex Response Delay $numVar&#34;
               return [<a name="::hextodec(11)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> $numVar]
            }
         } else {
            <a name="::result_debug(13)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Or Unexpected MLDType: $mldType&#34;
            return -1
         }
   }  &#34;81 00&#34; {
         if {$withRA == &#34;yes&#34;} {
            set mldType [<a name="::hextodec(12)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 198 199]]      ;<span class="comment-line">#tagged frame</span>
         } else {
            set mldType [<a name="::hextodec(13)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $rawFrame 174 175]]
         }
         if {$mldType == 130} {
               if {$withRA == &#34;yes&#34;} {
                  set numVar [join [string range $rawFrame 210 215] &#34;&#34;]
                  <a name="::result_debug(14)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Hex Response Delay $numVar&#34;
                  return [<a name="::hextodec(14)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> $numVar]
               } else {
                  set numVar [join [string range $rawFrame 162 167] &#34;&#34;]
                  <a name="::result_debug(15)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Hex Response Delay $numVar&#34;
                  return [<a name="::hextodec(15)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> $numVar]
               }
         } else {
            <a name="::result_debug(16)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Or Unexpected MLDType: $mldType&#34;
            return -1
         }      
   } default {
      <a name="::result_debug(17)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown EtherType: $type&#34;
      return -1
   }

}


<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetMLDMulticastAddr</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the hex icmp code value from an icmp packet header</span>
<span class="comment-line">#     Supports tagged frames too.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Integer or -1 on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetMLDMulticastAddr frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetMLDMulticastAddr_726">proc <a href="MessageDecodingV6.tcl-annot.html#::::GetMLDMulticastAddr">::::GetMLDMulticastAddr</a></a></strong> { rawFrame {withRA &#34;yes&#34;}} {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;86 DD&#34; {
         if {$withRA == &#34;yes&#34;} {
            return  [string range $rawFrame 210 256]
         } else {
            return  [string range $rawFrame 186 232]
         }
   }  &#34;81 00&#34; {
         if {$withRA == &#34;yes&#34;} {
            return  [string range $rawFrame 222 268]      ;<span class="comment-line">#tagged frame</span>
         } else {
            return  [string range $rawFrame 198 244]      ;<span class="comment-line">#tagged frame</span>
         }
   } default {
      <a name="::result_debug(18)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown IP Type: $type&#34;
      <span class="comment-line">#just return the type</span>
      return -1
   }
}
<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: CheckMLDGeneralQueryGroup</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc checks an mld packet to set if the group is all 0's</span>
<span class="comment-line">#     Supports tagged frames too.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Integer or 1 on pass 0 on fail</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># CheckMLDGeneralQueryGroup frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: VerifyTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::CheckMLDGeneralQueryGroup_764">proc <a href="MessageDecodingV6.tcl-annot.html#::::CheckMLDGeneralQueryGroup">::::CheckMLDGeneralQueryGroup</a></a></strong> { rawFrame {withRA &#34;yes&#34;} } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;86 DD&#34; {
         if {$withRA == &#34;yes&#34;} {
            if {[string range $rawFrame 210 256] == &#34;00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00&#34;} {
               return 1;
            } else {
               return 0;
            }
         } else {
            if {[string range $rawFrame 186 232] == &#34;00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00&#34;} {
               return 1;
            } else {
               return 0;
            }
         }
   }  &#34;81 00&#34; {
         if {$withRA == &#34;yes&#34;} {
            if {[string range $rawFrame 222 268] == &#34;00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00&#34;} {
               return 1;
            } else {
               return 0;
            }
         } else {
            if {[string range $rawFrame 198 244] == &#34;00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00&#34;} {
               return 1;
            } else {
               return 0;
            }
         }
   } default {
      <a name="::result_debug(19)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown IP Type: $type&#34;
      <span class="comment-line">#just return the type</span>
      return 0
   }
}
<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: GetMLDGroupAddr</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc returns the mcast group from an mld packet</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Space delimited v6 group address</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetMLDGroupAddr frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetMLDGroupAddr_817">proc <a href="MessageDecodingV6.tcl-annot.html#::::GetMLDGroupAddr">::::GetMLDGroupAddr</a></a></strong> { rawFrame {withRA &#34;yes&#34;} } {
   set type [string range $rawFrame 36 40]
   switch -- $type \
      &#34;86 DD&#34; {
         if {$withRA == &#34;yes&#34;} {
            return [string range $rawFrame 210 256];
         } else {
            return [string range $rawFrame 186 232];
         }
   }  &#34;81 00&#34; {
         if {$withRA == &#34;yes&#34;} {
            return [string range $rawFrame 222 268];
         } else {
            return [string range $rawFrame 198 244];
         }
   } default {
      <a name="::result_debug(20)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown IP Type: $type&#34;
      <span class="comment-line">#just return the type</span>
      return 0
   }
}

<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name: GetOSPFDesiredPktTypeV6</span>
<span class="comment-line">#</span>
<span class="comment-line"># Description: This proc is used to return the packets from rawPktList that match pktType,</span>
<span class="comment-line">#              srcIp and destIp</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args:  rawPktList, pktType, srcIp, dstIp</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return vlaue: Integer or &#34;&#34; on error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#  set OSPFHelloPackets [GetDesiredPktType $rawPortDataList IP_OSPFv2_HELLO $DUT1vlan1_3IP $ripMultiCastAddress]</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: VerifyTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetOSPFDesiredPktTypeV6_857">proc <a href="MessageDecodingV6.tcl-annot.html#::::GetOSPFDesiredPktTypeV6">::::GetOSPFDesiredPktTypeV6</a></a></strong> {rawPktList pktType srcIp dstIp} {

   set desiredPkts &#34;&#34;
   set prevPktFragFlag 0
   set sframe &#34;&#34;
   set dframe &#34;&#34;


<span class="comment-line">#Taking the first two bytes &amp; FF FE byte from sourec LLC address of rawframe</span>
<span class="comment-line">#Example FE 80 00 00 00 00 00 00 02 04 96 FF FE 1D 5A 80</span>

   set srcip &#34;FE 80 FF FE&#34;
   set desip &#34;FE 80 FF FE&#34;

<span class="comment-line">#Gettin the sourec LLC from the frame</span>
   if {[string length $rawPktList] &lt; 36} {
      return NOT_L3_PACKET
   }

   set type [string range $rawPktList 36 40]
   switch $type {
      &#34;81 00&#34; {set sframe [string range $rawPktList 78 124]}
      &#34;86 DD&#34; {set sframe [string range $rawPktList 66 112]}
      &#34;default&#34; {return NOT_L3_PACKET}
   }
  set srcframe  [concat [string range $sframe 0 4] [string range $sframe 33 37]]


<span class="comment-line">#Gettin the destniation LLC from the frame</span>

   set type [string range $rawPktList 36 40]
   switch -- $type \
      &#34;81 00&#34; {
      set dframe [string range $rawPktList 126 172]
   }  &#34;86 DD&#34; {
      set dframe [string range $rawPktList 114 160]
   }

set desframe  [concat [string range $dframe 0 4] [string range $dframe 33 37]]

set desmac [string range $rawPktList 3 7]
set srcmac [string range $rawPktList 21 25]


   set messageType [<a name="::GetOSPFMessageTypeV6(1)"><a href="./MessageDecodingV6.tcl.html#::GetOSPFMessageTypeV6_933">::GetOSPFMessageTypeV6</a></a> $rawPktList]

     <span class="comment-line"># Capture the packets from DUT1 to DRouters</span>
      if {[string equal $messageType $pktType] &amp;&amp; \
          [string equal $srcip $srcframe] &amp;&amp; \
          [string equal $desip $desframe] &amp;&amp; \
          [string equal $desmac $dstIp] &amp;&amp; \
          [string equal $srcmac $srcIp]} {
         return $messageType
      }
}



<span class="comment-line">#################################################################</span>
<span class="comment-line"># Procedure Name: GetOSPFMessageTypeV6</span>
<span class="comment-line">#</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to get the type of protocol and specific type in</span>
<span class="comment-line">#     that protocol. Currently, this proc supports OSPFV3 extensively.</span>
<span class="comment-line">#     Supports tagged frames too.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Automation supported message type or &#34;FAIL&#34; in error</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># GetMessageType frame</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: CaptureTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::GetOSPFMessageTypeV6_933">proc <a href="MessageDecodingV6.tcl-annot.html#::::GetOSPFMessageTypeV6">::::GetOSPFMessageTypeV6</a></a></strong> { rawFrame } {
   set type [string range $rawFrame 36 40]


 <span class="comment-line">#  result_debug &#34;the rawframe is $rawFrame&#34;</span>

   <span class="comment-line">#---- Verify OSPF for tagged frame</span>
   if {$type == &#34;81 00&#34;} {
   set ethTyp [string range $rawFrame 48 52]
   switch -- $ethTyp \
           &#34;86 DD&#34; {
               set proto [string range $rawFrame 72 73]
               switch -- $proto \
               &#34;59&#34; {
               set type [string range $rawFrame 177 178]
               set version [string range $rawFrame 175 175]
               switch -- $type \
               &#34;01&#34;  {
                  return &#34;IP_OSPFv${<a name="::version(1)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_HELLO&#34;
            }  &#34;02&#34;  {
                  return &#34;IP_OSPFv${<a name="::version(2)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_DATABASE&#34;
            }  &#34;03&#34;  {
                  return &#34;IP_OSPFv${<a name="::version(3)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_LINK_REQUEST&#34;
            }  &#34;04&#34;  {
                  return &#34;IP_OSPFv${<a name="::version(4)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_LINK_UPDATE&#34;
            }  &#34;05&#34;  {
                  return &#34;IP_OSPFv${<a name="::version(5)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_LINK_ACK&#34;
            }  default  {
                  <a name="::result_debug(21)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: IP_OSPFv${<a name="::version(6)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_$type&#34;
                  return &#34;IP_OSPFv${<a name="::version(7)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_$type&#34;
            }
       }

         }
    } elseif {$type == &#34;86 DD&#34;} {
               set proto [string range $rawFrame 60 61]
               switch -- $proto \
               &#34;59&#34; {
               set type [string range $rawFrame 165 166]
               set version [string range $rawFrame 163 163]
               switch -- $type \
               &#34;01&#34;  {
                  return &#34;IP_OSPFv${<a name="::version(8)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_HELLO&#34;
            }  &#34;02&#34;  {
                  return &#34;IP_OSPFv${<a name="::version(9)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_DATABASE&#34;
            }  &#34;03&#34;  {
                  return &#34;IP_OSPFv${<a name="::version(10)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_LINK_REQUEST&#34;
            }  &#34;04&#34;  {
                  return &#34;IP_OSPFv${<a name="::version(11)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_LINK_UPDATE&#34;
            }  &#34;05&#34;  {
                  return &#34;IP_OSPFv${<a name="::version(12)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_LINK_ACK&#34;
            }  default  {
                  <a name="::result_debug(22)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unknown Type: IP_OSPFv${<a name="::version(13)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_$type&#34;
                  return &#34;IP_OSPFv${<a name="::version(14)"><a href="./ePTClient.tcl.html#::version_470">::version</a></a>}_$type&#34;
            }
       }

   }
}

</pre>
<hr>
<div class="index-selector">
	<a href="index_main.html#byfilename">file name</a> 
 | 
	<a href="index_main.html#byprocname">procedure name</a> 
 | 
	<a href="index_main.html#bycall">procedure call</a> 
 | 
	<a href="index_annot_full.html">annotation</a> 

<br>
<cite>File generated 2018-06-14 at 17:09.</cite>
</div>

</body>
</html>
