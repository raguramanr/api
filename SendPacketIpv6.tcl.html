<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/transitional.dtd">
<!-- Generated by TclDoc @@VERSION@@ -->
<html>
<head>
  <title>SendPacketIpv6.tcl</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="default.css">
</head>
<body class="src-html">
<div class="index-selector">
<!-- index for tcl source files -->
	Index by: 
	<a href="index_main.html#SendPacketIpv6.tcl">file name</a> | 
	<a href="index_main.html#byprocname">procedure name</a> | 
	<a href="index_main.html#bycall">procedure call</a> | 
	<a href="index_annot_full.html">annotation</a>

</div>
<hr>

<p><strong>SendPacketIpv6.tcl</strong>&nbsp;&nbsp;<span class="filetype-link">(<a href="SendPacketIpv6.tcl-annot.html">annotations</a> | <a href="SendPacketIpv6.tcl.txt">original source</a>)</span>
</p>
<pre class="src-code">
<strong><a name="::::SendIpv6Frame_1">proc <a href="SendPacketIpv6.tcl-annot.html#::::SendIpv6Frame">::::SendIpv6Frame</a></a></strong> {args} {
     <a name="::parse_args(1)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> SendIpv6Frame $args {
     txPortId &#34;1&#34;
     rxPortId &#34;0&#34;
     <a name="::protocol(1)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a> &#34;ipV6&#34;
     nHeader &#34;tcp&#34;
     trafficClass &#34;3&#34;
     flowLabel &#34;0&#34;
     hopLimit  &#34;255&#34;
     <span class="comment-line">#sourceMac &#34;default&#34;</span>
     <span class="comment-line">#destMac &#34;00 00 00 00 00 02&#34;</span>
     sourceMac &#34;default&#34;
     destMac &#34;00 e0 2b 00 00 01&#34;
     sourceIp &#34;335:5555:6666:6666:7777:7777:8888:8888&#34;
     destIp &#34;FE80:0:0:0:2A1:F1FF:FE00:1&#34;
     dIpMask &#34;0:ffff:ffff:ffff:0:ffff:ffff:ffff&#34;
     sIpMask &#34;0:ffff:ffff:ffff:0:ffff:ffff:ffff&#34;
     sourcePort &#34;0&#34;
     destPort &#34;0&#34;
     goodChecksum &#34;true&#34;
     numFrames &#34;1&#34;
     frameSize &#34;128&#34;
     frameSizeType &#34;sizeFixed&#34;
     frameRate &#34;default&#34;
     frameType &#34;86 DD&#34;
     dataPattern &#34;0000&#34;
     streamType &#34;stopStream&#34;
     fcsError &#34;good&#34;
     tag &#34;none&#34;
     tagMode &#34;vIdle&#34;
     tagRepeat &#34;1&#34;
     percentage &#34;1&#34;
     saMode &#34;idle&#34;
     daMode &#34;idle&#34;
     saCount &#34;&#34;
     daCount &#34;&#34;
     ipSaMode &#34;ipV6Idle&#34;
     ipDaMode &#34;ipV6Idle&#34;
     ipSaCount &#34;&#34;
     ipDaCount &#34;&#34;
     tcpSynFlag &#34;false&#34;
     tcpFinFlag &#34;false&#34;
     tcpRstFlag &#34;false&#34;
     tcpAckFlag &#34;false&#34;
     tcpPushFlag &#34;false&#34;
     tcpUrgFlag &#34;false&#34;
     tcpSeqNum &#34;0&#34;
     type &#34;8&#34;
     code &#34;0&#34;
     id &#34;0&#34;
     sequence &#34;0&#34;
     direction &#34;1Way&#34;
     maxResponseTime &#34;100&#34;
     applyFilter &#34;0&#34;
     udfEnable &#34;false&#34;
     udfInitval &#34;00&#34;
     udfOffset &#34;0&#34;
     udfCountertype &#34;c8&#34;
     udfContinuousCount &#34;false&#34;
     udfUpdown &#34;uuuu&#34;
     udfRepeat &#34;1&#34;
     udfStep &#34;1&#34;
     clearStats &#34;yes&#34;
     dontTx &#34;0&#34;
     udpInvalidCheckSum &#34;0&#34;
    	 }
	
    set numIxiaCd [<a name="::::GetNumIxiaCd(1)"><a href="./SystemSetup.tcl.html#::::GetNumIxiaCd_546">::::GetNumIxiaCd</a></a> $txPortId]
    <a name="::MapIxiaPortId(1)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $txPortId chasisId card port
    if {$rxPortId==0} {
      set rxPortId $txPortId
    }
	
   <a name="::MapIxiaPortId(2)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $rxPortId ch c rxPort
   global portMappingList

   set portList [lindex $portMappingList [expr $txPortId-1]]
   <a name="::result_debug(1)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;INFO: DUT[lindex $portList 2] [lindex $portList 1] \
                               ingresses from portId [lindex $portList 0]&#34;

   if {$tag != &#34;none&#34; } { set wTag &#34;true&#34; } else {set wTag &#34;false&#34; }
   	global startCardNum
   	set frameSent [<a name="::ixiaConf_2Ports_ipv6(1)"><a href="./ePTL3TxIpv6.tcl.html#::ixiaConf_2Ports_ipv6_32">::ixiaConf_2Ports_ipv6</a></a> -numIxiaCd $numIxiaCd \
                  -txChas $chasisId -txCard $card -txPort $port \
		  -startCardNum $startCardNum  -rxChas $ch -rxCard $c \
                  -rxPort $rxPort -frameType $frameType \
                  -ipProtocol $protocol -sMacAddr $sourceMac \
                  -dMacAddr $destMac -sIpAddr $sourceIp -dIpAddr $destIp \
                  -flowLabel $flowLabel -trafficClass $trafficClass \
                  -pSrcPort $sourcePort -pDstPort $destPort -frameSizeType \
                  $frameSizeType -hopLimit $hopLimit \
                  -numFrames $numFrames -frameSize $frameSize \
                  -percentage $percentage -frameRate $frameRate -dataPattern \
                  $dataPattern -streamType $streamType \
                  -wTag $wTag -tagNo $tag -tagMode $tagMode \
                  -tagRepeat $tagRepeat -direction $direction -saMode $saMode \
                  -saCount $saCount -daMode $daMode -daCount $daCount \
                  -ipSaMode $ipSaMode -ipSaCount $ipSaCount -ipDaMode \
                  $ipDaMode -ipDaCount $ipDaCount \
                 -dIpMask $dIpMask sIpMask $sIpMask  -nHeader $nHeader \
                 -tcpSeqNum $tcpSeqNum -tcpSynFlag $tcpSynFlag \
                 -tcpFinFlag $tcpFinFlag \
                 -tcpPushFlag $tcpPushFlag -tcpUrgFlag $tcpUrgFlag \
                 -tcpRstFlag $tcpRstFlag -tcpAckFlag $tcpAckFlag \
                 -sequence $sequence -type $type -code $code \
                 -id $id -applyFilter $applyFilter -maxResponseTime \
                 $maxResponseTime  -udfEnable $udfEnable -udfInitval \
                 $udfInitval -udfOffset $udfOffset -udfCountertype \
                 $udfCountertype -udfContinuousCount $udfContinuousCount \
                 -udfUpdown $udfUpdown -udfRepeat $udfRepeat -udfStep $udfStep \
                 -clearStats $clearStats -dontTx $dontTx \
                 -invalidUdpChk $udpInvalidCheckSum ]

  if {$streamType != &#34;contPacket&#34; &amp;&amp; $numFrames &gt; 100 &amp;&amp; $dontTx==0} {
    	<a name="::ixiaCheckTxDone(1)"><a href="./ePTMisc.tcl.html#::ixiaCheckTxDone_334">::ixiaCheckTxDone</a></a> $chasisId $card $port $numFrames $txPortId
  }
  	return $frameSent
  }

<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name: CookIPv6Addr</span>
<span class="comment-line">#</span>
<span class="comment-line"># Description: Translate v6 addresses from / to many formats</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: In address, output format</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: Returns the packet sent</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#               set newIPv6 [CookIPv6Addr 3ffe::1:2 space]</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,</span>
<span class="comment-line">#                VerifySwitchOutput,  VerifyTraffic)</span>
<span class="comment-line"># Category: CookIPv6Addr</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::CookIPv6Addr_138">proc <a href="SendPacketIpv6.tcl-annot.html#::::CookIPv6Addr">::::CookIPv6Addr</a></a></strong> {Addr {output colon}} {
   set mode &#34;&#34;
   set v6Addr &#34;&#34;
   regsub -all {\:\:} &#34;$Addr&#34; &#34;X&#34; Addr1;
   
   <span class="comment-line"># 3ffe:2::1</span>
   set aList [split $Addr1 X]
   if {[llength $aList] &gt; 1} {
      <span class="comment-line">#Work on the left side of the ::</span>
      set mode &#34;short&#34;
      <span class="comment-line">#result_debug &#34;MODE = Short&#34;</span>
      set v6List &#34;&#34;
      regsub -all {\:} [lindex $aList 0] &#34;X&#34; AddrLeft;
      regsub -all {\:} [lindex $aList 1] &#34;X&#34; AddrRight;
      set bList [split $AddrLeft &#34;X&#34;]
      set leftCount [llength $bList]
      foreach leftBlock $bList {
         if {[string length $leftBlock] &lt; 4} {
            if {[string length $leftBlock] == 1} {
               set newBlock &#34;000$leftBlock&#34;
            } elseif {[string length $leftBlock] == 2} {
               set newBlock &#34;00$leftBlock&#34;
            } elseif {[string length $leftBlock] == 3} {
               set newBlock &#34;0$leftBlock&#34;
            } else {
               set newBlock $leftBlock
            }
         } else {
            set newBlock $leftBlock
         }
         lappend v6List $newBlock
      }
      <span class="comment-line">#Work on the right side of the address</span>
      set cList [split $AddrRight &#34;X&#34;]
      set rightCount [llength $cList]
      <span class="comment-line">#At this point we know how many null words have been skipped</span>
      <span class="comment-line">#  by the use of ::</span>
      set skipCount [expr 8 - $rightCount - $leftCount]
      for {set x 0} {$x&lt;$skipCount} {incr x} {
         lappend v6List &#34;0000&#34;;
      }
      foreach rightBlock $cList {
         if {[string length $rightBlock] &lt; 4} {
            if {[string length $rightBlock] == 1} {
               set newBlock &#34;000$rightBlock&#34;
            } elseif {[string length $rightBlock] == 2} {
               set newBlock &#34;00$rightBlock&#34;
            } elseif {[string length $rightBlock] == 3} {
               set newBlock &#34;0$rightBlock&#34;
            } else {
               set newBlock $rightBlock
            }
         } else {
            set newBlock $rightBlock
         }
         lappend v6List $newBlock
      }
      if {$output == &#34;colon&#34;} {
         set cookedAddr [join $v6List &#34;:&#34;]
      } else {
         foreach word $v6List {
            lappend newList [string range $word 0 1 ]
            lappend newList [string range $word 2 3 ]
         }
         set cookedAddr [join $newList &#34; &#34;]
      }
   } else {
      <span class="comment-line"># This will be a 16 word colon delimited addr passed in</span>
      <span class="comment-line">#   Probably the only desired output is byte spaced</span>
      regsub -all {\:} &#34;$Addr&#34; &#34;X&#34; Addr1;
      <span class="comment-line"># -- split the v6Addr by colon</span>
      set aList [split $Addr1 X]
      if {$mode != &#34;short&#34; &amp;&amp; [llength $aList] == &#34;8&#34;} {
         set mode &#34;normal&#34;
         <span class="comment-line">#result_debug &#34;MODE = NORMAL&#34;</span>
   
         <span class="comment-line"># -- split the v6Addr by colon</span>
         
         set v6List &#34;&#34;
         foreach block $aList {
            if {[string length $block] &lt; 4} {
               if {[string length $block] == 1} {
                  set newBlock &#34;000$block&#34;
               } elseif {[string length $block] == 2} {
                  set newBlock &#34;00$block&#34;
               } elseif {[string length $block] == 3} {
                  set newBlock &#34;0$block&#34;
               } else {
                  set newBlock $block
               }
            } else {
               set newBlock $block
            }
            if {$output == &#34;space&#34;} {
               lappend v6List [string range $newBlock 0 1 ]
               lappend v6List [string range $newBlock 2 3 ]
            } else {
               <span class="comment-line"># A 8 word colon delimited addr was input and colon out desired</span>
               lappend v6List $block
            }
         }
         if {$output == &#34;space&#34;} {
            set cookedAddr [join $v6List &#34; &#34;]            
         } else {
            <span class="comment-line"># A 8 word colon delimited addr was input and colon out desired</span>
            set cookedAddr [join $v6List &#34;:&#34;]
         }

      }
      <span class="comment-line"># This will be a 16 byte space delimited addr passed in</span>
      <span class="comment-line">#   </span>
      set aList [split $Addr1 &#34; &#34;]
      if {$mode != &#34;normal&#34; &amp;&amp; $mode != &#34;short&#34; &amp;&amp; [llength $aList] == &#34;16&#34;} {
         set mode &#34;space&#34;
         <span class="comment-line">#result_debug &#34;MODE = Space&#34;</span>
         <span class="comment-line"># -- split the v6Addr by colon</span>
         set v6List &#34;&#34;
         for {set i 0} {$i&lt;16} {incr i 2} {
            lappend v6List &#34;[lindex $aList $i][lindex $aList [expr $i + 1]]&#34;
         }
         <span class="comment-line">#result_debug &#34;\nOutput: $output&#34;</span>
         set cookedAddr [join $v6List &#34;:&#34;]
      }
   }
   if {$mode != &#34;normal&#34; &amp;&amp; $mode != &#34;short&#34; &amp;&amp; $mode != &#34;space&#34;} {
      set cookedAddr &#34;ERROR: no address matches&#34;
   }
   <span class="comment-line"># -- join by space</span>
   
   <span class="comment-line"># -- to upper case</span>
   set cookedAddr [string toupper $cookedAddr]
   <span class="comment-line">#result_debug &#34;cookedAddr=$cookedAddr&#34;</span>
   return $cookedAddr
}

<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name: SendNDMessage</span>
<span class="comment-line">#</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     This proc is used to send a neighbor advertisement of solicit.</span>
<span class="comment-line">#</span>
<span class="comment-line">#     Use ipSaMode &#34;incrIPv6&#34; and NumFrames to incr SA</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: args</span>
<span class="comment-line">#</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: Neighbor Messages in ixia raw frame format</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#     set NeighborMsg [SendNDMessage -mType &#34;adv&#34; \</span>
<span class="comment-line">#           -sourceMac -destMac ]</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,</span>
<span class="comment-line">#     VerifySwitchOutput,VerifyTraffic)</span>
<span class="comment-line"># Category: SendTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::SendNDMessage_293">proc <a href="SendPacketIpv6.tcl-annot.html#::::SendNDMessage">::::SendNDMessage</a></a></strong> {args} {
   <a name="::parse_args(2)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> SendNDMessage $args {
      txPortId        &#34;1&#34;
      <a name="::protocol(2)"><a href="./ePTClient.tcl.html#::protocol_728">::protocol</a></a>        &#34;ipV6&#34;
      destMac         &#34;33:33:00:00:00:11&#34;
      sourceMac       &#34;default&#34;
      sourceIp        &#34;fe80::02a1:f1ff:fe00:0001&#34;
      destIp          &#34;3ffe:0001:0000:0000:0000:0000:0000:0002&#34;
      targetAddr      &#34;3ffe:0002:0000:0000:0000:0000:0000:0002&#34;
      numFrames       &#34;1&#34;
      ipSaMode        &#34;ipV6Idle&#34;
      sIpMask         &#34;96&#34;
      tag             &#34;none&#34;
      percentage      &#34;1&#34;
      frameRate       &#34;default&#34;
      ndType          &#34;00&#34;
      ndLength        &#34;00&#34;
      ndLinkLocal     &#34;00:a1:f1:00:00:01&#34;
      mType           &#34;adv&#34;
      advType         &#34;OverRide&#34;
      ipV6HopLimit    &#34;255&#34;
      mCode           &#34;00&#34;
   }

   set ndLinkLocal [<a name="::cookMacForIxia(1)"><a href="./misc.tcl.html#::cookMacForIxia_61">::cookMacForIxia</a></a> $ndLinkLocal];
   
   if {$mType == &#34;adv&#34;} {
      switch $advType {
         &#34;OverRide&#34; {set advTypeValue &#34;20 00 00 00&#34;; set advTypeValue2 &#34; 20 00 00 00 &#34;;}
         &#34;Solicited&#34; {set advTypeValue &#34;40 00 00 00&#34;; set advTypeValue2 &#34; 40 00 00 00 &#34;;}
         &#34;Router&#34; {set advTypeValue &#34;80 00 00 00&#34;; set advTypeValue2 &#34; 80 00 00 00 &#34;;}
         &#34;Solicited_OverRide&#34; {set advTypeValue &#34;60 00 00 00&#34;; set advTypeValue2 &#34; 60 00 00 00 &#34;;}
         default {set advTypeValue &#34;20 00 00 00&#34;; set advTypeValue2 &#34; 20 00 00 00 &#34;;}
      }
   } else {
      set advTypeValue &#34;00 00 00 00&#34;;
      set advTypeValue2 &#34; 00 00 00 00 &#34;;
   }

   set sIPCSum  [<a name="::CookIPv6Addr(1)"><a href="./SendPacketIpv6.tcl.html#::CookIPv6Addr_138">::CookIPv6Addr</a></a> &#34;$sourceIp&#34; space]
   set dIPCSum  [<a name="::CookIPv6Addr(2)"><a href="./SendPacketIpv6.tcl.html#::CookIPv6Addr_138">::CookIPv6Addr</a></a> &#34;$destIp&#34; space]
   set targetCSum [<a name="::CookIPv6Addr(3)"><a href="./SendPacketIpv6.tcl.html#::CookIPv6Addr_138">::CookIPv6Addr</a></a> &#34;$targetAddr&#34; space]

   if {$mType == &#34;sol&#34;} {
      set mValue &#34;87&#34;
      set type 135
   } elseif {$mType == &#34;adv&#34;} {
      set mValue &#34;88&#34;
      set type 136
   } else {
      <a name="::result_error(1)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Neighbor Discovery Function: ONLY Solicit (sol) and Advertisements (adv) are Supported&#34;
      <a name="::close_result_file(1)"><a href="./result.tcl.html#::close_result_file_363">::close_result_file</a></a>
      <a name="::report_end_test(1)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>
      return -code return
   }
   <span class="comment-line"># Get the checksum</span>
   set cSum [<a name="::GetICMPv6Checksum(1)"><a href="./Checksum.tcl.html#::GetICMPv6Checksum_93">::GetICMPv6Checksum</a></a> -sourceIp &#34;$sIPCSum&#34; \
      -destIp &#34;$dIPCSum&#34; \
      -type $type \
      -code $mCode \
      -advTypeValue $advTypeValue \
      -ndTargetAddr &#34;$targetCSum&#34; \
      -ndType $ndType \
      -ndLength $ndLength \
      -ndLinkLayerAddr $ndLinkLocal ]

   set newTargetAddr [<a name="::CookIPv6Addr(4)"><a href="./SendPacketIpv6.tcl.html#::CookIPv6Addr_138">::CookIPv6Addr</a></a> &#34;$targetAddr&#34; space]

   <span class="comment-line"># Need to overwrite the next header as 3A and also decrement the csum if incr ND</span>
   if {$ipSaMode == &#34;incrIPv6&#34;} {
      set ipSaMode 5;
      set sIpMask  96;
      set udfEnable &#34;true&#34; 
      set udfContinuousCount &#34;false false&#34;
      set udfInitval &#34;3A \&#34;$cSum\&#34;&#34;
      if {$tag == &#34;none&#34;} {
         set udfOffset &#34;20 56&#34;
      } else {
         set udfOffset &#34;24 60&#34;
      }
      set udfCountertype &#34;c8 c16&#34;
      set udfUpdown &#34;uuuu dduu&#34;
      set udfRepeat &#34;1 $numFrames&#34;
      set udfStep &#34;1 1&#34;
   } else {
      set ipSaMode &#34;ipV6Idle&#34;;
      set sIpMask  0;
      set udfEnable &#34;true&#34; 
      set udfContinuousCount &#34;false&#34;
      set udfInitval &#34;3A&#34;
      if {$tag == &#34;none&#34;} {
         set udfOffset &#34;20&#34;
      } else {
         set udfOffset &#34;24&#34;
      }
      set udfCountertype &#34;c8&#34;
      set udfUpdown &#34;uuuu&#34;
      set udfRepeat &#34;1&#34;
      set udfStep &#34;1&#34;
   }      
   <span class="comment-line"># Set the frame size</span>
   if {$tag != &#34;none&#34;} {
      <span class="comment-line">#If tagged</span>
      if {$mType == &#34;adv&#34;} {
         set frameSize 94
      } elseif {$mType == &#34;sol&#34;} {
         set frameSize 94
      }
   } else {
      if {$mType == &#34;adv&#34;} {
         set frameSize 90
      } elseif {$mType == &#34;sol&#34;} {
         set frameSize 90
      }
   }

   set dataPattern &#34;$mValue $mCode $cSum${advTypeValue2}$newTargetAddr $ndType $ndLength $ndLinkLocal&#34;
   <span class="comment-line">#result_debug &#34;Data = $dataPattern&#34;</span>
   set streamSent [<a name="::SendIpv6Frame(1)"><a href="./SendPacketIpv6.tcl.html#::SendIpv6Frame_1">::SendIpv6Frame</a></a> -txPortId $txPortId -sourceIp &#34;$sourceIp&#34; -destIp &#34;$destIp&#34; \
      -destMac &#34;$destMac&#34; -numFrames $numFrames -tag $tag -frameSize $frameSize -frameRate $frameRate \
      -percentage &#34;$percentage&#34; -nHeader &#34;ipV6NoNextHeader&#34; -sourceMac $sourceMac \
      -dataPattern &#34;$dataPattern&#34; -hopLimit $ipV6HopLimit -ipSaMode $ipSaMode -sIpMask $sIpMask \
      -udfEnable &#34;true&#34; -udfContinuousCount &#34;$udfContinuousCount&#34; -udfUpdown &#34;$udfUpdown&#34; \
      -udfRepeat &#34;$udfRepeat&#34; -udfInitval &#34;$udfInitval&#34; -udfOffset &#34;$udfOffset&#34; \
      -udfCountertype &#34;$udfCountertype&#34; -udfStep &#34;$udfStep&#34;]

   <a name="::displayNDPacketFormat(1)"><a href="./SendPacketIpv6.tcl.html#::displayNDPacketFormat_443">::displayNDPacketFormat</a></a> -txPortId $txPortId -destMac $destMac -ipSaMode $ipSaMode \
      -sourceMac $sourceMac -sourceIp $sourceIp -destIp $destIp -frameRate $frameRate \
      -targetAddr $newTargetAddr -mType $mType -mCode $mCode -tag $tag \
      -advType $advType -ndType $ndType -ndLength $ndLength -ndLinkLocal $ndLinkLocal \
      -percentage $percentage -numFrames $numFrames -frameSent $streamSent
}

<span class="comment-line">##################################################################    </span>
<span class="comment-line"># Procedure Name: displayNDPacketFormat</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     	Displays the decoded version of a MLD packet sent over</span>
<span class="comment-line">#       the specified port.</span>
<span class="comment-line"># Input args: </span>
<span class="comment-line"># Output args:  None</span>
<span class="comment-line"># Return value: None</span>
<span class="comment-line"># Typical usage: </span>
<span class="comment-line">#   displayNDPacketFormat -txPortId $txPortId -destMac $destMac \</span>
<span class="comment-line">#      -sourceMac $sourceMac -sourceIp $sourceIp -destIp $destIp \</span>
<span class="comment-line">#      -targetAddr $newTargetAddr -mType $mType -mCode $mCode -tag $tag \</span>
<span class="comment-line">#      -advType $advType -ndType $ndType -ndLength $ndLength \ </span>
<span class="comment-line">#      -ndLinkLocal $ndLinkLocal\</span>
<span class="comment-line">#      -percentage $percentage -numFrames $numFrames -frameSent $streamSent </span>
<span class="comment-line"># Category: Utility</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::displayNDPacketFormat_443">proc <a href="SendPacketIpv6.tcl-annot.html#::::displayNDPacketFormat">::::displayNDPacketFormat</a></a></strong> {args} {
  <a name="::parse_args(3)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> displayMLDPacketFormat $args {
      txPortId    &#34;1&#34;
      destMac     &#34;33:33:00:00:00:11&#34;
      sourceMac   &#34;00:A1:f1:00:00:01&#34;
      sourceIp    &#34;fe80::02a1:f1ff:fe00:0001&#34;
      destIp      &#34;ff02:0000:0000:0000:0000:0000:0000:0002&#34;
      targetAddr  &#34;ff02:0000:0000:0000:0000:0000:0000:0002&#34;
      numFrames   &#34;1&#34;
      tag         &#34;none&#34;
      percentage  &#34;1&#34;
      frameRate   &#34;default&#34;
      mCode       &#34;00&#34;
      mType       &#34;adv&#34;
      advType     &#34;OverRide&#34;
      frameSent   &#34;none&#34;
      ndType      &#34;00&#34;
      ndLength    &#34;00&#34;
      ndLinkLocal &#34;00 00 00 00 00 00&#34;
      ipSaMode    &#34;ipV6Idle&#34;
   }
  set strType &#34;packet&#34;
  set numPacket $numFrames

  switch $mType {
     &#34;adv&#34; {set messageType &#34;Advertisement&#34;;}
     &#34;sol&#34; {set messageType &#34;Solicitation&#34;;}
     default {set messageType &#34;ERROR&#34;;}
  }
  
  <a name="::result_debug(2)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Transmit $numFrames Neighbor $messageType from portId $txPortId&#34;

  <a name="::result_debug(3)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$frameSent&#34;
  <a name="::result_debug(4)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34; &#34;

  set space1 14
  set space2 39
  set space3 53

  set str [format &#34;%-*s %s&#34; $space1 DestMac: $destMac]
  set str [format &#34;%-*s %s&#34; $space2 $str srcMac:]
  set str [format &#34;%-*s %s&#34; $space3 $str $sourceMac]
  <a name="::result_debug(5)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$str&#34;

  if {$tag != &#34;none&#34;} {
     set str [format &#34;%-*s %s&#34; $space1 Tag: $tag]
     set str [format &#34;%-*s %s&#34; $space2 $str txPerc:]
     set str [format &#34;%-*s %s&#34; $space3 $str $percentage]
     <a name="::result_debug(6)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$str&#34;
  } else {
     if {$frameRate != &#34;default&#34;} {
        set str [format &#34;%-*s %s&#34; $space1 frameRate: $frameRate]
        <a name="::result_debug(7)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$str&#34;
     } else {
        set str [format &#34;%-*s %s&#34; $space1 txPerc: $percentage]
        <a name="::result_debug(8)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$str&#34;
     }
  }

  set str [format &#34;%-*s %s&#34; $space1 ND_Type: $messageType]
  set str [format &#34;%-*s %s&#34; $space2 $str ICMP_Code:]
  set str [format &#34;%-*s %s&#34; $space3 $str $mCode]
  <a name="::result_debug(9)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$str&#34;

  if {$ipSaMode == &#34;5&#34;} {
  set str [format &#34;%-*s %s&#34; $space1 Incr_ND: $numPacket]
  <a name="::result_debug(10)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$str&#34;
  }

  if {$mType == &#34;adv&#34;} {
     set str [format &#34;%-*s %s&#34; $space1 Adv_Type: $advType]
     set str [format &#34;%-*s %s&#34; $space2 $str NDTypeLength:]
     set str [format &#34;%-*s %s&#34; $space3 $str ${ndType}${ndLength}]
     <a name="::result_debug(11)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$str&#34;     
  } else {
     <span class="comment-line">#set str [format &#34;%-*s %s&#34; $space1 DestIpV6Addr: $destIp]</span>
     <span class="comment-line">#result_debug &#34;$str&#34;</span>
  }
  set str [format &#34;%-*s %s&#34; $space1 TrgtLinkLocal: $ndLinkLocal]
  <a name="::result_debug(12)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$str&#34; 
  set str [format &#34;%-*s %s&#34; $space1 DestIpV6Addr: $destIp]
  <a name="::result_debug(13)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$str&#34;
  set str [format &#34;%-*s %s&#34; $space1 ND_TargetAddr: $targetAddr]
  <a name="::result_debug(14)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$str&#34;
  set str [format &#34;%-*s %s&#34; $space1 SrcIpV6Addr: $sourceIp]
  <a name="::result_debug(15)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$str&#34;

  <a name="::result_debug(16)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34; &#34;
}

</pre>
<hr>
<div class="index-selector">
	<a href="index_main.html#byfilename">file name</a> 
 | 
	<a href="index_main.html#byprocname">procedure name</a> 
 | 
	<a href="index_main.html#bycall">procedure call</a> 
 | 
	<a href="index_annot_full.html">annotation</a> 

<br>
<cite>File generated 2018-06-14 at 17:09.</cite>
</div>

</body>
</html>
