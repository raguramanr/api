<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/transitional.dtd">
<!-- Generated by TclDoc @@VERSION@@ -->
<html>
<head>
  <title>poweroutlet.tcl</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="default.css">
</head>
<body class="src-html">
<div class="index-selector">
<!-- index for tcl source files -->
	Index by: 
	<a href="index_main.html#poweroutlet.tcl">file name</a> | 
	<a href="index_main.html#byprocname">procedure name</a> | 
	<a href="index_main.html#bycall">procedure call</a> | 
	<a href="index_annot_full.html">annotation</a>

</div>
<hr>

<p><strong>poweroutlet.tcl</strong>&nbsp;&nbsp;<span class="filetype-link">(<a href="poweroutlet.tcl-annot.html">annotations</a> | <a href="poweroutlet.tcl.txt">original source</a>)</span>
</p>
<pre class="src-code">
<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: login_pwr_outlet</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: </span>
<span class="comment-line">#   Internal proc that is used to login to 3 supported power outlets apc, wti</span>
<span class="comment-line">#   or Mariner MEAD card.</span>
<span class="comment-line">#   returns error or ok</span>
<span class="comment-line"># Input args:</span>
<span class="comment-line">#     ipAddr - Ip address of the power cycle device used to login</span>
<span class="comment-line">#                </span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: apc/wti/mead or error on failure</span>
<span class="comment-line">#              </span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage: </span>
<span class="comment-line">#</span>
<span class="comment-line">#    set returnCode [login_pwr_outlet $ipAddr]</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::login_pwr_outlet_22">proc <a href="poweroutlet.tcl-annot.html#::::login_pwr_outlet">::::login_pwr_outlet</a></a></strong> {ipAddr {numRetry 5}  {backOffTime 10} {password &#34;extreme&#34;}} {
    global spawn_id
    global spawn_ids
    global telnet_pid
    global MAIN
 
    ;<span class="comment-line"># We try several times to spawn telnet because only 1 telnet session is allowed</span>
    ;<span class="comment-line"># per power cycler.  In the event there is already one connected, we backOff then</span>
    ;<span class="comment-line"># retry.</span>
    if {![info exists MAIN(tmpSpawnIds)]} {
        set MAIN(tmpSpawnIds) &#34;&#34;
    }

    for {set i 0}  {$i &lt; $numRetry} {incr i} {
        set connectStatus 1
        set pTry 0
        if [catch &#34;spawn telnet $ipAddr&#34; reason] {
            <a name="::result_warning(1)"><a href="./ql_multi.tcl.html#::result_warning_407">::result_warning</a></a> &#34;failed to spawn program: $reason\n&#34;
        }
        set telnet_pid $reason
        if {[lsearch $MAIN(tmpSpawnIds) $spawn_id] &lt; 0} {
            lappend MAIN(tmpSpawnIds) $spawn_id
        }
       
        set timeout 2
        <a name="::result_debug(1)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Login telnet $ipAddr,  pid=$spawn_id&#34;
        <span class="comment-line">#wait for connection</span>
        after 700
        send &#34;\r&#34;	
        expect {
            &#34;?nable to ?onnect&#34; {
                expect *
                <a name="::result_warning(2)"><a href="./ql_multi.tcl.html#::result_warning_407">::result_warning</a></a> &#34;Unable to connect&#34;		
                set connectStatus 0
            }
            &#34;closed by foreign host&#34; {
                <a name="::result_warning(3)"><a href="./ql_multi.tcl.html#::result_warning_407">::result_warning</a></a> &#34;Connection closed by foreign host exp $expect_out(buffer)&#34;
                set connectStatus 0
            }
            &#34;Connection refused&#34; {
                <a name="::result_warning(4)"><a href="./ql_multi.tcl.html#::result_warning_407">::result_warning</a></a> &#34;Connection refused&#34;
                set connectStatus 0
            }
            &#34;User Name : &#34; {
                send &#34;apc\r&#34;
                expect -re &#34;assword :*&#34;
                send &#34;apc\r&#34;
                expect {
                    &#34; Control Console &#34; {
                        send &#34;\r&#34;
                        expect -re &#34;&gt; &#34;
                        return &#34;apc&#34;
                    }
                    &#34;apc&gt;&#34; {
                        return &#34;apc2016&#34;
                    }
                }
            }
            &#34;login: &#34; {
                send &#34;extreme\r&#34;
                expect -re &#34;Password*&#34;
                send &#34;$password\r&#34;
                expect -re &#34;&gt; &#34;
                puts &#34;sent extreme and $password&#34;
                return &#34;mpc&#34;
            }
            &#34;MPC&gt;&#34; {
                send &#34;\r&#34;
                expect &#34;MPC&gt;&#34;
                return &#34;mpc&#34;
            }
            &#34;Username:&#34; {
                send &#34;extreme\r&#34;
                expect &#34;Password:&#34;
                send &#34;extreme\r&#34;
                expect {
                    &#34;LX:&#34; {
                        return &#34;mrv&#34;
                    }
                    &#34;Sentry:&#34; {
                        return &#34;mrv_sentry&#34;
                    }
                    &#34;Switched CDU:&#34; {
                        puts &#34;***\nSentry Switched CDU\n***&#34;
                        return &#34;mrv_sentry&#34;
                    }
                    -re &#34;Welcome to&#34; {
                        puts &#34;***\nDUALCOM DUALCOM\n***&#34;
                        return &#34;dualcom&#34;
                    }
                }
            }   
            &#34;Enter Password&#34; {
                send &#34;$password\r&#34;
                expect &#34;PS&gt;&#34;
                return &#34;wti_ips&#34;
            }
            &#34;NPS&gt;&#34; {
                puts &#34;1 send /s $spawn_id&#34;
                send &#34;/S\r&#34;
                expect {
                    -re &#34;NPS&gt;|NPS&gt; &#34; {
                        puts &#34;1 return wti_nps&#34;
                        return &#34;wti_nps&#34;
                    } 
                    &#34;&lt;ESC&gt; to quit&#34; {
                        puts &#34;1 continue&#34;
                        send &#34;\r&#34;
                        exp_continue;
                    }
                }
            }
            &#34;NPS&gt; &#34; {
                puts &#34;2 send /s&#34;
                send &#34;/S\r&#34;
                expect {
                    &#34;NPS&gt; &#34; {
                        puts &#34;2 return wti_nps&#34;
                        return &#34;wti_nps&#34;
                    }
                    &#34;&lt;ESC&gt; to quit&#34; {
                        puts &#34;2 continue&#34;
                        send &#34;\r&#34;
                        exp_continue;
                    }
                }
            }
            &#34;IPS&gt;&#34; {
                send &#34;\/Sr&#34;
                expect &#34;IPS&gt;&#34;
                return &#34;wti_ips&#34;
            }
            &#34;Mead&#34; {
                return &#34;mead&#34;
            }
            &#34;for command menu&#34; {
                return &#34;mead&#34;
            }
            timeout {
                incr pTry
                if {$pTry &lt; 4} {
                    puts &#34;timeout $pTry&#34;
                    <span class="comment-line">#want to get a Login prompt or #</span>
                    send &#34;\r&#34;
                    exp_continue
                } else {
                    puts &#34;timeout $pTry&#34;
                    <span class="comment-line">#want to get a Login prompt or #</span>
                    send &#34;\r&#34;
                    catch {close -i $spawn_id} why
                }
            }
        }
    
        if {$connectStatus == 0} {
            <a name="::result_warning(5)"><a href="./ql_multi.tcl.html#::result_warning_407">::result_warning</a></a> &#34;($i) Failed to spawn telnet to powerCycler: $reason...\
                retrying after $backOffTime secs\n&#34;
            <a name="::exSleep(1)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> $backOffTime
        }
    }

    <a name="::result_debug(2)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;After $numRetry attempts, we failed to connect to \
        PowerCycler at $ipAddr: $reason\n&#34;
    return &#34;error&#34;
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: power_cycle_apc</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: </span>
<span class="comment-line">#   Internal proc that is used to power cycle a apc device</span>
<span class="comment-line">#   Returns 1 on success</span>
<span class="comment-line"># Input args:</span>
<span class="comment-line">#     outletList - outlet List of the device to be power cycled</span>
<span class="comment-line">#                </span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line">#              </span>
<span class="comment-line"># Return value: 1</span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage: </span>
<span class="comment-line">#</span>
<span class="comment-line">#    power_cycle_apc $destinationPorts</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::power_cycle_apc_207">proc <a href="poweroutlet.tcl-annot.html#::::power_cycle_apc">::::power_cycle_apc</a></a></strong> {outletList} {
    global spawn_id
    <span class="comment-line"># Initialize an APC type variable</span>
    puts &#34;Outlet list : $outletList&#34;
    set apcType 9606
    <span class="comment-line"># Control Console Menu</span>
    send &#34;1\r&#34;    ;<span class="comment-line"># 1- Device Manager</span>
    ;<span class="comment-line"># Support both APC powercycler menus for APC9606 and APC7906 and APC9617</span>
    expect {
	-re &#34;3- Outlet Control.*&gt;&#34; {
	    <span class="comment-line"># Device Manager Menu</span>
	    send &#34;3\r&#34;    
	    expect -re &#34;&gt; &#34;
        }
	-re &#34;1- Outlet Control.*&gt;&#34; {
	    <span class="comment-line"># Device Manager Menu</span>
	    send &#34;1\r&#34;    
	    expect -re &#34;&gt; &#34;
        }
	-re &#34;2- Outlet Management.*&gt;&#34; {
	    <span class="comment-line"># Device Manager Menu</span>
	    send &#34;2\r&#34;    
            exp_continue;
        }
        -re &#34;1- MasterSwitch plus.*&#34; {
            <span class="comment-line"># Device Manager Menu for 9617</span>
            send &#34;1\r&#34;
            expect -re &#34;1- Outlet.*&#34;
            set apcType 9617
        }
	-re &#34;Master Control.*&gt;&#34; {
	    ;<span class="comment-line"># Do nothing</span>
	}
	timeout {
	    ;<span class="comment-line"># Do nothing</span>
	}
    }

    foreach outlet $outletList {
        <a name="::result_debug(3)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\nTurning off power on outlet #$outlet\n&#34;
        send &#34;$outlet\r&#34;
        expect -re  &#34;&gt; &#34;
        <span class="comment-line"># Outlet $outlet: Menu</span>
        send &#34;1\r&#34;    ;<span class="comment-line"># Control Outlet</span>
        expect -re  &#34;&gt; &#34;
        if {$apcType != 9617} {
            <span class="comment-line"># Control Outlet Menu</span>
            send &#34;2\r&#34;     ;<span class="comment-line"># Immediate Off</span>
            expect -re &#34;YES.* :&#34;
        } else {
            <span class="comment-line"># Control Outlet Menu for 9617</span>
            send &#34;3\r&#34;     ;<span class="comment-line"># Immediate Off is 3 for 9617</span>
            expect -re &#34;YES.* :&#34;
        }

        send &#34;YES\r&#34;
        expect -re &#34;&lt;ENTER&gt; .* ...&#34;
        send &#34;\r&#34;
        expect -re  &#34;&gt; &#34;

        <span class="comment-line"># Control Outlet Menu</span>
        <span class="comment-line"># EY-09-08-2005: Change delay to 1000 ms.</span>
        after 1000;
        send &#34;\033\r&#34;
        expect -re  &#34;&gt; &#34;
        send &#34;\033\r&#34;
        expect -re  &#34;&gt; &#34;
    }
    <a name="::exSleep(2)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 10
    foreach outlet $outletList {
        <a name="::result_debug(4)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\nTurning on power on outlet #$outlet\n&#34;
        send &#34;$outlet\r&#34;
        expect -re  &#34;&gt; &#34;

        <span class="comment-line"># Outlet $outlet: Menu</span>
        send &#34;1\r&#34;    ;<span class="comment-line"># Control Outlet</span>
        expect -re  &#34;&gt; &#34;

        <span class="comment-line"># Control Outlet Menu</span>
        send &#34;1\r&#34;     ;<span class="comment-line"># Immediate On</span>
        expect -re &#34;YES.* :&#34;

        send &#34;YES\r&#34;
        expect -re &#34;&lt;ENTER&gt; .* ...&#34;
        send &#34;\r&#34;
        send &#34;\r&#34;
        expect -re  &#34;&gt; &#34;

        <span class="comment-line"># Control Outlet Menu</span>
        after 500
        send &#34;\033\r&#34;
        expect -re  &#34;&gt; &#34;
        send &#34;\033\r&#34;
        expect -re  &#34;&gt; &#34;
    }
    send &#34;\033\r&#34;
    expect -re  &#34;&gt; &#34;
    send &#34;\033\r&#34;
    expect -re  &#34;&gt; &#34;
    send &#34;\033\r&#34;
    expect -re  &#34;&gt; &#34;

    send &#34;4\r&#34; 
    expect &#34;Connection closed by foreign host&#34;
    return 1 
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: power_cycle_apc2016</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: </span>
<span class="comment-line">#   Internal proc that is used to power cycle 220V rear mount APC</span>
<span class="comment-line">#   Returns 1 on success</span>
<span class="comment-line"># Input args:</span>
<span class="comment-line">#     outletList - outlet List of the device to be power cycled</span>
<span class="comment-line">#                </span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line">#              </span>
<span class="comment-line"># Return value: 1</span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage: </span>
<span class="comment-line">#</span>
<span class="comment-line">#    power_cycle_apc2016 $destinationPorts</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::power_cycle_apc2016_333">proc <a href="poweroutlet.tcl-annot.html#::::power_cycle_apc2016">::::power_cycle_apc2016</a></a></strong> {outletList} {
    global spawn_id
    <span class="comment-line"># Initialize an APC type variable</span>
    puts &#34;Outlet list : $outletList&#34;

    foreach outlet $outletList {
        <a name="::result_debug(5)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\nTurning off power on outlet #$outlet\n&#34;
        send &#34;olOff $outlet\r&#34;
        expect -re  &#34;&gt;&#34;
    }
    <a name="::exSleep(3)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 4
    foreach outlet $outletList {
        <a name="::result_debug(6)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\nTurning on power on outlet #$outlet\n&#34;
        send &#34;olOn $outlet\r&#34;
        expect -re  &#34;&gt;&#34;
    }
    send &#34;bye\r&#34;;
    expect &#34;Connection closed by foreign host&#34;
    return 1
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: PowerCycleDUT</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: </span>
<span class="comment-line">#   A Top level proc that can be used to powerCycle a device of interest. </span>
<span class="comment-line">#   Currently APC and WTI are supported</span>
<span class="comment-line">#</span>
<span class="comment-line">#   Returns 1 on success and -1 on error</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args:</span>
<span class="comment-line">#     dut    - DUT number (i.e.1-5) of the power cycle device to be power cycled</span>
<span class="comment-line">#                </span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: 1 on success or -1 on failure</span>
<span class="comment-line">#              </span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage: </span>
<span class="comment-line">#</span>
<span class="comment-line">#    PowerCycleDUT $dut</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::PowerCycleDUT_377">proc <a href="poweroutlet.tcl-annot.html#::::PowerCycleDUT">::::PowerCycleDUT</a></a></strong> {DUT {wait &#34;YES&#34;} {showError &#34;true&#34;} } {

    set time1 [clock seconds]
    global spawn_id
    global telnet_pid

    ;<span class="comment-line"># Support OLD format</span>
    global POWERCYCLE_IP
    global POWERCYCLE_PORTS

    ;<span class="comment-line"># New format array</span>
    global POWERCYCLE_DUT

    set pCycleIp &#34;&#34;
    set pCyclePasswd &#34;extreme&#34;

    ;<span class="comment-line"># First check if new config format exists</span>
    if {[info exists POWERCYCLE_DUT($DUT)]} {
        ;<span class="comment-line"># New format</span>
        <a name="::result_debug(7)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Using NEW format&#34;   
        set pCycleIp          [lindex $POWERCYCLE_DUT($DUT) 0]
        set destinationPorts  [lindex $POWERCYCLE_DUT($DUT) 1]
        if {[lindex $POWERCYCLE_DUT($DUT) 2] != &#34;&#34;} {
            set pCyclePasswd      [lindex $POWERCYCLE_DUT($DUT) 2]
        }
	
    } elseif {[info exists POWERCYCLE_IP] &amp;&amp; [info exists POWERCYCLE_PORTS] } {
        ;<span class="comment-line"># Old format</span>
        <a name="::result_debug(8)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Using OLD format&#34;   
        set pCycleIp         $POWERCYCLE_IP
        set destinationPorts [lindex $POWERCYCLE_PORTS [expr $DUT-1]]
    } else {
        <a name="::result_debug(9)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;No Power Cycle configuration defined in Config file&#34;   
        <a name="::::ClearConsoleDUT(1)"><a href="./termServer.tcl.html#::::ClearConsoleDUT_40">::::ClearConsoleDUT</a></a> $DUT
        return -1
    }
    
    global in
    if {[info exists in] &amp;&amp; $in != &#34;main&#34;} {
        <a name="::report_start_test(1)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;\n\nDUT $DUT Power Cycle&#34;
        <a name="::result_ok(1)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;PowerCycleDUT $DUT Start: DUT:$DUT IP:$pCycleIp \
        Ports:$destinationPorts, pCyclePasswd $pCyclePasswd..&#34;
        <a name="::report_end_test(1)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>
    } else {
        <a name="::report_start_test(2)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;\n\nDUT $DUT Power Cycle&#34;
        if {$showError!=&#34;false&#34;} {
            <a name="::result_error(1)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;PowerCycleDUT $DUT Start ERROR: DUT:$DUT IP:$pCycleIp \
            Ports:$destinationPorts, pCyclePasswd $pCyclePasswd..&#34;
        } else {
            <a name="::result_ok(2)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;PowerCycleDUT $DUT Start: DUT:$DUT IP:$pCycleIp \
            Ports:$destinationPorts, pCyclePasswd $pCyclePasswd..&#34;
        }
        <a name="::report_end_test(2)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>
    }
    
    

    set returnCode [<a name="::login_pwr_outlet(1)"><a href="./poweroutlet.tcl.html#::login_pwr_outlet_22">::login_pwr_outlet</a></a> $pCycleIp 5 20 $pCyclePasswd]
    if {$returnCode==&#34;error&#34;} {
        <a name="::result_debug(10)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unable to connect to power cycle unit at $pCycleIp...&#34;
        return -1
    } else {
        <a name="::result_debug(11)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;PowerCycleDut logged into $returnCode&#34;
    }

    switch -- $returnCode \
      &#34;apc&#34; {
        <a name="::power_cycle_apc(1)"><a href="./poweroutlet.tcl.html#::power_cycle_apc_207">::power_cycle_apc</a></a> $destinationPorts
        if {$wait == &#34;YES&#34;} {
            <a name="::exSleep(4)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 180  ;<span class="comment-line"># For PC platform in worst scenario with fsck</span>
        }
    } &#34;apc2016&#34; {
        <a name="::power_cycle_apc2016(1)"><a href="./poweroutlet.tcl.html#::power_cycle_apc2016_333">::power_cycle_apc2016</a></a> $destinationPorts
        if {$wait == &#34;YES&#34;} {
            <a name="::exSleep(5)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 90  ;<span class="comment-line"># For PC platform in worst scenario with fsck</span>
        }
    } &#34;wti&#34; {
        <a name="::power_cycle_wti(1)"><a href="./poweroutlet.tcl.html#::power_cycle_wti_543">::power_cycle_wti</a></a> $destinationPorts
        if {$wait == &#34;YES&#34;} {
            <a name="::exSleep(6)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 180
        }
    } &#34;wti_nps&#34; {
        puts &#34;Ports: $destinationPorts&#34;
        set destinationPorts [join $destinationPorts &#34;,&#34;]
        puts &#34;Ports: $destinationPorts&#34;
        <a name="::power_cycle_wti(2)"><a href="./poweroutlet.tcl.html#::power_cycle_wti_543">::power_cycle_wti</a></a> $destinationPorts
        if {$wait == &#34;YES&#34;} {
            <a name="::exSleep(7)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 90
        }
    } &#34;wti_ips&#34; {
        <span class="comment-line">#puts &#34;Ports: $destinationPorts&#34;</span>
        <span class="comment-line">#set destinationPorts [join $destinationPorts &#34;,&#34;]</span>
        puts &#34;Ports: $destinationPorts&#34;
        <a name="::power_cycle_wti(3)"><a href="./poweroutlet.tcl.html#::power_cycle_wti_543">::power_cycle_wti</a></a> $destinationPorts
        if {$wait == &#34;YES&#34;} {
            <a name="::exSleep(8)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 180
        }
    } &#34;mead&#34; {
        <a name="::power_cycle_mead(1)"><a href="./poweroutlet.tcl.html#::power_cycle_mead_742">::power_cycle_mead</a></a>
        if {$wait == &#34;YES&#34;} {
            <a name="::exSleep(9)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 60
        }
    } &#34;mrv&#34; {
        <a name="::result_debug(12)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Attempt to connect to MRV Power Controller&#34;
        <a name="::power_cycle_mrv(1)"><a href="./poweroutlet.tcl.html#::power_cycle_mrv_908">::power_cycle_mrv</a></a>  $destinationPorts
        if {$wait == &#34;YES&#34;} {
            <a name="::exSleep(10)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 60
        }
    } &#34;mrv_sentry&#34; {
        <a name="::result_debug(13)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Attempt to connect to MRV Sentry Power Controller&#34;
        <a name="::power_cycle_mrv_sentry(1)"><a href="./poweroutlet.tcl.html#::power_cycle_mrv_sentry_940">::power_cycle_mrv_sentry</a></a>  $destinationPorts
        if {$wait == &#34;YES&#34;} {
            <a name="::exSleep(11)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 60
        }
    } &#34;mpc&#34; {
        <a name="::result_debug(14)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Attempt to connect to MPC Power Cycler&#34;
        puts &#34;Ports: $destinationPorts&#34;
        set destinationPorts [join $destinationPorts &#34;+&#34;]
        puts &#34;Ports: $destinationPorts&#34;
        <a name="::power_cycle_mpc(1)"><a href="./poweroutlet.tcl.html#::power_cycle_mpc_779">::power_cycle_mpc</a></a> $destinationPorts
        if {$wait == &#34;YES&#34;} {
            <a name="::result_debug(15)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Wait for MPC Power Cycle of Ports: $destinationPorts&#34;
            <a name="::exSleep(12)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 180
        }
    } &#34;dualcom&#34; {
        <a name="::result_debug(16)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Attempt to connect to DUALCOM Power Controller&#34;
        <a name="::power_cycle_dualcom(1)"><a href="./poweroutlet.tcl.html#::power_cycle_dualcom_840">::power_cycle_dualcom</a></a>  $destinationPorts
        if {$wait == &#34;YES&#34;} {
            <a name="::exSleep(13)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 60
        }
    } &#34;default&#34; {
    }
    set time2 [clock seconds]
    if [catch {close -i $spawn_id} reason] {
        puts &#34;Failed to close spawn_id $spawn_id Reason: $reason&#34;
    }
    if [catch {wait} x] {
        puts &#34;Failed on wait : reason $x&#34;
    }
    <a name="::exSleep(14)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 1
    <a name="::result_debug(17)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;*** Time for power cycle $DUT = [expr $time2-$time1] secs\n\n&#34;
    <a name="::result_debug(18)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;*** Close spawn_id $spawn_id ... Kill pid $telnet_pid&#34;
    return 1
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: power_cycle_wti</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: </span>
<span class="comment-line">#   Internal proc to power cycle a wti device.</span>
<span class="comment-line">#   carried over from webstacks code</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args:</span>
<span class="comment-line">#     units   - port numbers on wti to be power cycled</span>
<span class="comment-line">#                </span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: none</span>
<span class="comment-line">#              </span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage: </span>
<span class="comment-line">#</span>
<span class="comment-line">#    power_cycle_wti $destinationPort</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::power_cycle_wti_543">proc <a href="poweroutlet.tcl-annot.html#::::power_cycle_wti">::::power_cycle_wti</a></a></strong> { units } {
    set result 0
    set done 0
    global expect_out spawn_id

    puts &#34;spawn_id is $spawn_id&#34;
    <span class="comment-line">#set unitLength [llength $units]</span>
    <span class="comment-line">#if {$unitLength &gt; 1} {</span>
    <span class="comment-line">#    set unitString [join $units &#34;,&#34;] ; # this is causing a problem for IPS powerCycle -- qdao</span>
    <span class="comment-line">#    set unitString [join $units &#34; &#34;]</span>
    <span class="comment-line">#} else {</span>
    <span class="comment-line">#    set unitString $units</span>
    <span class="comment-line">#}</span>
    exp_send &#34;\r&#34;
    set unitString $units
    <a name="::result_debug(19)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\nReboot power on ports #$units\n&#34;
    <a name="::exSleep(15)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 1
    expect {
        &#34;NPS&gt;&#34; {
            <a name="::result_debug(20)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ [timestamp -format %T] 1 Send /boot $unitString&#34;
            exp_send &#34;/boot $unitString \r&#34;
        }
        &#34;IPS&gt;&#34;  {
            <a name="::result_debug(21)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;--- [timestamp -format %T] ---&#34;
            <a name="::result_debug(22)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ [timestamp -format %T] +++&#34;
            <a name="::exSleep(16)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 1
            send &#34;/boot $unitString\r&#34;
        }
        -re &#34;NPS*&#34; {
            <a name="::result_debug(23)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ regex [timestamp -format %T] 2 Send /boot $unitString&#34;
            exp_send &#34;/boot $unitString \r&#34;
        }
        &#34;&lt;ESC&gt; to quit&#34; {
            exp_send &#34;\r&#34;
            exp_continue;
        } 
        -re &#34;IPS*&#34;  {
            <a name="::result_debug(24)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;--- [timestamp -format %T] ---&#34;
            <a name="::result_debug(25)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ [timestamp -format %T] +++&#34;
            <a name="::exSleep(17)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 1
            send &#34;/boot $unitString\r&#34;
        }
        timeout {
            <a name="::result_debug(26)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;ERROR: power_cycle never received Command prompt&#34;
        }
    }
    expect {
        -re &#34;Sure.*: &#34; {
            <a name="::result_debug(27)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ [timestamp -format %T] Are you sure $unitString&#34;
            send &#34;y\r&#34;
            expect -re &#34;&gt;&#34;
            send &#34;\X\r&#34;
        } 
        -re &#34;Sure&#34; {
            <a name="::result_debug(28)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ [timestamp -format %T] 222 Are you sure $unitString&#34;
            send &#34;y\r&#34;
            expect -re &#34;&gt;&#34;
            send &#34;\X\r&#34;
        }
        &#34;NPS&gt;&#34; {
            puts &#34;sleep a couple of seconds to see if it reboots.&#34;
            after 5000
            <a name="::result_debug(29)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ [timestamp -format %T] +++ $unitString&#34;
            <a name="::result_debug(30)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Send Exit - exp $expect_out(buffer)&#34;
            send &#34;\x&#34;
            return
        }
        &#34;&lt;ESC&gt; to quit&#34; {
            exp_send &#34;\r&#34;
            exp_continue;
        }
        &#34;IPS&gt;&#34; {
            <a name="::result_debug(31)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;--- [timestamp -format %T] ---&#34;
            <a name="::result_debug(32)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Send Exit&#34;
            send &#34;\x&#34;
        }
        -re &#34;NPS*&#34; {
            <a name="::result_debug(33)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;--- [timestamp -format %T] ---&#34;
            <a name="::result_debug(34)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Send Exit&#34;
            send &#34;\x&#34;
        }
        -re &#34;IPS*&#34; {
            <a name="::result_debug(35)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;--- [timestamp -format %T] ---&#34;
            <a name="::result_debug(36)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Send Exit&#34;
            send &#34;\x&#34;
        }
        timeout {
            <a name="::result_debug(37)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;!!!!!!! ERROR: power_cycle never received Confirmation question&#34;
        }
    }
    expect {
        -re &#34;Sure.*: &#34;  {
            <a name="::result_debug(38)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ [timestamp -format %T] Logout - Are you sure? $unitString&#34;
            send &#34;y\r&#34;
            set result 1
            set done 1
        }
        &#34;NPS&gt;&#34; {
            send &#34;\r&#34;
            set result 1
            set done 1
        }
        &#34;Disconnected&#34; {
        }
        &#34;&lt;ESC&gt; to quit&#34; {
            exp_send &#34;\r&#34;
            exp_continue;
        }
        -re &#34;NPS*&#34; {
            send &#34;\r&#34;
            set result 1
            set done 1
        }
        -re &#34;IPS*&#34; {
            send &#34;\r&#34;
            set result 1
            set done 1
        }
        timeout {
            <a name="::result_debug(39)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;ERROR: power_cycle never received EXIT prompt&#34;
        }
    }
    <a name="::exSleep(18)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 1
}   



<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: power_cycle_mead</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: </span>
<span class="comment-line">#   Internal proc to power cycle a Mariner Mead device.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: none</span>
<span class="comment-line">#</span>
<span class="comment-line"># Sample MEAD Login Screen</span>
<span class="comment-line">#              </span>
<span class="comment-line"># Mead PSU Controller</span>
<span class="comment-line"># Copyright 2003 Extreme Networks</span>
<span class="comment-line">#</span>
<span class="comment-line"># PSU Commands               Description</span>
<span class="comment-line"># ------------               -----------</span>
<span class="comment-line"># digital &lt;psu&gt;  . . . . . . Read digital status for PSU (0-5).</span>
<span class="comment-line"># enable &lt;psu&gt; . . . . . . . Enable PSU (0-5).</span>
<span class="comment-line"># enableall  . . . . . . . . Enable all PSUs.</span>
<span class="comment-line"># disable &lt;psu&gt;  . . . . . . Disable PSU (0-5).</span>
<span class="comment-line"># disableall . . . . . . . . Disable all PSUs (0-5).</span>
<span class="comment-line"># auto &lt;psu&gt; . . . . . . . . Auto-control PSU (0-5).</span>
<span class="comment-line"># autoall  . . . . . . . . . Auto-control all PSUs.</span>
<span class="comment-line"># range &lt;psu&gt; [low|high] . . Set PSU (0-5) AC range low or high.</span>
<span class="comment-line"># registers &lt;psu&gt;  . . . . . Display PSU (0-5) registers.</span>
<span class="comment-line"># read &lt;psu&gt; &lt;reg&gt; . . . . . Read PSU (0-5) register (00-7F).</span>
<span class="comment-line"># write &lt;psu&gt; &lt;reg&gt; &lt;data&gt; . Write PSU (0-5) register (00-7F) data (00-FF).</span>
<span class="comment-line"># rom &lt;psu&gt;  . . . . . . . . Display PSU (0-5) ROM contents.</span>
<span class="comment-line"># romblock &lt;psu&gt; . . . . . . Display PSU (0-5) ROM block contents.</span>
<span class="comment-line"># state  . . . . . . . . . . Display PSU state machine.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Mead Commands              Description</span>
<span class="comment-line"># -------------              -----------</span>
<span class="comment-line"># mute . . . . . . . . . . . Set console output to mute.</span>
<span class="comment-line"># terse  . . . . . . . . . . Set console output to terse.</span>
<span class="comment-line"># verbose  . . . . . . . . . Set console output to verbose.</span>
<span class="comment-line"># analog . . . . . . . . . . Display analog measurements.</span>
<span class="comment-line"># get &lt;offset&gt; . . . . . . . Get Mead EEPROM (0000-3F00) data.</span>
<span class="comment-line"># set &lt;offset&gt; &lt;data&gt;  . . . Set Mead EEPROM (0000-3FFF) data (00-FF).</span>
<span class="comment-line"># temp . . . . . . . . . . . Display Mead temperature.</span>
<span class="comment-line"># slot . . . . . . . . . . . Display Mead slot number.</span>
<span class="comment-line"># zero . . . . . . . . . . . Zero Mead odometer.</span>
<span class="comment-line"># rev  . . . . . . . . . . . Display Mead software revision.</span>
<span class="comment-line"># reset  . . . . . . . . . . Reset Mead.</span>
<span class="comment-line">#</span>
<span class="comment-line"># 03/04/04: Notes on MEAD console.</span>
<span class="comment-line">#            - No prompt on login.  When you attach to console you end up</span>
<span class="comment-line">#              at the last line...reset..........Reset Mead.</span>
<span class="comment-line">#            - Echos each char to screen with a new line</span>
<span class="comment-line">#                 i.e. d</span>
<span class="comment-line">#                      di</span>
<span class="comment-line">#                      dis</span>
<span class="comment-line">#                      disa</span>
<span class="comment-line">#                      disab</span>
<span class="comment-line">#            - Spews lots of status info onto console.  </span>
<span class="comment-line">#            - Serial Cable Pinout (RJ45)</span>
<span class="comment-line">#                       Xyplex   Mead</span>
<span class="comment-line">#                       ------   ----</span>
<span class="comment-line">#                      1 (CTS) - 2 (DCD)</span>
<span class="comment-line">#                      2 (DTR) - 1 (DSR)</span>
<span class="comment-line">#                      7 (DSR) - 3 (DTR)</span>
<span class="comment-line">#                      4 (GND) - 4 (GND)</span>
<span class="comment-line">#                      3 (TXD) - 5 (RXD)</span>
<span class="comment-line">#                      6 (RXD) - 6 (TXD)</span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage: </span>
<span class="comment-line">#</span>
<span class="comment-line">#    power_cycle_mead</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::power_cycle_mead_742">proc <a href="poweroutlet.tcl-annot.html#::::power_cycle_mead">::::power_cycle_mead</a></a></strong> {} {

    <a name="::result_debug(40)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\nPower Cycling through MEAD...&#34;

<span class="comment-line">#    send &#34;reset\r&#34;  ;# because of PD2-245459717, changed reset to disableall-&gt;enableall</span>
<span class="comment-line">#    expect &#34;Reset&#34;</span>
    send &#34;disableall\r&#34;
    expect &#34;PSU_STATE_MEAD_DISABLE&#34;
    send &#34;enableall\r&#34;
    expect &#34;PSU_STATE_MEAD_ENABLE&#34;
    send &#34;\035&#34;  ;<span class="comment-line"># logout, sends ctrl ]</span>
    expect &#34;telnet&gt;&#34;  ;<span class="comment-line"># sends q</span>
    send &#34;q\r&#34;

}
<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: power_cycle_mpc</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: </span>
<span class="comment-line">#   Internal proc to power cycle a NEW wti device.</span>
<span class="comment-line">#   Login prompt,password prompt, basic prompt seem to be different</span>
<span class="comment-line">#        from other wti</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args:</span>
<span class="comment-line">#     units   - port numbers on wti to be power cycled</span>
<span class="comment-line">#                </span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: none</span>
<span class="comment-line">#              </span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage: </span>
<span class="comment-line">#</span>
<span class="comment-line">#    power_cycle_mpc $destinationPort</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::power_cycle_mpc_779">proc <a href="poweroutlet.tcl-annot.html#::::power_cycle_mpc">::::power_cycle_mpc</a></a></strong> { units } {
    global spawn_id
    <a name="::result_debug(41)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\nPower reboot ports #$units\n&#34;
    <span class="comment-line">#exp_send &#34;\r&#34;</span>
    exp_send &#34;\r&#34;
    expect {
        &#34;MPC&gt;&#34; {
            puts &#34;!!!\nBOOT $units\n!!!&#34;
	    exp_send &#34;/BOOT $units\r&#34;
        }
        &#34;VMR&gt;&#34; {
            exp_send &#34;/BOOT $units\r&#34;
        }
        timeout {
            <a name="::result_debug(42)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;ERROR: power reboot never received Command prompt&#34;
	    return -1
        }
    }
<span class="comment-line"># Confirm command</span>
    expect {
        &#34;Are&#34; {
	    exp_send &#34;Y\r&#34;
	    exp_continue
        } \
        &#34;Processing&#34; {
	    exp_send &#34;\r&#34;
	    exp_continue
        } \
        &#34;MPC&gt;&#34; {
            exp_send &#34;/X\r&#34;
        } \
        &#34;VMR&gt;&#34; {
            exp_send &#34;/X\r&#34;
        } \
        timeout {
            <a name="::result_debug(43)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;ERROR: power reboot never received Processing confirmation&#34;
        }
    }

    <a name="::result_debug(44)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;MPC Power cycle reboot complete&#34;
}
<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: power_cycle_dualcom</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: </span>
<span class="comment-line">#   Internal proc to power cycle dual com ports</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args:</span>
<span class="comment-line">#     units   - port numbers on dualcom to be power cycled</span>
<span class="comment-line">#                </span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: none</span>
<span class="comment-line">#              </span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage: </span>
<span class="comment-line">#</span>
<span class="comment-line">#    power_cycle_dualcom $destinationPort</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::power_cycle_dualcom_840">proc <a href="poweroutlet.tcl-annot.html#::::power_cycle_dualcom">::::power_cycle_dualcom</a></a></strong> { units } {
    global spawn_id
    set result 0
    set done 0

    <a name="::result_debug(45)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\nTurning off power on ports #$units\n&#34;
    exp_send &#34;1&#34;;
    expect {
        -re &#34;Edit Outlet States&#34; {
            puts &#34;Got STATES&#34;
        }
    }
    foreach outlet $units {
        <a name="::result_debug(46)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\nTurning off power on outlet # $outlet\n&#34;
        exp_send &#34;$outlet&#34;
        expect *
        exp_send -- &#34;\055&#34;
        expect {
            -re &#34;OUTLET $outlet +OFF +0&#34; {
                puts &#34;Got OFF $outlet&#34;
            }
        }
    }
    <a name="::exSleep(19)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 1
    foreach outlet $units {
        <a name="::result_debug(47)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\nTurning off power on outlet # $outlet\n&#34;
        exp_send &#34;$outlet&#34;
        expect *
        exp_send &#34;\053&#34;
        expect {
            -re &#34;OUTLET $outlet +ON +0&#34; {
                puts &#34;Got ON $outlet&#34;
            }
        }
    }
    <a name="::result_debug(48)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Logout of Dualcom&#34;
    exp_send &#34;\010&#34;
    expect {
        -re &#34;Main Menu&#34; {
            puts &#34;GOT MAIN MENU&#34;
        }
    }
    <span class="comment-line">#exp_continue</span>
    <a name="::exSleep(20)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 1
    send &#34;4\r&#34;
puts &#34;GOT END&#34;
    <span class="comment-line">#exSleep 3;</span>
}
<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: power_cycle_mrv</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: </span>
<span class="comment-line">#   Internal proc to power cycle mrv com ports</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args:</span>
<span class="comment-line">#     units   - port numbers on dualcom to be power cycled</span>
<span class="comment-line">#                </span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: none</span>
<span class="comment-line">#              </span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage: </span>
<span class="comment-line">#</span>
<span class="comment-line">#    power_cycle_mrv $destinationPort</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::power_cycle_mrv_908">proc <a href="poweroutlet.tcl-annot.html#::::power_cycle_mrv">::::power_cycle_mrv</a></a></strong> { units } {
    global spawn_id
    <a name="::result_debug(49)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\nRebooting power on outlet #$units\n&#34;
    foreach outlet $units {
        <a name="::result_debug(50)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\nRebooting power on outlet # $outlet\n&#34;
        send &#34;reboot $outlet\r&#34;
        expect &#34;LX:&#34;
    }
    <a name="::exSleep(21)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 20;
    <a name="::result_debug(51)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Logout of MRV&#34;
    send &#34;exit\r&#34;
}
<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name: power_cycle_mrv_sentry</span>
<span class="comment-line">#</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#   Internal proc to power cycle mrv sentry com ports</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args:</span>
<span class="comment-line">#     units   - port numbers to be power cycled</span>
<span class="comment-line">#</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: none</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#</span>
<span class="comment-line">#    power_cycle_mrv_sentry $destinationPort</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::power_cycle_mrv_sentry_940">proc <a href="poweroutlet.tcl-annot.html#::::power_cycle_mrv_sentry">::::power_cycle_mrv_sentry</a></a></strong> { units } {
    <a name="::result_debug(52)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\nRebooting power on outlet #$units\n&#34;
    foreach outlet $units {
        <a name="::result_debug(53)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\nRebooting power on outlet # $outlet\n&#34;
        send &#34;reboot $outlet\r&#34;
        expect {
            &#34;Sentry:&#34; {}
            &#34;Switched CDU:&#34; {}
        }
    }
    <a name="::result_debug(54)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Logout of MRV&#34;
    send &#34;exit\r&#34;
}


<span class="comment-line">##################################################################</span>
<span class="comment-line">#</span>
<span class="comment-line"># Turn DUTs off when not in use</span>
<span class="comment-line">#</span>
<span class="comment-line">##################################################################</span>

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: PowerOffDUT</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: </span>
<span class="comment-line">#   A Top level proc that can be used to power off a device of interest. </span>
<span class="comment-line">#</span>
<span class="comment-line">#   Returns 1 on success and -1 on error</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args:</span>
<span class="comment-line">#     dut    - DUT number (i.e.1-5) of the power off device to be power offd</span>
<span class="comment-line">#                </span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: 1 on success or -1 on failure</span>
<span class="comment-line">#              </span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage: </span>
<span class="comment-line">#</span>
<span class="comment-line">#    PowerOffDUT $dut</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::PowerOffDUT_983">proc <a href="poweroutlet.tcl-annot.html#::::PowerOffDUT">::::PowerOffDUT</a></a></strong> {DUT action} {

    set time1 [clock seconds]
    global spawn_id
    global telnet_pid VBOXINFO
    global POWERCYCLE_DUT
    global MAIN

    if {[info exists VBOXINFO($DUT,name)]} {
        <a name="::::powerCycleVM(1)"><a href="./vm.tcl.html#::::powerCycleVM_116">::::powerCycleVM</a></a> $DUT $action
        return
    }

    set MAIN(tmpSpawnIds) &#34;&#34;
    set pOffIp &#34;&#34;
    set pOffPasswd &#34;extreme&#34;

    ;<span class="comment-line"># First check if new config format exists</span>
    if {[info exists POWERCYCLE_DUT($DUT)]} {
        set pOffIp          [lindex $POWERCYCLE_DUT($DUT) 0]
        set destinationPorts  [lindex $POWERCYCLE_DUT($DUT) 1]
        if {[lindex $POWERCYCLE_DUT($DUT) 2] != &#34;&#34;} {
            set pOffPasswd      [lindex $POWERCYCLE_DUT($DUT) 2]
        }
    } else {
        return 1
    }

    set returnCode [<a name="::login_pwr_outlet(2)"><a href="./poweroutlet.tcl.html#::login_pwr_outlet_22">::login_pwr_outlet</a></a> $pOffIp 5 20 $pOffPasswd]
    if {$returnCode==&#34;error&#34;} {
        <a name="::result_debug(55)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unable to connect to power controller at $pOffIp...&#34;
        return -1
    }
    puts &#34;**** I think that I am on a $returnCode power cycler ****&#34;
    switch -- $returnCode \
    &#34;apc&#34; {
        puts &#34;Getting ready to run power_off_apc&#34;
        <a name="::power_off_apc(1)"><a href="./poweroutlet.tcl.html#::power_off_apc_1181">::power_off_apc</a></a> $destinationPorts $action
    } \
    &#34;apc2016&#34; {
        puts &#34;Getting ready to run power_off_apc2016&#34;
        <a name="::power_off_apc2016(1)"><a href="./poweroutlet.tcl.html#::power_off_apc2016_1314">::power_off_apc2016</a></a> $destinationPorts $action
    } \
    &#34;mrv_sentry&#34; {
        puts &#34;Getting ready to power $action power_off_apc2016&#34;
        <a name="::power_off_mrv_sentry(1)"><a href="./poweroutlet.tcl.html#::power_off_mrv_sentry_1393">::power_off_mrv_sentry</a></a> $destinationPorts $action
    } \
    &#34;mpc&#34; {
        <a name="::result_debug(56)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Attempt to connect to MPC Power $action&#34;
        set destinationPorts [join $destinationPorts &#34;+&#34;]
        puts &#34;Ports: $destinationPorts&#34;
        <a name="::power_off_mpc(1)"><a href="./poweroutlet.tcl.html#::power_off_mpc_1098">::power_off_mpc</a></a> $destinationPorts $action
    } \
    &#34;mrv&#34; {
        <a name="::power_off_mrv(1)"><a href="./poweroutlet.tcl.html#::power_off_mrv_1346">::power_off_mrv</a></a> $destinationPorts $action
    } \
    &#34;wti&#34; {
        <a name="::power_off_wti(1)"><a href="./poweroutlet.tcl.html#::power_off_wti_1520">::power_off_wti</a></a> $destinationPorts $action
    } \
    &#34;wti_nps&#34; {
        puts &#34;Ports: $destinationPorts&#34;
        set destinationPorts [join $destinationPorts &#34;,&#34;]
        puts &#34;Ports: $destinationPorts&#34;
        <a name="::power_off_wti(2)"><a href="./poweroutlet.tcl.html#::power_off_wti_1520">::power_off_wti</a></a> $destinationPorts $action
    } \
    &#34;wti_ips&#34; {
        puts &#34;Ports: $destinationPorts&#34;
        <a name="::power_off_wti(3)"><a href="./poweroutlet.tcl.html#::power_off_wti_1520">::power_off_wti</a></a> $destinationPorts $action
    } \
    &#34;dualcom&#34; {
        <a name="::result_debug(57)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Attempt to turn $action $destinationPorts DUALCOM Power Controller&#34;
        <a name="::power_off_dualcom(1)"><a href="./poweroutlet.tcl.html#::power_off_dualcom_1458">::power_off_dualcom</a></a>  $destinationPorts $action
    } \
    default {
        <a name="::result_debug(58)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;*** No power $action procedure for $DUT\n\n&#34;
        return -1
    }
    set time2 [clock seconds]
    if [catch {close -i $spawn_id} reason] {
        puts &#34;Failed to close spawn_id $spawn_id Reason: $reason&#34;
    }
    if [catch {wait} x] {
        puts &#34;Failed on wait : reason $x&#34;
    }
    <a name="::exSleep(22)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 1
    <a name="::result_debug(59)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;*** Time for power $action $DUT = [expr $time2-$time1] secs\n\n&#34;
    <a name="::result_debug(60)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;*** Spawn_id $spawn_id  Telnet PID $telnet_pid\n\n&#34;
    foreach sid $MAIN(tmpSpawnIds) {
        catch {close -i $sid} reason
    } 
    <span class="comment-line">#send &#34;exit\r&#34;</span>
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: power_off_mpc</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: </span>
<span class="comment-line">#   Internal proc to power off a NEW wti device.</span>
<span class="comment-line">#   Login prompt,password prompt, basic prompt seem to be different</span>
<span class="comment-line">#        from other wti</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args:</span>
<span class="comment-line">#     units   - port numbers on wti to be power off-ed</span>
<span class="comment-line">#                </span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: none</span>
<span class="comment-line">#              </span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage: </span>
<span class="comment-line">#</span>
<span class="comment-line">#    power_off_mpc $destinationPort $action</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::power_off_mpc_1098">proc <a href="poweroutlet.tcl-annot.html#::::power_off_mpc">::::power_off_mpc</a></a></strong> { units action } {
    global spawn_id
    <a name="::result_debug(61)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\nMPC Power $action ports #$units\n&#34;
    exp_send &#34;\r&#34;
    <a name="::exSleep(23)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 1
    expect {
        &#34;MPC&gt;&#34; {
            <a name="::result_debug(62)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Rcvd MPC&gt; --- [timestamp -format %T] ---&#34;
	    switch $action {
		&#34;off&#34; {exp_send &#34;/OFF $units\r&#34;}
		&#34;on&#34; {exp_send &#34;/ON $units\r&#34;}
	    }
        }
        &#34;VMR&gt;&#34; {
            <a name="::result_debug(63)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Rcvd VMR&gt; --- [timestamp -format %T] ---&#34;
            switch $action {
                &#34;off&#34; {exp_send &#34;/OFF $units \r&#34;;}
                &#34;on&#34; {exp_send &#34;/ON $units\r&#34;; puts &#34;turn on&#34;}
            }
        }
        timeout {
            <a name="::result_debug(64)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;ERROR: power $action never received Command prompt&#34;
	    return -1
        }
    }
<span class="comment-line"># Confirm command</span>
   <a name="::exSleep(24)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 1
    expect {
        -re &#34;Are&#34; {
            <a name="::result_debug(65)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Rcvd Are you sure --- [timestamp -format %T] ---&#34;
	    exp_send &#34;Y\r&#34;
	    exp_continue
        } 
        -re &#34;rocessing&#34; {
            <a name="::result_debug(66)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Rcvd Processing --- [timestamp -format %T] ---&#34;
	    exp_send &#34;\r&#34;
	    exp_continue
        } 
        &#34;MPC&gt;&#34; {
            <a name="::result_debug(67)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Power $action complete --- [timestamp -format %T] ---&#34;
            exp_send &#34;/X\r&#34;
        } 
        &#34;VMR&gt;&#34; {
            <a name="::result_debug(68)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Power $action complete --- [timestamp -format %T] ---&#34;
            exp_send &#34;/X\r&#34;
        } 
        timeout {
            <a name="::result_debug(69)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;ERROR: power $action never received Processing confirmation&#34;
        }
    }

<span class="comment-line"># Confirm logout</span>
    expect {
        &#34;Disconnected&#34;  {
            <a name="::result_debug(70)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Rcvd Disconnected --- [timestamp -format %T] ---&#34;
            <a name="::result_debug(71)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;#$units Successfully Powered $action!&#34;
        }
        timeout {
            <a name="::result_debug(72)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Did not receive Disconnected message after logoff&#34;
	}
    }
    return 1
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: power_off_apc</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: </span>
<span class="comment-line">#   Internal proc that is used to power off a apc device</span>
<span class="comment-line">#   Returns 1 on success</span>
<span class="comment-line"># Input args:</span>
<span class="comment-line">#     outletList - outlet List of the device to be power offd</span>
<span class="comment-line">#                </span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line">#              </span>
<span class="comment-line"># Return value: 1</span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage: </span>
<span class="comment-line">#</span>
<span class="comment-line">#    power_off_apc $destinationPorts</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::power_off_apc_1181">proc <a href="poweroutlet.tcl-annot.html#::::power_off_apc">::::power_off_apc</a></a></strong> {outletList action} {
    global spawn_id
    puts &#34;@@@\n@@@\nAPC Outlet List: $outletList \n@@@\n@@@&#34;
    foreach outlet $outletList {
	expect {
	     &#34;1- Device Manager&#34; {
		    exp_send &#34;1\r&#34;
		}
	     timeout {
		<a name="::result_debug(73)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Timeout Disconnect1&#34;
		return 1 
		}
	}
	expect {
	    &#34;1- MasterSwitch&#34; {
		    exp_send &#34;1\r&#34;
		    exp_continue
		}
	    &#34;9- Master Control/Config&#34; {
		    exp_send &#34;$outlet\r&#34;
		}
	    &#34;9- ALL Outlets&#34; {
		    exp_send &#34;$outlet\r&#34;
		}
            &#34;2- Outlet Management&#34; {
                    exp_send &#34;2\r&#34;
                    expect &#34;&gt; &#34;
                    exp_send &#34;1\r&#34;
                    expect &#34;&gt; &#34;
                    exp_send &#34;$outlet\r&#34;
                }

	    timeout {
		<a name="::result_debug(74)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Timeout Disconnect2&#34;
		return 1 
		}
	}
	expect {
	    &#34;1- Control Outlet&#34; {
		    exp_send &#34;1\r&#34;
		}
	    &#34;1- Outlet Control&#34; {
		    exp_send &#34;1\r&#34;
		}
	    timeout {
		<a name="::result_debug(75)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Timeout Disconnect3&#34;
		return 1 
		}
	}
	expect {
	    &#34;2- Immediate Off&#34; {
		    switch $action {
			&#34;on&#34; { exp_send &#34;1\r&#34; } \
			&#34;off&#34; { exp_send &#34;2\r&#34; }
		    }
		}
	    &#34;2- Delayed On&#34; {
		    switch $action {
			&#34;on&#34; { exp_send &#34;1\r&#34; } \
			&#34;off&#34; { exp_send &#34;3\r&#34; }
		    }
		}
	    timeout {
		<a name="::result_debug(76)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Timeout Disconnect4&#34;
		return 1 
		}
	}
	expect {
	    &#34;Enter 'YES' to continue&#34; {
		    exp_send &#34;YES\r&#34;
		    exp_continue
		}
	    &#34;Press &lt;ENTER&gt; to continue&#34; {
		    exp_send &#34;\r&#34;
		    exp_sleep 1
		    exp_send &#34;\033&#34;
		    exp_sleep 1
		    exp_send &#34;\033&#34;
		    exp_sleep 1
		    exp_send &#34;\033&#34;
                    expect {
                        &#34;1- Outlet Control&#34; {
                            exp_send &#34;\033&#34;
                            exp_continue
                        }
                        &#34;1- MasterSwitch&#34; {
                            exp_send &#34;\033&#34;
                            exp_continue
                        }
                        &#34;1- Bank Management&#34; {
                            exp_send &#34;\033&#34;
                            exp_continue
                        }
                        &#34;4- Logout&#34; {
                            puts &#34;Hit Logout Prompt&#34;
                            exp_send &#34;4&#34;
                            return 1
                        }
                        timeout {
                            <a name="::result_debug(77)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;E1 Timeout Disconnect&#34;
                            return 1
                        }
	           }
            }
	    timeout {
		puts &#34;Timeout Disconnect5&#34;
		return 1 
            }
	}
    }
puts &#34;Hit the end somehow&#34;
    exp_send &#34;4\r&#34;
    return 1 
}
<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: power_off_apc2016</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: </span>
<span class="comment-line">#   Internal proc that is used to power off a apc 220Volt rear mount</span>
<span class="comment-line">#   Returns 1 on success</span>
<span class="comment-line"># Input args:</span>
<span class="comment-line">#     outletList - outlet List of the device to be power offd</span>
<span class="comment-line">#                </span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line">#              </span>
<span class="comment-line"># Return value: 1</span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage: </span>
<span class="comment-line">#</span>
<span class="comment-line">#    power_off_apc2016 $destinationPorts</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::power_off_apc2016_1314">proc <a href="poweroutlet.tcl-annot.html#::::power_off_apc2016">::::power_off_apc2016</a></a></strong> {outletList action} {
    global spawn_id
    puts &#34;@@@\n@@@\nAPC Outlet List: $outletList \n@@@\n@@@&#34;
    foreach outlet $outletList {
        switch $action {
            &#34;on&#34; { exp_send &#34;olOn $outlet\r&#34; } \
            &#34;off&#34; { exp_send &#34;olOFF $outlet\r&#34; }
        }
        expect &#34;apc&gt;&#34;
    }
    exp_send &#34;bye\r&#34;
    return 1
}
<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: power_off_mrv</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: </span>
<span class="comment-line">#   Internal proc that is used to power off a mrv device</span>
<span class="comment-line">#   Returns 1 on success</span>
<span class="comment-line"># Input args:</span>
<span class="comment-line">#     outletList - outlet List of the device to be power offd</span>
<span class="comment-line">#                </span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line">#              </span>
<span class="comment-line"># Return value: 1</span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage: </span>
<span class="comment-line">#</span>
<span class="comment-line">#    power_off_mrv $destinationPorts</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::power_off_mrv_1346">proc <a href="poweroutlet.tcl-annot.html#::::power_off_mrv">::::power_off_mrv</a></a></strong> {outletList action} {
    global spawn_id
    exp_send &#34;\r&#34;
    foreach outlet $outletList {
	expect {
	    &#34;LX:&#34; {
		switch $action {
		    &#34;on&#34; { exp_send &#34;ON $outlet\r&#34; } \
		    &#34;off&#34; { exp_send &#34;OFF $outlet\r&#34; }
		}
	    }
	    timeout {
		<a name="::result_debug(78)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Timeout Disconnect&#34;
		return 1 
	    }
	}
    }
    expect {
	&#34;LX:&#34; {
	    exp_send &#34;LOGOUT\r&#34;
	}
	timeout {
	    <a name="::result_debug(79)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Timeout Disconnect&#34;
	    return 1 
	}
    }
    return 1 
}
<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name: power_off_mrv_sentry</span>
<span class="comment-line">#</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#   Internal proc that is used to power off a mrv device</span>
<span class="comment-line">#   Returns 1 on success</span>
<span class="comment-line"># Input args:</span>
<span class="comment-line">#     outletList - outlet List of the device to be power offd</span>
<span class="comment-line">#</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line">#</span>
<span class="comment-line"># Return value: 1</span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#</span>
<span class="comment-line">#    power_off_mrv_sentry $destinationPorts</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::power_off_mrv_sentry_1393">proc <a href="poweroutlet.tcl-annot.html#::::power_off_mrv_sentry">::::power_off_mrv_sentry</a></a></strong> {outletList action} {
    exp_send &#34;\r&#34;
    foreach outlet $outletList {
        expect {
            &#34;Sentry:&#34; {
                switch $action {
                    &#34;on&#34; { exp_send &#34;ON $outlet\r&#34; } \
                    &#34;off&#34; { exp_send &#34;OFF $outlet\r&#34; }
                }
            }
            &#34;Switched CDU:&#34; {
                switch $action {
                    &#34;on&#34; { exp_send &#34;ON $outlet\r&#34; } \
                    &#34;off&#34; { exp_send &#34;OFF $outlet\r&#34; }
                }
            }
            timeout {
                <a name="::result_debug(80)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Timeout Disconnect&#34;
                catch {exp_close} what
                catch {wait} what
                after 1000
                return 1
            }
        }
    }
    expect {
        &#34;Sentry:&#34; {
            exp_send &#34;LOGOUT\r&#34;
        }
        &#34;Switched CDU:&#34; {
            exp_send &#34;LOGOUT\r&#34;
        }
        timeout {
            <a name="::result_debug(81)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Timeout Disconnect&#34;
            catch {exp_close} what
            catch {wait} what
            after 1000
            return 1
        }
    }
    <span class="comment-line">#catch {exp_close} what</span>
    <span class="comment-line">#catch {wait} what</span>
    <span class="comment-line">#after 1000</span>
    return 1
}
<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name: power_off_dualcom</span>
<span class="comment-line">#</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#   Internal proc to power off dual com ports</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args:</span>
<span class="comment-line">#     units   - port numbers on dualcom to be powered off/on</span>
<span class="comment-line">#</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: none</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#</span>
<span class="comment-line">#    power_off_dualcom $destinationPort $action</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::power_off_dualcom_1458">proc <a href="poweroutlet.tcl-annot.html#::::power_off_dualcom">::::power_off_dualcom</a></a></strong> { units action} {
    global spawn_id
    set result 0
    set done 0

    <a name="::result_debug(82)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\nTurning $action power on ports #$units\n&#34;
    exp_send &#34;1&#34;;
    expect {
        -re &#34;Edit Outlet States&#34; {
            puts &#34;Got STATES&#34;
        }
    }
    foreach outlet $units {
        <a name="::result_debug(83)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\nTurning $action power on outlet # $outlet\n&#34;
        exp_send &#34;$outlet&#34;
        expect *
        if {$action == &#34;off&#34;} {
            exp_send -- &#34;\055&#34;
        } else {
            exp_send -- &#34;\053&#34;
        }
        expect {
            -re &#34;OUTLET $outlet +OFF +0&#34; {
                puts &#34;Got OFF $outlet&#34;
            }
            -re &#34;OUTLET $outlet +ON +0&#34; {
                puts &#34;Got ON $outlet&#34;
            }
        }
    }
    <a name="::result_debug(84)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Logout of Dualcom&#34;
    exp_send &#34;\010&#34;
    expect {
        -re &#34;Main Menu&#34; {
            puts &#34;GOT MAIN MENU&#34;
        }
    }
    <a name="::exSleep(25)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 1
    send &#34;4\r&#34;
    puts &#34;END Dualcom $action&#34;
}
<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name: power_off_wti</span>
<span class="comment-line">#</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#   Internal proc to power off/on a wti device.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args:</span>
<span class="comment-line">#     units   - port numbers on wti to be power cycled</span>
<span class="comment-line">#     action  - off | on</span>
<span class="comment-line">#</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: none</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#</span>
<span class="comment-line">#    power_off_wti $destinationPort $action</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::power_off_wti_1520">proc <a href="poweroutlet.tcl-annot.html#::::power_off_wti">::::power_off_wti</a></a></strong> { units action } {
    global spawn_id
    set result 0
    set done 0
    global expect_out spawn_id

    exp_send &#34;\r&#34;
    set unitString $units
    <a name="::result_debug(85)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\nTurning $action power on ports #$units\n&#34;
    <a name="::exSleep(26)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 3
    expect {
        &#34;NPS&gt;&#34; {
            <a name="::result_debug(86)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ NPS Send /$action $unitString&#34;
            exp_send &#34;/$action $unitString \r&#34;
        }
        &#34;IPS&gt;&#34;  {
            <a name="::result_debug(87)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ IPS Send /$action $unitString&#34;
            <a name="::exSleep(27)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 1
            send &#34;/$action $unitString\r&#34;
        }
        -re &#34;NPS*&#34; {
            <a name="::result_debug(88)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ NPS 2 Send /$action $unitString&#34;
            exp_send &#34;/$action $unitString \r&#34;
        }
        -re &#34;IPS*&#34;  {
            <a name="::result_debug(89)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ IPS 2 Send /$action $unitString&#34;
            <a name="::exSleep(28)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 1
            send &#34;/$action $unitString\r&#34;
        }
        timeout {
            <a name="::result_debug(90)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;ERROR: power_cycle never received Command prompt&#34;
        }
    }
    expect {
        -re &#34;Sure.*: &#34; {
            <a name="::result_debug(91)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ [timestamp -format %T] Are you sure $unitString&#34;
            send &#34;y\r&#34;
        }
        -re &#34;Sure&#34; {
            <a name="::result_debug(92)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ [timestamp -format %T] 222 Are you sure $unitString&#34;
            send &#34;y\r&#34;
        }
        &#34;NPS&gt;&#34; {
            <a name="::result_debug(93)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ [timestamp -format %T] +++ $unitString&#34;
            <a name="::result_debug(94)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;No confirmation prompt seen 1 - exp $expect_out(buffer)&#34;
            send &#34;\r&#34;
        }
        &#34;IPS&gt;&#34; {
            <a name="::result_debug(95)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;--- [timestamp -format %T] ---&#34;
            <a name="::result_debug(96)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ [timestamp -format %T] +++&#34;
            <a name="::result_debug(97)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;No confirmation prompt seen&#34;
            send &#34;\r&#34;
        }
        -re &#34;NPS*&#34; {
            <a name="::result_debug(98)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;--- [timestamp -format %T] ---&#34;
            <a name="::result_debug(99)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ [timestamp -format %T] +++&#34;
            <a name="::result_debug(100)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;No confirmation prompt seen 2&#34;
            send &#34;\r&#34;
        }
        -re &#34;IPS*&#34; {
            <a name="::result_debug(101)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;--- [timestamp -format %T] ---&#34;
            <a name="::result_debug(102)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ [timestamp -format %T] +++&#34;
            <a name="::result_debug(103)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;No confirmation prompt seen&#34;
            send &#34;\r&#34;
        }
        timeout {
            <a name="::result_debug(104)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;!!!!!!! ERROR: power_cycle never received Confirmation question&#34;
        }
    }
    expect {
        &#34;NPS&gt;&#34; {
            <a name="::result_debug(105)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ [timestamp -format %T] +++ Exit NPS $unitString&#34;
            send &#34;/X\r&#34;
        }
        &#34;IPS&gt;&#34;  {
            <a name="::result_debug(106)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;--- [timestamp -format %T] ---&#34;
            <a name="::result_debug(107)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ [timestamp -format %T] +++&#34;
            send &#34;/X\r&#34;
        }
        -re &#34;NPS*&#34; {
            <a name="::result_debug(108)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;--- [timestamp -format %T] ---&#34;
            <a name="::result_debug(109)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ [timestamp -format %T] +++ 2&#34;
            send &#34;/X\r&#34;
        }
        -re &#34;IPS*&#34;  {
            <a name="::result_debug(110)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;--- [timestamp -format %T] ---&#34;
            <a name="::result_debug(111)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ [timestamp -format %T] +++&#34;
            send &#34;/X\r&#34;
        }
        timeout {
            <a name="::result_debug(112)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;ERROR: power_cycle never received Command prompt #2&#34;
        }
    }
    expect {
        -re &#34;Sure.*: &#34;  {
            <a name="::result_debug(113)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ [timestamp -format %T] Logout - Are you sure? $unitString&#34;
            send &#34;y\r&#34;
            set result 1
            set done 1
        }
        &#34;NPS&gt;&#34; {
            <a name="::result_debug(114)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;--- [timestamp -format %T] ---&#34;
            <a name="::result_debug(115)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ [timestamp -format %T] +++&#34;
            <a name="::result_debug(116)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;No confirmation prompt seen 1&#34;
            send &#34;\r&#34;
            set result 1
            set done 1
        }
        &#34;IPS&gt;&#34; {
            <a name="::result_debug(117)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;--- [timestamp -format %T] ---&#34;
            <a name="::result_debug(118)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ [timestamp -format %T] +++&#34;
            <a name="::result_debug(119)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;No confirmation prompt seen&#34;
            send &#34;\r&#34;
            set result 1
            set done 1
        }
        -re &#34;NPS*&#34; {
            <a name="::result_debug(120)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;--- [timestamp -format %T] ---&#34;
            <a name="::result_debug(121)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ [timestamp -format %T] +++&#34;
            <a name="::result_debug(122)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;No confirmation prompt seen 2&#34;
            send &#34;\r&#34;
            set result 1
            set done 1
        }
        -re &#34;IPS*&#34; {
            <a name="::result_debug(123)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;--- [timestamp -format %T] ---&#34;
            <a name="::result_debug(124)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;+++ [timestamp -format %T] +++&#34;
            <a name="::result_debug(125)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;No confirmation prompt seen&#34;
            send &#34;\r&#34;
            set result 1
            set done 1
        }
        timeout {
            <a name="::result_debug(126)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;ERROR: power_cycle never received EXIT prompt&#34;
        }
    }
}
<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name: PowerCycleBpes</span>
<span class="comment-line">#</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#   A Top level proc that can be used to powerCycle Bpe Slots</span>
<span class="comment-line">#   In event that they crash</span>
<span class="comment-line">#</span>
<span class="comment-line">#   Returns 1 on success and -1 on error</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args:</span>
<span class="comment-line">#     dut    - DUT number (i.e.1-5) of the power cycle device to be power cycled</span>
<span class="comment-line">#</span>
<span class="comment-line"># Output args: none</span>
<span class="comment-line"># Return value: 1 on success or -1 on failure</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#</span>
<span class="comment-line">#    PowerCycleDUT $dut</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category: Setup</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::PowerCycleBpes_1680">proc <a href="poweroutlet.tcl-annot.html#::::PowerCycleBpes">::::PowerCycleBpes</a></a></strong> {args} {
    global POWERCYCLE_BPE spawn_id
    <a name="::parse_args(1)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> PowerCycleBpes $args {
        DUT       &#34;1&#34;
        showError &#34;false&#34;
        wait      &#34;YES&#34;
    }

    set time1 [clock seconds]

    set pCycleIp &#34;&#34;
    set pCyclePasswd &#34;extreme&#34;

    ;<span class="comment-line"># First check if new config format exists</span>
    if {[info exists POWERCYCLE_BPE($DUT)]} {
        set pCycleIp          [lindex $POWERCYCLE_BPE($DUT) 0]
        set destinationPorts  [lindex $POWERCYCLE_BPE($DUT) 1]
        if {[lindex $POWERCYCLE_BPE($DUT) 2] != &#34;&#34;} {
            set pCyclePasswd      [lindex $POWERCYCLE_DUT($DUT) 2]
        }
    } else {
        <a name="::result_debug(127)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;No BPE Power Cycler configuration defined in Config file&#34;
        return -1
    }

    global in
    if {[info exists in] &amp;&amp; $in != &#34;main&#34;} {
        <a name="::report_start_test(3)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;\n\nDUT $DUT Power Cycle&#34;
        <a name="::result_ok(3)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Power Cycle BPE $DUT Start: DUT:$DUT IP:$pCycleIp \
        Ports:$destinationPorts, pCyclePasswd $pCyclePasswd..&#34;
        <a name="::report_end_test(3)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>
    } else {
        <a name="::report_start_test(4)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;\n\nDUT $DUT Power Cycle&#34;
        if {$showError!=&#34;false&#34;} {
            <a name="::result_error(2)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;PowerCycleBPE $DUT Start ERROR: DUT:$DUT IP:$pCycleIp \
            Ports:$destinationPorts, pCyclePasswd $pCyclePasswd..&#34;
        } else {
            <a name="::result_ok(4)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;PowerCycleDUTBPE $DUT Start: DUT:$DUT IP:$pCycleIp \
            Ports:$destinationPorts, pCyclePasswd $pCyclePasswd..&#34;
        }
        <a name="::report_end_test(4)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>
    }



    set returnCode [<a name="::login_pwr_outlet(3)"><a href="./poweroutlet.tcl.html#::login_pwr_outlet_22">::login_pwr_outlet</a></a> $pCycleIp 5 20 $pCyclePasswd]
    if {$returnCode==&#34;error&#34;} {
        <a name="::result_debug(128)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Unable to connect to power cycle unit at $pCycleIp...&#34;
        return -1
    }

    switch -- $returnCode \
      &#34;apc&#34; {
        <a name="::power_cycle_apc(2)"><a href="./poweroutlet.tcl.html#::power_cycle_apc_207">::power_cycle_apc</a></a> $destinationPorts
        if {$wait == &#34;YES&#34;} {
            <a name="::exSleep(29)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 60  ;<span class="comment-line"># For PC platform in worst scenario with fsck</span>
        }
    } &#34;apc2016&#34; {
        <a name="::power_cycle_apc2016(2)"><a href="./poweroutlet.tcl.html#::power_cycle_apc2016_333">::power_cycle_apc2016</a></a> $destinationPorts
        if {$wait == &#34;YES&#34;} {
            <a name="::exSleep(30)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 60  ;<span class="comment-line"># For PC platform in worst scenario with fsck</span>
        }
    } &#34;wti&#34; {
        <a name="::power_cycle_wti(4)"><a href="./poweroutlet.tcl.html#::power_cycle_wti_543">::power_cycle_wti</a></a> $destinationPorts
        if {$wait == &#34;YES&#34;} {
            <a name="::exSleep(31)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 60
        }
    } &#34;wti_nps&#34; {
        puts &#34;Ports: $destinationPorts&#34;
        set destinationPorts [join $destinationPorts &#34;,&#34;]
        puts &#34;Ports: $destinationPorts&#34;
        <a name="::power_cycle_wti(5)"><a href="./poweroutlet.tcl.html#::power_cycle_wti_543">::power_cycle_wti</a></a> $destinationPorts
        if {$wait == &#34;YES&#34;} {
            <a name="::exSleep(32)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 60
        }
    } &#34;wti_ips&#34; {
        <span class="comment-line">#puts &#34;Ports: $destinationPorts&#34;</span>
        <span class="comment-line">#set destinationPorts [join $destinationPorts &#34;,&#34;]</span>
        puts &#34;Ports: $destinationPorts&#34;
        <a name="::power_cycle_wti(6)"><a href="./poweroutlet.tcl.html#::power_cycle_wti_543">::power_cycle_wti</a></a> $destinationPorts
        if {$wait == &#34;YES&#34;} {
            <a name="::exSleep(33)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 60
        }
    } &#34;mead&#34; {
        <a name="::power_cycle_mead(2)"><a href="./poweroutlet.tcl.html#::power_cycle_mead_742">::power_cycle_mead</a></a>
        if {$wait == &#34;YES&#34;} {
            <a name="::exSleep(34)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 60
        }
    } &#34;mrv&#34; {
        <a name="::result_debug(129)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Attempt to connect to MRV Power Controller&#34;
        <a name="::power_cycle_mrv(2)"><a href="./poweroutlet.tcl.html#::power_cycle_mrv_908">::power_cycle_mrv</a></a>  $destinationPorts
        if {$wait == &#34;YES&#34;} {
            <a name="::exSleep(35)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 60
        }
    } &#34;mrv_sentry&#34; {
        <a name="::result_debug(130)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Attempt to connect to MRV Sentry Power Controller&#34;
        <a name="::power_cycle_mrv_sentry(2)"><a href="./poweroutlet.tcl.html#::power_cycle_mrv_sentry_940">::power_cycle_mrv_sentry</a></a>  $destinationPorts
        if {$wait == &#34;YES&#34;} {
            <a name="::exSleep(36)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 60
        }
    } &#34;mpc&#34; {
        <a name="::result_debug(131)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Attempt to connect to MPC Power Cycler&#34;
        puts &#34;Ports: $destinationPorts&#34;
        set destinationPorts [join $destinationPorts &#34;+&#34;]
        puts &#34;Ports: $destinationPorts&#34;
        <a name="::power_cycle_mpc(2)"><a href="./poweroutlet.tcl.html#::power_cycle_mpc_779">::power_cycle_mpc</a></a> $destinationPorts
        if {$wait == &#34;YES&#34;} {
            <a name="::result_debug(132)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Wait for MPC Power Cycle of Ports: $destinationPorts&#34;
            <a name="::exSleep(37)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 60
        }
    } &#34;dualcom&#34; {
        <a name="::result_debug(133)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Attempt to connect to DUALCOM Power Controller&#34;
        <a name="::power_cycle_dualcom(2)"><a href="./poweroutlet.tcl.html#::power_cycle_dualcom_840">::power_cycle_dualcom</a></a>  $destinationPorts
        if {$wait == &#34;YES&#34;} {
            <a name="::exSleep(38)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 60
        }
    } &#34;default&#34; {
    }
    set time2 [clock seconds]
    if [catch {close -i $spawn_id} reason] {
        puts &#34;Failed to close spawn_id $spawn_id Reason: $reason&#34;
    }
    if [catch {wait} x] {
        puts &#34;Failed on wait : reason $x&#34;
    }
    <a name="::exSleep(39)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 1
    <a name="::result_debug(134)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;*** Time for power cycle $DUT = [expr $time2-$time1] secs\n\n&#34;
    <a name="::result_debug(135)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;*** Close spawn_id $spawn_id ...&#34;
    return 1
}
</pre>
<hr>
<div class="index-selector">
	<a href="index_main.html#byfilename">file name</a> 
 | 
	<a href="index_main.html#byprocname">procedure name</a> 
 | 
	<a href="index_main.html#bycall">procedure call</a> 
 | 
	<a href="index_annot_full.html">annotation</a> 

<br>
<cite>File generated 2018-06-14 at 17:09.</cite>
</div>

</body>
</html>
