<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/transitional.dtd">
<!-- Generated by TclDoc @@VERSION@@ -->
<html>
<head>
  <title>make_snmpapi_object.tcl</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="default.css">
</head>
<body class="src-html">
<div class="index-selector">
<!-- index for tcl source files -->
	Index by: 
	<a href="index_main.html#make_snmpapi_object.tcl">file name</a> | 
	<a href="index_main.html#byprocname">procedure name</a> | 
	<a href="index_main.html#bycall">procedure call</a> | 
	<a href="index_annot_full.html">annotation</a>

</div>
<hr>

<p><strong>make_snmpapi_object.tcl</strong>&nbsp;&nbsp;<span class="filetype-link">(<a href="make_snmpapi_object.tcl-annot.html">annotations</a> | <a href="make_snmpapi_object.tcl.txt">original source</a>)</span>
</p>
<pre class="src-code">
<span class="comment-line">#!/usr/bin/tclsh</span>
set output [exec id]
if { [regexp {.*uid\=0\(root\).*} $output] == 0 } {
   puts &#34;ERROR: you must be a super-user to execute this script. installation aborted !!!\n&#34;
   exit
}

if { [file exists /usr/lib/libnetsnmp.so.5] } {
catch {set val [exec ls -al /usr/lib/libnetsnmp.so.5]} reason
if {[info exists val] == 1 } {
  if { [regexp -nocase &#34;.*libnetsnmp\.so\.5\.0\.9.*&#34; $val] == 1 } {
     if  {[ file exists /usr/lib/libnetsnmp.so.5.0.9] == 1 } {
        catch { [ exec rm -f /usr/lib/libnetsnmp.so.5] } reason
        catch { [exec ln -s /usr/lib/libnetsnmp.so.5.0.9 /usr/lib/libnetsnmp.so.5] }  reason
     } 
  }
}
}

if { ![file exists /auto/automation/Lib] } {
   puts &#34;ERROR: the directory /auto/automation/Lib doesn't exists. installation aborted !!!\n&#34;
   exit
}

if {[file exists /auto/automation/Lib/SnmpAPI.so]} {
   catch {[exec rm -f /auto/automation/Lib/SnmpAPI.so]} reason
}

if {![file exists /usr/bin/gcc]} {
   puts &#34;ERROR: unable to find gcc compiler in /usr/bin directory. installation aborted !!!\n&#34;
   exit
}

puts &#34;INFO: creating SnmpAPI.so in /auto/automation/Lib directory&#34;
<span class="comment-line"># Create SnmpAPI.so</span>
<span class="comment-line">#catch {eval [exec /usr/bin/gcc -shared ./snmp_api.c -o /usr/share/snmp/SnmpAPI.so -lnetsnmp -lcrypto -lm] error_msg}</span>
catch {eval [exec /usr/bin/gcc -shared ./snmp_api.c -o /auto/automation/Lib/SnmpAPI.so /usr/lib/libnetsnmp.so.5 -lcrypto -lm]} error_msg
catch {eval [exec /usr/bin/gcc -shared ./snmp_api.c -o SnmpAPI.so /usr/lib/libnetsnmp.so.5 -lcrypto -lm]} error_msg
if {[regexp &#34;.*cannot find -lm.*&#34; $error_msg]} {
   catch {eval [exec /usr/bin/gcc -shared ./snmp_api.c -o /auto/automation/Lib/SnmpAPI.so /usr/lib/libnetsnmp.so.5 -lcrypto]} error_msg
}


puts &#34;INFO: SnmpAPI.so library installation completed&#34;
</pre>
<hr>
<div class="index-selector">
	<a href="index_main.html#byfilename">file name</a> 
 | 
	<a href="index_main.html#byprocname">procedure name</a> 
 | 
	<a href="index_main.html#bycall">procedure call</a> 
 | 
	<a href="index_annot_full.html">annotation</a> 

<br>
<cite>File generated 2018-06-14 at 17:09.</cite>
</div>

</body>
</html>
