<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/transitional.dtd">
<!-- Generated by TclDoc @@VERSION@@ -->
<html>
<head>
  <title>xml-notification.tcl</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="default.css">
</head>
<body class="src-html">
<div class="index-selector">
<!-- index for tcl source files -->
	Index by: 
	<a href="index_main.html#xml-notification.tcl">file name</a> | 
	<a href="index_main.html#byprocname">procedure name</a> | 
	<a href="index_main.html#bycall">procedure call</a> | 
	<a href="index_annot_full.html">annotation</a>

</div>
<hr>

<p><strong>xml-notification.tcl</strong>&nbsp;&nbsp;<span class="filetype-link">(<a href="xml-notification.tcl-annot.html">annotations</a> | <a href="xml-notification.tcl.txt">original source</a>)</span>
</p>
<pre class="src-code">
<strong><a name="::::StartWebServer_1">proc <a href="xml-notification.tcl-annot.html#::::StartWebServer">::::StartWebServer</a></a></strong><a name="::::StartWebServer"></a> { enableAuth } {
	if { $enableAuth } {
		<a name="::::EnableWebServerAuth(1)"><a href="./xml-notification.tcl.html#::::EnableWebServerAuth_20">::::EnableWebServerAuth</a></a>
	} else {
		<a name="::::DisableWebServerAuth(1)"><a href="./xml-notification.tcl.html#::::DisableWebServerAuth_28">::::DisableWebServerAuth</a></a>
	}
	exec ../../main/Tmp/apache-tomcat-6.0.20/bin/startup.sh

	sleep 10
}

<strong><a name="::::StopWebServer_12">proc <a href="xml-notification.tcl-annot.html#::::StopWebServer">::::StopWebServer</a></a></strong><a name="::::StopWebServer"></a> {} {
	exec ../../main/Tmp/apache-tomcat-6.0.20/bin/shutdown.sh
}

<strong><a name="::::RemoveWebServerLog_16">proc <a href="xml-notification.tcl-annot.html#::::RemoveWebServerLog">::::RemoveWebServerLog</a></a></strong><a name="::::RemoveWebServerLog"></a> {} {
	exec rm -rf ../../main/Tmp/apache-tomcat-6.0.20/logs/catalina.out
}

<strong><a name="::::EnableWebServerAuth_20">proc <a href="xml-notification.tcl-annot.html#::::EnableWebServerAuth">::::EnableWebServerAuth</a></a></strong><a name="::::EnableWebServerAuth"></a> {} {
	exec chmod -R 777 ../../main/Tmp/apache-tomcat-6.0.20
	exec cp -f ../../XML_API/API_Java/assets/Auth_server.xml ../../main/Tmp/apache-tomcat-6.0.20/conf/server.xml
	exec cp -f ../../XML_API/API_Java/assets/Auth_tomcat-users.xml ../../main/Tmp/apache-tomcat-6.0.20/conf/tomcat-users.xml
	exec cp -f ../../XML_API/API_Java/assets/Auth_server-config.wsdd ../../main/Tmp/apache-tomcat-6.0.20/webapps/axis/WEB-INF/server-config.wsdd
	exec cp -f ../../XML_API/API_Java/assets/Auth_web.xml ../../main/Tmp/apache-tomcat-6.0.20/webapps/axis/WEB-INF/web.xml
}

<strong><a name="::::DisableWebServerAuth_28">proc <a href="xml-notification.tcl-annot.html#::::DisableWebServerAuth">::::DisableWebServerAuth</a></a></strong><a name="::::DisableWebServerAuth"></a> {} {
        exec cp -f ../../XML_API/API_Java/assets/NoAuth_server.xml ../../main/Tmp/apache-tomcat-6.0.20/conf/server.xml
        exec cp -f ../../XML_API/API_Java/assets/NoAuth_tomcat-users.xml ../../main/Tmp/apache-tomcat-6.0.20/conf/tomcat-users.xml
        exec cp -f ../../XML_API/API_Java/assets/NoAuth_server-config.wsdd ../../main/Tmp/apache-tomcat-6.0.20/webapps/axis/WEB-INF/server-config.wsdd
	exec cp -f ../../XML_API/API_Java/assets/NoAuth_web.xml ../../main/Tmp/apache-tomcat-6.0.20/webapps/axis/WEB-INF/web.xml
}

<strong><a name="::::ConfigureWebAuthOnSwitch_35">proc <a href="xml-notification.tcl-annot.html#::::ConfigureWebAuthOnSwitch">::::ConfigureWebAuthOnSwitch</a></a></strong><a name="::::ConfigureWebAuthOnSwitch"></a> { target } {
        global ServerIP
        global DUT1_CONNECT

	<a name="::Login(1)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $DUT1_CONNECT
	<a name="::SendACmd(1)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;configure xml-notification target $target user emanemos encrypted-auth ZW1hbmVtb3M6cGFzc3dvcmQ=&#34;
}

<strong><a name="::::ConfigureWebInvalidAuthOnSwitch_43">proc <a href="xml-notification.tcl-annot.html#::::ConfigureWebInvalidAuthOnSwitch">::::ConfigureWebInvalidAuthOnSwitch</a></a></strong><a name="::::ConfigureWebInvalidAuthOnSwitch"></a> { target } {
        global ServerIP
        global DUT1_CONNECT

        <a name="::Login(2)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $DUT1_CONNECT
        <a name="::SendACmd(2)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;configure xml-notification target $target user invalid encrypted-auth ZW1hbmVtb3M6cGFzc3dvcmQ=&#34;
}

<strong><a name="::::UnConfigureWebAuthOnSwitch_51">proc <a href="xml-notification.tcl-annot.html#::::UnConfigureWebAuthOnSwitch">::::UnConfigureWebAuthOnSwitch</a></a></strong><a name="::::UnConfigureWebAuthOnSwitch"></a> { target } {
        global ServerIP
        global DUT1_CONNECT

        <a name="::Login(3)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $DUT1_CONNECT
        <a name="::SendACmd(3)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;configure xml-notification target $target user none&#34;

}

<strong><a name="::::AddNotificationTarget_60">proc <a href="xml-notification.tcl-annot.html#::::AddNotificationTarget">::::AddNotificationTarget</a></a></strong><a name="::::AddNotificationTarget"></a> { target moduleList filterName enableAuth} {
	global ServerIP
	global XMLProtocol
	global DUT1_CONNECT

	if { [string match -nocase $XMLProtocol &#34;http&#34;] } {
		set XMLPort 9080
	} else {
		set XMLPort 9443
	}
	
	set url &#34;$XMLProtocol://$ServerIP:$XMLPort/axis/services/eventPort&#34;

	<a name="::Login(4)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $DUT1_CONNECT
	<a name="::SendACmd(4)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;create xml-notification target $target url $url&#34;
	foreach module $moduleList {
		<a name="::SendACmd(5)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;configure xml-notification target $target add $module&#34;
	}
	<a name="::SendACmd(6)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;create log target xml-notification $target&#34;
	<a name="::SendACmd(7)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;configure log target xml-notification $target filter $filterName&#34;
	if { $enableAuth } {
		<a name="::::ConfigureWebAuthOnSwitch(1)"><a href="./xml-notification.tcl.html#::::ConfigureWebAuthOnSwitch_35">::::ConfigureWebAuthOnSwitch</a></a> $target
	} 
}

<strong><a name="::::AddSecondNotificationTarget_85">proc <a href="xml-notification.tcl-annot.html#::::AddSecondNotificationTarget">::::AddSecondNotificationTarget</a></a></strong><a name="::::AddSecondNotificationTarget"></a> { target moduleList filterName enableAuth} {
        global ServerIP
        global XMLProtocol
        global DUT1_CONNECT

        if { [string match -nocase $XMLProtocol &#34;http&#34;] } {
                set XMLPort 10080
        } else {
                set XMLPort 10443
        }

        set url &#34;$XMLProtocol://$ServerIP:$XMLPort/axis/services/eventPort&#34;

        <a name="::Login(5)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $DUT1_CONNECT
        <a name="::SendACmd(8)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;create xml-notification target $target url $url&#34;
        foreach module $moduleList {
                <a name="::SendACmd(9)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;configure xml-notification target $target add $module&#34;
        }
        <a name="::SendACmd(10)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;create log target xml-notification $target&#34;
        <a name="::SendACmd(11)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;configure log target xml-notification $target filter $filterName&#34;
        if { $enableAuth } {
                <a name="::::ConfigureWebAuthOnSwitch(2)"><a href="./xml-notification.tcl.html#::::ConfigureWebAuthOnSwitch_35">::::ConfigureWebAuthOnSwitch</a></a> $target
        }
}


<strong><a name="::::EnableNotificationTarget_111">proc <a href="xml-notification.tcl-annot.html#::::EnableNotificationTarget">::::EnableNotificationTarget</a></a></strong><a name="::::EnableNotificationTarget"></a> { target } {
	
	global DUT1_CONNECT
	<a name="::Login(6)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $DUT1_CONNECT
	<a name="::SendACmd(12)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;enable log target xml-notification $target&#34;
	<a name="::SendACmd(13)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;enable xml-notification $target&#34;
}

<strong><a name="::::DisableNotificationTarget_119">proc <a href="xml-notification.tcl-annot.html#::::DisableNotificationTarget">::::DisableNotificationTarget</a></a></strong><a name="::::DisableNotificationTarget"></a> { target } {

	global DUT1_CONNECT
        <a name="::SendACmd(14)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable log target xml-notification $target&#34;
        <a name="::SendACmd(15)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable xml-notification $target&#34;
	<a name="::Login(7)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $DUT1_CONNECT
}

<strong><a name="::::RemoveNotificationTarget_127">proc <a href="xml-notification.tcl-annot.html#::::RemoveNotificationTarget">::::RemoveNotificationTarget</a></a></strong><a name="::::RemoveNotificationTarget"></a> { target } {

	global DUT1_CONNECT
        <a name="::SendACmd(16)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;delete xml-notification target $target&#34;
	<a name="::Login(8)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $DUT1_CONNECT
}

<strong><a name="::::readLogXmlNotification_134">proc <a href="xml-notification.tcl-annot.html#::::readLogXmlNotification">::::readLogXmlNotification</a></a></strong><a name="::::readLogXmlNotification"></a> {  matchAttr  } {
	set logFileName &#34;../../main/Tmp/apache-tomcat-6.0.20/logs/catalina.out&#34;
	set logFile [open $logFileName r]
	set msg [read $logFile]
	foreach line [split $msg &#34;\n&#34;] {
		if { [<a name="::::VerifyXmlNotification(1)"><a href="./xml-notification.tcl.html#::::VerifyXmlNotification_147">::::VerifyXmlNotification</a></a> $line $matchAttr] } {
			return 1
		}
	}	
	<a name="::result_debug(1)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$matchAttr Not Found&#34;
	return 0
}

<strong><a name="::::VerifyXmlNotification_147">proc <a href="xml-notification.tcl-annot.html#::::VerifyXmlNotification">::::VerifyXmlNotification</a></a></strong><a name="::::VerifyXmlNotification"></a> { keyValue matchAttr } {

	foreach attr $matchAttr {
		if {[string match -nocase *$attr* $keyValue]} {
			<a name="::result_debug(2)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$attr Found&#34;
		} else {
<span class="comment-line">#			result_error &#34;$attr Not Found&#34;</span>
			return 0
		}		
	}
	return 1
}
</pre>
<hr>
<div class="index-selector">
	<a href="index_main.html#byfilename">file name</a> 
 | 
	<a href="index_main.html#byprocname">procedure name</a> 
 | 
	<a href="index_main.html#bycall">procedure call</a> 
 | 
	<a href="index_annot_full.html">annotation</a> 

<br>
<cite>File generated 2018-06-14 at 17:09.</cite>
</div>

</body>
</html>
