<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/transitional.dtd">
<!-- Generated by TclDoc @@VERSION@@ -->
<html>
<head>
  <title>ISIS.tcl</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="default.css">
</head>
<body class="src-html">
<div class="index-selector">
<!-- index for tcl source files -->
	Index by: 
	<a href="index_main.html#ISIS.tcl">file name</a> | 
	<a href="index_main.html#byprocname">procedure name</a> | 
	<a href="index_main.html#bycall">procedure call</a> | 
	<a href="index_annot_full.html">annotation</a>

</div>
<hr>

<p><strong>ISIS.tcl</strong>&nbsp;&nbsp;<span class="filetype-link">(<a href="ISIS.tcl-annot.html">annotations</a> | <a href="ISIS.tcl.txt">original source</a>)</span>
</p>
<pre class="src-code">

<span class="comment-line"># convert MAC format to ISIS system ID format, e.g. 01:02:03:04:05:06 -&gt; 0102.0304.0506</span>
<strong><a name="::::MacToIsisId_3">proc <a href="ISIS.tcl-annot.html#::::MacToIsisId">::::MacToIsisId</a></a></strong> {mac} {
   set list [split [string tolower $mac] &#34;:&#34;]
   return [lindex $list 0][lindex $list 1].[lindex $list 2][lindex $list 3].[lindex $list 4][lindex $list 5]
}

<span class="comment-line"># clean manual area address of Level-2 except the 1st one which is the last one and can't be deleted</span>
<strong><a name="::::CleanLevel2AreaManuAddress_9">proc <a href="ISIS.tcl-annot.html#::::CleanLevel2AreaManuAddress">::::CleanLevel2AreaManuAddress</a></a></strong> { {dutNo &#34;1&#34;} } { 

    global DUT${dutNo}_CONNECT

    <a name="::Login(1)"><a href="./login.tcl.html#::Login_24">::Login</a></a> [set DUT${dutNo}_CONNECT] 

    lappend getKeyList &#34;{Manual Area Addresses:} 1&#34;
    set numAddress [<a name="::GetKeyValue(1)"><a href="./OptionCheck.tcl.html#::GetKeyValue_438">::GetKeyValue</a></a> &#34;show isis Level-2&#34; $getKeyList]
    unset getKeyList
    if {$numAddress == 0} {
	return &#34;NO_MANUAL_ADDRESS&#34;
    } else {
	set i $numAddress
	while { $i &gt; 1 } {
	    lappend getKeyList &#34;{Manual Area Addresses: $numAddress -} $i&#34;
	    set addr [<a name="::GetKeyValue(2)"><a href="./OptionCheck.tcl.html#::GetKeyValue_438">::GetKeyValue</a></a> &#34;show isis Level-2&#34; $getKeyList]
	    unset getKeyList
	    <a name="::SendACmd(1)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config isis Level-2 delete [string trimright $addr , ]&#34;
	    set i [expr $i - 1]
	}
	lappend getKeyList &#34;{Manual Area Addresses: 1 -} 1&#34;
	set addr [<a name="::GetKeyValue(3)"><a href="./OptionCheck.tcl.html#::GetKeyValue_438">::GetKeyValue</a></a> &#34;show isis Level-2&#34; $getKeyList]
	unset getKeyList
	return [string trimright $addr , ]  ;<span class="comment-line"># return the 1st area address if existing</span>
    }
  
} 

<span class="comment-line"># tests 1.4.* all share the same 2 DUTs config</span>
<strong><a name="::::SetUp1.4_38">proc <a href="ISIS.tcl-annot.html#::::SetUp1.4">::::SetUp1.4</a></a></strong> {filePt {enableISIS &#34;1&#34;}} {

    global DUT1_CONNECT
    global DUT2_CONNECT

    set vlanIp(1,1) 131.1.10.1/24
    set vlanIp(1,2) 131.1.20.1/24
    set vlanIp(1,3) 133.2.2.2/24
    set vlanIp(2,1) 133.2.2.1/24
    set vlanIp(2,2) 192.10.1.1/24

    puts &#34;vlanIp(2,2) = $vlanIp(2,2)&#34;

    <a name="::Login(2)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $DUT1_CONNECT $filePt
    <a name="::SendACmd(2)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable isis&#34;
    <a name="::SendACmd(3)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;create isis area area14&#34;
    <a name="::SendACmd(4)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config isis area area14 add 00.0001&#34;
    <a name="::SendACmd(5)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config isis Level-2 add 02&#34;
    for {set i 1} {$i &lt;= 3} {incr i} {
	<a name="::SendACmd(6)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;create vlan vlan$i&#34;
	<a name="::SendACmd(7)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config vlan$i ipaddress $vlanIp(1,$i)&#34;
	if { $i != 3}  {
	    <a name="::SendACmd(8)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config vlan$i add port [<a name="::MapDUTPortId(1)"><a href="./ePTPortMapping.tcl.html#::MapDUTPortId_120">::MapDUTPortId</a></a> $i 1]&#34;
	} else {
	    <a name="::SendACmd(9)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config vlan3 add port [<a name="::::GetATrunkPort(1)"><a href="./SystemSetup.tcl.html#::::GetATrunkPort_601">::::GetATrunkPort</a></a> 1 2 1]&#34;
	}   
	<a name="::SendACmd(10)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;enable ipforwarding vlan$i&#34;
	<a name="::SendACmd(11)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config isis add vlan vlan$i level-1-2 area area14&#34;
    }

    <a name="::Login(3)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $DUT2_CONNECT $filePt
    <a name="::SendACmd(12)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable isis&#34;
    <a name="::SendACmd(13)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;create isis area area14&#34;
    <a name="::SendACmd(14)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config isis area area14 add 00.0001&#34;
    <a name="::SendACmd(15)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config isis Level-2 add 02&#34;
    for {set i 1} {$i &lt;= 2} {incr i} {
	<a name="::SendACmd(16)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;create vlan vlan$i&#34;
	<a name="::SendACmd(17)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config vlan$i ipaddress $vlanIp(2,$i)&#34;
	if { $i == 1 }  {
	    <a name="::SendACmd(18)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config vlan1 add port [<a name="::::GetATrunkPort(2)"><a href="./SystemSetup.tcl.html#::::GetATrunkPort_601">::::GetATrunkPort</a></a> 2 1 1]&#34;
	} else {
	    <a name="::SendACmd(19)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config vlan2 add port [<a name="::MapDUTPortId(2)"><a href="./ePTPortMapping.tcl.html#::MapDUTPortId_120">::MapDUTPortId</a></a> 3 2]&#34;
	}   
	<a name="::SendACmd(20)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;enable ipforwarding vlan$i&#34;
	<a name="::SendACmd(21)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config isis add vlan vlan$i level-1-2 area area14&#34;
    }
    <a name="::result_debug(1)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;lower DUT2's vlan1 L-1-2 priority to be 60, so vlan3 on DUT1 will be DR&#34;
    <a name="::SendACmd(22)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config isis vlan vlan1 level-1-2 priority 60&#34;

    if {$enableISIS} {
	<a name="::Login(4)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $DUT1_CONNECT $filePt
	<a name="::SendACmd(23)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;enable isis&#34;

	<a name="::Login(5)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $DUT2_CONNECT $filePt
	<a name="::SendACmd(24)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;enable isis&#34;
  
	<a name="::result_debug(2)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\nwait for 10 sec to ensure adjacency establishment&#34;
	sleep 10
    }  

}

<strong><a name="::::CleanUp1.4_100">proc <a href="ISIS.tcl-annot.html#::::CleanUp1.4">::::CleanUp1.4</a></a></strong> {filePt} {

    global DUT1_CONNECT
    global DUT2_CONNECT

    <a name="::Login(6)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $DUT1_CONNECT $filePt
    <a name="::SendACmd(25)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable isis&#34;
    for {set i 1} {$i &lt;= 3} {incr i} {
	<a name="::SendACmd(26)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;delete vlan vlan$i&#34;
    }
    <a name="::SendACmd(27)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;delete isis area area14&#34;
    <a name="::SendACmd(28)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config isis Level-2 delete 02&#34; 

    <a name="::Login(7)"><a href="./login.tcl.html#::Login_24">::Login</a></a> $DUT2_CONNECT $filePt
    <a name="::SendACmd(29)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;disable isis&#34;
    for {set i 1} {$i &lt;= 2} {incr i} {
	<a name="::SendACmd(30)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;delete vlan vlan$i&#34;
    }
    <a name="::SendACmd(31)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;delete isis area area14&#34;
    <a name="::SendACmd(32)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;config isis Level-2 delete 02&#34; 

}

<span class="comment-line">##################################################################    </span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     The follwoing procs are used to decode PDU type, etc if the frame</span>
<span class="comment-line">#     is a ISIS PDU.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: rawFrame</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::RemoveIsisVlanTag_131">proc <a href="ISIS.tcl-annot.html#::::RemoveIsisVlanTag">::::RemoveIsisVlanTag</a></a></strong> { rawFrame } {
    set tagType [string range $rawFrame 36 40]
    <span class="comment-line"># if tagged, get rid of type and tag field from 36 to 47</span>
    if {$tagType == &#34;81 00&#34;} {
	set leftRawFrame [string range $rawFrame 0 35] 
	set rightRawFrame [string range $rawFrame 48 [string length $rawFrame]] 
	set rawFrame [format &#34;%s%s&#34; $leftRawFrame $rightRawFrame]
    }
    return $rawFrame
}

<strong><a name="::::GetIsisDestMacAddr_142">proc <a href="ISIS.tcl-annot.html#::::GetIsisDestMacAddr">::::GetIsisDestMacAddr</a></a></strong> { rawFrame } {
    return [string range $rawFrame 0 16]
}

<strong><a name="::::GetIsisSourceMacAddr_146">proc <a href="ISIS.tcl-annot.html#::::GetIsisSourceMacAddr">::::GetIsisSourceMacAddr</a></a></strong> { rawFrame } {
    return [string range $rawFrame 18 34]
}   

<strong><a name="::::GetIsisDlcLength_150">proc <a href="ISIS.tcl-annot.html#::::GetIsisDlcLength">::::GetIsisDlcLength</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(1)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    regsub -all { } [string range $mFrame 36 40] {} hexVal
    return [<a name="::hextodec(1)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> $hexVal]
}

<strong><a name="::::GetIsisIRPD_156">proc <a href="ISIS.tcl-annot.html#::::GetIsisIRPD">::::GetIsisIRPD</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(2)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    return [<a name="::hextodec(2)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $mFrame 51 52]]
}

<strong><a name="::::GetIsisHeaderLength_161">proc <a href="ISIS.tcl-annot.html#::::GetIsisHeaderLength">::::GetIsisHeaderLength</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(3)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    return [<a name="::hextodec(3)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $mFrame 54 55]]
}

<strong><a name="::::GetIsisVersionPID_166">proc <a href="ISIS.tcl-annot.html#::::GetIsisVersionPID">::::GetIsisVersionPID</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(4)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    return [<a name="::hextodec(4)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $mFrame 57 58]]
}

<span class="comment-line"># --- ID length = 0 indciates 6 octets</span>
<strong><a name="::::GetIsisIdLength_172">proc <a href="ISIS.tcl-annot.html#::::GetIsisIdLength">::::GetIsisIdLength</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(5)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    return [<a name="::hextodec(5)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $mFrame 60 61]]
}


<strong><a name="::::GetIsisVersion_178">proc <a href="ISIS.tcl-annot.html#::::GetIsisVersion">::::GetIsisVersion</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(6)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    return [<a name="::hextodec(6)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $mFrame 66 67]]
}

<strong><a name="::::GetIsisReserved_183">proc <a href="ISIS.tcl-annot.html#::::GetIsisReserved">::::GetIsisReserved</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(7)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    return [<a name="::hextodec(7)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $mFrame 69 70]]
}

<strong><a name="::::GetIsisMaxAreaAddr_188">proc <a href="ISIS.tcl-annot.html#::::GetIsisMaxAreaAddr">::::GetIsisMaxAreaAddr</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(8)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    return [<a name="::hextodec(8)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $mFrame 72 73]]
}

<strong><a name="::::GetIsisHelloCircuitType_193">proc <a href="ISIS.tcl-annot.html#::::GetIsisHelloCircuitType">::::GetIsisHelloCircuitType</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(9)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    return [<a name="::hextodec(9)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $mFrame 75 76]]
}

<strong><a name="::::GetIsisHelloSourceId_198">proc <a href="ISIS.tcl-annot.html#::::GetIsisHelloSourceId">::::GetIsisHelloSourceId</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(10)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    return [string range $mFrame 78 94]
}

<strong><a name="::::GetIsisHelloHoldTime_203">proc <a href="ISIS.tcl-annot.html#::::GetIsisHelloHoldTime">::::GetIsisHelloHoldTime</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(11)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    regsub -all { } [string range $mFrame 96 100] {} hexVal
    return [<a name="::hextodec(10)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> $hexVal]
}

<strong><a name="::::GetIsisHelloFrameLength_209">proc <a href="ISIS.tcl-annot.html#::::GetIsisHelloFrameLength">::::GetIsisHelloFrameLength</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(12)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    regsub -all { } [string range $mFrame 102 106] {} hexVal
    return [<a name="::hextodec(11)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> $hexVal]
}

<strong><a name="::::GetIsisHelloPriority_215">proc <a href="ISIS.tcl-annot.html#::::GetIsisHelloPriority">::::GetIsisHelloPriority</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(13)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    return [<a name="::hextodec(12)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $mFrame 108 109]]
}

<strong><a name="::::GetIsisHelloLanId_220">proc <a href="ISIS.tcl-annot.html#::::GetIsisHelloLanId">::::GetIsisHelloLanId</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(14)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    return [string range $mFrame 111 130]
}

<strong><a name="::::GetIsisLspFrameLength_225">proc <a href="ISIS.tcl-annot.html#::::GetIsisLspFrameLength">::::GetIsisLspFrameLength</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(15)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    regsub -all { } [string range $mFrame 75 79] {} hexVal
    return [<a name="::hextodec(13)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> $hexVal]
}

<strong><a name="::::GetIsisLspRemainLifetime_231">proc <a href="ISIS.tcl-annot.html#::::GetIsisLspRemainLifetime">::::GetIsisLspRemainLifetime</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(16)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    regsub -all { } [string range $mFrame 81 85] {} hexVal
    return [<a name="::hextodec(14)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> $hexVal]
}

<strong><a name="::::GetIsisLspFrameId_237">proc <a href="ISIS.tcl-annot.html#::::GetIsisLspFrameId">::::GetIsisLspFrameId</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(17)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    return [string range $mFrame 87 109] 
}

<strong><a name="::::GetIsisLspFrameSequence_242">proc <a href="ISIS.tcl-annot.html#::::GetIsisLspFrameSequence">::::GetIsisLspFrameSequence</a></a></strong> { rawFrame } {
   set mFrame [<a name="::RemoveIsisVlanTag(18)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
   regsub -all { } [string range $mFrame 111 121] {} hexVal
   return [<a name="::hextodec(15)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> $hexVal]
}

<strong><a name="::::GetIsisLspChecksum_248">proc <a href="ISIS.tcl-annot.html#::::GetIsisLspChecksum">::::GetIsisLspChecksum</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(19)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    return [string range $mFrame 123 127] 
}

<strong><a name="::::GetIsisCsnpFrameLength_253">proc <a href="ISIS.tcl-annot.html#::::GetIsisCsnpFrameLength">::::GetIsisCsnpFrameLength</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(20)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    regsub -all { } [string range $mFrame 75 79] {} hexVal
    return [<a name="::hextodec(16)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> $hexVal]
}

<strong><a name="::::GetIsisCsnpSourceId_259">proc <a href="ISIS.tcl-annot.html#::::GetIsisCsnpSourceId">::::GetIsisCsnpSourceId</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(21)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    return [string range $mFrame 81 100]
}

<strong><a name="::::GetIsisCsnpStartLspId_264">proc <a href="ISIS.tcl-annot.html#::::GetIsisCsnpStartLspId">::::GetIsisCsnpStartLspId</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(22)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    return [string range $mFrame 102 124]
}

<strong><a name="::::GetIsisCsnpEndLspId_269">proc <a href="ISIS.tcl-annot.html#::::GetIsisCsnpEndLspId">::::GetIsisCsnpEndLspId</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(23)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    return [string range $mFrame 126 148]
}

<strong><a name="::::GetIsisPsnpFrameLength_274">proc <a href="ISIS.tcl-annot.html#::::GetIsisPsnpFrameLength">::::GetIsisPsnpFrameLength</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(24)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    regsub -all { } [string range $mFrame 75 79] {} hexVal
    return [<a name="::hextodec(17)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> $hexVal]
}

<strong><a name="::::GetIsisPsnpSourceId_280">proc <a href="ISIS.tcl-annot.html#::::GetIsisPsnpSourceId">::::GetIsisPsnpSourceId</a></a></strong> { rawFrame } {
    set mFrame [<a name="::RemoveIsisVlanTag(25)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    return [string range $mFrame 81 100]
}

<span class="comment-line"># --- in Hello, variable-length fields are after position #132 (44 * 3) </span>
<span class="comment-line">#proc CheckHelloClv { rawFrame field {byteOffset &#34;44&#34;} } {</span>
<span class="comment-line">#    set clvs [string range [RemoveIsisVlanTag $rawFrame] [expr 3*$byteOffset] end]</span>
<span class="comment-line">#    result_debug &#34;$clvs bit&#34;</span>
<span class="comment-line">#    return [regexp -nocase $field $clvs]</span>
<span class="comment-line">#}</span>


<span class="comment-line"># --- in Hello, variable-length fields are after position #132 (44 * 3)</span>
<strong><a name="::::CheckHelloClv_294">proc <a href="ISIS.tcl-annot.html#::::CheckHelloClv">::::CheckHelloClv</a></a></strong> { rawFrame field startByte endByte} {
    set vlantag [<a name="::RemoveIsisVlanTag(26)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame]
    <a name="::result_ok(1)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;VLANTAG==&gt; $vlantag&#34;
    set clvs [string range [<a name="::RemoveIsisVlanTag(27)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame] $startByte $endByte]
    <a name="::result_debug(3)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$clvs bit&#34;
    return [regexp -nocase $field $clvs]
}



<span class="comment-line"># --- in LSP, variable-length fields are after position #132 (44 * 3) </span>
<strong><a name="::::CheckLspClv_305">proc <a href="ISIS.tcl-annot.html#::::CheckLspClv">::::CheckLspClv</a></a></strong> { rawFrame field {byteOffset &#34;44&#34;} } {
    set clvs [string range [<a name="::RemoveIsisVlanTag(28)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame] [expr 3*$byteOffset] end]
    return [regexp -nocase $field $clvs]
}

<span class="comment-line"># --- in LSP, variable-length fields are after position #132 (44 * 3) </span>
<strong><a name="::::GetLspClvs_311">proc <a href="ISIS.tcl-annot.html#::::GetLspClvs">::::GetLspClvs</a></a></strong> { rawFrame {byteOffset &#34;44&#34;} } {
    set clvs [string range [<a name="::RemoveIsisVlanTag(29)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame] [expr 3*$byteOffset] end]
    return $clvs
}
  
<span class="comment-line"># --- in CSNP, variable-length fields are after position #150 (50 * 3) </span>
<strong><a name="::::CheckCsnpClv_317">proc <a href="ISIS.tcl-annot.html#::::CheckCsnpClv">::::CheckCsnpClv</a></a></strong> { rawFrame field {byteOffset &#34;50&#34;} } {
    set clvs [string range [<a name="::RemoveIsisVlanTag(30)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame] [expr 3*$byteOffset] end]
    return [regexp -nocase $field $clvs]
}

<span class="comment-line"># --- in PSNP, variable-length fields are after position #102 (34 * 3) </span>
<strong><a name="::::CheckPsnpClv_323">proc <a href="ISIS.tcl-annot.html#::::CheckPsnpClv">::::CheckPsnpClv</a></a></strong> { rawFrame field {byteOffset &#34;34&#34;} } {
    set clvs [string range [<a name="::RemoveIsisVlanTag(31)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame] [expr 3*$byteOffset] end]
    return [regexp -nocase $field $clvs]
}

<strong><a name="::::GetPsnpClvs_328">proc <a href="ISIS.tcl-annot.html#::::GetPsnpClvs">::::GetPsnpClvs</a></a></strong> { rawFrame {byteOffset &#34;34&#34;} } {
    set clvs [string range [<a name="::RemoveIsisVlanTag(32)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $rawFrame] [expr 3*$byteOffset] end]
    return $clvs
}


<span class="comment-line">##################################################################    </span>
<span class="comment-line"># Procedure Name: GetCLV</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     The follwoing proc is used to search the CLVs to find the one</span>
<span class="comment-line">#	match the clv code specified</span>
<span class="comment-line">#     </span>
<span class="comment-line"># Input args: </span>
<span class="comment-line">#	clvs	- the clvs returned from GetxxxxClvs (including the ending</span>
<span class="comment-line">#			frame checksum)</span>
<span class="comment-line">#	code	- the clv code to locate</span>
<span class="comment-line">#	index	- the index-sh clv in the clvs</span>
<span class="comment-line"># Output args: None</span>
<span class="comment-line"># return: the clv</span>
<span class="comment-line"># Typical Usage:  </span>
<span class="comment-line">#	set clvs [GetpsnpClvs $frame]</span>
<span class="comment-line">#	set code9Clv [GetCLV $clvs 9 0]</span>
<span class="comment-line">##################################################################</span>
<span class="comment-line"># --- the input clvs is expected to have included the ending checksum</span>
<strong><a name="::::GetCLV_352">proc <a href="ISIS.tcl-annot.html#::::GetCLV">::::GetCLV</a></a></strong> { clvs code {index 0}} {
    set clvsLength [string length $clvs]
    incr clvsLength -6
    set clvs [string range $clvs 0 [expr $clvsLength -1]]
    <a name="::result_debug(4)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;clvs = $clvs&#34;
    <a name="::result_debug(5)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;clvsLength = $clvsLength&#34;
    set count 0
    while { $clvsLength &gt; 0 } {
	set clvCode [<a name="::hextodec(18)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $clvs 0 1]]
	set clvLengthField [<a name="::hextodec(19)"><a href="./ePTUtils.tcl.html#::hextodec_451">::hextodec</a></a> [string range $clvs 3 4]]
	<a name="::result_debug(6)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;clvCode = $clvCode&#34;
	<a name="::result_debug(7)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;clvLengthField = $clvLengthField&#34;
	set clvLength [expr 3 * [expr $clvLengthField + 2]]
	if { $clvCode == $code } {
	    if {$count == $index } {
		return [string range $clvs 0  [expr $clvLength - 1]]
	    }
	    incr count
	}
	set clvs [string range $clvs $clvLength [expr $clvsLength -1]]
	set clvsLength [expr $clvsLength - $clvLength]
	<a name="::result_debug(8)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;clvs = $clvs&#34;
	<a name="::result_debug(9)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;clvsLength = $clvsLength&#34;
    }
    return &#34;&#34;
}


<span class="comment-line">##################################################################    </span>
<span class="comment-line"># Procedure Name: decodeIsisPackets</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     The follwoing proc is used to decode ISIS packets</span>
<span class="comment-line">#     </span>
<span class="comment-line"># Input args: </span>
<span class="comment-line">#	frameList- the captured raw frames</span>
<span class="comment-line">#	dut	- for output display purpose</span>
<span class="comment-line">#	level	- for output display purpose</span>
<span class="comment-line"># Output args: None</span>
<span class="comment-line"># Typical Usage:  </span>
<span class="comment-line">#	decodeIsisPackets $frameList 1 2</span>
<span class="comment-line">##################################################################</span>
<span class="comment-line"># --- to decode isis packets</span>
<strong><a name="::::decodeIsisPackets_394">proc <a href="ISIS.tcl-annot.html#::::decodeIsisPackets">::::decodeIsisPackets</a></a></strong> {frameList {dut 1} {level 1} } {

    set dutMac [<a name="::GetDUTMac(1)"><a href="./misc.tcl.html#::GetDUTMac_380">::GetDUTMac</a></a> DUT$dut &#34; &#34;]
    if {$level == 1} {
	set isisDestMac &#34;01 80 C2 00 00 14&#34;
    } else {   
	set isisDestMac &#34;01 80 C2 00 00 15&#34;
    }

    <a name="::result_debug(10)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\n==== Decode DUT $dut Level $level PDU ====&#34;
    <a name="::result_debug(11)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Source Mac = $dutMac&#34;
    <a name="::result_debug(12)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Dest Mac = $isisDestMac&#34; 
    set frameListLength [llength $frameList]
    <a name="::result_debug(13)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;total number of frames: $frameListLength&#34;
 	
    for {set i 0} {$i &lt; $frameListLength} {incr i} {
    
	<a name="::result_debug(14)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\n    ++++ Decoded DUT $dut Level $level PDU ++++&#34;
	set frame [lindex $frameList $i]
	<a name="::result_debug(15)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;frame $i = $frame&#34; 
	set destMac [<a name="::GetIsisDestMacAddr(1)"><a href="./ISIS.tcl.html#::GetIsisDestMacAddr_142">::GetIsisDestMacAddr</a></a> $frame]
	set srcMac [<a name="::GetIsisSourceMacAddr(1)"><a href="./ISIS.tcl.html#::GetIsisSourceMacAddr_146">::GetIsisSourceMacAddr</a></a> $frame]
	set 8023Len [<a name="::GetIsisDlcLength(1)"><a href="./ISIS.tcl.html#::GetIsisDlcLength_150">::GetIsisDlcLength</a></a> $frame]
	set headerLen [<a name="::GetIsisHeaderLength(1)"><a href="./ISIS.tcl.html#::GetIsisHeaderLength_161">::GetIsisHeaderLength</a></a> $frame]
	set pduType [<a name="::GetIsisPduType(1)"><a href="./ISISv6.tcl.html#::GetIsisPduType_14">::GetIsisPduType</a></a> $frame]
	set frameLen [<a name="::GetIsisLspFrameLength(1)"><a href="./ISIS.tcl.html#::GetIsisLspFrameLength_225">::GetIsisLspFrameLength</a></a> $frame]  
	<a name="::result_debug(16)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;destination MAC = $destMac&#34;
	<a name="::result_debug(17)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;source MAC = $srcMac&#34;
	<a name="::result_debug(18)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;802.3 length = $8023Len&#34;
	<a name="::result_debug(19)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;header length = $headerLen&#34;  
	<a name="::result_debug(20)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;PDU Type = $pduType&#34;
	<a name="::result_debug(21)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;frame length = $frameLen&#34;
    
	if {$pduType == &#34;ISIS_LEVEL1_LSP&#34; || $pduType == &#34;ISIS_LEVEL2_LSP&#34; } {
    	    set remainLifetime [<a name="::GetIsisLspRemainLifetime(1)"><a href="./ISIS.tcl.html#::GetIsisLspRemainLifetime_231">::GetIsisLspRemainLifetime</a></a> $frame]
	    set lspId [<a name="::GetIsisLspFrameId(1)"><a href="./ISIS.tcl.html#::GetIsisLspFrameId_237">::GetIsisLspFrameId</a></a> $frame]
	    set frameSeq [<a name="::GetIsisLspFrameSequence(1)"><a href="./ISIS.tcl.html#::GetIsisLspFrameSequence_242">::GetIsisLspFrameSequence</a></a> $frame]
	    set checksum [<a name="::GetIsisLspChecksum(1)"><a href="./ISIS.tcl.html#::GetIsisLspChecksum_248">::GetIsisLspChecksum</a></a> $frame]
	    <a name="::result_debug(22)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;remaining lifetime = $remainLifetime&#34;
	    <a name="::result_debug(23)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;LSP ID = $lspId&#34;    
	    <a name="::result_debug(24)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;frame sequence = $frameSeq&#34;
	    <a name="::result_debug(25)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;checksum = $checksum&#34;	
	} elseif {$pduType == &#34;ISIS_LEVEL1_CSNP&#34; || $pduType == &#34;ISIS_LEVEL2_CSNP&#34; } {  
	    set srcId [<a name="::GetIsisCsnpSourceId(1)"><a href="./ISIS.tcl.html#::GetIsisCsnpSourceId_259">::GetIsisCsnpSourceId</a></a> $frame]
	    set startLspId [<a name="::GetIsisCsnpStartLspId(1)"><a href="./ISIS.tcl.html#::GetIsisCsnpStartLspId_264">::GetIsisCsnpStartLspId</a></a> $frame]
	    set endLspId [<a name="::GetIsisCsnpEndLspId(1)"><a href="./ISIS.tcl.html#::GetIsisCsnpEndLspId_269">::GetIsisCsnpEndLspId</a></a> $frame]
	    <a name="::result_debug(26)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;source ID = $srcId&#34;
	    <a name="::result_debug(27)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;start LSP ID = $startLspId&#34;
	    <a name="::result_debug(28)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;end LSP ID = $endLspId&#34;	
	} elseif {$pduType == &#34;ISIS_LEVEL1_PSNP&#34; || $pduType == &#34;ISIS_LEVEL2_PSNP&#34; } {
	    set srcId [<a name="::GetIsisPsnpSourceId(1)"><a href="./ISIS.tcl.html#::GetIsisPsnpSourceId_280">::GetIsisPsnpSourceId</a></a> $frame]
	    <a name="::result_debug(29)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;source ID = $srcId&#34;	
	}
    }

}


<span class="comment-line">##################################################################    </span>
<span class="comment-line"># Procedure Name: EnableIsisFilterOutHello</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     The follwoing proc is used to set up ixia filter to filter out </span>
<span class="comment-line">#	ISIS Hello packets</span>
<span class="comment-line">#     </span>
<span class="comment-line"># Input args: </span>
<span class="comment-line">#	PostIdList - ixia port IDs</span>
<span class="comment-line"># Output args: None</span>
<span class="comment-line"># Typical Usage:  </span>
<span class="comment-line">#	EnableIsisFilterOutHello 1</span>
<span class="comment-line">##################################################################</span>
<span class="comment-line"># --- Most of the time, we dont need to look into hello packets</span>
<strong><a name="::::EnableIsisFilterOutHello_465">proc <a href="ISIS.tcl-annot.html#::::EnableIsisFilterOutHello">::::EnableIsisFilterOutHello</a></a></strong> {portIdList} {
global TrafficGen

   if {$TrafficGen == &#34;stc&#34; } { <a name="::result_debug(30)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;STC NOT filtering ISIS hello packets&#34;; return}
      
    foreach portId $portIdList {
	<a name="::MapIxiaPortId(1)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $portId chas card port
	<a name="::port(1)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> get $chas $card $port
    
	<span class="comment-line"># Define filter &amp; capture</span>
	<a name="::filterPallette(1)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> config -pattern1 {05 D9}
	<a name="::filterPallette(2)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> config -patternMask1 {00 00}
	<a name="::filterPallette(3)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> config -patternOffset1 34
	<a name="::filterPallette(4)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> config -matchType1 3
	if {$TrafficGen != &#34;ept&#34;} {

	<a name="::filterPallette(5)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> set $chas $card $port

	<a name="::filter(1)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterEnable true
	<a name="::filter(2)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerEnable true
	<a name="::filter(3)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterPattern notPattern1
	<a name="::filter(4)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerPattern notPattern1
	<a name="::filter(5)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerDA anyAddr
	<a name="::filter(6)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterDA anyAddr
	<a name="::filter(7)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> set $chas $card $port
	set portList [list [list $chas $card $port]]
	<a name="::ixWriteConfigToHardware(1)"><a href="./mapping.tcl.html#::ixWriteConfigToHardware_151">::ixWriteConfigToHardware</a></a> portList
	} else {
        <a name="::filter(8)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterEnable true
        <a name="::filter(9)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerEnable true
        <a name="::filter(10)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterPattern notPattern1
        <a name="::filter(11)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerPattern notPattern1
        <a name="::filter(12)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerDA anyAddr
        <a name="::filter(13)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterDA anyAddr

	}
    }
}


<span class="comment-line">##################################################################    </span>
<span class="comment-line"># Procedure Name: DisableIsisFilterOutHello</span>
<span class="comment-line"># Description:</span>
<span class="comment-line">#     The follwoing proc is used to reset the ixia filter that has been set up</span>
<span class="comment-line">#	to filter out ISIS Hello packets</span>
<span class="comment-line">#     </span>
<span class="comment-line"># Input args: </span>
<span class="comment-line">#	PostIdList - ixia port IDs</span>
<span class="comment-line"># Output args: None</span>
<span class="comment-line"># Typical Usage:  </span>
<span class="comment-line">#	DisableIsisFilterOutHello 1</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::DisableIsisFilterOutHello_517">proc <a href="ISIS.tcl-annot.html#::::DisableIsisFilterOutHello">::::DisableIsisFilterOutHello</a></a></strong> {portIdList} {

global TrafficGen
   if {$TrafficGen == &#34;stc&#34; } { <a name="::result_debug(31)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;STC NOT filtering ISIS hello packets&#34;; return}
    foreach portId $portIdList {
	<a name="::MapIxiaPortId(2)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $portId chas card port
	<a name="::port(2)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> get $chas $card $port
    
	<span class="comment-line"># Define filter &amp; capture</span>

	<a name="::filterPallette(6)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> config -pattern1 00
	<a name="::filterPallette(7)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> config -patternMask1 00
	if {$TrafficGen != &#34;ept&#34;} {
	<a name="::filterPallette(8)"><a href="./ePTClient.tcl.html#::filterPallette_915">::filterPallette</a></a> set $chas $card $port

	<a name="::filter(14)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterEnable true
	<a name="::filter(15)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerEnable true
	<a name="::filter(16)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterPattern anypattern
	<a name="::filter(17)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerPattern anypattern
	<a name="::filter(18)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerDA anyAddr
	<a name="::filter(19)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterDA anyAddr
	<a name="::filter(20)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> set $chas $card $port
	set portList [list [list $chas $card $port]]
	<a name="::ixWriteConfigToHardware(2)"><a href="./mapping.tcl.html#::ixWriteConfigToHardware_151">::ixWriteConfigToHardware</a></a> portList
	} else {
        <a name="::filter(21)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterEnable true
        <a name="::filter(22)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerEnable true
        <a name="::filter(23)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterPattern anypattern
        <a name="::filter(24)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerPattern anypattern
        <a name="::filter(25)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureTriggerDA anyAddr
        <a name="::filter(26)"><a href="./ePTClient.tcl.html#::filter_846">::filter</a></a> config -captureFilterDA anyAddr

	}
    }
}


<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: VerifyRefreshInterval</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: This proc is used to verify LSP refresh interval in time stamped packets</span>
<span class="comment-line">#              for $interval seconds. A tolerance is accepted in percentage by default 25%.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args:  timeStampList, interval, tolerance</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: 0 on error only</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#              VerifyRefreshInterval $DD1TimeStamp</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: VerifyTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::VerifyRefreshInterval_570">proc <a href="ISIS.tcl-annot.html#::::VerifyRefreshInterval">::::VerifyRefreshInterval</a></a></strong> {timeStampList lspId {interval 900} {tolerance 25}} {
   set subTest &#34;Verify Refresh interval is $interval seconds for LSPID $lspId&#34;
   <a name="::report_start_test(1)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;$subTest&#34;
   
   <span class="comment-line"># Check for error</span>
   if {[llength $timeStampList]&lt;2} {
      <a name="::result_error(1)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Insufficient information in timestamp list, FAIL&#34;
      <a name="::report_end_test(1)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>
      
      return 0
   }
   
   for {set i 0} {$i &lt; [expr [llength $timeStampList]-1]} {incr i} {
      set secondTimeStamp [lindex $timeStampList [expr $i + 1]]
      set firstTimeStamp [lindex $timeStampList $i]
      
      <span class="comment-line"># Store in mili seconds</span>
<span class="comment-line">#      set secTimeStamp [string range $secondTimeStamp 0 8]</span>
<span class="comment-line">#      set firTimeStamp [string range $firstTimeStamp 0 8]</span>
      
      <span class="comment-line">#result_debug &#34;the firTimeStamp:$firTimeStamp, secTimeStamp:$secTimeStamp&#34;</span>
      set intervalInSe [mpexpr $secondTimeStamp-$firstTimeStamp]
      set intervalInSec [mpexpr $intervalInSe/1000000000.0]
      set diff [expr abs(double($intervalInSec) - double($interval))]
      set percent [expr double($diff)/ double($interval)*100.0]
      <a name="::result_debug(32)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;The interval=$intervalInSec, percent=$percent and diff:$diff&#34;
      <span class="comment-line"># Count for a percentage of 1 tolerance</span>
      if {$percent &lt;= $tolerance} {
         set result &#34;ok&#34;
      } else {
         set wrongInterval $intervalInSec
         set result &#34;ng&#34;
      }
   }

   if {$result == &#34;ok&#34;} {
      <a name="::result_ok(2)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Packets correctly spaced with $intervalInSec secs, PASS&#34;
   } else {
      <a name="::result_error(2)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Packets incorrectly spaced with $wrongInterval secs, FAIL&#34;
   }
   <a name="::report_end_test(2)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: CheckReachability</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: This proc is used to verify LSDB Internal or External Reachability.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args:  </span>
<span class="comment-line">#      - &lt;command&gt; - CLI command to execute</span>
<span class="comment-line">#      - &lt;parameterList&gt; - a list of keys to look for values</span>
<span class="comment-line">#                          Note: only support one key right now (Combination described in usage)</span>
<span class="comment-line">#      - [type] - Internal or External</span>
<span class="comment-line">#      - [testNo] - test number to be printed for reference in report.txt</span>
<span class="comment-line">#      - [comment] - text for comment for reference purposes to be put in report.txt</span>
<span class="comment-line">#      - [dut] - dut number (1,2,3,4..) on the command output is to be tested</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Return value: - returns &#34;ok&#34; if success &#34;error&#34; if failure</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#              VerifyInternalReachability &#34;show isis lsdb level-2 detail&#34; $paramList</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category: </span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::CheckReachability_633">proc <a href="ISIS.tcl-annot.html#::::CheckReachability">::::CheckReachability</a></a></strong> {command parameterList args} {
   
    global spawn_id
    set tmp &#34;Tmp&#34;
    set pwd [pwd]
    set pid _[pid]
    set done 0
   
    <a name="::parse_args(1)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> CheckKeyValue $args {
	testNo  &#34;CheckKeyValue&#34;
	comment &#34;&#34;
	dut     0
	type    &#34;Internal&#34;
    }

    if {$dut!=0} {
	set DUTName [format %s%d DUT $dut]
	global ${DUTName}_CONNECT;
	<a name="::Login(8)"><a href="./login.tcl.html#::Login_24">::Login</a></a> [set ${DUTName}_CONNECT];
    }

    if {([regexp -- {[\/]} $command]) &amp;&amp; ([string match {for file operation:*} $comment]) } {
	<span class="comment-line"># Command is passed as a file, read the file instead</span>
	<span class="comment-line"># of running the command</span>
	<a name="::report_start_test(2)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;Checking $type Reachability $comment&#34;
    } else {
	<a name="::report_start_test(3)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;Checking &lt;$command&gt; for $type Reachability $comment&#34;
    }
   
    foreach itemList $parameterList {
	set key [lindex $itemList 0]
	set valueWanted [lindex $itemList 1]
	set dataArray($key,$valueWanted,found) &#34;keyNotFound&#34;  ;<span class="comment-line">#might have the same key</span>
	set dataArray($key,$valueWanted,flag) &#34;exist&#34;
	if {[lindex $itemList 3] == &#34;notExist&#34;} {set dataArray($key,$valueWanted,flag) &#34;notExist&#34;} 
	if {[lindex $itemList 2] == &#34;notExist&#34;} {set dataArray($key,$valueWanted,flag) &#34;notExist&#34;} 
	if {[lindex $itemList 1] == &#34;notExist&#34;} {set dataArray($key,$valueWanted,flag) &#34;notExist&#34;} 
    }

    if {([regexp -- {[\/]} $command]) &amp;&amp; ([string match {for file operation:*} $comment]) } {
	set fd_in [open &#34;$command&#34; &#34;r&#34;]
    } else {
	set fd_in [open &#34;$tmp/tmp_$testNo$pid&#34; &#34;w&#34;]
	<a name="::SendACmd(33)"><a href="./SendSwCmd.tcl.html#::SendACmd_157">::SendACmd</a></a> &#34;$command&#34; NULL $fd_in
	close $fd_in
	set fd_in [open &#34;$tmp/tmp_$testNo$pid&#34; &#34;r&#34;]
    }
if { 0 } {
   set previousLine &#34;&#34;
   while {[gets $fd_in line] != -1} {
      set nextLineStart [tell $fd_in]
<span class="comment-line">#   result_debug &#34;----- Line=|$line|&#34;</span>
      foreach itemList $parameterList {
         set key [lindex $itemList 0]
         set valueWanted [lindex $itemList 1]
         if {[regexp -nocase -indices -- $key $line matchedRange] == 1} {
            <span class="comment-line">#found the key</span>
            <span class="comment-line">#result_debug &#34;Key: |$key| line: |$line| matchedRange: |$matchedRange|&#34;</span>
            set searchOption [lindex $itemList 2]
            if {$searchOption == &#34;inLine&#34; } {
               <span class="comment-line">#this is a quick hack, so it might be confusing</span>
               set lineOption [lindex $itemList 4]
               if {$lineOption == &#34;&#34; } { set lineOption 0 }
               if {$lineOption &gt; 0 } {
                  <span class="comment-line">#get the value on some line after the line where the key is found</span>
                  <span class="comment-line">#this won't work if using the same key</span>
                  for { set i 0 } { $i &lt; $lineOption } { incr i } {
                     gets $fd_in tmpLine
                  }
                  <a name="::result_debug(33)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Wanted line ${lineOption} after key: |$tmpLine|&#34; 
                  <span class="comment-line">#got needed line, backtrack so next key search works</span>
                  seek $fd_in $nextLineStart
               } elseif {$lineOption == -1 } { 
                  <a name="::result_debug(34)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Wanted the line before key: |$line|&#34; 
                  set tmpLine $previousLine 
               } else {
                  set tmpLine $line
               }
               <span class="comment-line">#value can be anywhere in this line</span>
               if {[regexp -nocase -- $valueWanted $tmpLine] == 1 } {
                   <span class="comment-line">#value looking for found</span>
                  if {$dataArray($key,$valueWanted,found) == $valueWanted } {
                     <a name="::result_debug(35)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Multiple Key: |$key| valueFound inLine: |$valueWanted|&#34;
                  } else {
                     set dataArray($key,$valueWanted,found) $valueWanted
                     <a name="::result_debug(36)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Key: |$key| valueFound inLine: |$valueWanted|&#34;
                  }
               } else {
                  if {$dataArray($key,$valueWanted,found) == &#34;notExist&#34; } {
                     set dataArray($key,$valueWanted,found) &#34;keyFoundValueNotFound&#34;
                     <a name="::result_debug(37)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Key: |$key| valueFound in Line: |$dataArray($key,$valueWanted,found)|&#34;
                  }
               }
            } elseif {$valueWanted == &#34;exist&#34;} {
               regexp -nocase -- $key $line pattern
               <a name="::result_debug(38)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Key: |$key| found with matched pattern |$pattern|&#34;
               if {$dataArray($key,$valueWanted,found) == &#34;exist&#34;} {
                  <a name="::result_warning(1)"><a href="./ql_multi.tcl.html#::result_warning_407">::result_warning</a></a> &#34;Multiple key found!!&#34;
               }           
               set dataArray($key,$valueWanted,found) &#34;exist&#34;             
            } else {
               <span class="comment-line">#value is right after key</span>
               set keyEnd [expr [lindex $matchedRange 1] + 1]
               set lineAfterKey [string range $line $keyEnd end]
               <span class="comment-line">#result_debug &#34;lineAfterKey: |$lineAfterKey|&#34;</span>
               set valueFound [lindex $lineAfterKey 0]
               if {$dataArray($key,$valueWanted,found) == $valueFound } {
                  <a name="::result_warning(2)"><a href="./ql_multi.tcl.html#::result_warning_407">::result_warning</a></a> &#34;Multiple key found!!&#34;
               }           
               set dataArray($key,$valueWanted,found) $valueFound
               <a name="::result_debug(39)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Key: |$key| valueFound: |$valueFound|&#34;
            }
        } 
     }      
     set previousLine $line   
   }
} else {
    set reachabilityList &#34;&#34;
    set key1 &#34;IP $type Reachability:&#34;
    set key2 &#34;Metric .*:&#34;
    <a name="::result_debug(40)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;key1 = $key1, key2 = $key2&#34;
    <span class="comment-line"># Look for IP Internal (or External) Reachability:</span>
    while {[gets $fd_in line] != -1} {
	if {[regexp -nocase -indices -- $key1 $line matchedRange] == 1} {
	    <span class="comment-line"># accumulate all following Metric xxx: lines</span>
	    <a name="::result_debug(41)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;found $key1&#34;
	    while {[gets $fd_in line] != -1} {
		if {[regexp -nocase -indices -- $key1 $line matchedRange] == 1} {
		    <a name="::result_debug(42)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;found again $key1&#34;
		    continue
		} elseif {[regexp -nocase -indices -- $key2 $line matchedRange] == 1} {
		    <a name="::result_debug(43)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;found $key2&#34;
		    if { [lsearch -exact $reachabilityList $line] == -1 } {
			lappend reachabilityList $line
		    }
		} else {
		    break
		}
	    }
	}
    }
}  
    close $fd_in
    file delete &#34;$tmp/tmp_$testNo$pid&#34;
    
    <a name="::result_debug(44)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;reachabilityList = $reachabilityList&#34;
    
    foreach itemList $parameterList {
    	set key [lindex $itemList 0]
    	set valueWanted [lindex $itemList 1]
    	foreach reachability $reachabilityList {
    	    if {[regexp -nocase -indices -- $key $reachability matchedRange] == 1} {
		set dataArray($key,$valueWanted,found) &#34;exist&#34;
		<a name="::result_debug(45)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;here: $key, $valueWanted, found exist&#34;
		break
    	    }
    	}
    }
    set returnCode &#34;ok&#34;
    foreach itemList $parameterList {
      set key [lindex $itemList 0]
      set valueWanted [lindex $itemList 1]
      set valueFound $dataArray($key,$valueWanted,found)
      set flag $dataArray($key,$valueWanted,flag)
      <a name="::result_debug(46)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$key, $valueWanted, $valueFound, $flag&#34;
      if {$flag == &#34;exist&#34;} {
         if { ([string tolower $valueWanted] == [string tolower $valueFound]) } {
            <a name="::result_ok(3)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Chk key &lt;$key&gt; with val &lt;$valueWanted&gt; pass&#34;
         } else {
	    <a name="::result_error(3)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Chk key &lt;$key&gt; fail. Wanted &lt;$valueWanted&gt; BUTGOT &lt;$valueFound&gt;&#34;
	    set returnCode &#34;error&#34;
         }
      } elseif {$flag == &#34;notExist&#34;} {
         if { ($valueFound == &#34;notExist&#34; )|| ($valueFound == &#34;keyNotFound&#34; ) } {
            <a name="::result_ok(4)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Chk key &lt;$key&gt; with val &lt;$valueWanted&gt;, flag &lt;$flag&gt; pass&#34;
         } else {
	    <a name="::result_error(4)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Chk key &lt;$key&gt; with val &lt;$valueWanted&gt;, flag &lt;$flag&gt; fail. Wanted &lt;$valueWanted&gt; BUTGOT &lt;$valueFound&gt;&#34;
	    set returnCode &#34;error&#34;
         }   
      } else {
          <a name="::result_error(5)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;Unexpected flag option&#34;
          set returnCode &#34;error&#34;
      }
   }

   <a name="::report_end_test(3)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>
   return $returnCode
}


<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: setupISISRouter</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description:  This proc is used to setup ixia port as an isis router. </span>
<span class="comment-line">#		It can create multiple interfaces supplied via interfaceIpList</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args:  args</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line"># setupISISRouter -dutIp &#34;62.1.0.109&#34; -interfaceIpList &#34;62.1.0.23&#34; -maskList &#34;255.255.255.0&#34; -areaIdList &#34;0&#34; \</span>
<span class="comment-line">#		 -helloIntervalList &#34;10&#34; \</span>
<span class="comment-line">#                -deadIntervalList &#34;40&#34; -networkTypeList &#34;isisBroadcast&#34; -metricList &#34;10&#34;  \</span>
<span class="comment-line">#                -numNetworksList 10000 -prefixList &#34;30&#34;  \</span>
<span class="comment-line">#                -networkIpList &#34;37.0.0.0&#34; -routerIdList &#34;62.1.0.23&#34; -txPortId 2</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: SendTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::setupISISRouter_844">proc <a href="ISIS.tcl-annot.html#::::setupISISRouter">::::setupISISRouter</a></a></strong> {args} {
   global TrafficGen
    <a name="::parse_args(2)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> setupISISRouter $args {
        dutIp &#34;&#34;
        interfaceMacList &#34;&#34;
        interfaceIpList &#34;&#34;
        maskList &#34;255.255.255.0&#34;
        areaIdList &#34;0&#34;
        levelList &#34;isisLevel2&#34;
        helloIntervalL1List &#34;10&#34;
        deadIntervalL1List &#34;30&#34;
        helloIntervalL2List &#34;10&#34;
        deadIntervalL2List &#34;30&#34;
        networkTypeList &#34;isisBroadcast&#34;
        metricList &#34;10&#34;
	routeOriginList &#34;&#34;
        numNetworksList &#34;0&#34;
        prefixList &#34;&#34;
        networkIpList &#34;&#34;
        routeMetricList &#34;10&#34;
        routerIdList &#34;&#34;
        txPortId  &#34;1&#34;
    }
    
    <span class="comment-line"># get the port information</span>
    <a name="::MapIxiaPortId(3)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $txPortId cha car por
    <a name="::result_debug(47)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;setupISISRouter: Chas: $cha Card: $car Port: $por&#34;
 switch -exact -- $TrafficGen {
      ixia -
      ixvm {
    
    <span class="comment-line"># select the port</span>
    ipAddressTable clear
    ipAddressTable setDefault
    ipAddressTable config -defaultGateway $dutIp
    ipAddressTableItem setDefault
    ipAddressTableItem config -fromIpAddress [lindex $interfaceIpList 0]
    if {[llength $interfaceMacList] &gt; 0} {
        set macAddr [lindex $interfaceMacList 0]
        if {$macAddr == &#34;default&#34;} {
            if {[<a name="::port(3)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> get $cha $car $por]} {
                error &#34;setupISISRouter: port get $chas $card $port failed.&#34;
            }
            set macAddr [<a name="::port(4)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> cget -MacAddress]
        }
    } else {
        set macAddr [<a name="::uniqMac(1)"><a href="./bgp.tcl.html#::uniqMac_1832">::uniqMac</a></a> $cha $car $por]
    }
    ipAddressTableItem config -fromMacAddress $macAddr
    ipAddressTableItem config -numAddresses 1
    ipAddressTableItem config -mappingOption oneIpToOneMac
    ipAddressTableItem config -enableUseNetwork true
    ipAddressTableItem config -netMask 24
    ipAddressTableItem set               
    ipAddressTable addItem
    ipAddressTable set $cha $car $por
    
    if {[isisServer select $cha $car $por]} {
        error &#34;setupISISRouter: isisServer select $cha $car $por failed.&#34;
    }
    if {[isisServer clearAllRouters]} {
        error &#34;setupISISRouter: isisServer clearAllRouters failed.&#34;
    }
    
      }
   }
    set routerId $macAddr
    
    for {set i 0} {$i&lt;[llength $interfaceIpList]} {incr i} {
    	<a name="::result_debug(48)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\nset up interfaces...&#34;
    	set interfaceId $macAddr
    	<a name="::result_debug(49)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;interfaceId: $interfaceId&#34;
    	<a name="::incrx(1)"><a href="./misc.tcl.html#::incrx_2341">::incrx</a></a> macAddr 5 1
    	<a name="::result_debug(50)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;macAddr: $macAddr&#34;
        set interfaceIp [lindex $interfaceIpList $i]
        <a name="::result_debug(51)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;interfaceIp: $interfaceIp&#34;
	if {[llength $maskList] &gt; 1} {
            set mask [lindex $maskList $i]
        } else {
            set mask [lindex $maskList 0]
        }
        <a name="::result_debug(52)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;mask: $mask&#34;
        if {[llength $areaIdList] &gt; 1} {
            set areaId [lindex $areaIdList $i]
        } else {
            set areaId [lindex $areaIdList 0]
        }
        <a name="::result_debug(53)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;areaId: $areaId&#34;
        if {[llength $levelList] &gt; 1} {
            set level [lindex $levelList $i]
        } else {
            set level [lindex $levelList 0]
        }
        <a name="::result_debug(54)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;level: $level&#34;
        if {[llength $helloIntervalL1List] &gt; 1} {
            set helloIntervalL1 [lindex $helloIntervalL1List $i]
        } else {
            set helloIntervalL1 [lindex $helloIntervalL1List 0]
        }
        <a name="::result_debug(55)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;helloIntervalL1: $helloIntervalL1&#34;
        if {[llength $deadIntervalL1List] &gt; 1} {
            set deadIntervalL1 [lindex $deadIntervalL1List $i]
        } else {
            set deadIntervalL1 [lindex $deadIntervalL1List 0]
        }
        <a name="::result_debug(56)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;deadIntervalL1: $deadIntervalL1&#34;
        if {[llength $helloIntervalL2List] &gt; 1} {
            set helloIntervalL2 [lindex $helloIntervalL2List $i]
        } else {
            set helloIntervalL2 [lindex $helloIntervalL2List 0]
        }
        <a name="::result_debug(57)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;helloIntervalL2: $helloIntervalL2&#34;
        if {[llength $deadIntervalL2List] &gt; 1} {
            set deadIntervalL2 [lindex $deadIntervalL2List $i]
        } else {
            set deadIntervalL2 [lindex $deadIntervalL2List 0]
        }
        <a name="::result_debug(58)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;deadIntervalL2: $deadIntervalL2&#34;
         if {[llength $networkTypeList] &gt; 1} {
            set networkType [lindex $networkTypeList $i]
        } else {
            set networkType [lindex $networkTypeList 0]
        }
        <a name="::result_debug(59)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;neworkType: $networkType&#34;
        if {[llength $metricList] &gt; 1} {
            set metric [lindex $metricList $i]
        } else {
            set metric [lindex $metricList 0]
        }
        <a name="::result_debug(60)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;metric: $metric&#34;
        if {[llength $numNetworksList] &gt; 1} {
            set numNetworks [lindex $numNetworksList $i]
        } else {
            set numNetworks [lindex $numNetworksList 0]
        }
        <a name="::result_debug(61)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;numNetworks: $numNetworks&#34;
        if {[llength $prefixList] &gt; 1} {
            set prefix [lindex $prefixList $i]
        } else {
            set prefix [lindex $prefixList 0]
        }
        <a name="::result_debug(62)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;prefix: $prefix&#34;
        if {[llength $networkIpList] &gt; 1} {
            set networkIp [lindex $networkIpList $i]
        } else {
            set networkIp [lindex $networkIpList 0]
        }
        <a name="::result_debug(63)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;networkIp: $networkIp&#34;
        if {[llength $routeOriginList] &gt; 1} {
            set routeOrigin [lindex $routeOriginList $i]
        } else {
            set routeOrigin [lindex $routeOriginList 0]
        }
        <a name="::result_debug(64)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;routeOrigin: $routeOrigin&#34;
        if {[llength $routeMetricList] &gt; 1} {
            set routeMetric [lindex $routeMetricList $i]
        } else {
            set routeMetric [lindex $routeMetricList 0]
        }
        <a name="::result_debug(65)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;routeMetric: $routeMetric&#34;
	if {[llength $routerIdList] &gt; 1} {
	    set routerId [lindex $routerIdList $i]
	} else {
	    set routerId [lindex $routerIdList 0]
	}
        if {[string length $routerId] == 0} {
            set routerId $interfaceId
        }
        <a name="::result_debug(66)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;routeId: $routerId&#34;
        set routerLocalId [expr ($i + 1)]
        <a name="::result_debug(67)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;routerLocaId: $routerLocalId&#34;
	set returnCode [<a name="::extrMakeIsisRouter(1)"><a href="./ISIS.tcl.html#::extrMakeIsisRouter_1233">::extrMakeIsisRouter</a></a> -interfaceId &#34;$interfaceId&#34; \
					   -interfaceIp &#34;$interfaceIp&#34; \
        				   -ipMask &#34;$mask&#34; \
					   -areaId &#34;$areaId&#34; \
					   -level $level \
					   -helloIntervalL1 $helloIntervalL1 \
					   -deadIntervalL1 $deadIntervalL1 \
					   -helloIntervalL2 $helloIntervalL2 \
					   -deadIntervalL2 $deadIntervalL2 \
					   -networkType $networkType \
					   -metric $metric \
					   -routeOrigin $routeOrigin\
					   -numNetworks $numNetworks \
					   -prefix $prefix \
					   -networkIp &#34;$networkIp&#34; \
					   -routeMetric $routeMetric \
					   -routerId &#34;$routerId&#34; \
					   -routerLocalId $routerLocalId \
                         -txPortId $txPortId \
                         -dutIp $dutIp]
      
        if {$returnCode==-1} {
            return -1
        }
    }
    
   switch -exact -- $TrafficGen {
      ixia -
      ixvm {
    protocolServer setDefault
    protocolServer config -enableArpResponse true
    protocolServer config -enablePingResponse true
    protocolServer config -enableIsisService true
    if {[protocolServer set $cha $car $por]} {
        error &#34;setupISISRouter: protocolServer set $cha $car $por failed.&#34;
    }
    
    set portList [list [list $cha $car $por]]   
    <a name="::result_debug(68)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Writing Configuration to Hardware...&#34;
    if {[<a name="::ixWriteConfigToHardware(3)"><a href="./mapping.tcl.html#::ixWriteConfigToHardware_151">::ixWriteConfigToHardware</a></a> portList]} {
        <a name="::result_debug(69)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Error writing config to hardware&#34;
    }
      }
   }
} ;<span class="comment-line"># setupISISRouter</span>

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: startIsis</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: This proc is used to start test equipment isis protocol adjacency</span>
<span class="comment-line">#              on the list of ports supplied via txPortIdList</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args:  txPortIdList</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#      startIsis 2</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: SendTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::startIsis_1079">proc <a href="ISIS.tcl-annot.html#::::startIsis">::::startIsis</a></a></strong> {txPortIdList} {
   global TrafficGen
   switch -exact -- $TrafficGen {
      ixia -
      ixvm {
    set pList &#34;&#34;
    foreach txPortId $txPortIdList {
	<a name="::MapIxiaPortId(4)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $txPortId cha car por
        <a name="::result_debug(70)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;startIsis: Chas: $cha Card: $car Port: $por&#34;
        lappend pList &#34;$cha $car $por&#34;
    }

    if {[ixStartIsis pList]} {
        error &#34;startIsis: ixStartIsis failed.&#34;
    }
}
      stc { <a name="::startBgp(1)"><a href="./bgp.tcl.html#::startBgp_54">::startBgp</a></a> $txPortIdList}
   }
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: stopIsis</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: This proc is used to stop test equipment isis protocol adjacency</span>
<span class="comment-line">#              on the list of ports supplied via txPortIdList</span>
<span class="comment-line">#              This proc is opposite of startIsis</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args:  txPortIdList</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#      stopIsis 2</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: SendTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::stopIsis_1118">proc <a href="ISIS.tcl-annot.html#::::stopIsis">::::stopIsis</a></a></strong> {txPortIdList} {
   global TrafficGen
   switch -exact -- $TrafficGen {
      ixia -
      ixvm {
    set pList &#34;&#34;
    foreach txPortId $txPortIdList {	
	<a name="::MapIxiaPortId(5)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $txPortId cha car por
        <a name="::result_debug(71)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;stopIsis: Chas: $cha Card: $car Port: $por&#34;
        lappend pList &#34;$cha $car $por&#34;
    }

    if {[ixStopIsis pList]} {
        error &#34;stopIsis: ixStopIsis failed.&#34;
    }
}
      stc { <a name="::stopBgp(1)"><a href="./bgp.tcl.html#::stopBgp_107">::stopBgp</a></a> $txPortIdList}
   }
}

<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: cleanupIsis</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: This proc is used to cleanup test equipment port for isis configuration</span>
<span class="comment-line">#              that was performed by setupISISRouter</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args:  txPortIdList</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#      cleanupIsis 2</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: SendTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::cleanupIsis_1156">proc <a href="ISIS.tcl-annot.html#::::cleanupIsis">::::cleanupIsis</a></a></strong> {txPortIdList} {
   global TrafficGen
   switch -exact -- $TrafficGen {
      ixia -
      ixvm {
    foreach txPortId $txPortIdList {    
        <span class="comment-line"># get the port information</span>
        <a name="::MapIxiaPortId(6)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $txPortId cha car por
        <a name="::result_debug(72)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;cleanupIsis: Chas: $cha Card: $car Port: $por&#34;
        
        <span class="comment-line"># select the port</span>
        if {[isisServer select $cha $car $por]} {
            error &#34;cleanupIsis: isisServer select $cha $car $por failed.&#34;
        }
        
        
        if {[isisServer getFirstRouter]} {
            error &#34;cleanupIsis: isisServer getFirstRouterfailed.&#34;
        }
        
        isisRouter clearAllInterfaces
        isisRouter clearAllRouteRanges
        isisRouter setDefault
        
        while {[isisServer getNextRouter] == 0} {
	    isisRouter clearAllInterfaces
	    isisRouter clearAllRouteRanges
	    isisRouter setDefault
        }
        
        if {[isisServer clearAllRouters]} {
            error &#34;cleanupIsis: isisServer clearAllRouters failed.&#34;
        }
        isisServer write
        
        ipAddressTable setDefault
        ipAddressTable clear
        ipAddressTable set $cha $car $por

        protocolServer setDefault
        protocolServer config -enableArpResponse false
        protocolServer config -enablePingResponse false
        protocolServer config -enableIsisService false
        if {[protocolServer set $cha $car $por]} {
            error &#34;cleanupIsis: Error Setting Protocol Server&#34;
        }
        if {[protocolServer write $cha $car $por]} {
            error &#34;cleanupIsis: protocolServer write $cha $car $por failed.&#34;
        }
    } ;<span class="comment-line"># foreach txPortId</span>
      }
      stc { cleanupBGP $txPortIdList }
   }
} ;<span class="comment-line"># cleanupIsis</span>


<span class="comment-line">################################################################## </span>
<span class="comment-line"># Procedure Name: extrMakeIsisRouter</span>
<span class="comment-line">#   </span>
<span class="comment-line"># Description: This internal proc is used to setup test equipment port for isis configuration</span>
<span class="comment-line">#              This is called within from setupISISRouter.</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args:  args</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#      set returnCode [extrMakeIsisRouter -interfaceIp $interfaceIp -ipMask $mask -areaId $areaId \</span>
<span class="comment-line">#          -helloInterval $helloInterval -deadInterval $deadInterval \</span>
<span class="comment-line">#          -networkType $networkType -metric $metric -numNetworks $numNetworks \</span>
<span class="comment-line">#          -prefix $prefix -networkIp $networkIp -routerId $routerId -txPortId $txPortId]</span>
<span class="comment-line">#</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (Setup,GetSwitchInfo,SendTraffic,CaptureTraffic,VerifySwitchOutput</span>
<span class="comment-line">#                          VerifyTraffic)</span>
<span class="comment-line"># Category: SendTraffic</span>
<span class="comment-line">##################################################################</span>
<strong><a name="::::extrMakeIsisRouter_1233">proc <a href="ISIS.tcl-annot.html#::::extrMakeIsisRouter">::::extrMakeIsisRouter</a></a></strong> {args} {
    <a name="::parse_args(3)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> extrMakeIsisRouter $args {
    	interfaceId &#34;&#34;
        interfaceIp &#34;&#34;
        ipMask &#34;&#34;
        areaId &#34;&#34;
        level &#34;isisLevel2&#34;
        helloIntervalL1 10
        deadIntervalL1 30
        helloIntervalL2 10
        deadIntervalL2 30
        networkType &#34;isisBroadcast&#34;
        metric 10
        routeMetric 10
        routeOrigin &#34;&#34;
	numNetworks 0
        prefix &#34;&#34;
        networkIp &#34;&#34;
        routerId &#34;&#34;
        routerLocalId &#34;1&#34;
        txPortId  &#34;1&#34;
      dutIp  &#34;&#34;
   }
   
    <a name="::result_debug(73)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;inside extrMakeIsisRouter&#34;
    <a name="::result_debug(74)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;interfaceId: $interfaceId&#34;
    <a name="::result_debug(75)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;interfaceIp: $interfaceIp&#34;
    <a name="::result_debug(76)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;ipMask: $ipMask&#34;
    <a name="::result_debug(77)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;areaId: $areaId&#34;
    <a name="::result_debug(78)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;level: $level&#34;
    <a name="::result_debug(79)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;prefix: $prefix&#34;
    <a name="::result_debug(80)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;networkIp: $networkIp&#34;
    <a name="::result_debug(81)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;routerId: $routerId&#34;
    <a name="::result_debug(82)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;routeOrigin: $routeOrigin&#34;
    isisRouter setDefault
    isisRouter clearAllInterfaces
    isisRouter clearAllRouteRanges
    isisRouter config -enable true
    isisRouter config -routerId $routerId
    isisRouter config -areaAddressList $areaId
    
    isisInterface setDefault
    isisInterface config -enable true
    isisInterface config -connectToDut true
    isisInterface config -ipAddress $interfaceIp
    isisInterface config -ipMask $ipMask
    isisInterface config -metric $metric
    isisInterface config -interfaceId $interfaceId
    isisInterface config -networkType $networkType
    isisInterface config -level $level
    isisInterface config -enableTrafficEngineering false
    isisInterface config -administrativeGroup {0.0.0.0}
    isisInterface config -maxBandwidth 0.0
    isisInterface config -maxReservableBandwidth 0.0
    isisInterface config -unreservedBandwidthPriority0 0.0
    isisInterface config -unreservedBandwidthPriority1 0.0
    isisInterface config -unreservedBandwidthPriority2 0.0
    isisInterface config -unreservedBandwidthPriority3 0.0
    isisInterface config -unreservedBandwidthPriority4 0.0
    isisInterface config -unreservedBandwidthPriority5 0.0
    isisInterface config -unreservedBandwidthPriority6 0.0
    isisInterface config -unreservedBandwidthPriority7 0.0
    isisInterface config -priorityLevel1 0
    isisInterface config -helloIntervalLevel1 $helloIntervalL1
    isisInterface config -deadIntervalLevel1 $deadIntervalL1
    isisInterface config -extendedDefaultMetric1 10
    isisInterface config -trafficEngineeringMetric1 10
    isisInterface config -priorityLevel2 0
    isisInterface config -helloIntervalLevel2 $helloIntervalL2
    isisInterface config -deadIntervalLevel2 $deadIntervalL2
    isisInterface config -extendedDefaultMetric2 10
    isisInterface config -trafficEngineeringMetric2 10

    if {[isisRouter addInterface interface1]} {
        error &#34;extrMakeIsisRouter: isisRouter addInterface interface1 failed.&#34;
    }
    set idx 0
    set rangeId 1
    while {[llength $networkIp] &gt; $idx} {
    	    set myIp [lindex $networkIp $idx]
	    set rMetric [lindex $routeMetric $idx]
	    set prefx [lindex $prefix $idx]
            set routeOrg [lindex $routeOrigin $idx]
	    set noOfNetworks [lindex $numNetworks $idx]
	    incr idx
	    isisRouteRange config -enable true
 	    isisRouteRange config -routeOrigin $routeOrg
  	    isisRouteRange config -metric $rMetric
	    isisRouteRange config -numberOfNetworks $noOfNetworks
	    isisRouteRange config -prefix $prefx
	    isisRouteRange config -networkIpAddress $myIp
	    isisRouter addRouteRange [format &#34;routeRange%02d&#34; $rangeId]
            isisRouteRange setDefault
            incr rangeId

   <span class="comment-line"># if {[isisRouter addRouteRange routeRange1]} {</span>
   <span class="comment-line">#     error &#34;extrMakeIsisRouter: isisRouter addRouteRange routeRange1 failed.&#34;</span>
    <span class="comment-line">#}</span>
}
    if {[isisServer addRouter router$routerLocalId]} {
        error &#34;extrMakeIsisRouter: isisServer addRouter router$routerLocalId failed.&#34;
    }
    
    return 0
} ;<span class="comment-line"># extrMakeIsisRouter</span>



<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name : checkIxiaCardTypeAndExecTest</span>
<span class="comment-line"># Description:</span>
<span class="comment-line"># This procedure checks for &#34;10/100 Base TX&#34; and &#34;GBIC&#34; cards and if those</span>
<span class="comment-line"># cards are found it will skip the test case</span>
<span class="comment-line">#</span>
<span class="comment-line"># optional Input args:</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Typical usage: checkIxiaCardTypeAndExecTest</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (SetupSwitch,GetSwitchInfo,SendTraffic,CaptureTraffic,</span>
<span class="comment-line">#                 SetupTestTool,VerifySwitchOutput,Utility,VerifyTraffic)</span>
<span class="comment-line"># Category: Utility</span>
<span class="comment-line">##################################################################</span>

<strong><a name="::::checkIxiaCardTypeAndExecTest_1356">proc <a href="ISIS.tcl-annot.html#::::checkIxiaCardTypeAndExecTest">::::checkIxiaCardTypeAndExecTest</a></a></strong> {testNo time1 txPortList} {

foreach txPort $txPortList {
       if {[<a name="::getIxiaPortType(1)"><a href="./ePTMisc.tcl.html#::getIxiaPortType_585">::getIxiaPortType</a></a> $txPort] == 1 || [<a name="::getIxiaPortType(2)"><a href="./ePTMisc.tcl.html#::getIxiaPortType_585">::getIxiaPortType</a></a> $txPort] == 8 } {
  result_skip &#34;Skipping this test as 10/100 Base Tx,GBIC cards do not support ISIS&#34;
          set time2 [clock seconds]
          result_p &#34;*** Time for $testNo = [expr $time2-$time1] secs\n\n&#34;
          <a name="::close_result_file(1)"><a href="./result.tcl.html#::close_result_file_363">::close_result_file</a></a>
          <a name="::report_end_test(4)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>
          return -code return
       }
    }

}


<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name : disIsisRouteRange</span>
<span class="comment-line"># Description:</span>
<span class="comment-line"># This procedure disables ISIS route ranges from a ISIS router in IXIA</span>
<span class="comment-line">#</span>
<span class="comment-line"># optional Input args:</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Typical usage: disIsisRouteRange 3 1</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (SetupSwitch,GetSwitchInfo,SendTraffic,CaptureTraffic,</span>
<span class="comment-line">#                 SetupTestTool,VerifySwitchOutput,Utility,VerifyTraffic)</span>
<span class="comment-line"># Category: Utility</span>
<span class="comment-line">##################################################################</span>

<strong><a name="::::disIsisRouteRange_1386">proc <a href="ISIS.tcl-annot.html#::::disIsisRouteRange">::::disIsisRouteRange</a></a></strong> {portId RouteRangeNo} {
        <a name="::MapIxiaPortId(7)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $portId cha car por
        <a name="::result_debug(83)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;disIsisRouteRange: Chas: $cha Card: $car Port: $por&#34;
        isisServer select $cha $car $por
        isisServer getRouter router1
        isisRouter cget -routerId
        isisRouter getRouteRange routeRange0$RouteRangeNo
        isisRouteRange config -enable false
        if [isisRouter setRouteRange routeRange0$RouteRangeNo] {
           <a name="::result_debug(84)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Error setting routerange&#34;
        }
        if [isisServer write] {
           <a name="::result_debug(85)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;problem in writing isiswriter&#34;
        }
}

<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name : enableIsisRouteRange</span>
<span class="comment-line"># Description:</span>
<span class="comment-line"># This procedure enable ISIS route ranges from a ISIS router in IXIA</span>
<span class="comment-line">#</span>
<span class="comment-line"># optional Input args:</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Typical usage: enableIsisRouteRange 3 3</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (SetupSwitch,GetSwitchInfo,SendTraffic,CaptureTraffic,</span>
<span class="comment-line">#                 SetupTestTool,VerifySwitchOutput,Utility,VerifyTraffic)</span>
<span class="comment-line"># Category: Utility</span>
<span class="comment-line">##################################################################</span>

<strong><a name="::::enableIsisRouteRange_1416">proc <a href="ISIS.tcl-annot.html#::::enableIsisRouteRange">::::enableIsisRouteRange</a></a></strong> {portId RouteRangeNo} {
        <a name="::MapIxiaPortId(8)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $portId cha car por
        <a name="::result_debug(86)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;disIsisRouteRange: Chas: $cha Card: $car Port: $por&#34;
        isisServer select $cha $car $por
        isisServer getRouter router1
        isisRouter getRouteRange routeRange0$RouteRangeNo
        isisRouteRange config -enable true
        if [isisRouter setRouteRange routeRange0$RouteRangeNo] {
           <a name="::result_debug(87)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;Error setting routerange&#34;
        }
        if [isisServer write] {
           <a name="::result_debug(88)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;problem in writing isiswriter&#34;
        }
}

<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name : disIsisAttach</span>
<span class="comment-line"># Description:</span>
<span class="comment-line"># This procedure disable attach bit in ISISsetup router in IXIA</span>
<span class="comment-line">#</span>
<span class="comment-line"># optional Input args:</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Typical usage:  disIsisAttach 1</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (SetupSwitch,GetSwitchInfo,SendTraffic,CaptureTraffic,</span>
<span class="comment-line">#                 SetupTestTool,VerifySwitchOutput,Utility,VerifyTraffic)</span>
<span class="comment-line"># Category: Utility</span>
<span class="comment-line">##################################################################</span>


<strong><a name="::::disIsisAttach_1446">proc <a href="ISIS.tcl-annot.html#::::disIsisAttach">::::disIsisAttach</a></a></strong> {portId} {
        <a name="::MapIxiaPortId(9)"><a href="./ePTPortMapping.tcl.html#::MapIxiaPortId_14">::MapIxiaPortId</a></a> $portId cha car por
        <a name="::result_debug(89)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;disIsisAttach: Chas: $cha Card: $car Port: $por&#34;
        isisServer select $cha $car $por

        if {[isisServer getFirstRouter]} {
            <a name="::result_debug(90)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;cleanupIsis: isisServer getFirstRouterfailed.&#34;
        }

        set nameIndex 2
        while {[isisServer getNextRouter] == 0} {
                isisRouter config -enableAttached false
                isisServer setRouter [format &#34;router%i&#34; $nameIndex]
                incr nameIndex
        }
        isisServer getRouter router1
        isisRouter config -enableAttached false
        isisServer setRouter router1

        if [isisServer write] {
           <a name="::result_debug(91)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;problem in writing isiswriter&#34;
        }

}

<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name : CheckRestartTlvIPv4</span>
<span class="comment-line"># Description:</span>
<span class="comment-line"># This procedure checks Restart TLV in ISIS Hello PDU for IPV4 interface</span>
<span class="comment-line">#</span>
<span class="comment-line"># optional Input args:</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Typical usage:  CheckRestartTlvIPv4</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (SetupSwitch,GetSwitchInfo,SendTraffic,CaptureTraffic,</span>
<span class="comment-line">#                 SetupTestTool,VerifySwitchOutput,Utility,VerifyTraffic)</span>
<span class="comment-line"># Category: Utility</span>
<span class="comment-line">##################################################################</span>


<strong><a name="::::CheckRestartTlvIPv4_1486">proc <a href="ISIS.tcl-annot.html#::::CheckRestartTlvIPv4">::::CheckRestartTlvIPv4</a></a></strong> {args} {
     <a name="::parse_args(4)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> CheckRestartTlvIPv4 $args {
     capPort &#34;4&#34;
     FirstDutno &#34;DUT1&#34;
     SecondDutno &#34;DUT2&#34;
     conditionCheck &#34;11&#34;		
     }
<span class="comment-line">################################################################</span>
set subTest &#34;Checking for RR and RA bit in Restart TLV in Hello PDUs &#34;
<span class="comment-line">################################################################</span>
result_h2 &#34;$subTest&#34;
<a name="::report_start_test(4)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;$subTest&#34;
set frameList [<a name="::GetCapturedFrames(1)"><a href="./ePTRx.tcl.html#::GetCapturedFrames_982">::GetCapturedFrames</a></a> $capPort NULL 2000]

set restart_clv_Adj &#34;D3 03 01 00 00 06 00&#34; 
set restart_clv_RR &#34;D3 03 01 00 00&#34;
set restart_clv_RR_PTOP &#34;D3 03 01&#34;
set restart_clv_RA &#34;D3 03 02&#34;
set numHello 0
set RR 0
set RA 0
set Adj 0

        foreach frame $frameList {
	  set frame [<a name="::RemoveIsisVlanTag(33)"><a href="./ISIS.tcl.html#::RemoveIsisVlanTag_131">::RemoveIsisVlanTag</a></a> $frame]
          set pduType [<a name="::GetIsisPduType(2)"><a href="./ISISv6.tcl.html#::GetIsisPduType_14">::GetIsisPduType</a></a> $frame]
	  <a name="::result_debug(92)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;PDUTYPE : $pduType&#34;
          set pduType1 &#34;ISIS_LEVEL1_HELLO&#34;
          set pduType2 &#34;ISIS_LEVEL2_HELLO&#34;
	  set pduType3 &#34;ISIS_PTOP_HELLO&#34;
           if {($pduType == $pduType1) || ($pduType == $pduType2) || ($pduType == $pduType3)} {
                        <a name="::result_debug(93)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;\n$pduType captured:&#34;
                        <a name="::result_debug(94)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$frame&#34;
                        set srcMac [<a name="::GetIsisSourceMacAddr(2)"><a href="./ISIS.tcl.html#::GetIsisSourceMacAddr_146">::GetIsisSourceMacAddr</a></a>  $frame]
                        set 8023Len [<a name="::GetIsisDlcLength(2)"><a href="./ISIS.tcl.html#::GetIsisDlcLength_150">::GetIsisDlcLength</a></a> $frame]
                        set destMac [<a name="::GetIsisDestMacAddr(2)"><a href="./ISIS.tcl.html#::GetIsisDestMacAddr_142">::GetIsisDestMacAddr</a></a> $frame]
                        set headerLen [<a name="::GetIsisHeaderLength(2)"><a href="./ISIS.tcl.html#::GetIsisHeaderLength_161">::GetIsisHeaderLength</a></a> $frame]
                        set idLen [<a name="::GetIsisIdLength(1)"><a href="./ISIS.tcl.html#::GetIsisIdLength_172">::GetIsisIdLength</a></a> $frame]
			if { ($pduType == $pduType3) } {
                        set restartTlvRR [string range $frame 111 124]	
			set restartTlvRA [string range $frame 111 118]
			set restartTlvAdj [string range $frame 111 131]
		        } else {
			set restartTlvRR [string range $frame 132 145]	
			set restartTlvRA [string range $frame 132 139]
			set restartTlvAdj [string range $frame 132 151]
			}
                        <a name="::result_debug(95)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;    ++++ Decoded $pduType packet ++++&#34;
                        <a name="::result_debug(96)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;destination MAC = $destMac &#34;
                        <a name="::result_debug(97)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;source MAC = $srcMac&#34;
                        <a name="::result_debug(98)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;802.3 length = $8023Len &#34;
                        <a name="::result_debug(99)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;header length = $headerLen&#34;
                        <a name="::result_debug(100)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;ID length = $idLen&#34;
                        <a name="::result_debug(101)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;RestartTLV value is RR=$restartTlvRR&#34;
                        <a name="::result_debug(102)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;RestartTLV value is RA=$restartTlvRA&#34;
			<a name="::result_debug(103)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;RestartTLV value is RR and Adj =$restartTlvAdj&#34;
    if {( $restartTlvRR == $restart_clv_RR) &amp;&amp; ($srcMac == [<a name="::GetDUTMac(2)"><a href="./misc.tcl.html#::GetDUTMac_380">::GetDUTMac</a></a> $FirstDutno &#34; &#34;])} {
                         incr RR
			 <a name="::result_debug(104)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$RR&#34;
     } elseif {( $restartTlvRA == $restart_clv_RA) &amp;&amp; ($srcMac == [<a name="::GetDUTMac(3)"><a href="./misc.tcl.html#::GetDUTMac_380">::GetDUTMac</a></a> $SecondDutno &#34; &#34;]) } {
                         incr RA
			 <a name="::result_debug(105)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$RA&#34;
		}

<span class="comment-line">#---tocheck RestartTLV set and ADJ set down</span>
	if {( $restartTlvAdj == $restart_clv_Adj) &amp;&amp; ($srcMac == [<a name="::GetDUTMac(4)"><a href="./misc.tcl.html#::GetDUTMac_380">::GetDUTMac</a></a> $FirstDutno &#34; &#34;])} {
        	         incr Adj
                	 <a name="::result_debug(106)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;$Adj&#34;
        	}
            }
     }


set type $conditionCheck
switch -- $type \
		&#34;11&#34; {
		if {$RR &gt;= 1 &amp;&amp; $RA &gt;= 1} {
      		<a name="::result_ok(5)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;IIH packet from DUTs are captured and RR - RA  \
			Bit is set in Planned/Unplanned/both state&#34;
       			} else {
     		<a name="::result_error(6)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;IIH packet from DUTs are captured and RR - RA  Bit is not set \
				PlannedUnplanned/both state&#34;
    			}
	     } &#34;00&#34; {  
		if {$RR == &#34;0&#34; &amp;&amp; $RA == &#34;0&#34;} {
		<a name="::result_ok(6)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;IIH packet from DUTs are captured and RR - RA  Bit \
			should not be set in NONE state&#34;       
		      } else {
	        <a name="::result_error(7)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;IIH packet from DUTs are captured and RR - RA  Bit \
			is set in NONE state&#34;
		      }
      	     } &#34;10&#34; {
		if {$RR &gt;= &#34;1&#34; &amp;&amp; $RA == &#34;0&#34;} {
		<a name="::result_ok(7)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;IIH packet from DUT1 are captured and RR Bit is set and RA bit \
				is not set for one switch config&#34;       
      			} else {
	  	<a name="::result_error(8)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;IIH packet from DUTs are captured and RR Bit is not set or RA bit \
				is also set for one switch config&#34;
			}
	     } &#34;01&#34; {
                if {$RA == &#34;0&#34; &amp;&amp; $Adj &gt;= &#34;1&#34;} {
                <a name="::result_ok(8)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;IIH packet from DUT1 are captured and RR Bit is set and Adjacency \
                                is set down and RA bit is not set by DUT-2&#34;
                        } else {
                <a name="::result_error(9)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;IIH packet from DUTs are captured and RR Bit is not set or RA bit \
                                is also set for one switch config or Adj is not down&#34;
                        }

	      }	&#34;L1-L2&#34; {
		if {$RR &gt;= &#34;2&#34; &amp;&amp; $RA &gt;= &#34;2&#34;} {
	      	<a name="::result_ok(9)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;IIH packet from DUT1 are captured and RR Bit and RA bit \
				is set in Planned/Unplanned/both state&#34;
	} else {
	        <a name="::result_error(10)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;IIH packet from DUTs are captured and RR Bit or RA bit is not set&#34;
			}
	     } default {
	        <a name="::result_debug(107)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;RA and RR bit not set accordingly&#34;
	        return -1
             }




<a name="::report_end_test(5)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>

}



<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name : startRestartTrafficIPv4</span>
<span class="comment-line"># Description:</span>
<span class="comment-line"># This procedure start traffic for restart TLV test cases for IPV4 interface</span>
<span class="comment-line">#</span>
<span class="comment-line"># optional Input args:</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Typical usage:  startRestartTrafficIPv4</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (SetupSwitch,GetSwitchInfo,SendTraffic,CaptureTraffic,</span>
<span class="comment-line">#                 SetupTestTool,VerifySwitchOutput,Utility,VerifyTraffic)</span>
<span class="comment-line"># Category: Utility</span>
<span class="comment-line">##################################################################</span>

<strong><a name="::::startRestartTrafficIPv4_1629">proc <a href="ISIS.tcl-annot.html#::::startRestartTrafficIPv4">::::startRestartTrafficIPv4</a></a></strong> {args} {
     <a name="::parse_args(5)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> startRestartTrafficIPv4 $args {
     Dut1Port &#34;1&#34;
     Dut2Port &#34;3&#34;
     }

upvar 1 dut1Mac dut1mac
upvar 1 dut2Mac dut2mac

<span class="comment-line">#---Verify the traffic flow between Dut1 and Dut 2</span>

<a name="::report_start_test(5)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;Transmit a ip frame between the ports&#34;

   set sip1 &#34;11.10.10.4&#34;;
   set dip1 &#34;12.10.10.4&#34;;

  <a name="::SendArpRequest(1)"><a href="./ePTSendPacket.tcl.html#::SendArpRequest_1127">::SendArpRequest</a></a> 1 11.10.10.4 11.10.10.1
  <a name="::SendArpRequest(2)"><a href="./ePTSendPacket.tcl.html#::SendArpRequest_1127">::SendArpRequest</a></a> 3 12.10.10.4 12.10.10.1

   <a name="::SendIpFrame(1)"><a href="./ePTSendPacket.tcl.html#::SendIpFrame_587">::SendIpFrame</a></a> -protocol &#34;ip&#34; -txPortId &#34;$Dut1Port&#34; -destMac $dut1mac \
		-destIp $dip1 -sourceIp $sip1 -streamType &#34;contPacket&#34; \
		-frameRate 14881 ;<span class="comment-line">#-percentage 10</span>

   <a name="::result_debug(108)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;sleep for 5s for packet transmission&#34;;
   <a name="::exSleep(1)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 5

  
   <a name="::SendIpFrame(2)"><a href="./ePTSendPacket.tcl.html#::SendIpFrame_587">::SendIpFrame</a></a> -protocol &#34;ip&#34; -txPortId &#34;$Dut2Port&#34; -destMac $dut2mac \
		-destIp $sip1 -sourceIp $dip1 -streamType &#34;contPacket&#34; \
		-frameRate 14881 ;<span class="comment-line">#-percentage 10</span>

   <a name="::result_debug(109)"><a href="./lconsoles.tcl.html#::result_debug_3">::result_debug</a></a> &#34;sleep for 5s for packet transmission&#34;;
   <a name="::exSleep(2)"><a href="./sleep.tcl.html#::exSleep_248">::exSleep</a></a> 5

<a name="::report_end_test(6)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>

}


<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name : checkRestartTrafficIPv4</span>
<span class="comment-line"># Description:</span>
<span class="comment-line"># This procedure checks traffic for restart TLV test cases for IPV4 interface</span>
<span class="comment-line">#</span>
<span class="comment-line"># optional Input args:</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Typical usage:  checkRestartTrafficIPv4</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (SetupSwitch,GetSwitchInfo,SendTraffic,CaptureTraffic,</span>
<span class="comment-line">#                 SetupTestTool,VerifySwitchOutput,Utility,VerifyTraffic)</span>
<span class="comment-line"># Category: Utility</span>
<span class="comment-line">##################################################################</span>

<strong><a name="::::checkRestartTrafficIPv4_1682">proc <a href="ISIS.tcl-annot.html#::::checkRestartTrafficIPv4">::::checkRestartTrafficIPv4</a></a></strong> {args} {
     <a name="::parse_args(6)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> checkRestartTrafficIPv4 $args {
     Dut1Port &#34;1&#34;
     Dut2Port &#34;3&#34;
     }

 <span class="comment-line">#---- Checking the traffic in port $Dut1Port</span>
   <a name="::result_ok(10)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Checking the traffic in port $Dut1Port&#34;
   set percentageList &#34;&#34;;
   lappend percentageList &#34;$Dut2Port 100&#34;;
   <a name="::CheckRates(1)"><a href="./ePTRx.tcl.html#::CheckRates_1509">::CheckRates</a></a> $Dut1Port $percentageList &#34;&#34; 1.5;
   unset percentageList;


 <span class="comment-line">#---- Checking the traffic in port $Dut1Port</span>
   <a name="::result_ok(11)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;Checking the traffic in port $Dut2Port&#34;
   set percentageList &#34;&#34;;
   lappend percentageList &#34;$Dut1Port 100&#34;;
   <a name="::CheckRates(2)"><a href="./ePTRx.tcl.html#::CheckRates_1509">::CheckRates</a></a> $Dut2Port $percentageList &#34;&#34; 1.5;

}

<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name : CheckOvlSet</span>
<span class="comment-line"># Description:</span>
<span class="comment-line"># This procedure checks the overload bit set in ISIS LSP PDU</span>
<span class="comment-line">#</span>
<span class="comment-line"># optional Input args:</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Typical usage:  CheckOvlSet 1 L1</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (SetupSwitch,GetSwitchInfo,SendTraffic,CaptureTraffic,</span>
<span class="comment-line">#                 SetupTestTool,VerifySwitchOutput,Utility,VerifyTraffic)</span>
<span class="comment-line"># Category: Utility</span>
<span class="comment-line">##################################################################</span>

<strong><a name="::::CheckOvlSet_1718">proc <a href="ISIS.tcl-annot.html#::::CheckOvlSet">::::CheckOvlSet</a></a></strong> {<a name="::port(5)"><a href="./ePTClient.tcl.html#::port_510">::port</a></a> Level} {

set frameLst [<a name="::GetCapturedFrames(2)"><a href="./ePTRx.tcl.html#::GetCapturedFrames_982">::GetCapturedFrames</a></a> $port]
set dutMac [<a name="::GetDUTMac(5)"><a href="./misc.tcl.html#::GetDUTMac_380">::GetDUTMac</a></a> DUT1]
set dutMac [split $dutMac :]
set validation 0
foreach frame $frameLst {
   set pduType [<a name="::GetIsisPduType(3)"><a href="./ISISv6.tcl.html#::GetIsisPduType_14">::GetIsisPduType</a></a> $frame]
   set srcMac [<a name="::GetIsisSourceMacAddr(3)"><a href="./ISIS.tcl.html#::GetIsisSourceMacAddr_146">::GetIsisSourceMacAddr</a></a>  $frame]
   switch $Level {

   &#34;L1&#34; {
        if {(($pduType == &#34;ISIS_LEVEL1_LSP&#34;) &amp;&amp; ($srcMac == $dutMac))} {
          set OvlBit [string range $frame 129 130]
          puts &#34;the overload bit captured is $OvlBit&#34;
          if {$OvlBit == &#34;05&#34;} {
             incr validation
          }
        }
        }

   &#34;L2&#34; {
        if {(($pduType == &#34;ISIS_LEVEL2_LSP&#34;) &amp;&amp; ($srcMac == $dutMac))} {
           set OvlBit [string range $frame 129 130]
           puts &#34;the overload bit captured is $OvlBit&#34;
           if {$OvlBit == &#34;07&#34;} {
              incr validation
           }
        }
        }
   &#34;L1L2&#34; {
        if {(($pduType == &#34;ISIS_LEVEL1_LSP&#34;) &amp;&amp; ($srcMac == $dutMac))} {
           set OvlBit [string range $frame 129 130]
           puts &#34;the overload bit captured is $OvlBit&#34;
           if {$OvlBit == &#34;07&#34;} {
              incr validation
           }
        }
        }
   }
}
<a name="::report_start_test(6)"><a href="./report.tcl.html#::report_start_test_79">::report_start_test</a></a> &#34;verify the overload bit is set on  Database \
                   sync failure&#34;
if $validation {
   <a name="::result_ok(12)"><a href="./lconsoles.tcl.html#::result_ok_9">::result_ok</a></a> &#34;overload bit set on OWN LSP on database sync failure&#34;
} else {
   <a name="::result_error(11)"><a href="./lconsoles.tcl.html#::result_error_6">::result_error</a></a> &#34;overload bit not set on own LSP on database sync failure&#34;
}
<a name="::report_end_test(7)"><a href="./report.tcl.html#::report_end_test_122">::report_end_test</a></a>
}





<span class="comment-line">##################################################################</span>
<span class="comment-line"># Procedure Name :  getISISLimit</span>
<span class="comment-line"># Description:</span>
<span class="comment-line"># This procedure sets the variable for scalability of different ISIS features</span>
<span class="comment-line">#</span>
<span class="comment-line"># optional Input args:</span>
<span class="comment-line"># Output args: None.</span>
<span class="comment-line"># Typical usage:  getISISLimit &#34;DUT2&#34; ISIS_RouteOrgination</span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types (SetupSwitch,GetSwitchInfo,SendTraffic,CaptureTraffic,</span>
<span class="comment-line">#                 SetupTestTool,VerifySwitchOutput,Utility,VerifyTraffic)</span>
<span class="comment-line"># Category: Utility</span>
<span class="comment-line">##################################################################</span>





<span class="comment-line">#---- Macro definitions for ISIS LIMITS</span>
<span class="comment-line">#---- ISIS_ADJACENCIES</span>
set Limits(ALL,bd-8810,ISIS_ADJACENCIES)                              	128
set Limits(ALL,bd-8806,ISIS_ADJACENCIES)                              	128
set Limits(ALL,SummitX450,ISIS_ADJACENCIES)                        	128
set Limits(ALL,BD-10808,ISIS_ADJACENCIES)                         	255
set Limits(ALL,BD-12804,ISIS_ADJACENCIES)                          	255
set Limits(ALL,pioneer,ISIS_ADJACENCIES)                                255

<span class="comment-line">#---- ISIS_ROUTERS</span>
set Limits(ALL,bd-8810,ISIS_ROUTERS)                              	128
set Limits(ALL,bd-8806,ISIS_ROUTERS)                              	128
set Limits(ALL,SummitX450,ISIS_ROUTERS)                        	        128
set Limits(ALL,BD-10808,ISIS_ROUTERS)                         		256
set Limits(ALL,BD-12804,ISIS_ROUTERS)                          		256
set Limits(ALL,pioneer,ISIS_ROUTERS)                                    256

<span class="comment-line">#---- ISIS_INTERFACE</span>
set Limits(ALL,bd-8810,ISIS_INTERFACE)                              	255
set Limits(ALL,bd-8806,ISIS_INTERFACE)                              	255
set Limits(ALL,SummitX450,ISIS_INTERFACE)                        	255
set Limits(ALL,BD-10808,ISIS_INTERFACE)                         	255
set Limits(ALL,BD-12804,ISIS_INTERFACE)                          	255
set Limits(ALL,pioneer,ISIS_INTERFACE)                                 255

<span class="comment-line">#--- ISIS_RouteOrgination</span>
set Limits(ALL,bd-8810,ISIS_RouteOrgination)                            20000
set Limits(ALL,bd-8806,ISIS_RouteOrgination)                            20000
set Limits(ALL,SummitX450,ISIS_RouteOrgination)                        	5000
set Limits(ALL,BD-10808,ISIS_RouteOrgination)                         	30000
set Limits(ALL,BD-12804,ISIS_RouteOrgination)                          	30000
set Limits(ALL,pioneer,ISIS_RouteOrgination)                           30000

<span class="comment-line">#--- ISIS_MaxRoutes per system</span>
set Limits(ALL,bd-8810,ISIS_MaxRoutes)                           	20000
set Limits(ALL,bd-8806,ISIS_MaxRoutes)                          	20000
set Limits(ALL,SummitX450,ISIS_MaxRoutes)                       	3000
set Limits(ALL,BD-10808,ISIS_MaxRoutes)                     		20000
set Limits(ALL,BD-10808,ISIS_MaxRoutes_MSMXL)                   	25000
set Limits(ALL,BD-12804,ISIS_MaxRoutes)                         	20000
set Limits(ALL,BD-12804,ISIS_MaxRoutes_6R)  	                   	25000
set Limits(ALL,pioneer,ISIS_MaxRoutes)                                  25000


<span class="comment-line">#--- ISIS Level1 routes in L1 router</span>
set Limits(ALL,bd-8810,ISISL1InL1)                           		25000
set Limits(ALL,bd-8806,ISISL1InL1)                            		25000
set Limits(ALL,SummitX450,ISISL1InL1)                        		5000
set Limits(ALL,BD-10808,ISISL1InL1)                     		120000
set Limits(ALL,BD-10808,ISISL1InL1_MSMXL)                     		180000
set Limits(ALL,BD-12804,ISISL1InL1)                          		120000
set Limits(ALL,BD-12804,ISISL1InL1_6R)                      		180000
set Limits(ALL,pioneer,ISISL1InL1)                                      120000

<span class="comment-line">#--- ISIS IPv6 Level1 routes in L1 router</span>
set Limits(ALL,bd-8810,ISISv6L1InL1)                           		10000
set Limits(ALL,bd-8806,ISISv6L1InL1)                           		10000
set Limits(ALL,SummitX450,ISISv6L1InL1)                        		5000
set Limits(ALL,BD-10808,ISISv6L1InL1)                     		30000
set Limits(ALL,BD-10808,ISISv6L1InL1_MSMXL)                    		65000
set Limits(ALL,BD-12804,ISISv6L1InL1)                          		40000
set Limits(ALL,BD-12804,ISISv6L1InL1_6R)                    		65000
set Limits(ALL,pioneer,ISISv6L1InL1)                                    40000


<span class="comment-line">#--- ISIS Level1 routes in L1_L2 router</span>
set Limits(ALL,bd-8810,ISISL1InL1_L2)                           	20000
set Limits(ALL,bd-8806,ISISL1InL1_L2)                            	20000
set Limits(ALL,SummitX450,ISISL1InL1_L2)                        	5000
set Limits(ALL,BD-10808,ISISL1InL1_L2)                     		20000
set Limits(ALL,BD-10808,ISISL1InL1_L2_MSMXL)                     	25000
set Limits(ALL,BD-12804,ISISL1InL1_L2)                          	20000
set Limits(ALL,BD-12804,ISISL1InL1_L2_6R)                       	25000
set Limits(ALL,pioneer,ISISL1InL1_L2)                                   20000

<span class="comment-line">#--- ISIS IPv6 Level1 routes in L1_L2 router</span>
set Limits(ALL,bd-8810,ISISv6L1InL1_L2)                           	10000
set Limits(ALL,bd-8806,ISISv6L1InL1_L2)                            	10000
set Limits(ALL,SummitX450,ISISv6L1InL1_L2)                        	3000
set Limits(ALL,BD-10808,ISISv6L1InL1_L2)                     		15000
set Limits(ALL,BD-10808,ISISv6L1InL1_L2_MSMXL)                     	25000
set Limits(ALL,BD-12804,ISISv6L1InL1_L2)                          	15000
set Limits(ALL,BD-12804,ISISv6L1InL1_L2_6R)                      	25000
set Limits(ALL,pioneer,ISISv6L1InL1_L2)                                 15000

<span class="comment-line">#--- ISIS Level2 routes in L2 Router</span>
set Limits(ALL,bd-8810,ISISL2InL2)                           		25000
set Limits(ALL,bd-8806,ISISL2InL2)                            		25000
set Limits(ALL,SummitX450,ISISL2InL2)                        		5000
set Limits(ALL,BD-10808,ISISL2InL2)                    		        120000
set Limits(ALL,BD-10808,ISISL2InL2_MSMXL)                     		180000
set Limits(ALL,BD-12804,ISISL2InL2)                          		120000
set Limits(ALL,BD-12804,ISISL2InL2_6R)                      		180000
set Limits(ALL,pioneer,ISISL2InL2)                                      120000

<span class="comment-line">#--- ISIS IPv6 Level2 routes in L2 Router</span>
set Limits(ALL,bd-8810,ISISv6L2InL2)                           		10000
set Limits(ALL,bd-8806,ISISv6L2InL2)                           		10000
set Limits(ALL,SummitX450,ISISv6L2InL2)                        		5000
set Limits(ALL,BD-10808,ISISv6L2InL2)                  		        30000
set Limits(ALL,BD-10808,ISISv6L2InL2_MSMXL)                    		65000
set Limits(ALL,BD-12804,ISISv6L2InL2)                          		40000
set Limits(ALL,BD-12804,ISISv6L2InL2_6R)                    		65000
set Limits(ALL,pioneer,ISISv6L2InL2)                                    40000

<span class="comment-line">#--- ISIS Level2 routes in L2_L1 Router</span>
set Limits(ALL,bd-8810,ISISL2InL1_L2)                           	25000
set Limits(ALL,bd-8806,ISISL2InL1_L2)                           	25000
set Limits(ALL,SummitX450,ISISL2InL1_L2)                        	5000
set Limits(ALL,BD-10808,ISISL2InL1_L2)                    	        120000
set Limits(ALL,BD-10808,ISISL2InL1_L2_MSMXL)                    	180000
set Limits(ALL,BD-12804,ISISL2InL1_L2)                          	120000
set Limits(ALL,BD-12804,ISISL2InL1_L2_6R) 	                    	180000
set Limits(ALL,pioneer,ISISL2InL1_L2)                                   120000

<span class="comment-line">#--- ISIS IPv6 Level2 routes in L2_L1 Router</span>
set Limits(ALL,bd-8810,ISISv6L2InL1_L2)                           	10000
set Limits(ALL,bd-8806,ISISv6L2InL1_L2)                           	10000
set Limits(ALL,SummitX450,ISISv6L2InL1_L2)                        	5000
set Limits(ALL,BD-10808,ISISv6L2InL1_L2)                    	        30000
set Limits(ALL,BD-10808,ISISv6L2InL1_L2_MSMXL)                    	65000
set Limits(ALL,BD-12804,ISISv6L2InL1_L2)                          	40000
set Limits(ALL,BD-12804,ISISv6L2InL1_L2_6R)                     	65000
set Limits(ALL,pioneer,ISISv6L2InL1_L2)                                 40000

<strong><a name="::::getISISLimit_1916">proc <a href="ISIS.tcl-annot.html#::::getISISLimit">::::getISISLimit</a></a></strong> {dutNo moduleParam} {
   global array Limits
   global gnssChassis
   global bcmChassis
   global bcmStackable
   global pioneerChassis

   if {[info exists Limits(ALL,ALL,$moduleParam)] } {
      return $Limits(ALL,ALL,$moduleParam)
   }

   set version [<a name="::GetVersion(1)"><a href="./misc.tcl.html#::GetVersion_303">::GetVersion</a></a> $dutNo 2]
   set platform [<a name="::GetPlatform(1)"><a href="./misc.tcl.html#::GetPlatform_478">::GetPlatform</a></a> $dutNo]

 if {[regexp -nocase $bcmChassis $platform] == 1} {
     set platform &#34;bd-8810&#34;
   } elseif {[regexp -nocase $bcmStackable $platform] == 1 } {
     set platform &#34;SummitX450&#34;
   } elseif {[regexp -nocase $gnssChassis $platform] == 1 } {
     set platform &#34;BD-10808&#34;
     if {[regexp -nocase &#34;BD-12804&#34; $platform] == 1 } {
        set platform &#34;BD-12804&#34;
     }
   } elseif {[regexp -nocase $pioneerChassis $platform]} {
     set platform &#34;pioneer&#34;
   }
 

   if {[info exists Limits($version,$platform,$moduleParam)] } {
      return $Limits($version,$platform,$moduleParam)
   }

   return $Limits(ALL,$platform,$moduleParam)
}


</pre>
<hr>
<div class="index-selector">
	<a href="index_main.html#byfilename">file name</a> 
 | 
	<a href="index_main.html#byprocname">procedure name</a> 
 | 
	<a href="index_main.html#bycall">procedure call</a> 
 | 
	<a href="index_annot_full.html">annotation</a> 

<br>
<cite>File generated 2018-06-14 at 17:09.</cite>
</div>

</body>
</html>
