<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/transitional.dtd">
<!-- Generated by TclDoc @@VERSION@@ -->
<html>
<head>
  <title>SiebelAccess.tcl</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="default.css">
</head>
<body class="src-html">
<div class="index-selector">
<!-- index for tcl source files -->
	Index by: 
	<a href="index_main.html#SiebelAccess.tcl">file name</a> | 
	<a href="index_main.html#byprocname">procedure name</a> | 
	<a href="index_main.html#bycall">procedure call</a> | 
	<a href="index_annot_full.html">annotation</a>

</div>
<hr>

<p><strong>SiebelAccess.tcl</strong>&nbsp;&nbsp;<span class="filetype-link">(<a href="SiebelAccess.tcl-annot.html">annotations</a> | <a href="SiebelAccess.tcl.txt">original source</a>)</span>
</p>
<pre class="src-code">

lappend auto_path &#34;/usr/lib/tcl8.3/lib&#34;
package require Oratcl
package require -exact Oratcl 4.1


<strong><a name="::::getPDStatus_7">proc <a href="SiebelAccess.tcl-annot.html#::::getPDStatus">::::getPDStatus</a></a></strong> {hdl pdList pdStatus } {
  upvar $pdStatus pdStatusArray

  foreach pd $pdList {
    set sql &#34;select status_cd from siebel.s_prod_defect where defect_num = '$pd'&#34;
    set status [<a name="::ExecuteSQL(1)"><a href="./SiebelAccess.tcl.html#::ExecuteSQL_143">::ExecuteSQL</a></a> $hdl $sql] 
    set pdStatusArray($pd) $status
  }
  return 0
}

<span class="comment-line">##################################################################i########</span>
<span class="comment-line"># Procedure Name: getPdCreateDate </span>
<span class="comment-line">#</span>
<span class="comment-line"># Description: Connects to Siebel server, executes the SQL query to</span>
<span class="comment-line">#              find the create date of a PD.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: pdList    - List of PDs to be checked</span>
<span class="comment-line">#             pdStatus  - Array to be returned with all the PDs and their status.</span>
<span class="comment-line">#             hdl - Handle to the sieble connection.</span>
<span class="comment-line"># Output args: pdAgeArray</span>
<span class="comment-line"># Typical usage:</span>
<span class="comment-line">#             getPdCreateDate $hdl $pdList pdAgeArray </span>
<span class="comment-line">#</span>
<span class="comment-line"># Category Types : Query Siebel</span>
<span class="comment-line">#</span>
<span class="comment-line"># Constraints : OraTcl4.1 and Oracle9.0 client should be installed</span>
<span class="comment-line">#################################################################i#########</span>

<strong><a name="::::getPdCreateDate_36">proc <a href="SiebelAccess.tcl-annot.html#::::getPdCreateDate">::::getPdCreateDate</a></a></strong> {hdl pdList pdAge } {
  upvar $pdAge pdAgeArray

  foreach pd $pdList {
    set sql &#34;select  created from siebel.s_prod_Defect where defect_num = '$pd'&#34;
    set crDate [<a name="::ExecuteSQL(2)"><a href="./SiebelAccess.tcl.html#::ExecuteSQL_143">::ExecuteSQL</a></a> $hdl $sql] 
    set pdAgeArray($pd) $crDate
  }
  return 0
}

<span class="comment-line">##################################################################i########</span>
<span class="comment-line"># Procedure Name: OpenSiebelSession </span>
<span class="comment-line">#</span>
<span class="comment-line"># Description: To open a session with Siebel server.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: None.</span>
<span class="comment-line"># Output args: handle to the connection </span>
<span class="comment-line"># Typical usage:  set lda [OpenSiebelSession]</span>
<span class="comment-line">#     </span>
<span class="comment-line"># Category Types : Init Siebel</span>
<span class="comment-line">#</span>
<span class="comment-line"># Constraints : OraTcl4.1 and Oracle9.0 client should be installed</span>
<span class="comment-line">#################################################################i#########</span>

<strong><a name="::::OpenSiebelSession_61">proc <a href="SiebelAccess.tcl-annot.html#::::OpenSiebelSession">::::OpenSiebelSession</a></a></strong> { } {
  set connect isoper/isoper@sblprd
  set lda [oralogon $connect]

  if { [ oramsg $lda rc ] == 0 } {
    puts &#34;Successfully connected to Siebel.&#34;
  } else {
    puts &#34;Unable to connect: [oramsg $lda rc]&#34;
    return -1
  }
  return $lda
}

<span class="comment-line">##################################################################i########</span>
<span class="comment-line"># Procedure Name: CloseSiebelSession </span>
<span class="comment-line">#</span>
<span class="comment-line"># Description: To close a session with Siebel server.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: Handle to the connection.</span>
<span class="comment-line"># Output args: None</span>
<span class="comment-line"># Typical usage:  CloseSiebelSession $lda</span>
<span class="comment-line">#     </span>
<span class="comment-line"># Category Types : logoff  Siebel</span>
<span class="comment-line">#</span>
<span class="comment-line"># Constraints : OraTcl4.1 and Oracle9.0 client should be installed</span>
<span class="comment-line">#################################################################i#########</span>

<strong><a name="::::CloseSiebelSession_88">proc <a href="SiebelAccess.tcl-annot.html#::::CloseSiebelSession">::::CloseSiebelSession</a></a></strong> { lda } {
     oralogoff $lda
}

<span class="comment-line">##################################################################i########</span>
<span class="comment-line"># Procedure Name: LoginSiebel </span>
<span class="comment-line">#</span>
<span class="comment-line"># Description: To open a session with oracle database.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: Handle to the siebel connection.</span>
<span class="comment-line"># Output args:handle to the db connection</span>
<span class="comment-line"># Typical usage: set hdl [LoginSiebel $lda]</span>
<span class="comment-line">#     </span>
<span class="comment-line"># Category Types : init  Siebel</span>
<span class="comment-line">#</span>
<span class="comment-line"># Constraints : OraTcl4.1 and Oracle9.0 client should be installed</span>
<span class="comment-line">#################################################################i#########</span>

<strong><a name="::::LoginSiebel_106">proc <a href="SiebelAccess.tcl-annot.html#::::LoginSiebel">::::LoginSiebel</a></a></strong> { lda } {
    set hdl [oraopen $lda]
    return $hdl
}

<span class="comment-line">##################################################################i########</span>
<span class="comment-line"># Procedure Name: LogoutSiebel </span>
<span class="comment-line">#</span>
<span class="comment-line"># Description: To close a session with oracle database.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: Handle to the db connection</span>
<span class="comment-line"># Output args: None</span>
<span class="comment-line"># Typical usage: LogoutSiebel $hdl</span>
<span class="comment-line">#     </span>
<span class="comment-line"># Category Types : init  Siebel</span>
<span class="comment-line">#</span>
<span class="comment-line"># Constraints : OraTcl4.1 and Oracle9.0 client should be installed</span>
<span class="comment-line">#################################################################i#########</span>

<strong><a name="::::LogoutSiebel_125">proc <a href="SiebelAccess.tcl-annot.html#::::LogoutSiebel">::::LogoutSiebel</a></a></strong> { hdl } {
    oraclose $hdl
}

<span class="comment-line">##################################################################i########</span>
<span class="comment-line"># Procedure Name: ExecuteSQL </span>
<span class="comment-line">#</span>
<span class="comment-line"># Description: To execute SQL query on Sieble database.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: Handle to the db connection, SQL string</span>
<span class="comment-line"># Output args: output of the SQL query.</span>
<span class="comment-line"># Typical usage: set row [ExecuteSQL $hdl $sql]</span>
<span class="comment-line">#     </span>
<span class="comment-line"># Category Types : Use  Siebel</span>
<span class="comment-line">#</span>
<span class="comment-line"># Constraints : OraTcl4.1 and Oracle9.0 client should be installed</span>
<span class="comment-line">#################################################################i#########</span>

<strong><a name="::::ExecuteSQL_143">proc <a href="SiebelAccess.tcl-annot.html#::::ExecuteSQL">::::ExecuteSQL</a></a></strong> { hdl sql } {
    set data &#34;Not Found&#34;
    orasql $hdl $sql
    set ret [orafetch $hdl -datavariable row]
    if { $ret == 0 } {
        set data $row
    }
    return $data
}

<span class="comment-line">##################################################################i########</span>
<span class="comment-line"># Procedure Name: GetPdInfo </span>
<span class="comment-line">#</span>
<span class="comment-line"># Description: To execute SQL query on Sieble database with dataarray option.</span>
<span class="comment-line">#</span>
<span class="comment-line"># Input args: Handle to the db connection, SQL string,array to hold the output data.</span>
<span class="comment-line"># Output args: output of the SQL query in a array.</span>
<span class="comment-line"># Typical usage: set row [GetPdInfo $hdl $sql row]</span>
<span class="comment-line">#     </span>
<span class="comment-line"># Category Types : Use  Siebel</span>
<span class="comment-line">#</span>
<span class="comment-line"># Constraints : OraTcl4.1 and Oracle9.0 client should be installed</span>
<span class="comment-line">#################################################################i#########</span>

<strong><a name="::::GetPdInfo_167">proc <a href="SiebelAccess.tcl-annot.html#::::GetPdInfo">::::GetPdInfo</a></a></strong> { hdl sql dataArray } {
     upvar $dataArray row
     orasql $hdl $sql
     set ret [orafetch $hdl -dataarray row]
     return $ret
}
</pre>
<hr>
<div class="index-selector">
	<a href="index_main.html#byfilename">file name</a> 
 | 
	<a href="index_main.html#byprocname">procedure name</a> 
 | 
	<a href="index_main.html#bycall">procedure call</a> 
 | 
	<a href="index_annot_full.html">annotation</a> 

<br>
<cite>File generated 2018-06-14 at 17:09.</cite>
</div>

</body>
</html>
