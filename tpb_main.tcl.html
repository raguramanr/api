<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/transitional.dtd">
<!-- Generated by TclDoc @@VERSION@@ -->
<html>
<head>
  <title>tpb_main.tcl</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="default.css">
</head>
<body class="src-html">
<div class="index-selector">
<!-- index for tcl source files -->
	Index by: 
	<a href="index_main.html#tpb_main.tcl">file name</a> | 
	<a href="index_main.html#byprocname">procedure name</a> | 
	<a href="index_main.html#bycall">procedure call</a> | 
	<a href="index_annot_full.html">annotation</a>

</div>
<hr>

<p><strong>tpb_main.tcl</strong>&nbsp;&nbsp;<span class="filetype-link">(<a href="tpb_main.tcl-annot.html">annotations</a> | <a href="tpb_main.tcl.txt">original source</a>)</span>
</p>
<pre class="src-code">
<span class="comment-line">#!/usr/bin/tclsh</span>


source ../Lib/mainLib.tcl
source ../Lib/mysqlLib.tcl
source ../Lib/parse_args.tcl
source runReg.cfg
source cfg/common.cfg



package require http 1.0;
package require Tclx


<a name="::parse_args(1)"><a href="./parse_args.tcl.html#::parse_args_29">::parse_args</a></a> tpb_main $argv {
    mode &#34;null&#34;
    module &#34;null&#34;
    cfg &#34;null&#34;
    lst &#34;dev&#34;
    tcList &#34;all&#34;
    regPath &#34;Functional&#34;
    cc &#34;&#34;
    cliFlag &#34;&#34;
    build &#34;&#34;
    subversion &#34;&#34;
    obuild &#34;&#34;
    moduleArg &#34;&#34;
    debugLevel &#34;0&#34;
    randomIndex &#34;unknown&#34;
    efence &#34;no&#34;
    saveConfigPerTest &#34;no&#34;
    stopRegOn &#34;null&#34;
    qId &#34;null&#34;
    heapTracingProcess &#34;no&#34;
    ezinfofile &#34;&#34;
    ezkillfile &#34;&#34;
    TrafficGen &#34;ixia&#34;
    harness &#34;tcl&#34;
    trackport  &#34;null&#34;
    launchserver &#34;off&#34;
    dispatch_id &#34;null&#34;
}


if {![file isdirectory Log]} {
        file mkdir Log
}
if {![file isdirectory Log/Regressions]} {
        file mkdir Log/Regressions
}


set cfgList [split [string trim [string trim $cfg &#34;..&#34;] &#34;/&#34;] &#34;/&#34;]
set cfgCount [llength $cfgList]
set nameCfg [lindex $cfgList [expr $cfgCount - 1]]
if {[catch {regsub -nocase &#34;\.cfg&#34; $nameCfg &#34;&#34; nCfg} why]} {
    set logFileName1 &#34;biglog${dispatch_id}.txt&#34;
} else {
    set logFileName1 &#34;${nCfg}${dispatch_id}.txt&#34;
}


set logFileName &#34;Log/Regressions/$logFileName1&#34;
set dir &#34;main&#34;
set link &#34;http://${RESWEB}/${dir}/${logFileName}&#34;

puts &#34;\n@@@@ TPB TCL BIG LOG Link @@@@&#34;
puts $link
puts &#34;@@@@ Test Builder END BIG LOG Link @@@@&#34;

if {[catch {open &#34;$logFileName&#34; a 0777} fd_big]} {
    puts &#34;Could not open BIG LOG&#34;
} else {
    puts $fd_big &#34;\n -------------------------------------------------------------&#34;
    puts $fd_big &#34;Anchor_Start: $regPath $module&#34; 
    puts $fd_big &#34; -------------------------------------------------------------\n&#34;
    puts $fd_big &#34; main.tcl \
    -mode \&#34;$mode\&#34; \
    -module \&#34;$module\&#34;\n \
    -cfg \&#34;$cfg\&#34;\n \
    -lst \&#34;$lst\&#34;\n \
    -tcList \&#34;$tcList\&#34;\n \
    -regPath \&#34;$regPath\&#34;\n \
    -cc \&#34;$cc\&#34;\n \
    -cliFlag \&#34;$cliFlag\&#34;\n \
    -build \&#34;$build\&#34;\n \
    -subversion \&#34;$subversion\&#34;\n \
    -obuild \&#34;$obuild\&#34;\n \
    -moduleArg \&#34;$moduleArg\&#34;\n \
    -debugLevel \&#34;$debugLevel\&#34;\n \
    -randomIndex \&#34;$randomIndex\&#34;\n \
    -efence \&#34;$efence\&#34;\n \
    -saveConfigPerTest \&#34;$saveConfigPerTest\&#34;\n \
    -stopRegOn \&#34;$stopRegOn\&#34;\n \
    -qId \&#34;$qId\&#34;\n \
    -heapTracingProcess \&#34;$heapTracingProcess\&#34;\n \
    -ezinfofile \&#34;$ezinfofile\&#34;\n \
    -ezkillfile \&#34;$ezkillfile\&#34;\n \
    -TrafficGen \&#34;$TrafficGen\&#34;\n \
    -harness \&#34;$harness\&#34;\n \
    -trackport  \&#34;$trackport\&#34;\n \
    -launchserver \&#34;$launchserver\&#34;\n&#34;
    puts $fd_big &#34;\n -------------------------------------------------------------&#34;
    close $fd_big
}
if {[catch { exec {tclsh} main.tcl \
    -mode &#34;$mode&#34; \
    -module &#34;$module&#34; \
    -cfg &#34;$cfg&#34; \
    -lst &#34;$lst&#34; \
    -tcList &#34;$tcList&#34; \
    -regPath &#34;$regPath&#34; \
    -cc &#34;$cc&#34; \
    -cliFlag &#34;$cliFlag&#34; \
    -build &#34;$build&#34; \
    -subversion &#34;$subversion&#34; \
    -obuild &#34;$obuild&#34; \
    -moduleArg &#34;$moduleArg&#34; \
    -debugLevel &#34;$debugLevel&#34; \
    -randomIndex &#34;$randomIndex&#34; \
    -efence &#34;$efence&#34; \
    -saveConfigPerTest &#34;$saveConfigPerTest&#34; \
    -stopRegOn &#34;$stopRegOn&#34; \
    -qId &#34;$qId&#34; \
    -heapTracingProcess &#34;$heapTracingProcess&#34; \
    -ezinfofile &#34;$ezinfofile&#34; \
    -ezkillfile &#34;$ezkillfile&#34; \
    -TrafficGen &#34;$TrafficGen&#34; \
    -harness &#34;$harness&#34; \
    -trackport  &#34;$trackport&#34; \
    -launchserver &#34;$launchserver&#34; \
    &gt;@stdout | busybox tee -a $logFileName } result]} {
    
        puts &#34;tpb_main call to main returned error: $result&#34;
        puts &#34;@@@@ TPB_MAIN call to main EXITED @@@@&#34;
        if {[catch {open &#34;$logFileName&#34; a 0777} fd_big]} {
            puts &#34;Could not open BIG LOG&#34;
        } else {
            puts $fd_big &#34;\n\n\ntpb_main call to main returned error: $result\n\n\n&#34;
            close $fd_big
        }
}
</pre>
<hr>
<div class="index-selector">
	<a href="index_main.html#byfilename">file name</a> 
 | 
	<a href="index_main.html#byprocname">procedure name</a> 
 | 
	<a href="index_main.html#bycall">procedure call</a> 
 | 
	<a href="index_annot_full.html">annotation</a> 

<br>
<cite>File generated 2018-06-14 at 17:09.</cite>
</div>

</body>
</html>
